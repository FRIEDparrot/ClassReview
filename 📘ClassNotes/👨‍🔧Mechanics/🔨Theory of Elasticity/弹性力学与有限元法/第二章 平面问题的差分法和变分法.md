##  一、差分公式的概念和建立

对于弹性力学问题，数值解法中有两种最基本的解法， 即<mark style="background: transparent; color: yellow">差分法和变分法</mark>

差分法是<u>微分方程的一种近似数值解法</u>，其基本方法是将<mark style="background: transparent; color: yellow">微分使用有限差分进行代替</mark>，并使用<mark style="background: transparent; color: yellow">有限差商代替导数</mark>，从而使用差分方程代替<u>基本方程和边界条件</u>，并将求解微分方程的问题转换成求解代数方程的问题

![[第二章 平面问题的差分法和变分法 2023-03-09 14.34.10|200]]

上图中，使用泰勒展开，其中设$\Delta x = \Delta y = h$，并略去三阶以上小量，则有
$$f_1 = f_0 + h\frac{\partial f}{\partial x}+\frac{h^2}{2} \frac{\partial^2 f}{\partial x^2} \qquad  f_3 = f_0 - h\frac{\partial f}{\partial x} + \frac{h^2}{2} \frac{\partial^2 f}{\partial x^2}$$
并使用类似[[Chapter1 Philosophy of Computational Fluid Dynamics#1. The Finite Difference Method|计算流体力学中的有限差分法]]中的推导过程，可以得到<u>抛物线差分公式</u>
$$\Large\begin{matrix}
\left( \frac{\partial f}{\partial x}\right)_0 = \frac{f_1  - f_3}{2h} \\
\left( \frac{\partial^2 f}{\partial x^2}\right)_0 = \frac{f_1 + f_3 - 2f_0}{h^2} \\
\left( \frac{\partial f}{\partial y}\right)_0 = \frac{f_4 - f_2}{2h} \\
\left( \frac{\partial^2 f}{\partial ^2 y}\right)_0 = \frac{f_2 + f_4 -2f_0}{h^2} \\
\left(\frac{\partial^2 f}{\partial x\partial y} \right) = \frac{1}{4h^2}\left[ (f_6 + f_8) - (f_5 + f_7)\right]
\end{matrix}$$

`````ad-note
title: 四阶导数差分公式
collapse: close


$$\left(\frac{\partial^4 f}{\partial x^4} \right)_0 = \frac{1}{h^4}\left[ 6f_0 - 4(f_1 + f_3) +(f_9 + f_{11})\right]$$
$$\left(\frac{\partial^4 }{\partial^2 x \partial^2 y} \right)_0 = \frac{1}{h^4} \left[ 4f_0- 2(f_1 + f_2 + f_3 + f_4) + (f_5 + f_6 + f_7 + f_8) \right]$$

`````

## 二、应力函数的差分解

#### (1) 应力的表示
在不计体力时，利用[[2. 经典的弹性力学应力问题求解#2. 应力函数求解思想|应力函数方法]]
$$\sigma_x = \frac{\partial^2 \Phi}{\partial y^2} \qquad \sigma_y = \frac{\partial^2 \Phi}{\partial x^2} \qquad \tau_{xy}= -\frac{\partial^2 \Phi}{\partial x\partial y}$$
利用上式的有限差分表示，则有**差分形式的应力表示**
$$\boxed{\large\begin{matrix}
\sigma_{x,0} =\left( \frac{\partial \Phi}{\partial y}\right)_0 = \frac{\Phi_4 - \Phi_2}{2h} \\
\sigma_{y,0} = \left( \frac{\partial^2 \Phi}{\partial x^2}\right)_0 = \frac{\Phi_1 + \Phi_3 - 2\Phi_0}{h^2} \\
\tau_{xy} = \frac{1}{4h^2}\left[(\Phi_5 + f_7) - (\Phi_6 + \Phi_8)\right]
\end{matrix}} \tag{5.9}$$
其中, 平衡方程，本构关系和弹性力学中的部分相同，而点的表示为:
![[第二章 平面问题的差分法和变分法 2023-03-09 14.34.10|200]]

#### (2) 协调方程
对于弹性体边界内各个节点处的$\Phi$值，必须满足协调方程，即
$$\nabla^2 (\sigma_x + \sigma_y) = 0 \quad \text{that is } \left( \frac{\partial^4 \Phi}{\partial x^4}\right) +  2\left( \frac{\partial^4 \Phi}{\partial x^2 \partial y^2}\right) + \left( \frac{\partial^4 \Phi}{\partial y^4}\right) =  0 \qquad \nabla^4 \Phi = 0$$
代入通过 <mark style="background: transparent; color: yellow">（推导之后写）</mark>得到：
$$\large\boxed{20 \Phi_0 - 8(\Phi_1 + \Phi_2 +\Phi_3 + \Phi_4) + 2(\Phi_5 + \Phi_6 + \Phi_7 + \Phi_8) + (\Phi_9 + \Phi_{10} + \Phi_{11} + \Phi_{12}) = 0}\tag{5-10}$$
此式即为**差分形式的协调方程**

#### (3) 边界条件
边界条件为
$$\begin{cases}
l \sigma_x + m\tau_{xy} = p_x \\ 
l \tau_{xy} + m \sigma_y = p_y
\end{cases}$$
代入应力函数的差分公式，则可以转换为：
$$\begin{cases}
l\frac{\partial^2 \Phi}{\partial y^2} - m \frac{\partial^2 \Phi}{\partial x \partial y} = p_x \\
- l\frac{\partial^2 \Phi}{\partial x \partial y} + m \frac{\partial^2 \Phi}{\partial x^2} = p_y
\end{cases}$$

![[第二章 平面问题的差分法和变分法 2023-03-14 13.59.40|300]]
显然有： 
$$ l =  \cos<n,x> = \frac{dy}{ds} \qquad m = \cos<n,y> = -\frac{dx}{ds}$$
通过重要推导[[有限元方法应力函数差分关系的推导.pdf]]
可以解得下列公式
$$\boxed{\left(\frac{\partial \Phi}{\partial y}\right)_B = \int_{A}^{B}f_x ds \qquad \quad \left(\frac{\partial \Phi}{\partial x}\right)_B = -\int_{A}^{B}f_y ds \tag{5-12}}$$
$$\boxed{\Phi_B = \int_{A}^{B}(x-x_B)f_y ds - \int_{A}^{B}(y - y_B) f_x ds }\tag{5-13}$$
但是需要注意的是，对于单连体我们导出了上述结果，对于多连体，上述推导中的假设
$$\Phi_A = \left( \frac{\partial \Phi}{\partial x}\right)_A = \left( \frac{\partial \Phi}{\partial y}\right)_A = 0$$
不再成立（由于应力函数$\Phi$不再具有任意性），而需要使用位移单值条件来进行确定。
另外，上述边界外一行的$\Phi$值，则可以使用函数$\Phi$在边界上的导数值和边界内一行的导数值来进行表示， 对于下图中， 可以表示有: 
![[第二章 平面问题的差分法和变分法 2023-03-09 14.34.10|200]]
$$\left(\frac{\partial \Phi}{\partial x}\right)_A = \frac{\Phi_{13}- \Phi_{9}}{2h},  \qquad \left(\frac{\partial \Phi}{\partial y}\right)_B = \frac{\Phi_{14} -\Phi_{10}}{2h}$$
即
$$\Phi_{13} = \Phi_9 + 2h\left( \frac{\partial \Phi}{\partial x}\right)_A \qquad \Phi_{14} = \Phi_8  + 2h \left( \frac{\partial \Phi}{\partial y}\right)_B\tag{5-14}$$

`````ad-note
title: 实际有限元计算中的一般步骤
collapse: open

1. 在边界上任意选定一个节点作为基点$A$,  并取$\Phi_A = \left(\frac{\partial \Phi}{\partial x} \right)_A = \left( \frac{\partial \Phi}{\partial y}\right)_A = 0$, 使用面力的矩和面力之和计算边界上各个节点的$\Phi$值, 以及对应部分所需要的$\frac{\partial \Phi}{\partial x}, \frac{\partial \Phi}{\partial y}$的值
2. 用$(5.14)$表示出边界外一行的虚节点处的$\Phi$值
3. 在内部节点处建立差分方程$(5-10)$, 并联立求解
4. 按照$(5.14)$求解虚节点的$\Phi$
5. 使用差分方程$(5-9)$计算应力分量
`````

`````ad-tip
title: 对于边界情况是曲线的计算思路
collapse: open
通过[[边界为曲线的泰勒展开公式推导.pdf]]

可以得到以下的求解曲线边界应力差分公式：
$$\Phi_9 = \frac{1- \xi^2}{(1+\xi)^2}\Phi_0 + \frac{4\xi}{(1+\xi)^2}\Phi_B + \frac{2(1- \xi)}{1+ \xi} h \left( \frac{\partial \Phi}{\partial x}\right)_B$$
$$\Phi_1 = \frac{\xi^2}{(1+  \xi)^2} \Phi_0 + \frac{1 + 2\xi}{(1 + \xi)^2} \Phi_B + \frac{-\xi}{(1 + \xi)^2} h\left( \frac{\partial \Phi}{\partial x}\right)_B$$
`````

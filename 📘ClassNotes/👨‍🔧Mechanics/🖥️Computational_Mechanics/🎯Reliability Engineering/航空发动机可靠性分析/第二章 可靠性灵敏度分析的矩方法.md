---
~
---
## ä¸€ã€ä¸€æ¬¡äºŒé˜¶çŸ©æ–¹æ³•(FOSM) 
### (1) å‡å€¼ FOSM å¯é æ€§åˆ†ææ–¹æ³•
#### 1. çº¿æ€§å‡½æ•°æƒ…å†µ
æˆ‘ä»¬è€ƒè™‘åŠŸèƒ½å‡½æ•° $Y = g(X)$æ˜¯è¾“å…¥å˜é‡$X = (X_1, X_2, \dots X_n)^T$çš„å‡½æ•°, å¹¶è®°$Y< 0$ä¸ºå¤±æ•ˆ, åˆ™æ ¹æ®æ¦‚ç‡è®ºåŸºæœ¬åŸç†, å½“åŠŸèƒ½å‡½æ•°ä¸ºè¾“å…¥å˜é‡çº¿æ€§å‡½æ•°ä¸”æœä»æ­£æ€åˆ†å¸ƒæ—¶ï¼Œå¯¹åº”çš„åŠŸèƒ½å‡½æ•°ä¹Ÿæœä»æ­£æ€åˆ†å¸ƒã€‚

è®¾åŠŸèƒ½å‡½æ•°$Y = g(X)$æ˜¯æœä»æ•´å¤©åˆ†å¸ƒçš„è¾“å…¥çš„éšæœºå˜é‡$X$å‡½æ•°, æ­¤æ—¶æœ‰: 
$$Y = g(X) = a_{0} + \sum^{n}_{i=1} a_{i} X_{i}$$
å®¹æ˜“è·å–å‡ºå‡å€¼ä¸æ–¹å·®å…³ç³»ä¸º(å‚è€ƒ[[ğŸ“˜ClassNotes/ğŸ“Mathmatics/ğŸ£Probability Theory/è¡¥å……éƒ¨åˆ†/æ–¹å·®çš„æ€§è´¨è¯æ˜.pdf|æ–¹å·®çš„æ€§è´¨è¯æ˜]]ä»¥åŠ[[ğŸ“˜ClassNotes/ğŸ“Mathmatics/ğŸ£Probability Theory/ç¬¬å››ç«  éšæœºå˜é‡çš„æ•°å­—ç‰¹å¾#ä¸‰ã€åæ–¹å·®åŠå…¶ç›¸å…³ç³»æ•°|åæ–¹å·®åŠå…¶ç›¸å…³ç³»æ•°]]) : 
$$\mu_{g} = a_{0} + \sum^{n}_{i=1} a_{i} \mu_{Xi}\qquad \sigma_{g}^{2} = \sum^{n}_{i=1} a_{i}^{2} \sigma_{Xi}^{2} + \sum^{n}_{i=1} \sum^{n}_{j=1(j\neq i)}  a_{i} a_{j}\space  \text{Cov}(X_{i}, X_{j})$$
å…¶ä¸­i = j æ—¶æ˜¾ç„¶åæ–¹å·®ä¸º0, æ­¤æ—¶ï¼Œ æ­£æ€å˜é‡ç»è¿‡çº¿æ€§ç»„åˆä¹‹åï¼Œ ä»ç„¶æœä»æ­£æ€åˆ†å¸ƒã€‚ 
æ­¤æ—¶ï¼Œ è®°å‡å€¼$\mu_g$å’Œæ ‡å‡†å·®$\sigma_g$çš„æ¯”å€¼è®°ä¸º<mark style="background: transparent; color: red">å¯é åº¦æŒ‡æ ‡</mark>$\beta$, åˆ™:
$$\beta = \frac{\mu_{g}}{\sigma_{g}} = \frac{a_{0} + \sum^{n}_{i=1}a_{i} \mu_{Xi}}{\sqrt{\sum^{n}_{i=1} a_{i}^{2} \sigma_{Xi}^{2} + \sum^{n}_{i=1} \sum^{n}_{j=1(j\neq i)}  a_{i} a_{j}\space  \text{Cov}(X_{i}, X_{j})}}$$
æ­¤æ—¶, ä¸€æ¬¡äºŒé˜¶çŸ©æ–¹æ³•çš„å¤±æ•ˆæ¦‚ç‡$P_f$å’Œå¯é åº¦$P_r$ä¸º: 
$$P_{f} = P\left\{ Y\leq 0 \right\} = P\left\{ \frac{Y - \mu_{g}}{\sigma_{g}} \leq  -\beta\right\} = \Phi (- \beta )$$
$$P_{r} = P\{Y > 0 \} = P \left\{\frac{Y - \mu_{g}}{\sigma_{g}} > - \beta \right\} \overset{è½¬æ¢< \beta }{\rightarrow} = \Phi (\beta )$$
![[Excalidraw/ç¬¬äºŒç«  å¯é æ€§çµæ•åº¦åˆ†æçš„çŸ©æ–¹æ³• 2024-01-24 11.18.50|450]]
#### 2. éçº¿æ€§åŠŸèƒ½å‡½æ•°æƒ…å†µ
å¯¹äºéçº¿æ€§å‡½æ•°ï¼Œåˆ™åœ¨ç›¸åº”çš„å‡å€¼ç‚¹å¤„å±•å¼€ä¸ºæ³°å‹’çº§æ•°ï¼Œå¯ä»¥å–
$$Y = g(X_{1},X_{2}, \dots ,X_{n}) \approx g(\mu_{X1}, \mu_{X2} , \dots \mu_{Xn}) + \sum^{n}_{i=1} \left.\frac{\partial g}{\partial X_{i}} \right|_{\mu_{X}} (X_{i} - \mu_{Xi})$$
æ˜¾ç„¶å¾—åˆ°: 
$$\beta  = \frac{\mu_{g}}{\sigma_{g}} = \frac{g(\mu_{X1}, \mu_{X2}, \dots  \mu_{Xn})}{\sqrt{\sum^{n}_{i=1} \left(\left.\frac{\partial g}{\partial X_{i}} \right|_{\mu_{X}}\right)^{2} \sigma_{i}^{2} + \sum^{n}_{i=1} \sum^{n}_{j=1(j\neq i)} \left.\left(\frac{\partial g}{\partial X_{i}}\right)\left(\frac{\partial g}{\partial X_{j}} \right) \right|_{\mu_{X}} Cov(X_{i}, X_{j}) }}$$
æ­¤æ—¶ä»ç„¶æ»¡è¶³:
$$P_{r} = \Phi(\beta) \qquad  P_{f} = \Phi(-\beta)$$
### (2) å‡å€¼FOSMå¯é æ€§çµæ•åº¦åˆ†ææ–¹æ³•
#### 1. å®šä¹‰
æ ¹æ®ä¸Šè¿°æ–¹æ³•, <mark style="background: transparent; color: red">å¯é æ€§çµæ•åº¦</mark>å®šä¹‰ä¸ºå¤±æ•ˆæ¦‚ç‡å¯¹äºå‡å€¼, æ–¹å·®å’Œåæ–¹å·®çš„åå¯¼æ•°, å³æœ‰: 
$$\frac{\partial P_{f}}{\partial \mu_{Xi}} = \frac{\partial P_{f}}{\partial \beta}\frac{\partial \beta }{\partial \mu_{Xi}} \quad \frac{\partial P_{f}}{\partial \sigma_{Xi}} = \frac{\partial P_{f}}{\partial \beta}\frac{\partial \beta }{\partial \sigma_{Xi}}\quad \frac{\partial P_{f}}{\partial \rho_{Xi,Xj}} = \frac{\partial P_{f}}{\partial \beta}\frac{\partial \beta }{\partial \rho_{Xi,Xj}}\tag{2.2.1}$$
æ­¤æ—¶, æ ¹æ®å…¬å¼[[ğŸ“˜ClassNotes/ğŸ“Mathmatics/ğŸ£Probability Theory/ç¬¬äºŒç«  éšæœºå˜é‡åŠå…¶åˆ†å¸ƒ#3. æ­£æ€åˆ†å¸ƒ|æ­£æ€åˆ†å¸ƒå…¬å¼]], æœ‰
$$P_{f} = \Phi(- \beta) = 1 - \Phi (\beta) = 1- \frac{1}{\sqrt{2\pi}} \int_{-\infty}^{\beta} e^{- \frac{t^{2}}{2}}dt$$
è·å¾—å…³äºå¯é åº¦æŒ‡æ ‡çš„ç»“æœ: 
$$\boxed {\frac{\partial P_{f}}{\partial \beta} = -\frac{1}{\sqrt{2\pi}}  e^{- \frac{\beta ^{2}}{2}} = -\frac{1}{\sqrt{2\pi}} \exp \left(- \frac{\mu_{g}^{2}}{2 \sigma_{g}^{2}}\right)} \tag{2.2.2}$$
#### 2. è¾“å…¥å˜é‡ç‹¬ç«‹æ—¶çš„å¯é æ€§çµæ•åº¦è®¡ç®— 
æ ¹æ®$\beta$çš„å®šä¹‰å¼, æœ‰: 
$$\beta = \frac{\mu_{g}}{\sigma_{g}} = \frac{a_{0} + \sum^{n}_{i=1}a_{i} \mu_{i}}{\sqrt{\sum^{n}_{i=1} a_{i}^{2} \sigma_{Xi}^{2} + \sum^{n}_{i=1} \sum^{n}_{j=1(j\neq i)}  a_{i} a_{j}\space  \text{Cov}(X_{i}, X_{j})}} \overset{ä¸ç›¸å…³}{\rightarrow } = \frac{a_{0} + \sum^{n}_{i=1} a_{i} \mu_{i}}{\sqrt{\sum^{n}_{i=1} a_{i}^{2} \sigma_{Xi}^{2}}}$$
$$\frac{\partial \beta}{\partial \mu_{Xi}} = \frac{a_{i}}{\sqrt{\sum^{n}_{i=1} a_{i}^{2} \sigma_{i}^{2}}} = \frac{a_{i}}{\sigma_{g}}, \qquad\frac{\partial \beta}{\partial \sigma_{Xi}} = -\frac{\mu_{g}}{\sigma_{g}^{2}} \times  \frac{1}{2 \sigma_{g}} \times 2a_{i}^{2} \sigma_{Xi} = - \frac{\mu_{g}  a_{i}^{2} \sigma_{Xi}}{\sigma_{g}^{3}}$$
ä»£å…¥2.2.1å¼å¾—åˆ°<mark style="background: transparent; color: red">ç‹¬ç«‹å˜é‡çš„çº¿æ€§å‡å€¼çµæ•åº¦å…¬å¼å’Œæ–¹å·®çµæ•åº¦å…¬å¼</mark>å¦‚ä¸‹: 
$$\boxed{\frac{\partial P_{f}}{\partial \mu_{Xi}} =- \frac{a_{i}}{\sqrt{2\pi } \sigma_{g}} \exp \left(- \frac{\mu_{g}^{2}}{2 \sigma_{g}^{2}}\right)\qquad  \frac{\partial P_{f}}{\partial \sigma_{Xi}} =  \frac{\mu_{g}a_{i}^{2} \sigma_{Xi}}{\sqrt{2\pi }\sigma_{g}^{3}} \exp \left(- \frac{\mu_{g}^{2}}{2\sigma_{g}^{2}}\right)}$$
å…¶ä¸­å¯¹äºç‹¬ç«‹<mark style="background: transparent; color: red">éçº¿æ€§</mark>æ—¶, åªéœ€å°†æ›¿æ¢$a_i$ä¸º$\left.\frac{\partial g}{\partial X_i} \right|_{\mu X}$å³å¯ã€‚

#### 3. è¾“å…¥å˜é‡ç›¸å…³æ—¶çš„å¯é æ€§çµæ•åº¦è®¡ç®— 
é¦–å…ˆï¼Œ å¦‚æœ**åŠŸèƒ½å‡½æ•°æ˜¯çº¿æ€§çš„**ï¼Œåˆ™å¯é æ€§çµæ•åº¦è®¡ç®—å¦‚ä¸‹:  
åœ¨çº¿æ€§çš„æƒ…å†µä¸‹, ä»ç„¶æ»¡è¶³:
$$\beta = \frac{\mu_{g}}{\sigma_{g}} = \frac{a_{0} + \sum^{n}_{i=1}a_{i} \mu_{Xi}}{\sqrt{\sum^{n}_{i=1} a_{i}^{2} \sigma_{Xi}^{2} + \sum^{n}_{i=1} \sum^{n}_{j=1(j\neq i)}  a_{i} a_{j}\space  \text{Cov}(X_{i}, X_{j})}}$$
å› æ­¤å®¹æ˜“è®¡ç®—å‡ºå¯¹$\mu_{g}, \sigma_{g}, \rho_{X_{i},X_{j}}$çš„åå¯¼æ•°, åŒæ—¶åˆ©ç”¨åæ–¹å·®çš„å®šä¹‰: 
$$\boxed{\rho_{XY} = \frac{\text{Cov}(X,Y)}{\sqrt{D(X)} \sqrt{D(Y)}}}$$
å› æ­¤åœ¨æ±‚è§£æ–¹å·®æ—¶éœ€è¦è€ƒè™‘, ç»è¿‡è®¡ç®—å¾—åˆ°:
$$\frac{\partial \beta}{\partial \mu_{X_{i}}} = \frac{a_{i}}{\sigma_{g}} \qquad \frac{\partial \beta}{\partial \sigma_{Xi}} = - \frac{\mu_{g} }{\sigma_{g}^{3}} \left(a_{i}^{2} \sigma_{Xi}^{2} +\sum^{n}_{j=1, j \neq i}  a_{i}a_{j}\rho_{X_{i}, X_{j}} \sigma_{Xj}\right)\qquad \frac{\partial \beta}{\partial \rho_{Xi, Xj}} = - \frac{ \mu_{g}}{2 \sigma_{g}^{3}}\left(a_{i}a_{j} \sigma_{Xi} \sigma_{Xj}\right)$$
å› è€Œæœ‰<mark style="background: transparent; color: red">å…³äºå‡å€¼ï¼Œ æ–¹å·®å’Œåæ–¹å·®çš„å¯é æ€§çµæ•åº¦è®¡ç®—ä¸º</mark>:
$$\begin{cases}
\frac{\partial P_{f}}{\partial \mu_{Xi}} = - \frac{a_{i}}{\sqrt{2 \pi }\sigma_{g}}\exp \left(- \frac{\mu_{g}^{2}}{2 \sigma_{g}^{2}}\right)  \\
\frac{\partial P_{f}}{\partial \sigma_{Xi}} = \frac{\mu_{g}}{\sqrt{2\pi }\sigma_{g}^{3}}\left(a_{i}^{2} \sigma_{Xi}^{2} +\sum^{n}_{j=1, j \neq i}  a_{i}a_{j}\rho_{X_{i}, X_{j}} \sigma_{Xj}\right) \exp \left(- \frac{\mu_{g}^{2}}{2 \sigma_{g}^{2}}\right) \\
\frac{\partial P_{f}}{\partial \rho_{Xi,Xj}} = \frac{\mu_{g}}{2\sqrt{2\pi }\sigma_{g}^{3}} \left(a_{i}a_{j} \sigma_{Xi} \sigma_{Xj}\right) \exp\left(- \frac{\mu_{g}^{2}}{2 \sigma_{g}^{2}}\right)
\end{cases}$$
æ­¤æ—¶å¦‚æœä¸ºéçº¿æ€§æ–¹ç¨‹, åˆ™åšå¦‚ä¸‹æ›¿æ¢(å…¶ä¸­$Y = g(X_{1}, \dots X_{n})\approx g(\mu_{X1}, \mu_{X2}, \dots \mu_{Xn})$) å³å¯: 
$$a_{i} = \left. \frac{\partial g}{\partial X_{i}} \right|_{\mu_{X}} \qquad a_{j} = \left. \frac{\partial g}{\partial X_{j}} \right|_{\mu_{X}}$$

ç»™å‡ºç®€å•çš„ matlab ç¤ºä¾‹ä»£ç : 
```erlang
clear,clc
%%%%%% 
% æŸå†…å‹åœ†ç­’å‹å®¹å™¨ææ–™ä¸º15MnV, éšæœºå˜é‡å–ä¸ºå†…å¾„D, å†…å‹å¼ºP, å£åštä¸å±ˆæœå¼ºåº¦sigma_s
% è¿™äº›éšæœºå˜é‡ç‹¬ç«‹ä¸”å‡æœä»æ­£æ€åˆ†å¸ƒ, å‚æ•°åœ¨ä¸‹é¢ç»™å‡º
D_mu = 460; D_sig = 7;
P_mu = 20;  P_sig = 2.4;
t_mu = 19;  t_sig = 0.8;
sigma_s_mu = 392; sigma_s_sig = 31.4 ; 


syms s p d t ss ps ds ts
g(s,p,d,t) = s - p * d/(2 * t);

% ------- derivates for function g------- 
g_s_ = subs(diff(g(s,p,d,t),s), [s,p,d,t],[sigma_s_mu, P_mu, D_mu, t_mu]);
g_p_ = subs(diff(g(s,p,d,t),p), [s,p,d,t],[sigma_s_mu, P_mu, D_mu, t_mu]);
g_d_ = subs(diff(g(s,p,d,t),d), [s,p,d,t],[sigma_s_mu, P_mu, D_mu, t_mu]);
g_t_ = subs(diff(g(s,p,d,t),t), [s,p,d,t],[sigma_s_mu, P_mu, D_mu, t_mu]);


mu_g = g(s,p,d,t);
sigma_g = sqrt(g_s_^2 * ss^2 + g_p_^2 * ps^2 + g_d_^2 * ds^2 + g_t_^2 * ts^2);

mu_g_var = vpa(subs(mu_g,[s,p,d,t], [sigma_s_mu,P_mu, D_mu,t_mu]));
sigma_g_var = vpa(subs(sigma_g,[ss,ps,ds,ts], [sigma_s_sig,P_sig, D_sig,t_sig]));

beta = mu_g/sigma_g;
beta_var = subs(beta,[s,p,d,t, ss,ps,ds,ts], [sigma_s_mu,P_mu, D_mu,t_mu, sigma_s_sig,P_sig, D_sig,t_sig]);

sprintf("mu_g: %f, sigma_g: %f",mu_g_var,sigma_g_var)
sprintf("beta: %f , Pf :%f", beta_var, normcdf(-beta_var))

beta_t_ = diff(beta,t);
beta_d_ = diff(beta, d);
beta_p_ = diff(beta, p);
beta_s_ = diff(beta, s);

Pf_beta_ = -1/sqrt(2 * pi) * exp(-mu_g^2/(2 * sigma_g^2));


sen_s = subs(beta_s_ * Pf_beta_, [s,p,d,t, ss,ps,ds,ts], [sigma_s_mu,P_mu, D_mu,t_mu, sigma_s_sig,P_sig, D_sig,t_sig] );
sen_p = subs(beta_p_ * Pf_beta_, [s,p,d,t, ss,ps,ds,ts], [sigma_s_mu,P_mu, D_mu,t_mu, sigma_s_sig,P_sig, D_sig,t_sig] );
sen_d = subs(beta_d_ * Pf_beta_, [s,p,d,t, ss,ps,ds,ts], [sigma_s_mu,P_mu, D_mu,t_mu, sigma_s_sig,P_sig, D_sig,t_sig] );
sen_t = subs(beta_t_ * Pf_beta_, [s,p,d,t, ss,ps,ds,ts], [sigma_s_mu,P_mu, D_mu,t_mu, sigma_s_sig,P_sig, D_sig,t_sig] );
% è¾“å‡ºæ¯ä¸€ä¸ªå‡å€¼æ•æ„Ÿåº¦ -> æ–¹å·®çµæ•åº¦åˆ†æç•¥å»
sprintf("sense: %0.8f, %0.8f, %0.8f, %0.8f", sen_d, sen_p, sen_t, sen_s)
```

```erlang
ans = 
    "mu_g: 149.894737, sigma_g: 44.130540"
ans = 
    "beta: 3.396621 , Pf :0.000341"
ans = 
    "sense: 0.00001487, 0.00034191, -0.00035990, -0.00002824"
```

### (3) æ”¹è¿› FOSM å¯é æ€§åˆ†ææ–¹æ³•
#### 1. çº¿æ€§åŠŸèƒ½å‡½æ•° 
Advanced FOSM method ä¸ºæ”¹è¿›çš„ä¸€æ¬¡äºŒé˜¶çŸ©æ–¹æ³•, ä¹Ÿæ˜¯é€šè¿‡ç±»ä¼¼æ–¹æ³•å°†éçº¿æ€§åŠŸèƒ½å‡½æ•°è¿›è¡Œçº¿æ€§å±•å¼€, å¹¶ä½¿ç”¨çº¿æ€§åŠŸèƒ½å‡½æ•°çš„å¤±æ•ˆæ¦‚ç‡è¿‘ä¼¼åŸå§‹éçº¿æ€§åŠŸèƒ½å‡½æ•°çš„å¤±æ•ˆæ¦‚ç‡ã€‚é’ˆå¯¹äºéçº¿æ€§åŠŸèƒ½å‡½æ•°,  å…¶å¤±æ•ˆåŸŸä¸­çš„æœ€å¯èƒ½å¤±æ•ˆçš„ç‚¹æ˜¯ä¸èƒ½æœ‰é™å¾—çŸ¥çš„, éœ€è¦ä½¿ç”¨å¯»ä¼˜å’Œè¿­ä»£çš„æ–¹æ³•ã€‚

é¦–å…ˆæˆ‘ä»¬è®¾åŠŸèƒ½å‡½æ•° Y = g(X) ä¸ºå¦‚ä¸‹å½¢å¼çš„çº¿æ€§å‡½æ•° : 
$$Y = g(X) = a_{0} + \sum^{n}_{i=1} a_{i} X_{i}$$
æ­¤æ—¶, è¦æ±‚æ”¹è¿›ä¸€æ¬¡äºŒé˜¶çŸ©æ–¹æ³•çš„åˆ†æç»“æœå’Œå‡å€¼ä¸€æ¬¡äºŒé˜¶çŸ©çš„å¯é æ€§åˆ†æç»“æœå®Œå…¨ä¸€è‡´ã€‚é¦–å…ˆ, <mark style="background: transparent; color: red">å°†æ­£æ€è¾“å…¥å˜é‡è¿›è¡Œæ ‡å‡†åŒ–</mark>, å–$Z_i$ä¸ºæ­£æ€åŒ–è¾“å…¥å˜é‡, å³æœ‰:
$$Z_{i}  = \frac{X_{i} - \mu_{Xi}}{\sigma_{Xi}}$$
æ­¤æ—¶, ä»£å…¥å³å¯å¾—åˆ°ä½¿ç”¨æ ‡å‡†æ­£æ€åˆ†å¸ƒè¡¨å¾çš„æé™çŠ¶æ€æ–¹ç¨‹: 
$$Y' = a_{0} +\sum^{n}_{i=1}  a_{i} (\sigma_{Xi} Z_{i}+ \mu_{Xi}) = 0 $$
æ­¤æ—¶ç§»é¡¹å¹¶åŒé™¤ $\sqrt{\sum^{n}_{i=1} a_{i}^{2} \sigma_{Xi}^{2}}$, å¾—åˆ°<mark style="background: transparent; color: red">æ ‡å‡†å‹çš„æ³•çº¿æ–¹ç¨‹</mark>: 
$$\frac{\sum^{n}_{i=1} a_{i} \sigma_{Xi} }{\sqrt{\sum^{n}_{i=1} a_{i}^{2}\sigma_{Xi}^{2}}}Z_{i} = - \frac{a_{0} + \sum^{n}_{i=1} a_{i} \mu_{Xi}}{\sqrt{\sum^{n}_{i=1} a_{i}^{2}\sigma_{Xi}^{2}}} = - \beta$$
å…¶ä¸­$\beta$ ä¸ºå¯é åº¦æŒ‡æ ‡, æ­¤æ—¶ä¸¤è¾¹åŒæ—¶å–è´Ÿå·, åˆ™æœ‰<mark style="background: transparent; color: red">åœ¨æ ‡å‡†æ­£æ€ç©ºé—´ä¸­çš„æé™çŠ¶æ€æ–¹ç¨‹</mark>: 
$$\boxed{\sum^{n}_{i=1} \lambda_{i}  Z_{i} = \beta\qquad  \lambda_{i} = - \frac{ a_{i} \sigma_{Xi} }{\sqrt{\sum^{n}_{i=1} a_{i}^{2}\sigma_{Xi}^{2}}}}$$
å…¶å‡ ä½•æ„ä¹‰å¦‚ä¸‹å›¾æ‰€ç¤º: å…¶ä¸­, $P(z_1^*, z_2^*)$ä¸º<mark style="background: transparent; color: red">è®¾è®¡ç‚¹</mark>, å¯¹äºæ ‡å‡†æ­£æ€ $Z$ ç©ºé—´, <mark style="background: transparent; color: red">è®¾è®¡ç‚¹æ˜¯æé™æ–¹ç¨‹çš„å¤±æ•ˆåŸŸä¸­å¯¹å¤±æ•ˆæ¦‚ç‡è´¡çŒ®æœ€å¤§çš„ç‚¹</mark>, ä¹Ÿç§°ä¹‹ä¸º<mark style="background: transparent; color: red">æœ€æœ‰å¯èƒ½å¤±æ•ˆç‚¹</mark>(MPP)ã€‚

ç”±äºå¤±æ•ˆçš„æ–¹ç¨‹æ˜¯ 
$$\sum^{n}_{i=1}  \lambda_{i} Z_{i} = \beta\quad  \overset{ä»…è€ƒè™‘ä¸¤ä¸ªå˜é‡}{\rightarrow}\quad  \lambda_{1}Z_{1} + \lambda_{2} Z_{2} - \beta = 0$$
æ˜¾ç„¶ç›´çº¿ä¸Šçš„ä»»ä½•ç‚¹å‡æ»¡è¶³$\lambda_1 z_1^* + \lambda_2 z_2^* = \beta$,  å› æ­¤è¿‡åŸç‚¹å‘æé™çŠ¶æ€æ–¹ç¨‹ä½œå‚çº¿, æ ¹æ®[[ğŸ“˜ClassNotes/ğŸ“Mathmatics/ğŸ“ˆAdvanced Mathematics/ç¬¬å…«ç«  å‘é‡ä»£æ•°å’Œç©ºé—´è§£æå‡ ä½•#(1) ç©ºé—´ç›´çº¿çš„ä¸€èˆ¬å¼æ–¹ç¨‹|ç›´çº¿çš„ä¸€èˆ¬å¼æ–¹ç¨‹]]ç‰©ç†æ„ä¹‰, åˆ™æ³•å‘é‡ä¸º $\vec{n}(\lambda_1, \lambda_2)$ , è€Œæ˜¾ç„¶æ»¡è¶³: $\lambda_1^2 + \lambda_2^2 = 1$(æ¨å¹¿åä¹Ÿæˆç«‹), æ˜¾ç„¶æœ‰:
$$\boxed{\lambda_1  = \cos \theta_1, \lambda_2 = \cos \theta_{2}}$$
![[Excalidraw/ç¬¬äºŒç«  å¯é æ€§çµæ•åº¦åˆ†æçš„çŸ©æ–¹æ³• 2024-01-25 16.11.03|400]]
æ­¤æ—¶æ ¹æ®[[ğŸ“˜ClassNotes/ğŸ“Mathmatics/ğŸ“ˆAdvanced Mathematics/ğŸ‘†é‡è¦å®šç†/ç©ºé—´å‡ ä½•ä½ç½®å…³ç³»æ€»ç»“|ç‚¹åˆ°å¹³é¢è·ç¦»å…¬å¼]]å¯ä»¥è®¡ç®—å‡º<b><mark style="background: transparent; color: blue">åŸç‚¹åˆ°ç›´çº¿çš„å‚çº¿è·ç¦»</mark></b>å³ä¸º<mark style="background: transparent; color: red">å¯é åº¦çš„å‡ ä½•æ„ä¹‰</mark>: 
$$d = \frac{\beta}{\sqrt{\lambda_{1}^{2} + \lambda_{2}^{2}}} =  \beta$$
åœ¨å®é™…æ±‚è§£ä¸­ï¼Œ åº”å½“å…ˆæ±‚å–è®¾è®¡ç‚¹$P(z_1^*, z_2^*, \dots z_n^*)$, ç»è¿‡åå˜æ¢ä¹‹åå¯ä»¥æ±‚å¾—å¯¹åº”çš„$X$ç©ºé—´è®¾è®¡ç‚¹åæ ‡ã€‚ åŒæ—¶, å¯ä»¥è§£å‡ºå¯¹åº”çš„$z_{1}^{*}, z_{2}^{*}$, åªéœ€ç”¨$\frac{z_{1}^{*}}{z_{2}^{*}} = \frac{\lambda_{1}}{\lambda_{2}}$, å®¹æ˜“æ±‚è§£å‡º:
$$\boxed{z_{1}^{*} =  \lambda_{1}\beta,\qquad z_{2}^{*} =  \lambda_{2}\beta }$$
#### 2. éçº¿æ€§åŠŸèƒ½å‡½æ•°
ä»ç„¶å°†éçº¿æ€§çš„åŠŸèƒ½å‡½æ•°è¿›è¡Œå±•å¼€å¹¶å–å…¶ä¸­çš„çº¿æ€§éƒ¨åˆ†: 
$$Y = g(X_{1}, X_{2},\dots X_{n})\approx g(x_{1}^{*}, \dots x_{n}^{*}) + \sum^{n}_{i=1} \left. \frac{\partial g}{\partial x_{i}} \right|_{P^{*}}(X_{i}- x_{i}^{*})$$
æ­¤æ—¶ç”±äº$P^*$å¯¹åº”çš„$g  (X_1, X_2, \dots  X_n) = 0$åœ¨å¤±æ•ˆè¾¹ç•Œä¸Š, å› è€Œæœ‰ $g(x_1^*, x_2^*, \dots x_n^*) = 0$, ä»£å…¥ä¸Šå¼åˆ™æœ‰<mark style="background: transparent; color: red">åŠŸèƒ½å‡½æ•°çš„çº¿æ€§è¿‘ä¼¼</mark>:
$$\boxed{\left. \sum^{n}_{i=1} \frac{\partial g}{\partial x_{i}} \right|_{P^{*}}  (X_{i} - x_{i}^{*})= 0}$$
æ­¤æ—¶ç›´æ¥æŒ‰ç…§[[#(1) å‡å€¼ FOSM å¯é æ€§åˆ†ææ–¹æ³•]]è¿›è¡Œçº¿æ€§æ±‚è§£å³å¯, å…¶ä¸­$a_{0} = -\sum^{n}_{i=1} \dots x_{i}^{*}$
ä»£å…¥å…¬å¼å³å¾—åˆ°: 
$$\beta = \frac{\left. \sum^{n}_{i=1} \frac{\partial g}{\partial x_{i}} \right|_{P^{*}}  (\mu_{Xi} - x_{i}^{*})}{\sqrt{\sum^{n}_{i=1} a_{i}^{2}\sigma_{Xi}^{2} + \sum^{n}_{i=1}  \sum^{n}_{j=1(j \neq i)} a_{i}a_{j} \text{Cov} (X_{i}, X_{j})}}$$
å¯¹åº”åœ°ï¼Œ æœ‰å¤±æ•ˆæ¦‚ç‡ä¸º:
$$P_{f} = \Phi(-\beta)$$
æ­¤æ—¶å¯é åº¦æŒ‡æ ‡ä»¥åŠå¯¹åº”è®¾è®¡ç‚¹çš„å‡ ä½•æ„ä¹‰å¦‚ä¸‹å›¾:
![[Excalidraw/ç¬¬äºŒç«  å¯é æ€§çµæ•åº¦åˆ†æçš„çŸ©æ–¹æ³• 2024-01-25 18.30.40|350]]
æ­¤æ—¶, ä»ç„¶æœ‰: 
$$\boxed{\Large z_{i}^{*} = \lambda_{i} \beta\qquad  \lambda_{i} = - \frac{\left. \frac{\partial g}{\partial X_{i}} \right|_{P^{*}}\sigma_{Xi}}{\left[\sum^{n}_{i=1}\left( \left. \frac{\partial g}{\partial X}\right|_{P^{*}}\right)^{2}  \sigma_{Xi}^{2}\right]^{\frac{1}{2}}} = \cos \theta_{i}}\tag{2.3.3}$$
æ­¤æ—¶, å°†æ ‡å‡†æ­£æ€$Z$ç©ºé—´çš„è®¾è®¡ç‚¹$P^{*}(z_{1}^{*}, z_{2}^{*}\dots z_{n}^{*})$, å˜æ¢åˆ°$P^{*}(x_{1}^{*}, x_{2}^{*}, \dots x_{n}^{*})$ç©ºé—´, ä»è€Œå¾—åˆ°è®¾è®¡ç‚¹$P^{*}$<mark style="background: transparent; color: red">åœ¨Xåæ ‡ç³»ä¸‹çš„åæ ‡</mark>:
$$\boxed{x_{i}^{*} = \mu_{Xi} + \sigma_{Xi} z_{i}^{*} =  \mu_{Xi} + \sigma_{Xi}\lambda_{i} \beta \tag{2.3.4}}$$
ç”±äº$P^*(x_1^*, x_2^*, \dots x_n^* )$åœ¨**å¤±æ•ˆè¾¹ç•Œä¸Š**, åˆ™æœ‰:
$$g(x_1^*, x_2^*, \dots x_n^*)=0$$

> [!summary] æ”¹è¿›ä¸€æ¬¡äºŒé˜¶çŸ©çš„è¿­ä»£æ±‚è§£æ–¹æ³•
> - å‡å®šè®¾è®¡ç‚¹åæ ‡$P^*(x_{1}^{*}, x_{2}^{*}, \dots x_{n}^{*})$ç­‰çš„åˆå§‹å€¼éƒ¨åˆ†(å¯ä»¥å–$\mu_{X}$çš„å€¼)ä¸ºåˆå§‹å€¼ã€‚å¦å¤–å¯ä»¥è®¾ç¬¬ä¸€æ¬¡è§£å‡ºçš„$\beta$ åˆå§‹å€¼ä¸º0;
> - åˆ©ç”¨å‡è®¾çš„åˆå§‹å€¼,  å°†å¼2.3.4ä»£å…¥$g(X) = 0$ä¸­, å¯ä»¥è§£å‡º$\beta$çš„åˆå§‹å€¼ã€‚
> - å°†$\beta$ å€¼ç»§ç»­ä»£å…¥2.3.4å¹¶é‡å¤è¿­ä»£è·å–æœ€ç»ˆçš„$\beta$å€¼
>  éœ€è¦è¯´æ˜çš„æ˜¯, è®¾ç½®åˆå§‹å€¼ä¸º0, æ¯ä¸€æ¬¡çš„å€¼å‡ä»$g(x^{*}) = 0$ä¸­è§£å‡º; è€Œè¿­ä»£è¿‡ç¨‹æ¯ä¸€æ¬¡åˆå°†betaä»£å›è®¡ç®—x, é€šè¿‡æ›´æ”¹åçš„ç‚¹ç»è¿‡$\lambda$å…¬å¼(2.3.3) é‡æ–°è®¡ç®—è·å–æ–°çš„lambdaå€¼å†è¿›è¡Œè¿­ä»£å¾—åˆ°æœ€ç»ˆç»“æœçš„ã€‚ 


> [!NOTE] è¡¥å……
> è¯´æ˜: 
> - å¯¹äºçº¿æ€§æƒ…å†µï¼Œ æ±‚è§£çš„ç»“æœä¸FOSMæ–¹æ³•ç›¸åŒ, æ­¤æ—¶åªéœ€è¿­ä»£ä¸€æ¬¡å³å¯å¾—åˆ°ç»“æœï¼Œä¸”ä¸è®ºè¿­ä»£å¤šå°‘æ¬¡å¾—åˆ°ç»“æœå‡ç›¸åŒ
> 
> ç¼ºç‚¹: 
> 1. ä¸èƒ½åæ˜ åŠŸèƒ½å‡½æ•°å¯¹å¤±æ•ˆæ¦‚ç‡çš„å½±å“
> 2. å¯¹äºåŠŸèƒ½å‡½æ•°åœ¨éçº¿æ€§ç¨‹åº¦æ¯”è¾ƒå¤§çš„æƒ…å†µä¸‹, è¿­ä»£ç®—æ³•å—åˆ°åˆå§‹ç‚¹å½±å“è¾ƒå¤§, å¯¼è‡´é™·å…¥å±€éƒ¨æœ€ä¼˜è§£;
> 3. å¯¹äºæé™çŠ¶æ€æ–¹ç¨‹çš„è¡¨è¾¾å¼æœ‰è§£æçš„è¦æ±‚ï¼Œ å¯¹äºéšå‡½æ•°è¡¨è¾¾çš„æé™çŠ¶æ€æ–¹ç¨‹ï¼Œ éš¾ä»¥æ±‚è§£å¯¼æ•°ã€‚ 

### (4) æ”¹è¿›FOSM å¯é æ€§çµæ•åº¦åˆ†ææ–¹æ³• 
æ”¹è¿›çš„ FOSM å¯é æ€§çµæ•åº¦åˆ†ææ–¹æ³•: åˆ©ç”¨åœ¨è®¾è®¡ç‚¹çš„å±•å¼€è¡¨è¾¾å¼ : 
$$Y = g(x_{1}^{*}, x_{2}^{*}, \dots x_{n}^{*}) + \sum^{n}_{i=1} \left. \frac{\partial g}{\partial X_{i}}  \right|_{P^{*}} (X_{i} - x_{i}^{*})$$
å…¶ä¸­, = g(X)ä¹Ÿå¯ä»¥ä½¿ç”¨ä¸‹å¼è¡¨è¾¾ :
$$c_{0} = g(x_{1}^{*}, x_{2}^{*}, \dots x_{n}^{*}) - \sum^{n}_{i=1} \left. \frac{\partial g}{\partial X_{i}} \right|_{P^{*}} x_{i}^{*} \qquad g(X) = c_{0} + \sum^{n}_{i=1}c_{i} X_{i}\qquad c_{i} =  \left.  \frac{\partial g}{\partial X_{i}} \right|_{P^{*}}$$
æ˜¾ç„¶åœ¨è®¾è®¡ç‚¹$g (x_{1}^{*}, x_{2}^{*}, \dots x_{n}^{*}) = 0$, åˆ™æœ‰: 
$$\beta = \frac{\mu_{g}}{\sigma_{g}} = \frac{\sum^{n}_{i=1} \left. \frac{\partial g}{\partial X_{i}}\right|_{P^{*}} (\mu_{Xi} - x_{i}^{*})}{\sqrt{\sum^{n}_{i=1} \left(\left. \frac{\partial g}{\partial X_{i}} \right|_{P^{*}} \right)^{2} \sigma _{Xi}^{2}}} = \frac{\sum^{n}_{i=1} c_{i} (\mu_{Xi} - x_{i})}{\sqrt{ \sum^{n}_{i=1}  c_{i}^{2} \sigma_{Xi}^{2}}} \tag{2. 4. 1}$$
å¹¶æœ‰$P_f  = \Phi(-\beta)$, å…¶ä¸­, æ˜¾ç„¶æœ‰:
$$\mu_{g} = c_{0} + \sum^{n}_{i=1}  c_{i} \mu_{Xi} \qquad  \sigma_{g} = \sum^{n}_{i=1} \left(\left. \frac{\partial g}{\partial X_{i}} \right|_{P^{*}} \right)^{2} \sigma _{Xi}^{2}$$
æ˜¾ç„¶æœ‰
$$\begin{cases}
\frac{\partial P_{f}}{\partial \mu_{Xi}} = - \frac{c_{i}}{\sqrt{2 \pi }\sigma_{g}}\exp \left(- \frac{\mu_{g}^{2}}{2 \sigma_{g}^{2}}\right) \\
\frac{\partial P_{f}}{\partial \sigma_{Xi}} = \frac{\mu_{g}}{\sqrt{2\pi }\sigma_{g}^{3}}\left(c_{i}^{2} \sigma_{Xi}^{2} +\sum^{n}_{j=1, j \neq i}  c_{i}c_{j}\rho_{X_{i}, X_{j}} \sigma_{Xj}\right) \exp \left(- \frac{\mu_{g}^{2}}{2 \sigma_{g}^{2}}\right) \\
\frac{\partial P_{f}}{\partial \rho_{Xi,Xj}} = \frac{\mu_{g}}{2\sqrt{2\pi }\sigma_{g}^{3}} \left(c_{i}c_{j} \sigma_{Xi} \sigma_{Xj}\right) \exp\left(- \frac{\mu_{g}^{2}}{2 \sigma_{g}^{2}}\right)
\end{cases}$$
æ ¹æ®ä¸Šè¿°æ–¹æ³•æ±‚è§£å¯é åº¦æŒ‡æ ‡$\beta$ä¹‹å, å³å¯é€šè¿‡ä¸Šå¼è·å–è¾“å…¥å˜é‡ç›¸å…³ä¸‹çš„å¯é æ€§çµæ•åº¦ã€‚ 

> [!NOTE] è¯´æ˜
> å¯¹äºæ±‚è§£çš„ç²¾åº¦, ä¸€èˆ¬è€Œè¨€ï¼ŒåŠŸèƒ½å‡½æ•°éçº¿æ€§ç¨‹åº¦è¶Šå°ï¼Œ è·å¾—çš„è§£ç²¾åº¦è¶Šé«˜ã€‚è€Œå½“éçº¿æ€§ç¨‹åº¦å¤§æ—¶, è·å¾—çš„è§£å¯èƒ½é”™è¯¯ã€‚ 

ä¸Šé¢ä¸€é¢˜å¯ä»¥ä½¿ç”¨å¦‚ä¸‹çš„ä»£ç è¿›è¡Œè¿­ä»£æ±‚è§£: 
```erlang
g_t_var = subs(g_t_, [s,p,d,t],[sigma_s_mu, P_mu, D_mu, t_mu]);

% ------- mu_g , sigma_g -------------------
mu_g = g(s,p,d,t);
sigma_g = sqrt(g_s_^2 * ss^2 + g_p_^2 * ps^2 + g_d_^2 * ds^2 + g_t_^2 * ts^2);


% use the formula for lambda 
lambda_s_ = -(diff(g(s,p,d,t), s) * sigma_s_sig)/sigma_g;
lambda_p_ = -(diff(g(s,p,d,t), p) * P_sig)/sigma_g;
lambda_d_ = -(diff(g(s,p,d,t), d) * D_sig)/sigma_g;
lambda_t_ = -(diff(g(s,p,d,t), t) * t_sig)/sigma_g;

mu_values = [sigma_s_mu, P_mu, D_mu, t_mu];
sigma_values = [sigma_s_sig, P_sig, D_sig, t_sig];

lambda_s_var = subs(lambda_s_,[s,p,d,t, ss,ps,ds,ts], ...
    [mu_values(1),mu_values(2), mu_values(3),mu_values(4), sigma_s_sig,P_sig, D_sig,t_sig]);
lambda_p_var = subs(lambda_p_,[s,p,d,t, ss,ps,ds,ts], ...
    [mu_values(1),mu_values(2), mu_values(3),mu_values(4), sigma_s_sig,P_sig, D_sig,t_sig]);
lambda_d_var = subs(lambda_d_,[s,p,d,t, ss,ps,ds,ts], ...
    [mu_values(1),mu_values(2), mu_values(3),mu_values(4), sigma_s_sig,P_sig, D_sig,t_sig]);
lambda_t_var = subs(lambda_t_,[s,p,d,t, ss,ps,ds,ts], ...
    [mu_values(1),mu_values(2), mu_values(3),mu_values(4), sigma_s_sig,P_sig, D_sig,t_sig]);
sprintf("lambda_init: %f, %f, %f, %f", lambda_s_var, lambda_p_var, lambda_d_var,lambda_t_var)
lambda_values = [lambda_s_var, lambda_p_var, lambda_d_var, lambda_t_var]; 

syms b_test
Xi = mu_values;  % åˆå§‹å€¼

beta_fst = 0;
for epoch = 1:1000
    if epoch == 1 
        beta_chk = beta_fst; % ä½¿ç”¨0ä½œä¸ºres1
    else
        beta_chk = beta_sec; % ä¸Šä¸€æ¬¡ç»“æœä½œä¸ºè¿­ä»£ç»“æœæ£€æŸ¥res1
        Xi = mu_values + sigma_values .* lambda_values * beta_sec;  % é‡æ–°è®¡ç®—è®¾è®¡ç‚¹
        % åˆ©ç”¨è®¾è®¡ç‚¹è·å–æ–°çš„lambdaå€¼
        lambda_s_var = subs(lambda_s_,[s,p,d,t, ss,ps,ds,ts], ...
            [Xi(1), Xi(2),Xi(3), Xi(4), sigma_s_sig,P_sig, D_sig,t_sig]);
        lambda_p_var = subs(lambda_p_,[s,p,d,t, ss,ps,ds,ts], ...
            [Xi(1), Xi(2),Xi(3), Xi(4), sigma_s_sig,P_sig, D_sig,t_sig]);
        lambda_d_var = subs(lambda_d_,[s,p,d,t, ss,ps,ds,ts], ...
            [Xi(1), Xi(2),Xi(3), Xi(4), sigma_s_sig,P_sig, D_sig,t_sig]);
        lambda_t_var = subs(lambda_t_,[s,p,d,t, ss,ps,ds,ts], ...
            [Xi(1), Xi(2),Xi(3), Xi(4), sigma_s_sig,P_sig, D_sig,t_sig]);
        lambda_values = [lambda_s_var, lambda_p_var, lambda_d_var, lambda_t_var]; % æ›´æ–°lambda_valueså€¼
    end
    % æ³¨æ„: ä¿ç•™6ä½æœ‰æ•ˆæ•°å­—, é¿å…ç²¾åº¦è¿‡é«˜å¯¼è‡´æ— æ³•è®¡ç®—
    x_res = vpa(mu_values + sigma_values  .* lambda_values * b_test, 6); % æ¯ä¸€æ¬¡éƒ½è¦é‡æ–°è®¡ç®— x_res
    beta_sec = vpa(min(solve(g(x_res(1), x_res(2), x_res(3), x_res(4)) == 0, b_test)), 6);
    sprintf("epoch: %d, res1: %f, res2 : %f",epoch, vpa(beta_chk,6), vpa(beta_sec,6))
    if (abs(beta_chk - beta_sec))<0.001
        break;
    end
end
sprintf("design point: %f, %f, %f, %f", Xi(1), Xi(2), Xi(3), Xi(4))
```

ç»“æœå¦‚ä¸‹:
```erlang 
ans =     "epoch: 1, res1: 0.000000, res2 : 3.335089"
ans =     "epoch: 2, res1: 3.335089, res2 : 3.324230"
ans =     "epoch: 3, res1: 3.324230, res2 : 3.324148"
ans =     "design point: 320.634706, 25.238194, 462.437569, 18.199978"
```
---
~
---
## ä¸€ã€ä¸€æ¬¡äºŒé˜¶çŸ©æ–¹æ³•(FOSM) 
### (1) å‡å€¼ FOSM å¯é æ€§åˆ†ææ–¹æ³•
#### 1. çº¿æ€§å‡½æ•°æƒ…å†µ
æˆ‘ä»¬è€ƒè™‘åŠŸèƒ½å‡½æ•° $Y = g(X)$æ˜¯è¾“å…¥å˜é‡$X = (X_1, X_2, \dots X_n)^T$çš„å‡½æ•°, å¹¶è®°$Y< 0$ä¸ºå¤±æ•ˆ, åˆ™æ ¹æ®æ¦‚ç‡è®ºåŸºæœ¬åŸç†, å½“åŠŸèƒ½å‡½æ•°ä¸ºè¾“å…¥å˜é‡çº¿æ€§å‡½æ•°ä¸”æœä»æ­£æ€åˆ†å¸ƒæ—¶ï¼Œå¯¹åº”çš„åŠŸèƒ½å‡½æ•°ä¹Ÿæœä»æ­£æ€åˆ†å¸ƒã€‚

è®¾åŠŸèƒ½å‡½æ•°$Y = g(X)$æ˜¯**æœä»æ­£æ€åˆ†å¸ƒçš„è¾“å…¥çš„éšæœºå˜é‡$X$çš„çº¿æ€§å‡½æ•°**, æ­¤æ—¶æœ‰:
$$Y = g(X) = a_{0} + \sum^{n}_{i=1} a_{i} X_{i}$$
å®¹æ˜“è·å–å‡ºå‡å€¼ä¸æ–¹å·®å…³ç³»ä¸º(å‚è€ƒ[[ğŸ“˜ClassNotes/ğŸ“Mathmatics/ğŸ£Probability Theory/è¡¥å……éƒ¨åˆ†/æ–¹å·®çš„æ€§è´¨è¯æ˜.pdf|æ–¹å·®çš„æ€§è´¨è¯æ˜]]ä»¥åŠ[[ğŸ“˜ClassNotes/ğŸ“Mathmatics/ğŸ£Probability Theory/ç¬¬å››ç«  éšæœºå˜é‡çš„æ•°å­—ç‰¹å¾#ä¸‰ã€åæ–¹å·®åŠå…¶ç›¸å…³ç³»æ•°|åæ–¹å·®åŠå…¶ç›¸å…³ç³»æ•°]]):
$$\mu_{g} = a_{0} + \sum^{n}_{i=1} a_{i} \mu_{Xi}\qquad \sigma_{g}^{2} = \sum^{n}_{i=1} a_{i}^{2} \sigma_{Xi}^{2} + \sum^{n}_{i=1} \sum^{n}_{j=1(j\neq i)}  a_{i} a_{j}\space  \text{Cov}(X_{i}, X_{j})$$
å…¶ä¸­i = j æ—¶æ˜¾ç„¶åæ–¹å·®ä¸º0, æ­¤æ—¶ï¼Œ æ­£æ€å˜é‡ç»è¿‡çº¿æ€§ç»„åˆä¹‹åï¼Œ ä»ç„¶æœä»æ­£æ€åˆ†å¸ƒã€‚ 
ä¸ºäº†ä¿è¯ç»“æ„æ€»ä½“æ˜¯æœ‰æ•ˆçš„ï¼Œ å³ä¿è¯$Y = g(x) > 0$, å› æ­¤ä»£å…¥å¾—åˆ°:
$$\Large\boxed{\mu_{g} - \beta \sigma_{g} > 0}$$
æ­¤æ—¶ï¼Œ è®°**å‡å€¼$\mu_g$å’Œæ ‡å‡†å·®$\sigma_g$çš„æ¯”å€¼**è®°ä¸º<mark style="background: transparent; color: red">å¯é åº¦æŒ‡æ ‡</mark>$\beta$, åˆ™:
$$\Large \boxed {\beta = \frac{\mu_{g}}{\sigma_{g}} = \frac{a_{0} + \sum^{n}_{i=1}a_{i} \mu_{Xi}}{\sqrt{\sum^{n}_{i=1} a_{i}^{2} \sigma_{Xi}^{2} + \sum^{n}_{i=1} \sum^{n}_{j=1(j\neq i)}  a_{i} a_{j}\space  \text{Cov}(X_{i}, X_{j})}}}$$
ç”±äºè¾“å…¥æ­£æ€åŒ–å˜é‡$Z$å¯ä»¥çœ‹æˆæ˜¯$Z = \frac{Y - \mu_{g}}{\sigma_{g}}$,
æ­¤æ—¶, ä¸€æ¬¡äºŒé˜¶çŸ©æ–¹æ³•çš„**å¤±æ•ˆæ¦‚ç‡**$P_f$å’Œå¯é åº¦$P_r$ä¸º:
$$P_{f} = P\left\{ Z\leq 0 \right\} = P\left\{ \frac{X - \mu_{g}}{\sigma_{g}} \leq  -\beta\right\} = \Phi (- \beta )$$
$$P_{r} = P\{Z > 0 \} = P \left\{\frac{X - \mu_{g}}{\sigma_{g}} > - \beta \right\} \overset{è½¬æ¢< \beta }{\rightarrow} = \Phi (\beta )$$
![[Excalidraw/ç¬¬äºŒç«  å¯é æ€§çµæ•åº¦åˆ†æçš„çŸ©æ–¹æ³• 2024-01-24 11.18.50|500]]
#### 2. éçº¿æ€§åŠŸèƒ½å‡½æ•°æƒ…å†µ
å¯¹äºéçº¿æ€§å‡½æ•°ï¼Œåˆ™åœ¨ç›¸åº”çš„å‡å€¼ç‚¹å¤„å±•å¼€ä¸ºæ³°å‹’çº§æ•°ï¼Œå¯ä»¥å– 
$$Y = g(X_{1},X_{2}, \dots ,X_{n}) \approx g(\mu_{X1}, \mu_{X2} , \dots \mu_{Xn}) + \sum^{n}_{i=1} \left.\frac{\partial g}{\partial X_{i}} \right|_{\mu_{X}} (X_{i} - \mu_{Xi})$$
æ˜¾ç„¶å¾—åˆ°: 
$$\beta  = \frac{\mu_{g}}{\sigma_{g}} = \frac{g(\mu_{X1}, \mu_{X2}, \dots  \mu_{Xn})}{\sqrt{\sum^{n}_{i=1} \left(\left.\frac{\partial g}{\partial X_{i}} \right|_{\mu_{X}}\right)^{2} \sigma_{i}^{2} + \sum^{n}_{i=1} \sum^{n}_{j=1(j\neq i)} \left.\left(\frac{\partial g}{\partial X_{i}}\right)\left(\frac{\partial g}{\partial X_{j}} \right) \right|_{\mu_{X}} Cov(X_{i}, X_{j}) }}$$
æ­¤æ—¶ä»ç„¶æ»¡è¶³:
$$P_{r} = \Phi(\beta) \qquad  P_{f} = \Phi(-\beta)$$

> [!caution] é™„æ³¨
> ä¸ºäº†å¯¹æ¨¡å‹çš„éçº¿æ€§è¿›è¡Œé™ç»´ï¼Œ æˆ‘ä»¬å¾€å¾€ä»¥å°½å¯èƒ½ç®€å•çš„å˜é‡ä½œä¸ºé¢„æµ‹å€¼ï¼Œè€Œéçº¿æ€§è¾ƒå¼ºçš„éƒ¨åˆ†å¾€å¾€å¯ä»¥é€šè¿‡ç®€å•çš„è®¡ç®—å‡ºæ¥ã€‚ä¾‹å¦‚åº”åŠ›å’Œå¯¿å‘½ç›¸äº’è½¬æ¢ï¼Œå¯ä»¥å®ç°å°†éçº¿æ€§è¾ƒå¼ºçš„å¯¿å‘½è½¬æ¢ä¸ºåº”åŠ›æ¨¡å‹ã€‚

### (2) å‡å€¼FOSMå¯é æ€§çµæ•åº¦åˆ†ææ–¹æ³•
#### 1. å®šä¹‰
æ ¹æ®ä¸Šè¿°æ–¹æ³•, <mark style="background: transparent; color: red">å¯é æ€§çµæ•åº¦</mark>å®šä¹‰ä¸ºå¤±æ•ˆæ¦‚ç‡å¯¹äºå‡å€¼, æ–¹å·®å’Œåæ–¹å·®çš„åå¯¼æ•°, å³æœ‰: 
$$\frac{\partial P_{f}}{\partial \mu_{Xi}} = \frac{\partial P_{f}}{\partial \beta}\frac{\partial \beta }{\partial \mu_{Xi}} \quad \frac{\partial P_{f}}{\partial \sigma_{Xi}} = \frac{\partial P_{f}}{\partial \beta}\frac{\partial \beta }{\partial \sigma_{Xi}}\quad \frac{\partial P_{f}}{\partial \rho_{Xi,Xj}} = \frac{\partial P_{f}}{\partial \beta}\frac{\partial \beta }{\partial \rho_{Xi,Xj}}\tag{2.2.1}$$
æ­¤æ—¶, æ ¹æ®å…¬å¼[[ğŸ“˜ClassNotes/ğŸ“Mathmatics/ğŸ£Probability Theory/ç¬¬äºŒç«  éšæœºå˜é‡åŠå…¶åˆ†å¸ƒ#3. æ­£æ€åˆ†å¸ƒ|æ­£æ€åˆ†å¸ƒå…¬å¼]], æœ‰: 
$$P_{f} = \Phi(- \beta) = 1 - \Phi (\beta) = 1- \frac{1}{\sqrt{2\pi}} \int_{-\infty}^{\beta} e^{- \frac{t^{2}}{2}}dt$$
è·å¾—å…³äºå¯é åº¦æŒ‡æ ‡çš„ç»“æœ: 
$$\boxed {\frac{\partial P_{f}}{\partial \beta} = -\frac{1}{\sqrt{2\pi}}  e^{- \frac{\beta ^{2}}{2}} = -\frac{1}{\sqrt{2\pi}} \exp \left(- \frac{\mu_{g}^{2}}{2 \sigma_{g}^{2}}\right)} \tag{2.2.2}$$
#### 2. è¾“å…¥å˜é‡ç‹¬ç«‹æ—¶çš„å¯é æ€§çµæ•åº¦è®¡ç®— 
æ ¹æ®$\beta$çš„å®šä¹‰å¼, æœ‰:
$$\beta = \frac{\mu_{g}}{\sigma_{g}} = \frac{a_{0} + \sum^{n}_{i=1}a_{i} \mu_{i}}{\sqrt{\sum^{n}_{i=1} a_{i}^{2} \sigma_{Xi}^{2} + \sum^{n}_{i=1} \sum^{n}_{j=1(j\neq i)}  a_{i} a_{j}\space  \text{Cov}(X_{i}, X_{j})}} \overset{ä¸ç›¸å…³}{\rightarrow } = \frac{a_{0} + \sum^{n}_{i=1} a_{i} \mu_{i}}{\sqrt{\sum^{n}_{i=1} a_{i}^{2} \sigma_{Xi}^{2}}}$$
$$\frac{\partial \beta}{\partial \mu_{Xi}} = \frac{a_{i}}{\sqrt{\sum^{n}_{i=1} a_{i}^{2} \sigma_{i}^{2}}} = \frac{a_{i}}{\sigma_{g}}, \qquad\frac{\partial \beta}{\partial \sigma_{Xi}} = -\frac{\mu_{g}}{\sigma_{g}^{2}} \times  \frac{1}{2 \sigma_{g}} \times 2a_{i}^{2} \sigma_{Xi} = - \frac{\mu_{g}  a_{i}^{2} \sigma_{Xi}}{\sigma_{g}^{3}}$$
ä»£å…¥2.2.1å¼å¾—åˆ°<mark style="background: transparent; color: red">ç‹¬ç«‹å˜é‡çš„çº¿æ€§å‡å€¼çµæ•åº¦å…¬å¼å’Œæ–¹å·®çµæ•åº¦å…¬å¼</mark>å¦‚ä¸‹: 
$$\Large \boxed{\frac{\partial P_{f}}{\partial \mu_{Xi}} =- \frac{a_{i}}{\sqrt{2\pi } \sigma_{g}} \exp \left(- \frac{\mu_{g}^{2}}{2 \sigma_{g}^{2}}\right)\qquad  \frac{\partial P_{f}}{\partial \sigma_{Xi}} =  \frac{\mu_{g}a_{i}^{2} \sigma_{Xi}}{\sqrt{2\pi }\sigma_{g}^{3}} \exp \left(- \frac{\mu_{g}^{2}}{2\sigma_{g}^{2}}\right)}$$
å…¶ä¸­å¯¹äºç‹¬ç«‹<mark style="background: transparent; color: red">éçº¿æ€§</mark>æ—¶, åªéœ€å°†æ›¿æ¢$a_i$ä¸º$\left.\frac{\partial g}{\partial X_i} \right|_{\mu X}$å³å¯ã€‚

#### 3. è¾“å…¥å˜é‡ç›¸å…³æ—¶çš„å¯é æ€§çµæ•åº¦è®¡ç®— 
é¦–å…ˆï¼Œ å¦‚æœ**åŠŸèƒ½å‡½æ•°æ˜¯çº¿æ€§çš„**ï¼Œåˆ™å¯é æ€§çµæ•åº¦è®¡ç®—å¦‚ä¸‹:  
åœ¨çº¿æ€§çš„æƒ…å†µä¸‹, ä»ç„¶æ»¡è¶³:
$$\beta = \frac{\mu_{g}}{\sigma_{g}} = \frac{a_{0} + \sum^{n}_{i=1}a_{i} \mu_{Xi}}{\sqrt{\sum^{n}_{i=1} a_{i}^{2} \sigma_{Xi}^{2} + \sum^{n}_{i=1} \sum^{n}_{j=1(j\neq i)}  a_{i} a_{j}\space  \text{Cov}(X_{i}, X_{j})}}$$
å› æ­¤å®¹æ˜“è®¡ç®—å‡ºå¯¹$\mu_{g}, \sigma_{g}, \rho_{X_{i},X_{j}}$çš„åå¯¼æ•°, åŒæ—¶åˆ©ç”¨åæ–¹å·®çš„å®šä¹‰: 
$$\boxed{\rho_{XY} = \frac{\text{Cov}(X,Y)}{\sqrt{D(X)} \sqrt{D(Y)}}}$$
å› æ­¤åœ¨æ±‚è§£æ–¹å·®æ—¶éœ€è¦è€ƒè™‘, ç»è¿‡è®¡ç®—å¾—åˆ°:
$$\frac{\partial \beta}{\partial \mu_{X_{i}}} = \frac{a_{i}}{\sigma_{g}} \qquad \frac{\partial \beta}{\partial \sigma_{Xi}} = - \frac{\mu_{g} }{\sigma_{g}^{3}} \left(a_{i}^{2} \sigma_{Xi}^{2} +\sum^{n}_{j=1, j \neq i}  a_{i}a_{j}\rho_{X_{i}, X_{j}} \sigma_{Xj}\right)\qquad \frac{\partial \beta}{\partial \rho_{Xi, Xj}} = - \frac{ \mu_{g}}{2 \sigma_{g}^{3}}\left(a_{i}a_{j} \sigma_{Xi} \sigma_{Xj}\right)$$
å› è€Œæœ‰<mark style="background: transparent; color: red">å…³äºå‡å€¼ï¼Œ æ–¹å·®å’Œåæ–¹å·®çš„å¯é æ€§çµæ•åº¦è®¡ç®—ä¸º</mark>:
$$\begin{cases}
\frac{\partial P_{f}}{\partial \mu_{Xi}} = - \frac{a_{i}}{\sqrt{2 \pi }\sigma_{g}}\exp \left(- \frac{\mu_{g}^{2}}{2 \sigma_{g}^{2}}\right)  \\
\frac{\partial P_{f}}{\partial \sigma_{Xi}} = \frac{\mu_{g}}{\sqrt{2\pi }\sigma_{g}^{3}}\left(a_{i}^{2} \sigma_{Xi}^{2} +\sum^{n}_{j=1, j \neq i}  a_{i}a_{j}\rho_{X_{i}, X_{j}} \sigma_{Xj}\right) \exp \left(- \frac{\mu_{g}^{2}}{2 \sigma_{g}^{2}}\right) \\
\frac{\partial P_{f}}{\partial \rho_{Xi,Xj}} = \frac{\mu_{g}}{2\sqrt{2\pi }\sigma_{g}^{3}} \left(a_{i}a_{j} \sigma_{Xi} \sigma_{Xj}\right) \exp\left(- \frac{\mu_{g}^{2}}{2 \sigma_{g}^{2}}\right)
\end{cases}$$
æ­¤æ—¶å¦‚æœä¸ºéçº¿æ€§æ–¹ç¨‹, åˆ™åšå¦‚ä¸‹æ›¿æ¢(å…¶ä¸­$Y = g(X_{1}, \dots X_{n})\approx g(\mu_{X1}, \mu_{X2}, \dots \mu_{Xn})$) å³å¯: 
$$a_{i} = \left. \frac{\partial g}{\partial X_{i}} \right|_{\mu_{X}} \qquad a_{j} = \left. \frac{\partial g}{\partial X_{j}} \right|_{\mu_{X}}$$
ç»™å‡ºç®€å•çš„ matlab ç¤ºä¾‹ä»£ç : 
```erlang
clear,clc
%%%%%% 
% æŸå†…å‹åœ†ç­’å‹å®¹å™¨ææ–™ä¸º15MnV, éšæœºå˜é‡å–ä¸ºå†…å¾„D, å†…å‹å¼ºP, å£åštä¸å±ˆæœå¼ºåº¦sigma_s
% è¿™äº›éšæœºå˜é‡ç‹¬ç«‹ä¸”å‡æœä»æ­£æ€åˆ†å¸ƒ, å‚æ•°åœ¨ä¸‹é¢ç»™å‡º
D_mu = 460; D_sig = 7;
P_mu = 20;  P_sig = 2.4;
t_mu = 19;  t_sig = 0.8;
sigma_s_mu = 392; sigma_s_sig = 31.4 ; 


syms s p d t ss ps ds ts
g(s,p,d,t) = s - p * d/(2 * t);

% ------- derivates for function g------- 
g_s_ = subs(diff(g(s,p,d,t),s), [s,p,d,t],[sigma_s_mu, P_mu, D_mu, t_mu]);
g_p_ = subs(diff(g(s,p,d,t),p), [s,p,d,t],[sigma_s_mu, P_mu, D_mu, t_mu]);
g_d_ = subs(diff(g(s,p,d,t),d), [s,p,d,t],[sigma_s_mu, P_mu, D_mu, t_mu]);
g_t_ = subs(diff(g(s,p,d,t),t), [s,p,d,t],[sigma_s_mu, P_mu, D_mu, t_mu]);


mu_g = g(s,p,d,t);
sigma_g = sqrt(g_s_^2 * ss^2 + g_p_^2 * ps^2 + g_d_^2 * ds^2 + g_t_^2 * ts^2);

mu_g_var = vpa(subs(mu_g,[s,p,d,t], [sigma_s_mu,P_mu, D_mu,t_mu]));
sigma_g_var = vpa(subs(sigma_g,[ss,ps,ds,ts], [sigma_s_sig,P_sig, D_sig,t_sig]));

beta = mu_g/sigma_g;
beta_var = subs(beta,[s,p,d,t, ss,ps,ds,ts], [sigma_s_mu,P_mu, D_mu,t_mu, sigma_s_sig,P_sig, D_sig,t_sig]);

sprintf("mu_g: %f, sigma_g: %f",mu_g_var,sigma_g_var)
sprintf("beta: %f , Pf :%f", beta_var, normcdf(-beta_var))

beta_t_ = diff(beta,t);
beta_d_ = diff(beta, d);
beta_p_ = diff(beta, p);
beta_s_ = diff(beta, s);

Pf_beta_ = -1/sqrt(2 * pi) * exp(-mu_g^2/(2 * sigma_g^2));


sen_s = subs(beta_s_ * Pf_beta_, [s,p,d,t, ss,ps,ds,ts], [sigma_s_mu,P_mu, D_mu,t_mu, sigma_s_sig,P_sig, D_sig,t_sig] );
sen_p = subs(beta_p_ * Pf_beta_, [s,p,d,t, ss,ps,ds,ts], [sigma_s_mu,P_mu, D_mu,t_mu, sigma_s_sig,P_sig, D_sig,t_sig] );
sen_d = subs(beta_d_ * Pf_beta_, [s,p,d,t, ss,ps,ds,ts], [sigma_s_mu,P_mu, D_mu,t_mu, sigma_s_sig,P_sig, D_sig,t_sig] );
sen_t = subs(beta_t_ * Pf_beta_, [s,p,d,t, ss,ps,ds,ts], [sigma_s_mu,P_mu, D_mu,t_mu, sigma_s_sig,P_sig, D_sig,t_sig] );
% è¾“å‡ºæ¯ä¸€ä¸ªå‡å€¼æ•æ„Ÿåº¦ -> æ–¹å·®çµæ•åº¦åˆ†æç•¥å»
sprintf("sense: %0.8f, %0.8f, %0.8f, %0.8f", sen_d, sen_p, sen_t, sen_s)
```

```erlang
ans = 
    "mu_g: 149.894737, sigma_g: 44.130540"
ans = 
    "beta: 3.396621 , Pf :0.000341"
ans = 
    "sense: 0.00001487, 0.00034191, -0.00035990, -0.00002824"
```

### (3) æ”¹è¿› FOSM å¯é æ€§åˆ†ææ–¹æ³•
#### 1. çº¿æ€§åŠŸèƒ½å‡½æ•° 
Advanced FOSM method ä¸ºæ”¹è¿›çš„ä¸€æ¬¡äºŒé˜¶çŸ©æ–¹æ³•, ä¹Ÿæ˜¯é€šè¿‡ç±»ä¼¼æ–¹æ³•å°†éçº¿æ€§åŠŸèƒ½å‡½æ•°è¿›è¡Œçº¿æ€§å±•å¼€, å¹¶ä½¿ç”¨çº¿æ€§åŠŸèƒ½å‡½æ•°çš„å¤±æ•ˆæ¦‚ç‡è¿‘ä¼¼åŸå§‹éçº¿æ€§åŠŸèƒ½å‡½æ•°çš„å¤±æ•ˆæ¦‚ç‡ã€‚é’ˆå¯¹äºéçº¿æ€§åŠŸèƒ½å‡½æ•°,  å…¶å¤±æ•ˆåŸŸä¸­çš„æœ€å¯èƒ½å¤±æ•ˆçš„ç‚¹æ˜¯ä¸èƒ½æœ‰é™å¾—çŸ¥çš„, éœ€è¦ä½¿ç”¨å¯»ä¼˜å’Œè¿­ä»£çš„æ–¹æ³•ã€‚

é¦–å…ˆæˆ‘ä»¬è®¾**åŠŸèƒ½å‡½æ•° Y = g(X)** ä¸ºå¦‚ä¸‹å½¢å¼çš„çº¿æ€§å‡½æ•°:
$$Y = g(X) = a_{0} + \sum^{n}_{i=1} a_{i} X_{i}$$
æ­¤æ—¶, è¦æ±‚æ”¹è¿›ä¸€æ¬¡äºŒé˜¶çŸ©æ–¹æ³•çš„åˆ†æç»“æœå’Œå‡å€¼ä¸€æ¬¡äºŒé˜¶çŸ©çš„å¯é æ€§åˆ†æç»“æœå®Œå…¨ä¸€è‡´ã€‚é¦–å…ˆ, <mark style="background: transparent; color: red">å°†æ­£æ€è¾“å…¥å˜é‡è¿›è¡Œæ ‡å‡†åŒ–</mark>, å–$Z_i$ä¸ºæ­£æ€åŒ–è¾“å…¥å˜é‡, å³æœ‰:
$$Z_{i}  = \frac{X_{i} - \mu_{Xi}}{\sigma_{Xi}}$$
æ­¤æ—¶, ä»£å…¥å³å¯å¾—åˆ°ä½¿ç”¨**æ ‡å‡†æ­£æ€åˆ†å¸ƒè¡¨å¾çš„æé™çŠ¶æ€æ–¹ç¨‹**:
$$Y' = a_{0} +\sum^{n}_{i=1}  a_{i} (\sigma_{Xi} Z_{i}+ \mu_{Xi}) = 0 $$
æ­¤æ—¶ç§»é¡¹å¹¶åŒé™¤ $\sqrt{\sum^{n}_{i=1} a_{i}^{2} \sigma_{Xi}^{2}}$, å¾—åˆ°<mark style="background: transparent; color: red">æ ‡å‡†å‹çš„æ³•çº¿æ–¹ç¨‹</mark>: 
$$\frac{\sum^{n}_{i=1} a_{i} \sigma_{Xi} }{\sqrt{\sum^{n}_{i=1} a_{i}^{2}\sigma_{Xi}^{2}}}Z_{i} = - \frac{a_{0} + \sum^{n}_{i=1} a_{i} \mu_{Xi}}{\sqrt{\sum^{n}_{i=1} a_{i}^{2}\sigma_{Xi}^{2}}} = - \beta$$
å…¶ä¸­$\beta$ ä¸ºå¯é åº¦æŒ‡æ ‡, æ­¤æ—¶ä¸¤è¾¹åŒæ—¶å–è´Ÿå·, åˆ™æœ‰<mark style="background: transparent; color: red">åœ¨æ ‡å‡†æ­£æ€ç©ºé—´ä¸­çš„æé™çŠ¶æ€æ–¹ç¨‹</mark>: 
$$\boxed{\sum^{n}_{i=1} \lambda_{i}  Z_{i} = \beta\qquad  \lambda_{i} = - \frac{ a_{i} \sigma_{Xi} }{\sqrt{\sum^{n}_{i=1} a_{i}^{2}\sigma_{Xi}^{2}}}}$$
å…¶å‡ ä½•æ„ä¹‰å¦‚ä¸‹å›¾æ‰€ç¤º: å…¶ä¸­, $P(z_1^*, z_2^*)$ä¸º<mark style="background: transparent; color: red">è®¾è®¡ç‚¹</mark>, å¯¹äºæ ‡å‡†æ­£æ€ $Z$ ç©ºé—´, <mark style="background: transparent; color: red">è®¾è®¡ç‚¹æ˜¯æé™æ–¹ç¨‹çš„å¤±æ•ˆåŸŸä¸­å¯¹å¤±æ•ˆæ¦‚ç‡è´¡çŒ®æœ€å¤§çš„ç‚¹</mark>, ä¹Ÿç§°ä¹‹ä¸º<mark style="background: transparent; color: red">æœ€æœ‰å¯èƒ½å¤±æ•ˆç‚¹</mark>(MPP)ã€‚

ç”±äºå¤±æ•ˆçš„æ–¹ç¨‹æ˜¯
$$\boxed{\sum^{n}_{i=1}  \lambda_{i} Z_{i} = \beta\quad  \overset{ä»…è€ƒè™‘ä¸¤ä¸ªå˜é‡}{\rightarrow}\quad  \lambda_{1}Z_{1} + \lambda_{2} Z_{2} - \beta = 0}$$
æ˜¾ç„¶ç›´çº¿ä¸Šçš„ä»»ä½•ç‚¹å‡æ»¡è¶³$\lambda_1 z_1^* + \lambda_2 z_2^* = \beta$,  å› æ­¤è¿‡åŸç‚¹å‘æé™çŠ¶æ€æ–¹ç¨‹ä½œå‚çº¿, æ ¹æ®[[ğŸ“˜ClassNotes/ğŸ“Mathmatics/ğŸ“ˆAdvanced Mathematics/ç¬¬å…«ç«  å‘é‡ä»£æ•°å’Œç©ºé—´è§£æå‡ ä½•#(1) ç©ºé—´ç›´çº¿çš„ä¸€èˆ¬å¼æ–¹ç¨‹|ç›´çº¿çš„ä¸€èˆ¬å¼æ–¹ç¨‹]]ç‰©ç†æ„ä¹‰, åˆ™æ³•å‘é‡ä¸º $\vec{n}(\lambda_1, \lambda_2)$ , è€Œæ˜¾ç„¶æ»¡è¶³: $\lambda_1^2 + \lambda_2^2 = 1$(æ¨å¹¿åä¹Ÿæˆç«‹), æ˜¾ç„¶æœ‰:
$$\boxed{\lambda_1  = \cos \theta_1, \lambda_2 = \cos \theta_{2}}$$
![[Excalidraw/ç¬¬äºŒç«  å¯é æ€§çµæ•åº¦åˆ†æçš„çŸ©æ–¹æ³• 2024-01-25 16.11.03|400]]
æ­¤æ—¶æ ¹æ®[[ğŸ“˜ClassNotes/ğŸ“Mathmatics/ğŸ“ˆAdvanced Mathematics/ğŸ‘†é‡è¦å®šç†/ç©ºé—´å‡ ä½•ä½ç½®å…³ç³»æ€»ç»“|ç‚¹åˆ°å¹³é¢è·ç¦»å…¬å¼]]å¯ä»¥è®¡ç®—å‡º<b><mark style="background: transparent; color: blue">åŸç‚¹åˆ°ç›´çº¿çš„å‚çº¿è·ç¦»</mark></b>å³ä¸º<mark style="background: transparent; color: red">å¯é åº¦çš„å‡ ä½•æ„ä¹‰</mark>: 
$$d = \frac{\beta}{\sqrt{\lambda_{1}^{2} + \lambda_{2}^{2}}} =  \beta$$
åœ¨å®é™…æ±‚è§£ä¸­ï¼Œ åº”å½“å…ˆæ±‚å–è®¾è®¡ç‚¹$P(z_1^*, z_2^*, \dots z_n^*)$, ç»è¿‡åå˜æ¢ä¹‹åå¯ä»¥æ±‚å¾—å¯¹åº”çš„$X$ç©ºé—´è®¾è®¡ç‚¹åæ ‡ã€‚ åŒæ—¶, å¯ä»¥è§£å‡ºå¯¹åº”çš„$z_{1}^{*}, z_{2}^{*}$, åªéœ€ç”¨$\frac{z_{1}^{*}}{z_{2}^{*}} = \frac{\lambda_{1}}{\lambda_{2}}$, å®¹æ˜“æ±‚è§£å‡º:
$$\boxed{z_{1}^{*} =  \lambda_{1}\beta,\qquad z_{2}^{*} =  \lambda_{2}\beta }$$
#### 2. éçº¿æ€§åŠŸèƒ½å‡½æ•°
ä»ç„¶å°†éçº¿æ€§çš„åŠŸèƒ½å‡½æ•°è¿›è¡Œå±•å¼€å¹¶å–å…¶ä¸­çš„çº¿æ€§éƒ¨åˆ†:
$$Y = g(X_{1}, X_{2},\dots X_{n})\approx g(x_{1}^{*}, \dots x_{n}^{*}) + \sum^{n}_{i=1} \left. \frac{\partial g}{\partial x_{i}} \right|_{P^{*}}(X_{i}- x_{i}^{*})$$
æ­¤æ—¶ç”±äº$P^*$å¯¹åº”çš„$g  (X_1, X_2, \dots  X_n) = 0$åœ¨å¤±æ•ˆè¾¹ç•Œä¸Š, å› è€Œæœ‰ $g(x_1^*, x_2^*, \dots x_n^*) = 0$, ä»£å…¥ä¸Šå¼åˆ™æœ‰<mark style="background: transparent; color: red">åŠŸèƒ½å‡½æ•°çš„çº¿æ€§è¿‘ä¼¼</mark>: 
$$\boxed{\left. \sum^{n}_{i=1} \frac{\partial g}{\partial x_{i}} \right|_{P^{*}}  (X_{i} - x_{i}^{*})= 0}$$
æ­¤æ—¶ç›´æ¥æŒ‰ç…§[[#(1) å‡å€¼ FOSM å¯é æ€§åˆ†ææ–¹æ³•]]è¿›è¡Œçº¿æ€§æ±‚è§£å³å¯, å…¶ä¸­$a_{0} = -\sum^{n}_{i=1} \dots x_{i}^{*}$ , **ä»£å…¥å…¬å¼å³å¾—åˆ°**: 
$$\beta = \frac{\left. \sum^{n}_{i=1} \frac{\partial g}{\partial x_{i}} \right|_{P^{*}}  (\mu_{Xi} - x_{i}^{*})}{\sqrt{\sum^{n}_{i=1} a_{i}^{2}\sigma_{Xi}^{2} + \sum^{n}_{i=1}  \sum^{n}_{j=1(j \neq i)} a_{i}a_{j} \text{Cov} (X_{i}, X_{j})}}$$
å¯¹åº”åœ°ï¼Œçº¿æ€§å‡½æ•°çš„å¤±æ•ˆæ¦‚ç‡ä¸º:
$$P_{f} = \Phi(-\beta)$$
æ­¤æ—¶å¯é åº¦æŒ‡æ ‡ä»¥åŠå¯¹åº”è®¾è®¡ç‚¹çš„å‡ ä½•æ„ä¹‰å¦‚ä¸‹å›¾:
![[Excalidraw/ç¬¬äºŒç«  å¯é æ€§çµæ•åº¦åˆ†æçš„çŸ©æ–¹æ³• 2024-01-25 18.30.40|350]]
æ­¤æ—¶, ä»ç„¶æœ‰:
$$\boxed{\Large z_{i}^{*} = \lambda_{i} \beta\qquad  \lambda_{i} = - \frac{\left. \frac{\partial g}{\partial X_{i}} \right|_{P^{*}}\sigma_{Xi}}{\left[\sum^{n}_{i=1}\left( \left. \frac{\partial g}{\partial X}\right|_{P^{*}}\right)^{2}  \sigma_{Xi}^{2}\right]^{\frac{1}{2}}} = \cos \theta_{i}}\tag{2.3.3}$$
æ­¤æ—¶, å°†æ ‡å‡†æ­£æ€$Z$ç©ºé—´çš„è®¾è®¡ç‚¹$P^{*}(z_{1}^{*}, z_{2}^{*}\dots z_{n}^{*})$, å˜æ¢åˆ°$P^{*}(x_{1}^{*}, x_{2}^{*}, \dots x_{n}^{*})$ç©ºé—´, ä»è€Œå¾—åˆ°è®¾è®¡ç‚¹$P^{*}$<mark style="background: transparent; color: red">åœ¨Xåæ ‡ç³»ä¸‹çš„åæ ‡</mark>: 
$$\Large\boxed{x_{i}^{*} = \mu_{Xi} + \sigma_{Xi} z_{i}^{*} =  \mu_{Xi} + \sigma_{Xi}\lambda_{i} \beta \tag{2.3.4}}$$
ç”±äºè®¾è®¡ç‚¹$P^*(x_1^*, x_2^*, \dots x_n^* )$åœ¨**å¤±æ•ˆè¾¹ç•Œä¸Š**, åˆ™æœ‰:
$$\Large\boxed{g(x_1^*, x_2^*, \dots x_n^*)=0\tag{2.3.5}}$$
> [!summary] æ”¹è¿›ä¸€æ¬¡äºŒé˜¶çŸ©çš„è¿­ä»£æ±‚è§£æ–¹æ³•
> - å‡å®šè®¾è®¡ç‚¹åæ ‡$P^*(x_{1}^{*}, x_{2}^{*}, \dots x_{n}^{*})$ç­‰çš„åˆå§‹å€¼éƒ¨åˆ†(å¯ä»¥å–$\mu_{X}$çš„å€¼)ä¸ºåˆå§‹å€¼ã€‚å¦å¤–å¯ä»¥è®¾ç¬¬ä¸€æ¬¡è§£å‡ºçš„$\beta$ åˆå§‹å€¼ä¸º0;
> - åˆ©ç”¨å‡è®¾çš„åˆå§‹å€¼,  å°†å¼2.3.4ä»£å…¥$g(X) = 0$ä¸­, å¯ä»¥è§£å‡º$\beta$çš„åˆå§‹å€¼ã€‚
> - å°†$\beta$ å€¼ç»§ç»­ä»£å…¥2.3.4å¹¶é‡å¤è¿­ä»£è·å–æœ€ç»ˆçš„$\beta$å€¼
>  éœ€è¦è¯´æ˜çš„æ˜¯, è®¾ç½®åˆå§‹å€¼ä¸º0, æ¯ä¸€æ¬¡çš„å€¼å‡ä»$g(x^{*}) = 0$ä¸­è§£å‡º; è€Œè¿­ä»£è¿‡ç¨‹æ¯ä¸€æ¬¡åˆå°†betaä»£å›è®¡ç®—x, é€šè¿‡æ›´æ”¹åçš„ç‚¹ç»è¿‡$\lambda$å…¬å¼(2.3.3) é‡æ–°è®¡ç®—è·å–æ–°çš„lambdaå€¼å†è¿›è¡Œè¿­ä»£å¾—åˆ°æœ€ç»ˆç»“æœçš„ã€‚ 

> [!NOTE] è¡¥å……
> è¯´æ˜: 
> - å¯¹äºçº¿æ€§æƒ…å†µï¼Œ æ±‚è§£çš„ç»“æœä¸FOSMæ–¹æ³•ç›¸åŒ, æ­¤æ—¶åªéœ€è¿­ä»£ä¸€æ¬¡å³å¯å¾—åˆ°ç»“æœï¼Œä¸”ä¸è®ºè¿­ä»£å¤šå°‘æ¬¡å¾—åˆ°ç»“æœå‡ç›¸åŒ
> 
> ç¼ºç‚¹: 
> 1. ä¸èƒ½åæ˜ åŠŸèƒ½å‡½æ•°å¯¹å¤±æ•ˆæ¦‚ç‡çš„å½±å“
> 2. å¯¹äºåŠŸèƒ½å‡½æ•°åœ¨éçº¿æ€§ç¨‹åº¦æ¯”è¾ƒå¤§çš„æƒ…å†µä¸‹, è¿­ä»£ç®—æ³•å—åˆ°åˆå§‹ç‚¹å½±å“è¾ƒå¤§, å¯¼è‡´é™·å…¥å±€éƒ¨æœ€ä¼˜è§£;
> 3. å¯¹äºæé™çŠ¶æ€æ–¹ç¨‹çš„è¡¨è¾¾å¼æœ‰è§£æçš„è¦æ±‚ï¼Œ å¯¹äºéšå‡½æ•°è¡¨è¾¾çš„æé™çŠ¶æ€æ–¹ç¨‹ï¼Œ éš¾ä»¥æ±‚è§£å¯¼æ•°ã€‚ 
### (4) æ”¹è¿›FOSM å¯é æ€§çµæ•åº¦åˆ†ææ–¹æ³• 
æ”¹è¿›çš„ FOSM å¯é æ€§çµæ•åº¦åˆ†ææ–¹æ³•: <b><mark style="background: transparent; color: blue">åˆ©ç”¨åœ¨è®¾è®¡ç‚¹çš„å±•å¼€è¡¨è¾¾å¼</mark></b>: 
$$Y = g(x_{1}^{*}, x_{2}^{*}, \dots x_{n}^{*}) + \sum^{n}_{i=1} \left. \frac{\partial g}{\partial X_{i}}  \right|_{P^{*}} (X_{i} - x_{i}^{*})$$
å…¶ä¸­, $g(X)$ä¹Ÿå¯ä»¥ä½¿ç”¨ä¸‹å¼è¡¨è¾¾:
$$c_{0} = g(x_{1}^{*}, x_{2}^{*}, \dots x_{n}^{*}) - \sum^{n}_{i=1} \left. \frac{\partial g}{\partial X_{i}} \right|_{P^{*}} x_{i}^{*} \qquad g(X) = c_{0} + \sum^{n}_{i=1}c_{i} X_{i}\qquad c_{i} =  \left.  \frac{\partial g}{\partial X_{i}} \right|_{P^{*}}$$
æ˜¾ç„¶åœ¨**è®¾è®¡ç‚¹**$g (x_{1}^{*}, x_{2}^{*}, \dots x_{n}^{*}) = 0$, åˆ™æœ‰:
$$\beta = \frac{\mu_{g}}{\sigma_{g}} = \frac{\sum^{n}_{i=1} \left. \frac{\partial g}{\partial X_{i}}\right|_{P^{*}} (\mu_{Xi} - x_{i}^{*})}{\sqrt{\sum^{n}_{i=1} \left(\left. \frac{\partial g}{\partial X_{i}} \right|_{P^{*}} \right)^{2} \sigma _{Xi}^{2}}} = \frac{\sum^{n}_{i=1} c_{i} (\mu_{Xi} - x_{i})}{\sqrt{ \sum^{n}_{i=1}  c_{i}^{2} \sigma_{Xi}^{2}}} \tag{2. 4. 1}$$
è€ƒè™‘åˆ°çº¿æ€§æƒ…å†µä¸‹æœ‰$P_{f}  = \Phi(-\beta)$, å…¶ä¸­, æ˜¾ç„¶æœ‰<b><mark style="background: transparent; color: blue">åœ¨å˜é‡ç›¸äº’ç‹¬ç«‹çš„æƒ…å†µä¸‹</mark></b>ï¼Œ æ˜¾ç„¶ç”±äº$g(x_{i}^{*}) = 0$, åˆ™æœ‰:
$$\mu_{g} = c_{0} + \sum^{n}_{i=1}  c_{i} \mu_{Xi} \qquad  \sigma_{g} = \sum^{n}_{i=1} \left(\left. \frac{\partial g}{\partial X_{i}} \right|_{P^{*}} \right)^{2} \sigma _{Xi}^{2}$$
å¾—åˆ°<b><mark style="background: transparent; color: blue">è€ƒè™‘å˜é‡ç›¸å…³æƒ…å†µä¸‹çš„å¤±æ•ˆæ¦‚ç‡çµæ•åº¦ä¸º</mark></b>:
$$\begin{cases}
\frac{\partial P_{f}}{\partial \mu_{Xi}} = - \frac{c_{i}}{\sqrt{2 \pi }\sigma_{g}}\exp \left(- \frac{\mu_{g}^{2}}{2 \sigma_{g}^{2}}\right) \\
\frac{\partial P_{f}}{\partial \sigma_{Xi}} = \frac{\mu_{g}}{\sqrt{2\pi }\sigma_{g}^{3}}\left(c_{i}^{2} \sigma_{Xi}^{2} +\sum^{n}_{j=1, j \neq i}  c_{i}c_{j}\rho_{X_{i}, X_{j}} \sigma_{Xj}\right) \exp \left(- \frac{\mu_{g}^{2}}{2 \sigma_{g}^{2}}\right) \\
\frac{\partial P_{f}}{\partial \rho_{Xi,Xj}} = \frac{\mu_{g}}{2\sqrt{2\pi }\sigma_{g}^{3}} \left(c_{i}c_{j} \sigma_{Xi} \sigma_{Xj}\right) \exp\left(- \frac{\mu_{g}^{2}}{2 \sigma_{g}^{2}}\right)
\end{cases}$$
æ ¹æ®ä¸Šè¿°æ–¹æ³•æ±‚è§£å¯é åº¦æŒ‡æ ‡$\beta$ä¹‹å, å³å¯**é€šè¿‡ä¸Šå¼è·å–è¾“å…¥å˜é‡ç›¸å…³ä¸‹çš„å¯é æ€§çµæ•åº¦**ã€‚
> [!NOTE] è¯´æ˜
> å¯¹äºæ±‚è§£çš„ç²¾åº¦, ä¸€èˆ¬è€Œè¨€ï¼ŒåŠŸèƒ½å‡½æ•°éçº¿æ€§ç¨‹åº¦è¶Šå°ï¼Œ è·å¾—çš„è§£ç²¾åº¦è¶Šé«˜ã€‚è€Œå½“éçº¿æ€§ç¨‹åº¦å¤§æ—¶, è·å¾—çš„è§£å¯èƒ½é”™è¯¯ã€‚ 

ä¸Šé¢éƒ¨åˆ†å¯ä»¥ä½¿ç”¨å¦‚ä¸‹çš„ä»£ç è¿›è¡Œè¿­ä»£æ±‚è§£: 
```erlang
g_t_var = subs(g_t_, [s,p,d,t],[sigma_s_mu, P_mu, D_mu, t_mu]);
% ------- mu_g , sigma_g -------------------
mu_g = g(s,p,d,t);
sigma_g = sqrt(g_s_^2 * ss^2 + g_p_^2 * ps^2 + g_d_^2 * ds^2 + g_t_^2 * ts^2);
% use the formula for lambda 
lambda_s_ = -(diff(g(s,p,d,t), s) * sigma_s_sig)/sigma_g;
lambda_p_ = -(diff(g(s,p,d,t), p) * P_sig)/sigma_g;
lambda_d_ = -(diff(g(s,p,d,t), d) * D_sig)/sigma_g;
lambda_t_ = -(diff(g(s,p,d,t), t) * t_sig)/sigma_g;

mu_values = [sigma_s_mu, P_mu, D_mu, t_mu];
sigma_values = [sigma_s_sig, P_sig, D_sig, t_sig];

lambda_s_var = subs(lambda_s_,[s,p,d,t, ss,ps,ds,ts], ...
    [mu_values(1),mu_values(2), mu_values(3),mu_values(4), sigma_s_sig,P_sig, D_sig,t_sig]);
lambda_p_var = subs(lambda_p_,[s,p,d,t, ss,ps,ds,ts], ...
    [mu_values(1),mu_values(2), mu_values(3),mu_values(4), sigma_s_sig,P_sig, D_sig,t_sig]);
lambda_d_var = subs(lambda_d_,[s,p,d,t, ss,ps,ds,ts], ...
    [mu_values(1),mu_values(2), mu_values(3),mu_values(4), sigma_s_sig,P_sig, D_sig,t_sig]);
lambda_t_var = subs(lambda_t_,[s,p,d,t, ss,ps,ds,ts], ...
    [mu_values(1),mu_values(2), mu_values(3),mu_values(4), sigma_s_sig,P_sig, D_sig,t_sig]);
sprintf("lambda_init: %f, %f, %f, %f", lambda_s_var, lambda_p_var, lambda_d_var,lambda_t_var)
lambda_values = [lambda_s_var, lambda_p_var, lambda_d_var, lambda_t_var]; 

syms b_test
Xi = mu_values;  % åˆå§‹å€¼

beta_fst = 0;
for epoch = 1:1000
    if epoch == 1 
        beta_chk = beta_fst; % ä½¿ç”¨0ä½œä¸ºres1
    else
        beta_chk = beta_sec; % ä¸Šä¸€æ¬¡ç»“æœä½œä¸ºè¿­ä»£ç»“æœæ£€æŸ¥res1
        Xi = mu_values + sigma_values .* lambda_values * beta_sec;  % é‡æ–°è®¡ç®—è®¾è®¡ç‚¹
        % åˆ©ç”¨è®¾è®¡ç‚¹è·å–æ–°çš„lambdaå€¼
        lambda_s_var = subs(lambda_s_,[s,p,d,t, ss,ps,ds,ts], ...
            [Xi(1), Xi(2),Xi(3), Xi(4), sigma_s_sig,P_sig, D_sig,t_sig]);
        lambda_p_var = subs(lambda_p_,[s,p,d,t, ss,ps,ds,ts], ...
            [Xi(1), Xi(2),Xi(3), Xi(4), sigma_s_sig,P_sig, D_sig,t_sig]);
        lambda_d_var = subs(lambda_d_,[s,p,d,t, ss,ps,ds,ts], ...
            [Xi(1), Xi(2),Xi(3), Xi(4), sigma_s_sig,P_sig, D_sig,t_sig]);
        lambda_t_var = subs(lambda_t_,[s,p,d,t, ss,ps,ds,ts], ...
            [Xi(1), Xi(2),Xi(3), Xi(4), sigma_s_sig,P_sig, D_sig,t_sig]);
        lambda_values = [lambda_s_var, lambda_p_var, lambda_d_var, lambda_t_var]; % æ›´æ–°lambda_valueså€¼
    end
    % æ³¨æ„: ä¿ç•™6ä½æœ‰æ•ˆæ•°å­—, é¿å…ç²¾åº¦è¿‡é«˜å¯¼è‡´æ— æ³•è®¡ç®—
    x_res = vpa(mu_values + sigma_values  .* lambda_values * b_test, 6); % æ¯ä¸€æ¬¡éƒ½è¦é‡æ–°è®¡ç®— x_res
    beta_sec = vpa(min(solve(g(x_res(1), x_res(2), x_res(3), x_res(4)) == 0, b_test)), 6);
    sprintf("epoch: %d, res1: %f, res2 : %f",epoch, vpa(beta_chk,6), vpa(beta_sec,6))
    if (abs(beta_chk - beta_sec))<0.001
        break;
    end
end
sprintf("design point: %f, %f, %f, %f", Xi(1), Xi(2), Xi(3), Xi(4))
```

ç»“æœå¦‚ä¸‹:
```matlab
ans =     "epoch: 1, res1: 0.000000, res2 : 3.335089"
ans =     "epoch: 2, res1: 3.335089, res2 : 3.324230"
ans =     "epoch: 3, res1: 3.324230, res2 : 3.324148"
ans =     "design point: 320.634706, 25.238194, 462.437569, 18.199978"
```

### (5) å°è£…çš„æ”¹è¿›FOSMæµ‹è¯•å‡½æ•°
```matlab
function [x_i, beta_res, P_f] = AFOSM_solu(mu_,sigma_, g) fold
%AFOSM_SOLUTION AFOSMæ–¹æ³•, æ”¹è¿›ä¸€æ¬¡äºŒé˜¶çŸ©æ–¹æ³•æ±‚è§£å¯é åº¦ beta ä»¥åŠè®¾è®¡ç‚¹åæ ‡x_i
%   å¿…é¡»éƒ½æ˜¯æ­£æ€åˆ†å¸ƒçš„æŠ½æ ·, ä¸”æœ€å¥½æ˜¯çº¿æ€§çš„å¤±æ•ˆå‡½æ•°;
x_i = mu_;     % åˆå§‹åŒ–è¿­ä»£ç‚¹
sigma_d = sqrt(diag(sigma_))';

beta_pre = 0;   % å®é™…ä¸Šæ˜¯ä»¥å‡å€¼ä¸ºè®¾è®¡ç‚¹è®¡ç®—çš„betaå€¼

% é¦–å…ˆæ±‚è§£è®¾è®¡ç‚¹, ç”±äºæ˜¯çº¿æ€§å‡½æ•°, ä½¿ç”¨çš„æ˜¯AFOSMæ–¹æ³•æ±‚è§£å¯é åº¦
for epoch = 1:2000
    dg_dx = diff_function(g,x_i);
    lambda_ = - (dg_dx .* sigma_d)/ sqrt(sum(dg_dx.^2 .* sigma_d.^2));% æ±‚è§£å¯¹åº”çš„lambda
    G =  @(beta_) g(mu_ + sigma_d .* lambda_ .* beta_ );   % æ ¹æ® lambda æ±‚è§£ beta
    % åŸå˜é‡ç©ºé—´æ»¡è¶³ g(X1, X2, ... Xn) = 0;
    beta_temp = fzero(G, beta_pre);     % è®¡ç®—ä¸€ä¸ªæ–°çš„betaå€¼
    if abs(beta_temp - beta_pre) < 1e-4  % è¿­ä»£ç›´åˆ°beta_æ”¶æ•›
        break
    else
        beta_pre = beta_temp;
        x_i = mu_ + sigma_d .*  lambda_ .*beta_temp;
    end
end

beta_res = beta_temp;
P_f = normcdf(-beta_res);

if epoch == 2000
    warning("reach the maximum epoch, the result may be not correct");
end

end
```

åˆå§‹ç¨‹åºè®¡ç®—æ—¶ï¼Œ å¤±æ•ˆæ¦‚ç‡è®¡ç®—å­˜åœ¨é—®é¢˜, ç»è¿‡å¤šæ¬¡è°ƒè¯•ï¼Œ å‘ç°æ˜¯è®¡ç®—$\lambda_g$ï¼ˆ2.3.3åˆ†æ¯ï¼‰æ—¶å¿˜äº†å¼€æ–¹(4.1çš„å¹³æ–¹æ ¹é¡¹æ˜¯1, ä¸ä¼šå‡ºç°è¿™ç§é—®é¢˜)
```MATLAB
sqrt(sum(dg_dx.^2 .* sigma_d.^2))   // 12è¡Œ
```

## äºŒã€é’ˆå¯¹éæ­£æ€å˜é‡çš„Rackwitz-Fiessleræ–¹æ³•
### (1) åŸºæœ¬æ±‚è§£æ–¹æ³•
æ”¹è¿›çš„ä¸€æ¬¡äºŒé˜¶çŸ©æ–¹æ³•ä»…èƒ½å¤Ÿå¤„ç†æ­£æ€åˆ†å¸ƒçš„è¾“å…¥å˜é‡ï¼Œ è€Œé’ˆå¯¹éæ­£æ€åˆ†å¸ƒå˜é‡ï¼Œ å¯ä»¥ä½¿ç”¨R-Fæ–¹æ³•è¿›è¡Œè®¡ç®—; 
R-Fæ–¹æ³•çš„åŸºæœ¬åŸç†å’Œè®¡ç®—å…¬å¼å¦‚ä¸‹: 

é¦–å…ˆå¯¹äºä¸€ä¸ªæœä»æŸä¸€åˆ†å¸ƒçš„æ­£æ€éšæœºå˜é‡$X$, å¯†åº¦å‡½æ•°ä¸º$f_X(x)$, åˆ†å¸ƒå‡½æ•° $F(x)$, åˆ™éœ€è¦æ‰¾åˆ°éæ­£æ€å˜é‡$X$çš„ç­‰ä»·æ­£æ€å˜é‡$X'$ : 
$$X' \sim N (\mu'_{X} , \sigma_{X}^{'2} )$$
å‚è€ƒ[[ğŸ“˜ClassNotes/ğŸ“Mathmatics/ğŸ£Probability Theory/ç¬¬äºŒç«  éšæœºå˜é‡åŠå…¶åˆ†å¸ƒ|éšæœºå˜é‡åŠå…¶åˆ†å¸ƒ]], åˆ©ç”¨æ­£æ€å…¬å¼å¾—åˆ°**åœ¨ç‰¹å®šç‚¹$x'$å¤„çš„ç­‰ä»·å˜æ¢æ¡ä»¶**:
1. åˆ†å¸ƒå‡½æ•°
$$\boxed {F_{X} (x) = \Phi_{X'}(x') = \Phi \left( \frac{x' -  \mu'_{X}}{ \sigma_{X}'}\right)} \tag{2.2.1}$$
2. æ¦‚ç‡å¯†åº¦å‡½æ•°(ç›´æ¥å¯¹$\Phi$æ±‚å¯¼ä¹‹åä½¿ç”¨å¤åˆå‡½æ•°æ±‚å¯¼)
$$\boxed{f_{X}(x) = \Phi'_{X'}(x') = \frac{1}{\sigma'_{X}}\phi \left( \frac{x'  - \mu'_{X}}{\sigma_{X}'}\right)}$$
ä»è€Œå®¹æ˜“æ±‚è§£å‡ºå¯¹åº”çš„**ç­‰æ•ˆå‡å€¼å’Œæ–¹å·®**å¦‚ä¸‹:(å®é™…è®¡ç®—ä¸­å…ˆè®¡ç®—æ–¹å·®)
$$\Large\boxed {\mu_{X_{i}}' = x_{i}' - \sigma_{X_{i}}' \Phi^{-1} (F_{X_{i}} (x_{i}')) \qquad  \sigma_{X_{i}}' = \frac{\phi (\Phi^{-1} (F_{X_{i}} (x_{i}^{*})))}{f_{X_{i}}(x_{i}^{*})}}$$
**ä½¿ç”¨ç­‰ä»·æ­£æ€éšæœºå˜é‡$X_{i}'$è¿›è¡Œè®¡ç®—**, è€Œ**å¯¹åº”çš„å‡å€¼å’Œæ–¹å·®**$\mu'_{X_i}$å’Œ$\sigma'_{X_i}$å¯ä»¥**ä½¿ç”¨ä¸Šè¿°æ–¹æ³•è¿›è¡Œæ±‚è§£å‡º**;   
> [!NOTE] è¯´æ˜
> å¯¹äºä¸Šè¿°çš„è½¬æ¢æ–¹æ³•ï¼Œ åœ¨è½¬æ¢å‰åï¼Œ è¦æ±‚**ç­‰ä»·è½¬æ¢çš„æ­£æ€å˜é‡$X'$å’Œéæ­£æ€å˜é‡$X$åœ¨ç‰¹å¾ç‚¹$x^*$å¤„çš„æ¦‚ç‡å¯†åº¦å‡½æ•°å€¼ä¸åˆ†å¸ƒå‡½æ•°å€¼å‡ç›¸ç­‰**ã€‚

![[Excalidraw/ç¬¬äºŒç«  å¯é æ€§çµæ•åº¦åˆ†æçš„çŸ©æ–¹æ³• 2024-02-26 12.21.24|600]]
æ­¤æ—¶ï¼Œ æˆ‘ä»¬å°†$g(x_{1}^{*}, x_{2}^{*}, \dots x_{n}^{*}) = 0$ä»£å…¥ä¸Šå¼, å³$\sum^{n}_{i=1} a_{i} x_{i} = 0$; æ­¤æ—¶å¾—åˆ°: 
$$\left. \frac{\partial g}{\partial X_{i}} \right|_{P^{*}} (x_{i}'  - x_{i}^{'*}) = 0$$
åŒæ—¶ï¼Œ æˆ‘ä»¬å–$Z$ åæ ‡ä¸º:
$$Z_{i} =  \frac{x_{i}' - \mu_{i}'}{\sigma_{Xi}'}$$
ä»£å…¥ä¹‹å, æ­¤æ—¶åœ¨**æ–°çš„$Z$åæ ‡ä¸‹, æé™çŠ¶æ€æ–¹ç¨‹**ä¸º: 
$$\sum^{n}_{i=1} \left. \frac{\partial g}{\partial X_{i}'} \right|_{P^{*}} \left(Z_{i} \sigma_{X_{i}}' + \mu_{X_{i}}'\right) - \sum^{n}_{i=1} \left. \frac{\partial g}{\partial X_{i}} \right|_{P^{*}} x_{i}^{'*} = 0$$
åŒç†å¯ä»¥è·å¾—ç±»ä¼¼çš„æ³•çº¿æ–¹ç¨‹, å…¶ä¸­$Z_{i}$çš„ç³»æ•°ä¸º: 
$$\lambda_{i}  =-  \frac{\sum^{n}_{i=1} \left. \frac{\partial g}{\partial X_{i}'} \right|_{P^{*}} \sigma_{X_{i}}' }{ \sqrt{ \sum^{n}_{i=1}\left(\left.\frac{\partial g}{\partial X_{i}'} \right|_{P^{*}} \right)^{2} \sigma_{X_{i}}^{2}}} = \cos \theta$$
å…¶ä¸­æ˜¾ç„¶æœ‰: $\sum^{n}_{i=1} \lambda_{i}^{2} = 1$, å³æœ‰æ ‡å‡†åŒ–ç‰¹æ€§; 
**å¯é åº¦æŒ‡æ ‡**$\beta$å®šä¹‰ä¸ºå³ä¾§çš„éƒ¨åˆ†:
$$\beta =  \frac{\sum^{n}_{i=1} \left. \frac{\partial g}{\partial X_{i}'} \right|_{P^{*}}  (\mu'_{X_{i}} - x_{i}') }{ \sqrt{ \sum^{n}_{i=1}\left(\frac{\partial g}{\partial X_{i}'} |_{P^{*}} \right)^{2} \sigma_{X_{i}}^{2}}}$$
å¾—åˆ°çš„å¯é åº¦æ³•çº¿æ–¹ç¨‹ä¸º:
$$\Large\boxed{\beta  = \lambda_{i} Z_{i}}$$
ç”±äº$\lambda_i Z_i + \beta = 0$å˜å›åŸæ¥åæ ‡ç³»ä¸‹ä¹‹åï¼Œé€šè¿‡[[ğŸ“˜ClassNotes/ğŸ‘¨â€ğŸ”§Mechanics/ğŸ–¥ï¸Computational_Mechanics/âœˆï¸èˆªç©ºå‘åŠ¨æœºå¯é æ€§åˆ†æ/æ¨å¯¼éƒ¨åˆ†/æ­£æ€ç©ºé—´ä¸‹çš„æ ·æœ¬ç‚¹æ¨å¯¼.pdf|æ­£æ€ç©ºé—´ä¸‹çš„æ ·æœ¬ç‚¹æ¨å¯¼.pdf]], å¯ä»¥å¾—åˆ°è®¾è®¡ç‚¹ä¸º$z_i^* = \lambda_i \beta$; 
$$\boxed {x_{i}^{'*} =\mu_{X_{i}}' + \sigma'_{X_{i}} z_{i}^{*} = \mu'_{X_{i}} + \sigma'_{X_{i}} \beta \cdot \lambda_{i}}\qquad  (\star)$$
æ˜¾ç„¶è®¾è®¡ç‚¹Xè½åœ¨æé™çŠ¶æ€æ–¹ç¨‹ä¸Šï¼Œ å› æ­¤æœ‰:
$$g(x_{1}^{*}, x_{2}^{*}\dots x_{n}^{*}) = 0$$
éœ€è¦è¯´æ˜çš„æ˜¯ï¼Œ å®é™…æ±‚è§£è¿‡ç¨‹ä¸­ï¼Œç¬¬ä¸€æ¬¡æ±‚è§£**å¾€å¾€ä½¿ç”¨å‡å€¼ä½œä¸ºxiçš„åˆå§‹å€¼**(è¿™æ˜¯ç”±äºæˆ‘ä»¬ä¸çŸ¥é“å˜æ¢å…¬å¼ä¸­çš„xi'), è€Œæ±‚å‡º$\beta$ä¹‹åï¼Œè¿˜éœ€è¦è¿›è¡Œè¿­ä»£ç›´åˆ°å‰åä¸¤æ¬¡çš„å·®å¼‚æ»¡è¶³ç²¾åº¦è¦æ±‚; **å…·ä½“è¿­ä»£å…¬å¼å¯ä»¥ä½¿ç”¨$(\star)$å¼ä»£å…¥$g = 0$è¿›è¡Œè·å–**; 

```matlab title:å¯ä»¥ä½¿ç”¨å¦‚ä¸‹çš„å…³é”®ä»£ç è·å–å‡å€¼å’Œæ ‡å‡†å·®
mu_fixed = zeros(1,2); sigma_fixed =  zeros(1,2);

sigma_fixed(1) = normpdf(norminv(unifcdf(x_i(1), 0, 100)), 0, 1)/unifpdf(x_i(1), 0, 100);  % calculate the sigma first
sigma_fixed(2) = normpdf(norminv( expcdf(x_i(2),   12.5)), 0, 1)/exppdf (x_i(2), 12.5);

mu_fixed(1) = x_i(1) - sigma_fixed(1) * norminv(unifcdf(x_i(1),0,100));
mu_fixed(2) = x_i(2) - sigma_fixed(2) * norminv(expcdf(x_i(2), 12.5));
```

å…¶ä¸­éš¾ç‚¹æ˜¯å¦‚ä½•è¿›è¡Œè¿­ä»£: æ¯ä¸€æ¬¡ï¼Œç”±äºå¯¹äº**åœ¨æ³•çº¿ä¸Šæ—¶**ï¼Œåº”å½“æ»¡è¶³$\beta = \lambda_{i} Z_{i}$ æ–¹ç¨‹, è€Œæˆ‘ä»¬æ¯ä¸€æ¬¡è¿­ä»£å…ˆè§£å‡º$\lambda_i$, æ ¹æ® = 0è§£å‡º$\beta$, ç„¶åé€šè¿‡$\beta$, ä»£å…¥$x_{i}^{'*} =\mu_{X_{i}}' + \sigma'_{X_{i}} Z_{i} = \mu'_{X_{i}} + \sigma'_{X_{i}} \frac{ \beta}{ \lambda_{i}}$ å…¬å¼, ä»è€Œå¯ä»¥å¾—åˆ°ä¸‹ä¸€æ¬¡çš„$x_i$çš„å€¼; 

## ä¸‰ã€è®¡ç®—åŠŸèƒ½å‡½æ•°çŸ©çš„ç‚¹ä¼°è®¡æ³•
### (1) åŠŸèƒ½å‡½æ•°çš„å®šä¹‰
å‚è€ƒ [[ğŸ“˜ClassNotes/ğŸ“Mathmatics/ğŸ£Probability Theory/ç¬¬å››ç«  éšæœºå˜é‡çš„æ•°å­—ç‰¹å¾#å››ã€çŸ©å’Œåæ–¹å·®çŸ©é˜µ|çŸ©å’Œåæ–¹å·®çŸ©é˜µ]], æˆ‘ä»¬è€ƒè™‘è¾“å…¥å˜é‡$X = (X_{1}, X_{2}, \dots , X_{n})^{T}$, ä¸”å…¶è”åˆæ¦‚ç‡å¯†åº¦å‡½æ•°ä¸º$f_{X}(x)$, æ­¤æ—¶, å…¶<mark style="background: transparent; color: red">ç»“æ„å“åº”çš„åŠŸèƒ½å‡½æ•°</mark>ä¸º $Y = g(X)$. å…¶æ¦‚ç‡çŸ©å¯ä»¥è®¡ç®—ä¸º: 
$$\boxed{\mu_{g} = \int g(x) f_{X}(x) dx\qquad \sigma_{g}^{2} = \int [g(x) - \mu_{g}]^{2}f_{X}(x)dx}\tag{2.3.0}$$
æˆ‘ä»¬å°†å“åº”çš„çŸ©æ¨å¹¿åˆ°$k$é˜¶çŸ©ï¼Œ åˆ™ç»“æ„å“åº”çš„ $k$ é˜¶<mark style="background: transparent; color: red">æ— é‡çº²ä¸­å¿ƒçŸ©</mark>$\alpha_{kg}$ ä¸º:
$$\alpha_{kg} = \int \left[\frac{g(x) - \mu_{g}}{\sigma_{g} }\right]^{k} f_{X}(x) dx$$
å…¶ä¸­, 1é˜¶ä¸ºå‡å€¼, 2é˜¶ä¸ºæ–¹å·®, å› è€Œå¯ä»¥åˆ†åˆ«è®°ä¸º$\alpha_{k1}, \alpha_{k2}$; å¯¹åº”åœ°, $\alpha_{3g}, \alpha_{4g}$åˆ†åˆ«ä¸ºåŠŸèƒ½å‡½æ•°çš„<mark style="background: transparent; color: red">ååº¦å’Œå³°åº¦</mark>;

ä¾‹å¦‚ï¼Œ **ååº¦å’Œå³°åº¦çš„å®šä¹‰**ä¸º: 
$$S = \frac{1}{n} \sum^{n}_{i=1}\left(\frac{X_{i} - \mu }{\sigma} \right)^{3} \qquad  K = \frac{1}{n} \sum^{n}_{i=1}\left(\frac{X_{i} - \mu }{\sigma} \right)^{4} $$
### (2) Rosenblueth æ–¹æ³• 
å¯¹äº Rosenblueth æ–¹æ³•ï¼Œå…¶æ ¸å¿ƒå’ŒåŸºæœ¬æ€æƒ³æ˜¯**è€ƒè™‘éšæœºå˜é‡åŒ…å«ä¸ç¡®å®šå› ç´ çš„æƒ…å†µä¸‹**ï¼Œ åˆ©ç”¨<mark style="background: transparent; color: red">åŠŸèƒ½å‡½æ•°çš„ç¦»æ•£åŠ æƒä¼°è®¡å€¼</mark>æ¥è®¡ç®—åŠŸèƒ½å‡½æ•°çš„å‰ä¸‰é˜¶ç»Ÿè®¡çŸ©;
æˆ‘ä»¬è®¾$x_+, x_{-}$æ˜¯éšæœºå˜é‡çš„ä¸¤ä¸ªå®ç°å€¼ï¼Œ è€Œå¯¹åº”çš„$p_{+}, p_{-}$æ˜¯**ç¦»æ•£æ¦‚ç‡å¯†åº¦åœ¨$x_+, x_-$ç‚¹å¤„çš„å€¼,  å¹¶ä¸”ç§°ä¹‹ä¸ºæƒå€¼**; 

| X   | +     | -     |
| --- | ----- | ----- |
| p   | $p_+$ | $p_-$ |
å¯¹åº”åœ°ï¼Œ æˆ‘ä»¬<b><mark style="background: transparent; color: blue">å–å˜é‡çš„æ­£åˆ™åŒ–éšæœºå˜é‡ä¸º</mark></b> 
$$U = \frac{X - \mu_{X}}{\sigma_{X}}$$
ä¸”å…¶å¯¹åº”çš„ä¸¤ä¸ªå€¼åˆ†åˆ«ä¸º$u^+, u^-$; ä¸ºæ­£åˆ™åŒ–éšæœºå˜é‡ç©ºé—´$U$ä¸­ä¸¤ä¸ªå®ç°å€¼, æ˜¾ç„¶$u_-, u_+$å¯ä»¥è®¡ç®—ä¸º: 
$$u_{-} = \frac{x_{-}- \mu_{X}}{\sigma_{X}} \qquad u_{+} = \frac{x_{+} - \mu_{X}}{\sigma_{X}}$$
#### 1. å•å˜é‡å‡½æ•°
é¦–å…ˆå¯¹äº**å•å˜é‡å‡½æ•°**, ç»å…¸çš„Rosenbluethæ–¹æ³•<mark style="background: transparent; color: red">ä½¿ç”¨ä¸¤ç‚¹ç¦»æ•£åˆ†å¸ƒçš„ç»Ÿè®¡çŸ©æ–¹æ³•æ¥é€¼è¿‘è¿ç»­éšæœºå˜é‡çš„ç»Ÿè®¡çŸ©</mark>;é’ˆå¯¹$x_{+}, x_{-},  p_{-}, p^{+}$åŒæ—¶æ»¡è¶³ä¸‹é¢çš„å››ä¸ªæ–¹ç¨‹æ—¶ï¼Œ é‡‡ç”¨ä¸¤ç‚¹åˆ†å¸ƒå¯ä»¥ç²¾ç¡®é€¼è¿‘è¿ç»­åˆ†å¸ƒçš„å‰ä¸‰é˜¶ç»Ÿè®¡çŸ©; 
$$p_{+} + p_{-} = 1$$
$$p_{+} u_{+} + p_{-}  u_{-} = \mu_{U}$$
$$p_{+} u_{+}^{2}  + p_{-}u_{-}^{2} =  \sigma_{U}^{2}$$
$$p_{+} u_{+}^{3}  + p_{-} u_{-}^{3} = \gamma_{U}$$
å…¶ä¸­ $\gamma_{U}$ ä¸ºæ­£åˆ™åŒ–éšæœºå˜é‡çš„**ååº¦**, å››ä¸ªæœªçŸ¥é‡çš„è§£å¦‚ä¸‹: 
$$p_{+} = \frac{u_{-}}{u_{+} + u_{-}}\qquad  p_{-} = 1 - p_{+}$$
$$u_{+} = \frac{\gamma_{U}}{2} + \sqrt{1 + \left(\frac{\gamma_{U}}{2}\right)^{2}}\qquad  u_{-}  =  \frac{\gamma_{U}}{2} - \sqrt{1 + \left(\frac{\gamma_{U}}{2}\right)^{2}}$$
æ­¤æ—¶ï¼Œ å‰ä¸‰é˜¶åŸç‚¹çŸ© $E[Y^k]$ å¯ç”±ä¸‹å¼è¿›è¡Œè®¡ç®—: 
$$E[Y^{k}] \approx  p_{+} g(x_{+})^{k} + p_{-}  g(x_{-})^{k}\qquad  k = 1,2,3$$
#### 2. å¤šå˜é‡å‡½æ•°
æ ¹æ®Rosenbluethæ–¹æ³•ï¼Œ **æ ¹æ®è¾“å…¥éšæœºå˜é‡**ä½¿ç”¨$X_i$çš„**ç¦»æ•£åˆ†å¸ƒ**æ¥ä¼°è®¡ç»“æ„å“åº”éšæœºå˜é‡$Y = g(X_1, X_2, \dots X_n)$çš„åŸç‚¹çŸ©;

è€ƒè™‘å¯¹äº$n$ä¸ªéšæœºå˜é‡çš„é—®é¢˜, Rosenblueth æ–¹æ³•æ˜¯æ ¹æ®éšæœºå˜é‡$X_i$çš„ç¦»æ•£åˆ†å¸ƒ$(x_{i\pm}, p_{i\pm})$éƒ¨åˆ†æ¥ä¼°è®¡ç»“æ„å“åº”éšæœºå˜é‡$Y = g(X_1, X_2, \dots X_n)$, å¹¶å¯ä»¥ä½¿ç”¨å¦‚ä¸‹å…¬å¼è¿›è¡Œè®¡ç®—:
$$E[Y^{k}] \approx  \sum^{-}_{a_{1}=+} \sum^{-}_{a_{2}=+} \dots  \sum^{-}_{a_{n}=+} p_{1a_{1}}p_{2a_{2}}\dots p_{na_{n}}(g(x_{1a_{1}}, x_{2a_{2}}, \dots x_{na_{n}}))$$
å…¶ä¸­ï¼Œå¯¹äºæ¯ä¸€ä¸ªéšæœºå˜é‡$x_{i}$,å¯¹äº†ä¸¤ä¸ªå®ç°å€¼$x_{i+}, x_{i-}$, ä»è€Œå¯¹äº2nä¸ªéšæœºå˜é‡ä¹Ÿä¼šäº§ç”Ÿ2nä¸ªå–å€¼ç‚¹; æ˜¾ç„¶ç»„åˆçŠ¶æ€æœ‰$2^{n}$ä¸ª;
ä½¿ç”¨å¦‚ä¸‹çš„$Y'$é€¼è¿‘åŸå§‹å‡½æ•°çš„$Y$: 
$$Y = Y' = g'(X) = g(\mu_{X}) \prod_{i=1}^{n} \left(\frac{g_{i}}{g(\mu_{X})}\right) \tag{2.3.1}$$
å…¶ä¸­$g(\mu_{X})$ä¸º**å–å‡å€¼æ—¶çš„å“åº”**; è€Œ$g_{i}$ä¸º**é™¤ç¬¬ $i$ ä¸ªéšæœºå˜é‡$X_i$ä»¥å¤–, å…¶ä»–éšæœºå˜é‡å–å‡å€¼æ—¶çš„åŠŸèƒ½å‡½æ•°**; 
å³æœ‰$g(X_{i})= g(\mu_{X_{1}}, \mu_{X_{2}}, \dots, X_{i}, \dots \mu_{X_{n}})$; æ­¤æ—¶, $g_{i}$æ˜¯å•å˜é‡å‡½æ•°, è€Œè®¡ç®—åŠŸèƒ½å‡½æ•°åŸç‚¹çŸ©æ—¶, å¯¹æ¯ä¸€ä¸ª$g_i$åªéœ€è¦å–ä¸¤ç‚¹$x_{i+}, x_{i-}$è¿›è¡Œè®¡ç®—,  æ­¤æ—¶è®¡ç®—é‡å˜ä¸º 2n+1(1æ˜¯å…¨å–å‡å€¼çš„æƒ…å†µ); 

ç»“æ„å“åº”çš„åŸç‚¹çŸ©å…¬å¼å¯ä»¥å¦‚ä¸‹è¿›è¡Œæ±‚è§£:
$$E[Y^{k}] = \frac{1}{(g^{n-1}  (\mu_{X}))^{k}}\prod_{i=1}^{n} (p_{i+} g_{i+}^{k}+p_{i-} g_{i-}^{k})$$
å…¶ä¸­, $g_{i+} =  g(\mu_{X_{1}}, \mu_{X_{2}}, \dots, x_{i+}, \dots \mu_{X_{n}}), g_{i-} =  g(\mu_{X_{1}}, \mu_{X_{2}}, \dots, x_{i-}, \dots \mu_{X_{n}})$, è€Œ$p_{i+}, p_{i-}$æ˜¯å¯¹åº”çš„ä¼°è®¡ç‚¹çš„æƒå€¼;
### (3) Gorman å’Œ Seo çš„ä¸‰ç‚¹ä¼°è®¡æ–¹æ³•
#### 1. å•å˜é‡æƒ…å†µ
é€šè¿‡**ä¸‰ç‚¹ç¦»æ•£åˆ†å¸ƒç»Ÿè®¡çŸ©æ¥æ‹Ÿåˆå’Œæè¿°è¿ç»­åˆ†å¸ƒçš„ç»Ÿè®¡çŸ©**; 
å•å˜é‡å‡½æ•°ä¸­, å½“å‡½æ•°ä»…æœ‰ä¸€ä¸ªéšæœºå˜é‡$X$æ—¶, æœ‰ Y = g(X), å…¶ä¸­$Y$ çš„å‡å€¼ $\alpha_{1g}$, æ ‡å‡†å·®ä¸º$\alpha_{2g}$, ååº¦ä¸º$\alpha_{3g}$, å³°åº¦ $\alpha_{4g}$; æˆ‘ä»¬ä»…ç»™å‡ºå‰ä¸‰ä¸ªè®¡ç®—å…¬å¼, ç¬¬å››ä¸ªç”±å®šä¹‰å’Œç¬¬ä¸‰ä¸ªæ¨å¹¿è·å–
$$\begin{cases}
\alpha_{1g}  =  P_{X,1} g (l_{X,1}) + P_{X,2} g(l_{X,2}) + P_{X,3} \\
\alpha_{2g} = [P_{X,1} (g(l_{X,1})- \alpha_{1g})^{2} + P_{X,2}(g(l_{X,2}) - \alpha_{1g})^{3} + P_{X,3} (g(l _{X,3}) - \alpha_{1g})^{2}]^{\frac{1}{2}} \\
\alpha_{3g} = \frac{1}{\alpha_{2g}^{3}}[P_{X,1} (g(l_{X,1}) - \alpha_{1g})^{3}  + P_{X,2}(g(l_{X,2}) -  \alpha_{2g})^{3} +P_{X,3}(g(l _{X,3}) - \alpha_{1g})^{3}]
\end{cases}$$
ä¸Šå¼ä¸­,  $l_{X,i}$æ˜¯**è¾“å…¥å˜é‡ $X$ çš„ç¦»æ•£åˆ†å¸ƒçš„ä¸‰ç‚¹; $P_{X,i}$æ˜¯ä¸‰ç‚¹å¯¹åº”çš„æƒå€¼**; å¹¶æœ‰å¦‚ä¸‹çš„è®¡ç®—å…¬å¼
$$\large \boxed{\begin{cases}
P_{X, 1} = \frac{1}{2} \left(\frac{1 + \alpha_{3X} /\sqrt{4 \alpha_{4X} - 3 \alpha_{3X}^{2}}}{\alpha_{4X} - \alpha_{3X}^{2}} \right)  \\
P_{X,2} = 1 - \frac{1}{\alpha_{4X} - \alpha_{3X}^{2}}  \\
P_{X,3} = \frac{1}{2} \left( \frac{1- \alpha_{3X}/\sqrt{4\alpha_{4X}- 3\alpha_{3X}^{2}}}{\alpha_{4X} - \alpha_{3X}^{2} }\right)   \\
l_{X,1} = \alpha_{1X} - \frac{\alpha_{2X}}{2} (\sqrt{4\alpha_{4X} - 3 \alpha_{3X}^{2}} - \alpha_{3X})  \\
l_{X,2} = \alpha_{1X} \\
l_{X,3} = \alpha_{1X} +\frac{\alpha_{2X}}{2} (\sqrt{4\alpha_{4X} - 3 \alpha_{3X}^{2}} + \alpha_{3X})
\end{cases}}$$
> [!NOTE] è¯´æ˜
> å¯¹äºå¤šå˜é‡å‡½æ•°,  è®¡ç®—é‡å’Œç»´åº¦nå‘ˆæŒ‡æ•°å…³ç³», å¾€å¾€ä¸é€‚ç”¨äºé«˜ç»´å˜é‡çš„æƒ…å†µ; 
#### 2.  å¤šå˜é‡æƒ…å†µ
å¤šå˜é‡çš„è§£å†³æ–¹æ¡ˆæ˜¯
$$\alpha_{1g}= \sum^{3}_{i_{1}=1}P_{X_{1} i_{1}}  \sum^{3}_{i_{2}=1} P_{X_{2} i_{2}} \dots \sum^{3}_{i_{n}=1}  P_{X_{n} i_{n}} g(l_{X_{1},i_{1}} , l_{X_{2},i_{2}}, \dots l_{X_{n},i_{n}})$$
### (4) Zhouå’ŒNowakæ–¹æ³• 
#### 1. å•ä¸ªå˜é‡æƒ…å†µ
é’ˆå¯¹**å•ä¸ªæ ‡å‡†æ­£æ€éšæœºå˜é‡**Xçš„å‡½æ•°$Y  = g(X)$ , X çš„æ¦‚ç‡å¯†åº¦å‡½æ•°ä¸º$f_X (x)$, ä¸º: 
$$f_{X}(x) = \phi(x) = \frac{1}{\sqrt{2\pi}} \exp \left(- \frac{1}{2} x^{2}\right)$$
æ­¤æ—¶ï¼Œ å–$X = \sqrt{2} u$, ä»£å…¥å¾—åˆ°:
$$E[g^{k}(X)] = \int_{-\infty}^{+\infty} g^{k}(x) f_{X}(x) dx = \int_{-\infty}^{+\infty} g^{k}(\sqrt{2}u) \frac{1}{\sqrt{\pi}} \exp \left(- u^{2} \right)du$$
å› æ­¤, å¯ä»¥ä½¿ç”¨ Gauss-Hermite ç§¯åˆ†è®¡ç®—$E(g^{k}(X)]$çš„å€¼: 
$$\boxed{\frac{1}{\sqrt{\pi }}\int_{-\infty}^{+\infty}\exp (-u^{2}g^{k}(\sqrt{2} u)) \approxeq \frac{1}{\sqrt{\pi}} \sum^{m}_{i=1} w_{i}g^{k}(\sqrt{2} u_{i})}\tag{2.3.2}$$
å…¶ä¸­, **ç§¯åˆ†ç‚¹$u_i$æ˜¯$(-\infty, +\infty)$ä¸Šçš„å¸¦æƒçš„$e^{-u^{2}}$ çš„æ­£äº¤m + 1æ¬¡Hermiteå¤šé¡¹å¼** 
$$H_{m+1} (u) = (-1)^{m+1} e^{x^{2}} \frac{d^{m+1} (e^{-x^{2}})}{dx^{m+1}}$$
**çš„é›¶ç‚¹**; è€Œç§¯åˆ†ç‚¹çš„æƒç³»æ•°$w_{i}$å¯ä»¥è®¡ç®—ä¸º(mä¸ºç§¯åˆ†èŠ‚ç‚¹æ•°): 
$$w_{i} = \frac{2^{m+2}  (m+1)! \sqrt{\pi}}{[H'_{m+1} (u_{i})]^{2}}$$
åŒæ ·åœ°ï¼Œ å¯¹äºéæ­£æ€éšæœºå˜é‡$X$, ä¹Ÿå¯ä»¥åšå¦‚ä¸‹è½¬æ¢:
$$x = F_{X}^{-1} (\Phi(z))\qquad  z = \sqrt{2} u_{i}$$
#### 2. å¤šå˜é‡æƒ…å†µ
å¯¹äºå¤šç»´çš„ç‹¬ç«‹æ­£æ€å˜é‡æƒ…å†µ, å½“è¾“å…¥éšæœºå‘é‡**ç”±ç›¸äº’ç‹¬ç«‹çš„æ ‡å‡†æ­£æ€å˜é‡æ„æˆ**æ—¶, å…¶è”åˆæ¦‚ç‡å¯†åº¦å‡½æ•°ä¸º $f_X(x_1, x_2, \dots x_n)$, åˆ™å¯ä»¥è®¡ç®—ä¸º:
$$f(x_{1}, x_{2}, \dots x_{n}) =  \phi_{X1}(x_{1}) \phi_{X2}(x_{2})\dots \phi_{Xn}(x_{n})$$
å…¶ä¸­$\phi_{X_{i}} (x_{i})$ä¸ºæ ‡å‡†æ­£æ€å˜é‡$X_i$çš„æ¦‚ç‡å¯†åº¦å‡½æ•°; ä¸Šå¼ä»£å…¥**åŠŸèƒ½å‡½æ•°$k$é˜¶åŸç‚¹çŸ©çš„è®¡ç®—å…¬å¼**å¾—åˆ°:
$$E[g^{k}(X] =  \int_{-\infty}^{+\infty}\dots \int_{-\infty}^{+\infty} \phi_{X1} \phi_{X2} \dots \phi_{Xn} \space  g^{k}(x_{1}, x_{2}, \dots, x_{n} )  dx_{1}dx_{2}\dots dx_{n} \tag{2.3.3}$$
æ–¹æ³•ä¸€æ˜¯é‡‡ç”¨[[#(2) Rosenblueth æ–¹æ³•]](2.3.1)é€¼è¿‘, ä½¿ç”¨$Y'$ä»£æ›¿$Y$, å¾—åˆ° Y çš„$k$ é˜¶è¿‘ä¼¼è¡¨è¾¾å¼å¦‚ä¸‹:
$$E[g^{k}(X)] \approx  E\left[\left( g(\mu_{X})\prod_{i=1}^{n} \left( \frac{g_{i}}{g(\mu_{X})} \right)\right)^{k} \right] = \frac{1}{[g^{n-1}(\mu_{X})]^{k}} \prod_{i=1}^{n}  E[g_{i}^{k}]$$
è€Œ $E[g_i^k]$ ä¸ºå•å˜é‡ $X_i$ å‡½æ•°çš„åŸç‚¹çŸ©, åŒæ—¶, å¯ä»¥**é‡‡ç”¨ Gauss-Hermite ç§¯åˆ†å…¬å¼, è®¡ç®—ä¸Šå¼ç§¯åˆ†**, æ ¹æ®2.3.3, ç»“æœä¸º: 
$$E[g^{k}(X)] \approx \frac{1}{\left( \sqrt{\pi} g^{n-1} (\mu_{X})\right)^{k}} \prod_{i=1}^{n} \left(\sum^{m_{i}}_{j=1}  w_{ij} g_{i}^{k}(X_{ij}) \right)$$

æ–¹æ³•äºŒæ˜¯æ”¹å†™è”åˆå¯†åº¦å‡½æ•°: 
$$f_{X} (x_{1,}x_{2}, \dots ) = \frac{1}{\sqrt{(2\pi)^{n}}} \exp \left(- \frac{1}{2} x_{1}^{2} - \frac{1}{2} x_{2}^{2}- \dots  - \frac{1}{2} x_{n}^{2} \right)$$
æ­¤æ—¶ï¼Œ æˆ‘ä»¬å¯ä»¥å–$X_{i} = \sqrt{2}u$, å¹¶ä»£å…¥åŠŸèƒ½å‡½æ•°Yçš„ké˜¶çŸ©ç§¯åˆ†è¡¨è¾¾å¼, åˆ™æœ‰:
$$E[g^{k}(X) ]= \int_{-\infty}^{+\infty} g^{k}(x) f_{X}(x) dx = \frac{1}{\sqrt{\pi^{n}}}\int_{-\infty}^{+\infty} \dots\int_{-\infty}^{+\infty } \exp (- u_{1}^{2} - \dots  - u_{n}^{2}) g^{k}(\sqrt{2}u_{1}, \dots \sqrt{2} u_{n}) du_{1}\dots du_{n}$$
æ­¤æ—¶æˆ‘ä»¬ä»ç„¶å¯ä»¥ä½¿ç”¨ Gauss-Hermite å…¬å¼è¿›è¡Œä¼°è®¡ï¼Œ å› æ­¤æœ‰: 
$$E[g^{k}(X)] =  \frac{1}{\sqrt{\pi^{n}}} \sum^{m}_{j=0}w_{j} g^{k} ( \sqrt{2} u_{1j } , \sqrt{2} u_{2j},   \dots\sqrt{2} u_{nj})$$
#### 3. éæ­£æ€å¤šç»´å˜é‡çš„æƒ…å†µ
æˆ‘ä»¬è€ƒè™‘éšæœºå‘é‡ $X = (X_1, X_2, \dots  X_n)^T$ å…·æœ‰è”åˆåˆ†å¸ƒå‡½æ•°$F_{X}(x_{1}, x_{2}, \dots  x_{n})$,  åˆ™è”åˆåˆ†å¸ƒå‡½æ•°å®é™…ä¸Šæ˜¯ä¸€ç³»åˆ—<b><mark style="background: transparent; color: blue">æ¡ä»¶åˆ†å¸ƒå‡½æ•°çš„ä¹˜ç§¯å½¢å¼</mark></b>: 
$$F_{X}(x_{1}, x_{2}, \dots x_{n}) = F_{X1} (x_{1}) F_{X_{2}|X_{1}} (x_{2})\dots F_{X_{n} | X_{1} \dots  X_{n-1}} (x_{n})$$
å› æ­¤, å°†æ¡ä»¶åˆ†å¸ƒå‡½æ•°å½¢å¼ä»£å…¥, æœ‰å˜æ¢çš„ ä¸€èˆ¬å½¢å¼ä¸º:
$$X_{n} =  F_{X_{n}| X_{1}\dots X_{n-1}}[\Phi(u_{n})]$$

#### 4. Zhao  å’Œ Ono çš„ç‚¹ä¼°è®¡æ–¹æ³•
é’ˆå¯¹äºå¤šå˜é‡å½¢å¼, æ­¤ç§ç‚¹ä¼°è®¡æ–¹æ³•é‡‡ç”¨äº†ç²¾åº¦æ›´é«˜çš„é€¼è¿‘å½¢å¼, åœ¨è¿™ç§ç‚¹ä¼°è®¡æ³•ä¸‹ï¼Œ**ä¸­å¿ƒçŸ©**$\alpha_{kg }$å¯ä»¥ç»™å‡ºä¸º:
$$\begin{cases}
\mu_{g} = \sum^{m}_{l=1}  P_{l} \times  g (T^{-1} (u_{l}))  \\
\sigma_{g}  = \sum^{m}_{l=1}  P_{l} \times  (g(T^{-1}(u_{l})) - \mu_{g})^{2}  \\
\alpha_{kg} \sigma_{g}^{k}=  \sum^{m}_{l=1} P_{l} \times (g(T^{-1}(u_{l})) - \mu_{g})^{k} \quad  k > 2
\end{cases}$$
å…¶ä¸­mä¸ºç”¨äºè¿‘ä¼¼è®¡ç®—åŠŸèƒ½å‡½æ•°å„é˜¶çŸ©çš„èŠ‚ç‚¹çš„ä¸ªæ•°,  å…¶ä¸­å¾€å¾€å–m=7, å…¶ä¸­7ä¸ªç‚¹å¤„çš„å‚æ•°u, På¯ä»¥å‚è€ƒè¯¾æœ¬; è€Œ$T$ä¸ºä»»æ„è¾“å…¥å˜é‡$X$æ ‡å‡†æ­£æ€åŒ–å˜æ¢å‡½æ•°çš„åå‡½æ•°; å¹¶ä¸”æœ‰:
$$x_{l} = T^{-1} (u_{l})$$
ä¾‹å¦‚, å½“ä¸ºéæ ‡å‡†æ­£æ€éšæœºå˜é‡æ—¶ï¼Œ åˆ™
$$u_{l} = \frac{x - \mu }{\sigma}$$
è€Œ**éæ ‡å‡†æ­£æ€å˜é‡**, æ ¹æ®(2.2.1)æœ‰: 
$$x = T^{-1}(u_{l}) = F^{-1}_{X}(\Phi(u_{l}))$$
å¦‚æœæ˜¯å¯¹äºå¤šå˜é‡çš„å½¢å¼ï¼Œåˆ™å¯ä»¥ä½¿ç”¨å¦‚ä¸‹çš„é€¼è¿‘:
$$Y \approx Y' = \sum^{n}_{i=1} (g_{i} - g(\mu_{X})) + g(\mu_{X})$$
å…¶ä¸­, $g_{i} = g(T^{-1}(u_{\mu_{X1}}, u_{\mu_{X2}}, \dots , u_{\mu_{Xn}}))$, è€Œ$u$ æ˜¯å¯¹åº”åŸå§‹éšæœºå˜é‡å‡å€¼å‘é‡$(\mu_{X1}, \mu_{X2}, \dots \mu_{Xn})$åœ¨æ ‡å‡†æ­£æ€ç©ºé—´ä¸­çš„æ˜ å°„é‡; è¿™ç§æ–¹å¼å¯ä»¥ç»™å‡ºæ›´åŠ ç²¾ç¡®çš„é€¼è¿‘æ–¹æ¡ˆ; 

å…·ä½“å‰å››é˜¶çš„æ— é‡çº²ä¸­å¿ƒçŸ©è®¡ç®—æ–¹æ³•å¯ä»¥å‚è€ƒè¯¾æœ¬; 
> [!NOTE] è¯´æ˜
> è¿™ä¸ªæ–¹æ³•é€‚ç”¨äºè®¡ç®—åŠŸèƒ½å‡½æ•°çš„ä¸­å¿ƒçŸ©, è€Œ(4)ä¸­çš„æ–¹æ³•ç”¨äºè®¡ç®—åŸç‚¹çŸ©; 

## å››ã€å¯é æ€§ä»¥åŠå¯é æ€§çµæ•åº¦åˆ†æçš„å››é˜¶çŸ©æ–¹æ³•
### (1) å¯é æ€§åˆ†æç›¸å…³å››é˜¶çŸ©æ–¹æ³•
å¤±æ•ˆåŸŸçš„æ¦‚ç‡($P[Y \leq  0]$)å¯ä»¥è¡¨è¾¾ä¸º: 
$$P\{  Y\leq 0\} = P\left\{\frac{Y - \mu_{g}}{\sigma_{g}} \leq  - \frac{\mu_{g}}{\sigma_{g}} \right\} =\Phi(- \frac{\mu_{g}}{\sigma_{g}})$$
æˆ‘ä»¬è€ƒè™‘åŠŸèƒ½å‡½æ•° $Y = g(x)$ , å¹¶ä¸”**å‡è®¾å…¶å‰å››é˜¶ä¸­å¿ƒçŸ©å·²çŸ¥**, åˆ™å¯ä»¥å°†å…¶è¿›è¡Œæ ‡å‡†åŒ–:
$$z_{u} = \frac{Y - \mu_{g}}{\sigma_{g}}\tag{2.4.1}$$
æˆ‘ä»¬å–äºŒé˜¶å¯é åº¦æŒ‡æ ‡ä¸º$\beta_{2M} = \frac{\mu_{g}}{\sigma_{g}}$, åˆ™ä¸Šå¼å¯ä»¥è®°ä¸º:
$$P\left\{ z_{u} \leq -\beta_{2M}\right\}\tag{2.4.2}$$
åˆ©ç”¨**é«˜é˜¶çŸ©æ ‡å‡†åŒ–æŠ€æœ¯æ–¹æ³•**ï¼Œ å¾—åˆ°**æ ‡å‡†æ­£æ€éšæœºå˜é‡**ä¸º: 
$$u = \frac{3(\alpha_{4g} - 1) z_{u} + \alpha_{3g} (z_{u}^{2} -  1)}{\sqrt{(5 \alpha_{3g}^{2} -   9 \alpha_{4g} +  9) (1 - \alpha_{4g})}}$$
è¿›è¡Œæ ‡å‡†æ­£æ€åŒ–, å¹¶åˆ©ç”¨uæ˜¯é’ˆå¯¹$z_{u}$çš„å•å¢å‡½æ•°ï¼Œåˆ™å°†$z_{u}$å’Œ$\beta_{2M}$åˆ†åˆ«ä»£å…¥ä¹‹å, å¼(2.4.2)å¯ä»¥åŒ–ä¸º: 
$$P\{ z_{u} \leq -\beta_{2M} \} = P\left\{ u  \leq -   \frac{3(\alpha_{4g} - 1) \beta_{2M} + \alpha_{3g} (\beta_{2M}^{2} -  1)}{\sqrt{(5 \alpha_{3g}^{2} -   9 \alpha_{4g} +  9) (1 - \alpha_{4g})}} \right\}$$
æˆ‘ä»¬å¯ä»¥è®¡å³ä¾§ä¸€é¡¹ä¸º$- \beta_{4M}$, å³ä¸º**å››é˜¶å¯é åº¦æŒ‡æ ‡**; å…¶ä¸­, $\alpha_{3g}  = 0$æ—¶,  æœ‰$\beta_{4M} = \beta_{2M}$æˆç«‹;  
> [!Note] è¯´æ˜
> ä¸Šè¿°æ–¹æ³•ä¸»è¦æ˜¯åˆ©ç”¨é«˜é˜¶çŸ©æ ‡å‡†åŒ–æŠ€æœ¯å¾—å‡ºçš„ç»“æœï¼Œ è€Œä¸€èˆ¬çš„äºŒé˜¶çŸ©æ ‡å‡†åŒ–ç›´æ¥ä½¿ç”¨$\mu, \sigma$é‡‡ç”¨(2.4.1)å³å¯;

### (2) å¯é æ€§çµæ•åº¦åˆ†æç›¸å…³åˆ†æå››é˜¶çŸ©æ–¹æ³•
æˆ‘ä»¬è€ƒè™‘å››é˜¶çŸ©æ—¶çš„$P_{f}$ç›¸å¯¹äºè¾“å…¥å˜é‡çš„åˆ†å¸ƒå‚æ•°çš„çµæ•åº¦$\theta_{X_{i}}^{(k)}$, ($X_{i}$çš„ç¬¬$k$ä¸ªåˆ†å¸ƒå‚æ•°)çš„è®¡ç®—å…¬å¼å¯å†™ä¸º:
$$\frac{\partial P}{\partial \theta_{X_{i}}^{(k)}} = \frac{\partial P_{f} }{\partial \beta_{4M}} \left[ \frac{\partial \beta_{4M}}{\partial \beta_{2M}} \left(\frac{\partial \beta_{2M}}{\partial \alpha_{2g}} \frac{\partial \alpha_{2g}}{\partial \theta_{X_{i}} ^{(k)}} + \frac{\partial \beta_{2M}}{\partial \alpha_{1g}} \frac{\partial \alpha_{1g}}{\partial \theta_{X_{i}} ^{(k)}}\right) +\frac{\partial \beta_{4M}}{\partial \alpha_{3g}}\frac{\partial \alpha_{3g}}{\partial \theta_{X_{i}}^{(k)}}+ \frac{\partial \beta_{4M}}{\partial \alpha_{4g}} \frac{\partial \alpha_{4g}}{\partial \theta_{X_{i}}^{(k)}}\right] $$
å…¶ä¸­**æ˜¾ç„¶å¯¹äºä¸€, äºŒé˜¶çŸ©çš„åå¯¼æ•°**å¯ä»¥æ ¹æ®$(2.4.1)$è¿›è¡Œæ±‚è§£; å¦å¤–é€šè¿‡$\beta_{4M}$å’Œ$P_{f4M}$è§£æ, å¯ä»¥ç»™å‡ºå…¶ä»–éœ€è¦çš„åå¯¼æ•°å…¬å¼; 
![[attachments/Pasted image 20240227154659.png|900]]

æˆ‘ä»¬ä½¿ç”¨å˜é‡çš„ç»Ÿè®¡çŸ©å¯¹$\theta_{X_{i}}^{(k)}$æ±‚è§£åå¯¼, å‚è€ƒ[[#(1) åŠŸèƒ½å‡½æ•°çš„å®šä¹‰]], åˆ™æœ‰:
$$\begin{cases}
\alpha_{1g} = \int_{R^{n}} g(x) f_{X}(x) dx \\
\alpha_{2g} = \left\{\int [g(x) - \mu_{g}]^{2}f_{X}(x)dx \right\}^{\frac{1}{2}}   \\
\alpha_{kg} = \int_{R^{n}} \left[\frac{g(x) - \mu_{g}}{\sigma_{g} }\right]^{k} f_{X}(x) dx
\end{cases}$$
æ ¹æ®ä¸Šå¼ï¼Œ å¯ä»¥åˆ†åˆ«æ±‚è§£å‡º $\alpha_{1g}, \alpha_{2g}, \alpha_{3g}, \alpha_{4g}$ å…³äº$\theta_{X_{i}}^{(k)}$çš„å¯¼æ•°, åŒæ ·å¯ä»¥å¾—åˆ°ä»¥æ•°å­¦æœŸæœ›å½¢å¼è¡¨ç¤ºçš„$\frac{\partial \alpha_{kg}}{\partial \theta_{X_{i}}^{(k)}}$, 
åŒæ ·åœ°ï¼Œ ä¹Ÿå¯ä»¥ä½¿ç”¨æ•°å­¦æœŸæœ›è¡¨ç¤º$\frac{\partial \alpha_{kg}}{\partial \theta_{X_{i}}^{(k)}}$éƒ¨åˆ†ï¼Œå…¬å¼ç•¥å»; 

<b><mark style="background: transparent; color: blue">å¯¹äºæ­£æ€å˜é‡,  å¯é æ€§çµæ•åº¦</mark></b>å¯ä»¥è®¡ç®—ä¸º : 
$$\frac{1}{f_{X_{i}}(x_{i})} \frac{\partial f_{X_{i}}(x_{i})}{\partial \mu_{X_{i}}} = \frac{1}{\sigma_{X}} \frac{x_{i} - \mu_{X_{i}}}{\sigma_{X_{i}}}= \frac{1}{\sigma_{X_{i}}} u_{i}$$
$$\frac{1}{f_{X_{i}}(x_{i})} \frac{\partial f_{X_{i}} (x_{i})}{\partial \sigma_{X_{i}}} = \frac{1}{\sigma_{X_{i}}}\left( \left( \frac{x_{i} - \mu_{X_{i}}}{\sigma_{X_{i}}} \right)^{2} -1 \right) = \frac{1}{\sigma_{X_{i}}} (u_{i}^{2} - 1)$$
å…¶ä¸­æœ‰å…³ç³»:
$$u_{i} = \frac{x_{i} - \mu_{X_{i}}}{\sigma_{X_{i}}}$$
ä¸ºæ ‡å‡†åŒ–æ­£æ€å˜é‡ã€‚

```erlang title:è’™ç‰¹å¡æ´›æ¨¡æ‹Ÿæ±‚è§£å‡½æ•°
clear, clc;
%%%%%%%%%%%%%%%%%%%%%%% Example 2.6 %%%%%%%%%%%%%%%%%%%%%%%%%%
% å¯¹äºä¸¤ä¸ªå‚æ•°çš„å¯é æ€§çµæ•åº¦åˆ†æ, å…¶ä¸­å¤±æ•ˆæ¦‚ç‡å‡½æ•°å®šä¹‰ä¸º:
% g(x) = exp(0.2 X1 + 1.4) - X2; å…¶ä¸­X1, X2ç›¸äº’ç‹¬ç«‹ä¸”æœä»äºæ ‡å‡†æ­£æ€åˆ†å¸ƒ
g = @(x) exp(0.2 .*x(:,1) + 1.4) - x(:,2);
mu_ = [0,0]; sigma_ = diag([1,1]); skewness_ = [0,0]; kurtosis_ = [3,3]; % ç”±äºç›¸äº’ç‹¬ç«‹åæ–¹å·®æ˜¯0 
% æ³¨æ„sigmaæ˜¯ä¸€ä¸ªçŸ©é˜µ, åŒæ—¶æä¾›äº†æ–¹å·®å’Œåæ–¹å·®éƒ¨åˆ†;

%%%%%%%%%%%%%%% MCS è’™ç‰¹å¡æ´›æ–¹æ³•è¿›è¡Œæ±‚è§£çš„å‡½æ•° %%%%%%%%%%%%%%%%%%%%% 
function [res_theta1, res_theta2, Failure_property] = MCS_Solution(mu_, sigma_, g)
n = size(mu_, 2);   % è·å–å˜é‡çš„ä¸ªæ•°;
num_MCS_Simulation = 1e7;
x_i = lhsnorm(mu_, sigma_, num_MCS_Simulation, 'on');  % æŠ½å–x_içš„ä¸ªæ•°ä¸º 1e7 ä¸ª

Failure_Points = find(g(x_i) < 0); % æ‰¾å‡ºå…¶ä¸­çš„å¤±æ•ˆç‚¹;

Failure_property = size(Failure_Points, 1)/num_MCS_Simulation; % è®¡ç®—å¤±æ•ˆæ¦‚ç‡éƒ¨åˆ†;

% temp = zeros(num_MCS_Simulation, 1);
x_i  =  x_i(Failure_Points,:); % ä»…å–å‡ºå…¶ä¸­å¤±æ•ˆçš„ä¸€éƒ¨åˆ†;
m = size(x_i, 1);

u = zeros(m, n);  % åˆå§‹åŒ–æ•°ç»„, å–æ ‡å‡†åŒ–å˜é‡ä¸ºu, ä¸ºäº†èŠ‚çœè®¡ç®—é‡ä»…å–éœ€è¦çš„ä¸€éƒ¨åˆ†;
for i = 1:n  % è·å–æ ‡å‡†åŒ–ä¹‹åçš„å˜é‡;
    u(:, i) = (x_i(:,i) - mu_(i))./sigma_(i, i);  % è·å–æ­£äº¤å˜é‡ä¸­éœ€è¦çš„ä¸€éƒ¨åˆ† 
    % æ³¨æ„è¿™ä¸ªä»…é€‚ç”¨äºç‹¬ç«‹å˜é‡, å¦‚æœæ˜¯éç‹¬ç«‹åˆ™ä¸èƒ½ä½¿ç”¨; 
end 

res_theta1 = zeros(1,n); res_theta2 = zeros(1,n);
% è¿™ä¸ªè®¡ç®—åªé€‚ç”¨äºæ­£æ€å˜é‡ -> éæ­£æ€åˆ†å¸ƒéœ€è¦å˜æ¢æˆæ­£æ€åˆ†å¸ƒ; 
for i = 1:n
    % å®é™…ä¸Šæ˜¯å¯¹æ•´ä¸ªéƒ¨åˆ†æ±‚è§£å‡å€¼;
    res_theta1(i) = sum(u(:, i) ./ sigma_(i, i)) / num_MCS_Simulation;
    % ç¬¬ä¸€ä¸ªæ˜¯é’ˆå¯¹theta1æ±‚è§£å‡å€¼, è€Œç¬¬äºŒä¸ªæ˜¯é’ˆå¯¹theta2æ±‚è§£å‡å€¼
    res_theta2(i) = sum (( u(:,i).^2-1)./ sigma_(i,i)) / num_MCS_Simulation; 
    % Reliability_sensitivity 
end
end
```


## äº”ã€ç³»ç»Ÿå¯é æ€§ä»¥åŠå¯é æ€§çµæ•åº¦çš„åˆ†æçŸ©æ–¹æ³•
å¯¹äºæœ‰$i$ä¸ªå¤±æ•ˆæ¨¡å¼çš„ç³»ç»Ÿï¼Œç›¸åº”çš„åŠŸèƒ½å‡½æ•°åˆ†åˆ«ä¸º$g_{j}(X)$, å…¶ä¸­$j = 1,2, \dots l$, è€Œå¯¹äºlä¸ªå¤±æ•ˆæ¨¡å¼**æ„æˆä¸²è”ç³»ç»Ÿæ—¶**ï¼Œ åˆ™åŠŸèƒ½å‡½æ•°è®¾ä¸º$g^{(s)}(X)$, ä¸º: 
$$g^{(s)} (X) =  \min  (g_{1}(x), g_{2}(x), \dots g_{l}(x))$$
å³å–å…¶ä¸­**ä¸åŒåŠŸèƒ½å‡½æ•°çš„æœ€å°å€¼ä½œä¸ºå¤±æ•ˆæ¨¡å¼**ï¼Œä¸”ä»»æ„ä¸€ä¸ªåŠŸèƒ½å‡½æ•°<0æ—¶å³å¤±æ•ˆ;
è€Œæ˜¾ç„¶**æ„æˆå¹¶è”ç³»ç»Ÿæ—¶çš„å¤±æ•ˆå‡½æ•°**ä¸º: 
$$g^{(s)} (X) =  \min  (g_{1}(x), g_{2}(x), \dots g_{l}(x))$$

> [!cite] è¯´æ˜
> å¯¹äº Rosenblueth å’Œ Gorman-Seo çš„ç‚¹ä¼°è®¡æ³•, å¯¹äºç¬¬$j$ä¸ªæ–¹ç¨‹æ±‚è§£$m$ä¸ªèŠ‚ç‚¹, $n_j$ä¸ªå˜é‡æ—¶ï¼Œ è°ƒç”¨çš„æ¬¡æ•°ä¸º$m^{n_{j}}$; è€Œå¯¹äºZhao Nowakå’ŒZhao Ono çš„æ–¹æ³•ï¼Œ æ¯ä¸ªå¤±æ•ˆæ¨¡å¼è°ƒç”¨$g_{j}(X)$çš„æ¬¡æ•°ä¸º$m * n_j + 1$

## å…­ã€ ç›¸å…³å˜é‡ç‹¬ç«‹åŒ–è½¬æ¢çš„æ­£äº¤å˜æ¢æ–¹æ³•
### (1) æ­£æ€åˆ†å¸ƒç›¸å…³å˜é‡å‘ç‹¬ç«‹è½¬åŒ–çš„æ–¹æ³•
æˆ‘ä»¬è®¾è¾“å…¥å˜é‡ä¸º $X = (X_{1}, X_{2}, \dots X_{n})^{T}$, ä¸”å„ä¸ªå˜é‡ç›¸å…³, åˆ™nç»´æ­£æ€å˜é‡$X$çš„å¯†åº¦å‡½æ•°å¯¹åº”çš„åæ–¹å·®çŸ©é˜µä¸º:
$$C_{X} = \left[\begin{matrix}
\sigma_{X1}^{2} & \text{Cov}(X_{1}, X_{2})  & \dots   & \text{Cov}(X_{1}, X_{n}) \\ 
\dots  \\ 
\text{Cov}(X_{n} , X_{1})  &  \text{Cov}(X_{n}, X_{2})  &  \dots  & \sigma_{X_{n}}^{2}
\end{matrix}\right]$$
æ­¤æ—¶å¯ä»¥é€šè¿‡æ­£äº¤åˆ†è§£å°†$X$å˜æ¢ä¸ºZ, å¯¹åº”Zçš„åæ–¹å·®é˜µä¸º$C_z$ , åˆ™å¯ä»¥åˆ†è§£ä¸º:
$$C_{Z} = A^{T} C_{X} A = \left[\begin{matrix}
\lambda_{1}  \\ & \ddots  \\  && \lambda_{n}
\end{matrix}\right]\qquad \mu_{Z} = (0,0,0, \dots 0)^{T}$$
åªéœ€ä½¿ç”¨å¦‚ä¸‹ä»£ç æ±‚è§£å³å¯: 
```erlang title:ä½¿ç”¨matlabæ±‚è§£çŸ©é˜µçš„ç‰¹å¾å€¼å¹¶è¿›è¡Œåˆ†è§£
[A,C_Z] = eig(C_X);
```
è€Œæ­¤æ—¶ï¼Œ å¯¹åº”çš„ $x$ å‘é‡ä¹Ÿåº”å½“è½¬æ¢ä¸º $z$ å‘é‡, ä¸”æœ‰;
$$\left[\begin{matrix}
x_{1}  \\ x_{2}  \\  \vdots  \\  x_{n}
\end{matrix}\right]  = \left[\begin{matrix}
a_{11} & a_{12} &\dots & a_{1n} \\ \vdots \\ \vdots \\ a_{1n} & \dots & \dots & a_{nn}
\end{matrix}\right]\left[\begin{matrix} 
z_{1}  \\  z_{2}   \\  \vdots  \\ z_{n} 
\end{matrix}\right] +  \left[\begin{matrix}
\mu_{1}  \\  \mu_{2}  \\ \vdots  \\ \mu_{n}
\end{matrix}\right] $$
```erlang title:ç¤ºä¾‹ä»£ç å¦‚ä¸‹:
[A,sigma_new] = eig(sigma_);  % å°†çŸ©é˜µè¿›è¡Œæ­£äº¤åˆ†è§£;
x1 = @(z) mu_(1) + A(1,1) * z(:,1) + A(1,2) * z(:,2) + A(1,3)* z(:,3);
x2 = @(z) mu_(2) + A(2,1) * z(:,1) + A(2,2) * z(:,2) + A(2,3)* z(:,3);
x3 = @(z) mu_(3) + A(3,1) * z(:,1) + A(3,2) * z(:,2) + A(3,3)* z(:,3);
g_new = @(z)(1 - 2 .* 10^-5 .* x2(z) - (2e-4 .* abs(x1(z))).^1.2 - (2e-5 .* abs(x3(z))).^2.1);
```

### (2) ä¸€èˆ¬åˆ†å¸ƒä¸‹å‘ç‹¬ç«‹æ­£æ€å˜é‡è½¬æ¢çš„Rosenblattæ–¹æ³• 
Rosenblatt å˜æ¢å®šä¹‰å…³ç³»ä¸º: $u = T (x)$, å…¶ä¸­éšæœºå‘é‡ $u = (u_1, u_2, \dots  u_n)^T$æŒ‰ç…§æ¡ä»¶æ¦‚ç‡è®¡ç®—:
$$u_{1} = F_{X1}(x_{1}) \qquad u_{n} = F_{Xn|X1\dots Xn-1}(x_{n})$$
ç”±äºéšæœºå˜é‡$u_1, u_2\dots u_n$åœ¨[0,1]åŒºé—´å‡åŒ€åˆ†å¸ƒ, åˆ©ç”¨åå˜æ¢æ–¹æ³•å¯ä»¥å°†éšæœºå˜é‡ $X_i$ è½¬æ¢ä¸ºç‹¬ç«‹çš„æ ‡å‡†æ­£æ€å˜é‡ $Z_i$ , åˆ©ç”¨å¦‚ä¸‹è¡¨è¾¾å¼å˜æ¢: 
$$z_{1} =  \Phi^{-1}(F_{X1} (x_{1})),  \qquad z_{n} = \Phi^{-1}(F_{Xn|X1\dots  Xn-1}(x_{n}))$$

 
## 一、蒙特卡洛数字模拟和随机数发生器
### (1) 常用随机变量抽样公式
蒙特卡罗法主要依据是:
1. 样本的均值收敛于总体的均值
2. 事件发生的频率依概率收敛于其发生概率;
通常产生(0,1)区间**均匀独立分布的随机样本**, 并**将这些样本转换为服从各种分布的随机样本;** 而服从其他分布的随机变量的样本是通过(0,1)区间均匀独立随机分布样本进行实现的; 

常见的随机抽样方法有**反变换方法，组合法，卷积法和接受-拒绝方法**; 首先变量$r_i$在$[0,1]$区间均匀取值, 而设我们**所需要目标函数的分布**为$F_{X}$; 由于变换之后分布函数相等, 则有:
$$F_{X}(x_{i}) = U(r_{i}) = \begin{cases}
r_{i} \qquad  \\
0 \qquad 
\end{cases}$$
因此有关系:
$$x_{i} = F_{X}^{-1}(r_{i})$$
例如, 对于均匀分布, 由于$F(x_i) = \frac{x-a}{b-a} = r$, 容易获取到:
$$x = r (b-a) + a$$
具体的公式列表如下:
![[attachments/Pasted image 20240228235739.png|800]]
### (2) 常用抽样命令
我们常常利用如下的matlab命令进行抽样: 
```erlang
% 均匀抽样
X = unifrnd(a,b, n,1); % 均匀抽样, 后面n,1表示 n x 1向量
% 正态抽样 
X = normrnd(mu, sigma, N,1); 
```

需要说明的是, 对于简单随机样本，往往会出现样本过度聚集等等问题， 而解决方案是使用拉丁超立方抽样, 能够保证样本的相对均匀性; 
```erlang title:标准均匀分布和正态分布的拉丁超立方抽样
X = lhdesign(N,1);
X = lhsnorm(mu, sigma^2, N,1); % 正态分布的拉丁超立方抽样, 并使用mu, sigma表示均值和方差
```

Sobol 序列抽样: 对于sobol序列抽样, 其着重于在空间产生均匀分布; 其中, 当样本个数为2的整数次幂时, 
```erlang
%skip the first Num1 values, and then retain every Num2+1 point
% 标准均匀分布的sobol序列抽样:
X = sobolset(1, 'Skip', Num1, 'Leap', Num2);  % 第一个参数是维数 (Dimension )
% 标准正态分布的Sobol序列抽样:
q = qrandstream('sobol', n, 'Skip', Num1, 'Leap', Num2);   % 与sobolset效果想通
% 对应使用net和下标取行都可以返回抽样的点的坐标数值; 
X0 = qrand(q,N);  %qrand(q,4), 生成反正态样本
X = norminv(X0); 
```

## 二、单失效模式下求解的Monte Carlo方法与收敛性分析
首先设结构的功能函数为: 
$$Y = g(X) = g(X_{1}, X_{2}, \dots X_{n})$$
其失效概率为: 
$$P_{f} = \int_{F} f_{X}(x) dx$$
其中$f_{X}(x)$ 是输入随机变量$X = \left\{ X_1, X_2\dots X_n \right\}^T$的联合概率密度函数; 显然, 变量相互独立时, 参考[[📘ClassNotes/📐Mathmatics/🎣Probability Theory/第三章 多维随机变量及其分布#(1) 独立随机变量|独立随机变量]], 有$f_{X} (x)= \prod_{i=1}^{n} f_{X_{i}} (x_{i})$, 即等于**每个输入变量的边缘概率密度函数的乘积**; 

显然**失效概率的估计值**可以使用失效域指示函数的样本值落入失效域内的样本个数与总样本个数之比表示; 其中$I_{F}$为失效域指示函数, 当失效时$I_F = 1$;
$$\hat{P}_{f} = \frac{1}{N} \sum^{n}_{j=1} I_{F} (x_{j}) = \frac{N_{F}}{N}\tag{3.2.1}$$
因此我们只需求解失效概率数学期望即可。 两边求解数学期望得到: 
$$E(\hat{P}_{f}) = E\left( \frac{1}{N} \sum^{n}_{j=1} I_{F} (x_{j}) \right) = \frac{1}{N}\sum^{n}_{i=1} E[I_{F}(x_{j})] =E[I_{F}(x)]  = P_{f}$$
因此, 蒙特卡洛方法获取的失效概率估计值是失效概率的无偏估计; 另外， 对(3.2.1)求解方差， 得到:
$$V[\hat{P}_{f}] = V\left[\frac{1}{N}\sum^{n}_{i=1} I_{F} (x_{i}) \right] = \frac{1}{N^{2}}V\left[\sum^{n}_{i=1}  \right]$$
```erlang
% 
```


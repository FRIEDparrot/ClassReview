## ä¸€ã€æ—¶å˜å¯é æ€§çš„å®šä¹‰
### (1) å¯é æ€§ä¸å¯é åŸŸå®šä¹‰
æ—¶å˜ç»“æ„çš„åŠŸèƒ½å‡½æ•°ä¸€èˆ¬æœ‰ä»¥ä¸‹ä¸‰ç§å‚æ•°ï¼ŒåŸºæœ¬å½¢å¼å¦‚ä¸‹:
$$Z(t) = g(X, Y(t), t)$$
å…¶ä¸­$X$æ˜¯éšæœºå˜é‡ï¼Œ Yä¸ºéšæœºè¿‡ç¨‹, tä¸ºæ—¶é—´ã€‚å¯èƒ½ä¸å«å…¶ä¸­Yæˆ–è€…tå‡½æ•°, ä½†æ˜¯Y,tè‡³å°‘å«æœ‰å…¶ä¸€ã€‚

å¯¹äºæ—¶å˜å¯é æ€§é—®é¢˜ä¸­, æˆ‘ä»¬è€ƒè™‘$[t_0, t_s]$ä¹‹å†…çš„æƒ…å†µ, å¯¹äºå…¶ä¸­ä»»æ„ç»™å®šçš„æ—¶åˆ»$t^{*}$å¦‚æœæœ‰$Z(t^{*}) \leq  0$ï¼Œ åˆ™è®¤ä¸ºç»“æ„æ˜¯å¤±æ•ˆçš„ã€‚å…¶å¤±æ•ˆåŸŸå’Œå®‰å…¨åŸŸå¯ä»¥è¡¨ç¤ºä¸º:
$$F = \left\{ Z(t) \leq  0 , \exists  t \in  [t_{0}, t_{s}] \right\}\tag{10.1.1.1}$$
$$S= \left\{ Z (t) > 0, \forall  t \in [t_{0}, t_{s}] \right\}\tag{10.1.1.2}$$
### (2) EOLEæ¨¡å‹å±•å¼€æ–¹æ³•æ¦‚è¿°
æˆ‘ä»¬ä½¿ç”¨EOLE (Expansion Optimial Linear Estimation)æ¨¡å‹è¿›è¡Œå±•å¼€, å…¶å±•å¼€è¿‡ç¨‹ä¸º:
é¦–å…ˆ, å–æ­¥é•¿ä¸º$\frac{t_{s} - t_{0}}{N}$, å±•å¼€å¼ä¸º:
$$\Large \boxed{Y_{j}(t) = \mu_{Y_{j}}+ \sigma_{Y_{j}}^{2}  \sum^{r}_{k=1} \frac{\xi_{jk}}{\sqrt{\lambda_{jk}} } \varphi_{jk}^{T} \rho_{Y_{j}}(t)}$$
å…¶ä¸­, å³ä¾§ $k = 1,2, ... r$, è®°**æ‰€æœ‰çš„éšæœºè¿‡ç¨‹å…±æœ‰mä¸ª**, å¯¹åº”çš„<mark style="background: transparent; color: red">æ ‡å‡†æ­£æ€å‘é‡</mark>åˆ†åˆ«ä¸º$\xi = (\xi_{1}^{T}, \xi_{2}^{T}, \dots \xi_{m}^{T})$ï¼Œr ä¸º<mark style="background: transparent; color: red">éšæœºå±•å¼€è¿‡ç¨‹ä¸­çš„æˆªæ–­é˜¶æ•°</mark>ï¼Œæˆ‘ä»¬åœ¨å®é™…æˆªæ–­æ—¶ï¼Œå–éšæœºè¿‡ç¨‹Yåæ–¹å·®çŸ©é˜µçš„ç‰¹å¾å€¼ä¸º$\lambda_{jk}$,å…¶ä¸­å–å¤§çš„rä¸ªæˆªæ–­ä¸º $\lambda_{j1}, \lambda_{j2},\dots \lambda_{jr}$, è€Œå¯¹åº”çš„ $\xi$ å’Œ $\rho_{Y}$ ä¹Ÿåšç›¸åº”çš„æˆªæ–­ã€‚

å…¶ä¸­ $\rho_{Y_{j}} (t) = \left(\rho_{Y_{j}} (t, t_{0}), \rho_{Y_{j}} (t, t_{1}), \dots  \rho_{Y_{j}} (t, t_{N}) \right)$ä¸ºç›¸å…³ç³»æ•°å‘é‡ã€‚$\xi$ ä¸ºç‹¬ç«‹æ­£æ€éšæœºå˜é‡, ä¸”**åŸºäº $Y_j(t)$å±•å¼€å¯¹åº”çš„ç‹¬ç«‹æ ‡å‡†æ­£æ€å‘é‡**ä¸º $\xi_{j} =  (\xi_{j1},  \xi_{j2}, \dots  \xi_{jr})^{T}$(åˆ—å‘é‡), è€Œæˆ‘ä»¬å¯ä»¥å°†æ‰€æœ‰çš„mä¸ªéšæœºè¿‡ç¨‹ä¸­çš„åˆ—å‘é‡æ’æˆçŸ©é˜µï¼Œ åˆ™å˜ä¸º:
$$\xi = (\xi_{1}, \xi_{2}, \dots  \xi_{m})$$


### (3) æ—¶å˜å¯é æ€§åˆ†æçš„MCSæ–¹æ³•
é¦–å…ˆï¼Œ æ ¹æ®xçš„æ¦‚ç‡å¯†åº¦, äº§ç”Ÿ**æ ·æœ¬çŸ©é˜µS**, å…¶ä¸­Sçš„ç¬¬iè¡Œä»£è¡¨æ—¶é—´ä¸º$i$çš„æ ·æœ¬;
$$x = \left[\begin{matrix}
\vec{x}_{1}   \\  \vec{x}_{2}  \\  \vdots   \\  \vec{x}_{N}
\end{matrix}\right] \qquad   t = \left[\begin{matrix}
t_{1}  \\  t_{2} \\  \vdots   \\  t_{n}
\end{matrix}\right]$$
å®šä¹‰çŸ©é˜µ$B$, å…¶ä¸­ç”±$S$çŸ©é˜µçš„ç¬¬iè¡Œå’Œç¦»æ•£æ—¶åˆ»å‘é‡Tç»„æˆ, å³`B(i,:) = [xp(i,:), t(i,:) ]`,   ä»£å…¥çŸ©é˜µBçš„æ¯ä¸€è¡Œï¼Œè®¡ç®—æ˜¯å¦å¤±æ•ˆã€‚
æ—¶å˜å¯é æ€§çš„å¤±æ•ˆæ¦‚ç‡è®¡ç®—å’Œæ–¹å·®è®¡ç®—ä»ç„¶ä¸ä¼ ç»Ÿçš„ç›¸åŒ
$$P_{f} (t_{0}, t_{s})=  \frac{\sum^{n}_{i=1}I_{F} (x_{i})}{N}$$
$$\text{cov} (P_{f}(t_{0}, t_{s})) = \sqrt{\frac{1 - P_{f}}{(N-1 ) P_{f}}}$$
æ˜¾ç„¶æˆ‘ä»¬éœ€è¦åŒå±‚å¾ªç¯è°ƒç”¨ $N * N_t$ æ¬¡æ¨¡å‹æ±‚è§£é—®é¢˜, ä½†æ˜¯ï¼Œç”±äºæ—¶å˜ä¸­æ¯ä¸€æ¬¡çš„ $x_i$éƒ½åº”è¯¥æ˜¯ç›¸åŒçš„, æ‰€ä»¥æŠ½æ ·æ¬¡æ•°ä»…ä¸ºnum_MCSï¼Œè€Œè°ƒç”¨æ¨¡å‹æ¬¡æ•°ä¸ºnum_MCS * length(t); 
```matlab fold title:MCSæ–¹æ³•æ±‚è§£ç¤ºä¾‹ä»£ç 
%% %%%%%%%%%%%%%% æ—¶å˜åŠŸèƒ½å‡½æ•°çš„MCSæ±‚è§£ %%%%%%%%%%%%%%%%%%%%%%
% %%%%%%%% è€ƒè™‘ä»¥ä¸‹çš„æ—¶å˜åŠŸèƒ½å‡½æ•°, æ—¶é—´è§‚å¯ŸåŸŸ 0:5 %%%%%%%%
clear, clc;
% t = (0:0.01:5);
% mu_ = [3.5, 3.5];    sigma_d = [0.3, 0.3]; sigma_ = diag(sigma_d.^2);
% g = @(x, t) x(:,1).^2 .* x(:,2) - 5 .* x(:,1) .* t + (x(:,2) + 1) .* t.^2 - 20;

%% %%%%%%%%%% å››è¿æ†æœºæ„çš„å¯é æ€§åˆ†æ %%%%%%%%%%%%%%%%%%%%%%%%%%%
mu_ = [53, 122, 66.5,  100]; sigma_d = [0.1, 0.1, 0.1, 0.1]; sigma_ = diag(sigma_d.^2);

t = deg2rad(95.5:0.6:155.5);
D = @(x,t) -2 .* x(:,1) .* x(:,3) .*sin(t);
E = @(x,t) 2 * x(:,3) .*((x(:,4) - x(:,1) .* cos(t)));
F = @(x,t) x(:,2).^2 - x(:,1).^2 - x(:,3).^2 - x(:,4).^2 + 2 .* x(:,1) .* x(:,4) .* cos(t);
g = @(x,t) deg2rad(0.8) - abs((deg2rad(76) + deg2rad(60) .* sin(3./4.* (t - deg2rad(95.5))) -2.* atan((D(x,t) + sqrt(D(x,t).^2 + E(x,t).^2 - F(x,t).^2))./(E(x,t)+ F(x,t)))));

num_MCS = 2^16;
pf = time_MCS(mu_, sigma_, g, t, num_MCS);

function Pf = time_MCS(mu_, sigma_, g, t, num_MCS)
    if (size(t, 1) == 1)
        t_new = t';
    end
	xp = lhsnorm(mu_, sigma_, num_MCS , "on");
	If = zeros(num_MCS, 1);
	for i = 1:num_MCS
		yp = g(xp(i,:), t_new);  % æŠ•å½±åˆ°æ•´ä¸ªtéƒ¨åˆ†
		if ~isempty(find(yp < 0, 1))
			If(i,:) = 1;
		end
		if mod(i, 100) == 0
			sprintf("epoch: %d", i)
		end
	end
	Pf = sum(If) ./ num_MCS;
end
```

## äºŒã€æ—¶å˜å¯é æ€§åˆ†æçš„è·¨è¶Šç‡æ–¹æ³•
### (1) è·¨è¶Šç‡æ–¹æ³•æ±‚è§£æ—¶å˜å¯é æ€§åŸç†
è€ƒè™‘(10.1.1.1), å¾—åˆ°:
$$P_{f}(t_{0}, t_{s}) = P\left\{\{ g(X, t_{0})\leq 0\} \cup  \{ N^{+}(t_{0}, t_{s}) > 0\}   \right\}$$
å…¶ä¸­$\{ g(X, t_{0})\leq 0\}$è¡¨ç¤ºåˆå§‹æ—¶åˆ»å¤±æ•ˆ,è€Œ$\{ N^{+}(t_{0}, t_{s}) > 0\}$è¡¨ç¤ºè·¨è¶Šæ¬¡æ•°ã€‚å³è·¨è¶Šæ¬¡æ•°èŒƒå›´å†…ä¸èƒ½æœ‰å¤±æ•ˆç‚¹å­˜åœ¨, å³<b><mark style="background: transparent; color: blue">ä¹‹åçš„è·¨è¶Šæ¬¡æ•°åªèƒ½ä¸º0</mark></b>ã€‚
å‚è€ƒ[[ğŸ“˜ClassNotes/ğŸ‘¨â€ğŸ”§Mechanics/ğŸ–¥ï¸Computational_Mechanics/ğŸš§ç»“æ„å¯é æ€§è®¾è®¡åŸºç¡€/æ¨å¯¼éƒ¨åˆ†/è·¨è¶Šç‡æ–¹æ³•æœ‰å…³å®šç†æ¨å¯¼è¿‡ç¨‹.pdf|è·¨è¶Šç‡æ–¹æ³•æœ‰å…³å®šç†æ¨å¯¼è¿‡ç¨‹.pdf]], æœ‰ä¸ç­‰å¼:
$$\max P_{f}(\tau, \tau)\leq P_{f}(t_{0}, t_{0}) + P \{ N^{+}(t_{0}, t_{s}) > 0\} $$
æ­¤æ—¶å®šä¹‰è·¨è¶Šç‡ä¸º:
$$\Large \boxed{\nu^{+} (\tau) = \lim_{\Delta  \tau\rightarrow 0,\Delta \tau > 0} \frac{P\left\{ N^{+}(\tau, \tau + \Delta  \tau = 1) \right\}}{\Delta \tau}}$$
æˆ‘ä»¬å‡è®¾è·¨è¶Šæ¬¡æ•°æœä»[[ğŸ“˜ClassNotes/ğŸ“Mathmatics/ğŸ£Probability Theory/ç¬¬äºŒç«  éšæœºå˜é‡åŠå…¶åˆ†å¸ƒ#3. æ³Šæ¾åˆ†å¸ƒ|æ³Šæ¾åˆ†å¸ƒ]], å‚è€ƒ[[ğŸ“˜ClassNotes/ğŸ‘¨â€ğŸ”§Mechanics/ğŸ–¥ï¸Computational_Mechanics/ğŸš§ç»“æ„å¯é æ€§è®¾è®¡åŸºç¡€/æ¨å¯¼éƒ¨åˆ†/è·¨è¶Šç‡æ–¹æ³•æœ‰å…³å®šç†æ¨å¯¼è¿‡ç¨‹.pdf|è·¨è¶Šç‡æ–¹æ³•æœ‰å…³å®šç†æ¨å¯¼è¿‡ç¨‹.pdf]], æ—¶å˜å¤±æ•ˆæ¦‚ç‡çš„è®¡ç®—è¡¨è¾¾å¼å¯ä»¥è®¡ç®—ä¸º:
$$P_{f}(t_{0}, t_{s}) = 1- R(t_{0}, t_{s}) =  1 - (1 - P_{f}(t_{0}, t_{0}) \exp \left[-  \int_{t_{0}}^{t_{s}} \nu^{+} (\tau) dt \right])$$
éœ€è¦è¯´æ˜çš„æ˜¯ï¼Œ**å®é™…ç¼–ç¨‹ä¸­ï¼Œ$\nu^{+}(\tau)$ æ˜¯æœªçŸ¥çš„ã€‚å…¶æ±‚è§£æ˜¯è·¨è¶Šç‡æ³•çš„å…³é”®æ­¥éª¤**ï¼Œ å¾€å¾€ä½¿ç”¨MCSæ–¹æ³•æˆ–è€…ç›´æ¥æ–¹æ³•æ±‚è§£ã€‚

### (2) æ±‚è§£è·¨è¶Šç‡çš„ç›´æ¥æ–¹æ³•
åŸºæœ¬æ€è·¯å¦‚ä¸‹:
1. é¦–å…ˆï¼Œ æ ¹æ®æ—¶ä¸å˜ä¸€æ¬¡å¯é æ€§åˆ†ææ–¹æ³•æ±‚è§£æ—¶åˆ» $\tau$ å’Œ $\tau + \Delta  \tau$ å¯¹åº”çš„å¯é åº¦æŒ‡æ ‡å¹¶è®°ä¸º$\beta (\tau)$, æ­¤æ—¶, $-\beta(\tau)$ æ˜¯ $\left\{ g(X,\tau) > 0 \right\}$çš„å¯é åº¦æŒ‡æ ‡, è€Œ$\beta(\tau + \Delta  \tau)$æ˜¯$\left\{ g(X, \tau + \Delta \tau)\leq  0\right\}$çš„æŒ‡æ ‡ã€‚
2. è®¡ç®—$g(X, \tau)$ä¸$g(X, \tau + \Delta \tau)$çš„ç›¸å…³ç³»æ•°$\rho (\tau, \tau + \Delta \tau)$, å¹¶å¯ä»¥è®¡ç®—ä¸º:
$$\rho_{G} (\tau, \tau + \Delta  \tau) = - \alpha(\tau) \alpha(\tau + \Delta \tau)$$
å…¶ä¸­, $\alpha(\tau) = \frac{U^*(\tau)}{\beta(\tau)}$, å¹¶æœ‰$\alpha(\tau+\Delta \tau) = \frac{U^{*}(\tau + \Delta \tau)}{\beta(\tau + \Delta \tau)}$ åˆ†åˆ«ä¸º<b><mark style="background: transparent; color: blue">æ ‡å‡†æ­£æ€ç©ºé—´ä¸­</mark></b>**åæ ‡åŸç‚¹æŒ‡å‘è®¾è®¡ç‚¹çš„å•ä½æ–¹å‘å‘é‡**, å…¶ä¸­$U$ä¸ºæ ‡å‡†æ­£æ€ç©ºé—´è®¾è®¡ç‚¹å‘é‡, **è€Œ$\beta$æ˜¯ç›¸åº”æ ‡å‡†æ­£æ€è®¾è®¡ç‚¹ä¸åŸç‚¹çš„è·ç¦»** 
> [!caution] è¯´æ˜
> åœ¨ç”¨AFSOMæ±‚è§£å‡ºè®¾è®¡ç‚¹ä¹‹å, éœ€è¦**æŠ•å½±åˆ°æ ‡å‡†æ­£æ€ç©ºé—´**(x- mu)/sigmaï¼Œç„¶åå†è¿›è¡Œåé¢çš„æ±‚è§£

![[Excalidraw/ç¬¬åç«  æ—¶å˜å¯é æ€§åˆ†æçš„æ–¹æ³• 2024-04-18 12.35.02|300]]
æ­¤æ—¶,å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„è¡¨è¾¾å¼æ±‚è§£$v^+(\tau)$:
$$\large\boxed{v^{+} (\tau) =   \frac{\Phi_{2}(\beta(\tau), - \beta(\tau + \Delta  \tau)   \quad ;\quad   \rho_{G} (\tau, \tau+ \Delta  \tau ))}{\Delta  \tau}}$$
å…¶ä¸­$\Phi_{2}$ä¸º**äºŒå…ƒæ­£æ€ç´¯è®¡åˆ†å¸ƒå‡½æ•°**,å…¶ä¸­ä¸Šå¼è¡¨è¾¾ä¸º$\tau + \Delta\tau \geq 0$çš„ä¸$\tau$æ—¶å°äº0çš„é¢åˆ†åˆ«çš„å¯é åº¦æŒ‡æ ‡åˆ†å¸ƒ, **å®é™…ä¸Šæ˜¯ä»¥(0,0)ä¸ºå‡å€¼, ä»¥$\rho_G$ä¸ºåæ–¹å·®åœ¨$\beta(\tau), - \beta(\tau + \Delta \tau)$å¤„è®¡ç®—å‡ºçš„äºŒå…ƒæ­£æ€åˆ†å¸ƒå€¼**ï¼Œå…¶ä¸­, åé˜²å·®çŸ©é˜µæ˜¯
$$R = \left[\begin{matrix}
1 & \rho_{G}   \\   \rho_{G} & 1
\end{matrix}\right]\qquad  \rho_{G} =  - \cos (\alpha_{1}, \alpha_{2}) \approx -1$$
ç”±äºä¸¤ä¸ª$\alpha$ç›¸äº’æ¥è¿‘, æ˜¾ç„¶è·å¾—çš„æ˜¯ä¸€ä¸ªæ¯”è¾ƒæ¥è¿‘äº-1çš„å€¼ã€‚

`````ad-note
title: è¡¥å……: å¤šå…ƒæ­£æ€ç´¯è®¡åˆ†å¸ƒå‡½æ•°å’Œå¯†åº¦å‡½æ•°
collapse: close 
å‚è€ƒ[en.wikipedia.org/wiki/Multivariate_normal_distribution](https://en.wikipedia.org/wiki/Multivariate_normal_distribution), å¾—åˆ°å¤šå…ƒæ­£æ€ç´¯è®¡åˆ†å¸ƒå‡½æ•°å›¾åƒï¼Œ è€Œåœ¨MATLABä¸­åªéœ€ä½¿ç”¨`mvncdf`å³å¯æ±‚è§£å¯¹åº”çš„åˆ†å¸ƒå¯†åº¦ã€‚
![[attachments/Pasted image 20240419150722.png]]
ä¸€ä¸ªå¸¸ç”¨çš„ç¤ºä¾‹å¦‚ä¸‹:
```matlab 
mu = [1 -1];   Sigma = [.9 .4; .4 .3];  %æŒ‡å®šå‡å€¼å’Œæ–¹å·®çŸ©é˜µ
[X1,X2] = meshgrid(linspace(-1,3,25)',linspace(-3,1,25)');   % X1,X2å‡ä¸º 25 * 25 çŸ©é˜µ
X = [X1(:), X2(:)];   % éœ€è¦æ³¨æ„çš„æ˜¯è¿™ä¸ªç´¢å¼•, è¿™ä¸ªæ˜¯å°†X1,X2æ’æˆåˆ—å‘é‡ç„¶åæ‹¼æ¥æˆ625 * 2 çš„åˆ—å‘é‡
p = mvncdf(X,mu,Sigma);
Z = reshape(p,25,25);
surf(X1,X2,Z)
```
`````

ä¸€ä¸ªç¤ºä¾‹ä»£ç å¦‚ä¸‹:
```matlab title:ä½¿ç”¨è·¨è¶Šç‡æ–¹æ³•è®¡ç®—æ—¶å˜å¤±æ•ˆæ¦‚ç‡ä¸å¯é æ€§
clear, clc;
t = (0:0.1:5)';
mu_ = [3.5, 3.5]; sigma_d = [0.3, 0.3]; sigma_ = diag(sigma_d.^2);
g = @(x, t) x(:,1).^2 .* x(:,2) - 5 .* x(:,1) .* t + (x(:,2) + 1) .* t.^2 - 20; 

% å…ˆè®¡ç®—åˆå§‹çš„beta0çš„å€¼
x0 = (AFOSM_solu(mu_, sigma_, @(x)g(x, 0)) - mu_)./sigma_d;
beta0 = sqrt(sum(x0 .* x0, 2));

cross_rate = zeros(length(t) -1, 1);  % è·¨è¶Šç‡
for i = 1:length(t) - 1
	% ä½¿ç”¨AFOSMæ–¹æ³•æ±‚è§£ä¸¤ä¸ªç›¸é‚»çš„tç‚¹å¯¹åº”çš„è®¾è®¡ç‚¹ 
	x_i1 = AFOSM_solu(mu_, sigma_, @(x)g(x, t(i)));
	x_i2 = AFOSM_solu(mu_, sigma_, @(x)g(x, t(i+1)));
    
	% å…ˆå°†è®¾è®¡ç‚¹ä»¥muä¸ºä¸­å¿ƒè¿›è¡Œè§„èŒƒåŒ–
    x_new1 = (x_i1 - mu_)./ sigma_d;
    x_new2 = (x_i2 - mu_)./ sigma_d;

    beta_   = [sqrt(sum(x_new1.^2, 2)), sqrt(sum(x_new2.^2, 2))]; % è®¡ç®—é•¿åº¦
    alpha_  = [x_new1 ./ beta_(1); x_new2./beta_(2)];              % è®¡ç®—å•ä½åŒ–å‘é‡
	
    rho = -sum(alpha_(1,:) .* alpha_(2,:), 2);  % ä½¿ç”¨ä¸¤ä¸ªå‘é‡ç‚¹ä¹˜è´Ÿå€¼ä½œä¸ºç›¸å…³ç³»æ•°
    R = [1,rho;rho,1]; % åæ–¹å·®çŸ©é˜µ
	cross_rate(i) = mvncdf([beta_(1), - beta_(2)],[0, 0], R);
end
Pf = 1 - (1-normcdf(-beta0)).* exp(-sum(cross_rate).* 0.1);
```

## ä¸‰ã€æ—¶å˜å¯é æ€§åˆ†æçš„æå€¼æ–¹æ³•
### (1) æå€¼æ–¹æ³•æ±‚è§£æ—¶å˜å¯é æ€§çš„åŸç†
å¯¹äºæ—¶å˜é—®é¢˜ï¼ŒåŠŸèƒ½å‡½æ•°ä¸­çš„$Z(t) = g(X,t)$å¯ä»¥çœ‹æˆæ¦‚ç‡ç©ºé—´ä¸­çš„$R^n$ä¸‹çš„éšæœºå˜é‡$X$å’Œæ—¶é—´è§‚å¯ŸåŸŸ$t = [t_0, t_s]$ä¸­çš„å‚æ•°$t$çš„ä¸€ä¸ªå¤šå…ƒå‡½æ•°ã€‚
æ­¤æ—¶, è¾“å…¥å˜é‡$X \in R^{n}$,**å›ºå®šåœ¨æŸä¸ªå®ç°å€¼$x^*$æ—¶**, $Z(t) = g(x^{*}, t)$ ä¸ºå…³äºæ—¶é—´çš„ä¸€å…ƒå‡½æ•°ã€‚å¹¶å°†æ­¤å‡½æ•°ç§°ä¸ºåŠŸèƒ½$Z(t) = g(x^*, t)$çš„æ ·æœ¬å‡½æ•°ã€‚æ˜¾ç„¶$\min g(x^{*}, t) < 0$åˆ™ç»“æ„å¤±æ•ˆã€‚

æ—¶å˜å¤±æ•ˆåŸŸçš„è¡¨è¾¾å¼ä¸º:
$$F = \left\{\min_{t \in [t_{0}, t_{s}]} g(X, t) \leq 0 \right\}$$
æ­¤æ—¶ï¼Œæ—¶é—´åŒºé—´$[t_0,t_s]$å†…, æ—¶å˜å¤±æ•ˆæ¦‚ç‡ $P_{f}$ å¯ä»¥è¡¨ç¤ºä¸ºä¸‹å¼:
$$\boxed {P_{f}(t_{0}, t_{s}) = P\{ F\} =P\left\{\min_{t \in [t_{0}, t_{s}]} g(X, t) \leq 0 \right\}\tag{10.3.1.1}}$$
å› æ­¤åªéœ€æ±‚è§£æ—¶å˜åŠŸèƒ½å‡½æ•°g(x,t)å…³äºtçš„æå°å€¼, **å³å¯å°†æ—¶å˜å¯é æ€§åˆ†æé—®é¢˜è½¬åŒ–ä¸ºæ—¶ä¸å˜å¯é æ€§é—®é¢˜**ã€‚ä¸Šå¼å³ä¸º<mark style="background: transparent; color: red">æ—¶å˜å¯é æ€§åˆ†æçš„æå€¼æ³•</mark>ã€‚

å¾€å¾€å…ˆé€šè¿‡å…±è½­æ¢¯åº¦æ³•ï¼Œ æœ€é€Ÿä¸‹é™æ³•æˆ–è€…[[ğŸ“˜ClassNotes/âŒ¨ï¸Programming/ğŸ‘¨â€ğŸ“Deep Learning/ğŸŒŸæ·±åº¦å­¦ä¹ ä¼˜åŒ–ç®—æ³•åˆé›†/2. é—ä¼ ä¼˜åŒ–ç®—æ³•(GA)|é—ä¼ ç®—æ³•]]ï¼Œ[[ğŸ“˜ClassNotes/âŒ¨ï¸Programming/ğŸ‘¨â€ğŸ“Deep Learning/ğŸŒŸæ·±åº¦å­¦ä¹ ä¼˜åŒ–ç®—æ³•åˆé›†/1. æ¨¡æ‹Ÿé€€ç«ç®—æ³•(SA)|æ¨¡æ‹Ÿé€€ç«ç®—æ³•]]ç­‰ç­‰æ±‚è§£**æ—¶åŸŸä¸Šçš„æœ€å°å€¼**;åªéœ€é€šè¿‡æ±‚è§£æå°å€¼ç‚¹å’Œå–å…¶ä¸­æœ€å°çš„ç‚¹è·å–å³å¯ã€‚

**å®é™…ä¸Š, å¯¹äºæå€¼MCSæ–¹æ³•ï¼Œåªæ˜¯å°†æ¯ä¸€ç»„æ ·æœ¬åˆ¤æ–­æ—¶é—´è§‚å¯ŸåŸŸä¸Šæå€¼ä¸0çš„å…³ç³», ä¸MCSæ–¹æ³•å®Œå…¨ç›¸åŒ**, è€Œä¸”è¿˜å¤šäº†æ­¥éª¤ï¼Œ å› æ­¤ç›´æ¥ä½¿ç”¨å‰é¢è®²çš„MCSæ–¹æ³•ä»£ç è¿›è¡Œæ›¿ä»£å³å¯ã€‚

### (2) æ—¶å˜å¯é æ€§åˆ†æçš„åŒ…ç»œå‡½æ•°æ–¹æ³•
#### 1. åŒ…ç»œå‡½æ•°è¡¨è¾¾å¼
é¦–å…ˆï¼Œè€ƒè™‘ä¸åŒ…å«éšæœºè¿‡ç¨‹çš„æ—¶å˜é—®é¢˜, åˆ™æ—¶å˜åŠŸèƒ½å‡½æ•°ä¸º:
$$Z(t) = g(X,t), \qquad t \in  [t_{0}, t_{s}]$$
å¯¹äº$Z(t)$çš„åŒ…ç»œé¢å¯ä»¥ä½¿ç”¨å¦‚ä¸‹çš„æ–¹ç¨‹è¿›è¡Œè·å–ï¼Œè€Œ<b><mark style="background: transparent; color: blue">æ—¶å˜å¤±æ•ˆæ¦‚ç‡ä¹Ÿç­‰æ•ˆè½¬æ¢ä¸ºæ—¶ä¸å˜å¤±æ•ˆæ¦‚ç‡</mark></b>:
$$\Large G(x) =  \begin{cases}
g(x,t) = 0 \\ 
\frac{\partial g(x,t)}{\partial t} = 0
\end{cases}$$
å³ G(x) < 0 å¯¹åº”çš„æ¦‚ç‡å³ä¸ºæ—¶å˜å¤±æ•ˆæ¦‚ç‡;

å–æ—¶é—´è§‚å¯ŸåŸŸå†…çš„åŠŸèƒ½å‡½æ•°g(x,t), å…¶åœ¨$x$å¤„çš„å‡å€¼ç‚¹ä¸º $\mu_{X} = \left\{ \mu_{X1}, \mu_{X2}, \dots \mu_{Xn} \right\}$, åˆ™åœ¨å¯¹åº”éƒ¨åˆ†è¿›è¡Œä¸€é˜¶æ³°å‹’å±•å¼€ï¼Œåˆ™æœ‰:
$$g(x,t) = g(\mu_{X}, t) + \left(\left. \frac{\partial g}{\partial x_{1}}\right|_{\mu_{X}}, \dots \left.\frac{\partial g}{\partial x_{n}} \right|_{\mu_{X}}\right)^{T} (x - \mu_{X}) \tag{*}$$
å…¶ä¸­$x,\mu_{X}$ç­‰å‡ä¸ºåˆ—å‘é‡, æ­¤æ—¶, æˆ‘ä»¬å– $u_{i} = \frac{x_{i} - \mu_{Xi}}{\sigma_{Xi}}$,å¹¶å°† $x_{i} = \mu_{X_{i}} + \sigma_{Xi}u_{i}$ è¿›è¡Œä»£å…¥,å¾—åˆ°:
$$\Large \boxed{g(x,t) \approx L(u,t)  = b_{0} + b^{T}(t) u}\tag{10.3.2.1}$$
å…¶ä¸­$b0 = g(\mu_X, t)$,è€Œbä¸º 
$$\boxed{b = \left\{ \left. \frac{\partial g}{\partial u_{1}}\right|_{\mu_{X}}, \dots \left.\frac{\partial g}{\partial u_{n}} \right|_{\mu_{X}} \right\} \rightarrow b_{i} = \sigma_{Xi} \frac{\partial g(x,t)}{\partial x_{i}}}\tag{10.3.2.2}$$
æ˜¾ç„¶è”åˆ 10.3.2.1 å’Œ 10.3.2.2 ä¸¤ä¸ªå‡½æ•°,å®¹æ˜“å¾—åˆ° * å¼ã€‚

æ­¤æ—¶ï¼ŒåŸå§‹é—®é¢˜ä¸­çš„<mark style="background: transparent; color: red">çº¿æ€§æ—¶å˜åŠŸèƒ½å‡½æ•°</mark>ä¸º$L(u,t)$, å…¶åŒ…ç»œå‡½æ•°å¯ä»¥è·å¾—ä¸º: 
$$\boxed{\Large\begin{cases}
L(u,t) = g(\mu_{X}, t) + b^{T}(t) u  = 0  \\
L '(u,t) =\frac{\partial g(\mu_{X}, t)}{\partial t}  + b'^{T} (t) u = 0
\end{cases}} \tag{10.3.2.3}$$
å…¶ä¸­
$$\left. b'_i (t) = \sigma_{X_{i}}\frac{\partial^{2} g(x,t)}{\partial x\partial t} \right|_{\mu_{X}} \tag{10.3.2.4}$$
#### 2. åŒ…ç»œå‡½æ•°å±•å¼€ç‚¹çš„æ¦‚å¿µ



#### 3. ç¼–ç¨‹æ¡ˆä¾‹
ç¤ºä¾‹ä»£ç å…¥ä¸‹:
```matlab fold title:åŒ…ç»œå‡½æ•°æ³•æ±‚è§£æ—¶å˜å¯é æ€§åˆ†æ
%% %%%%%%%%%%%%%%%%%%% åŒ…ç»œå‡½æ•°(Envelope Function Method)æ–¹æ³•æ±‚è§£æ—¶å˜å¯é æ€§çš„ç¤ºä¾‹ä»£ç  %%%%%%%%%%%%%%%%
%           è®¡ç®—å››è¿æ†æœºæ„çš„å¯é æ€§åˆ†æç»“æœ
clear, clc;
mu_ = [3.5, 3.5];
sigma_d = [0.3, 0.3];
sigma_ = diag(sigma_d.^2);
tspan = 0:0.05:5-0.05;

g = @(x, t) x(:,1).^2 .* x(:,2) - 5 .* x(:,1) .* t  + (x(:,2) + 1) .* t.^2 - 20;    % åŠŸèƒ½å‡½æ•°å®šä¹‰
dgdt = @(x,t) -5 .* x(:,1) +  2 .* t .* (x(:,2) + 1);                   % åŠŸèƒ½å‡½æ•°å¯¹æ—¶é—´çš„å¯¼æ•°å€¼
dgdx = @(x,t) [2.* x(:,1).* x(:,2)-5.*t, x(:,1).^2 + t.^2];           % å¯¹äºæ¯ä¸ª x å€¼çš„åå¯¼æ•°    
dg_dxdt = @ (x,t)  [-5,  2.* t];                                        % å¯¹äºdxdtçš„äºŒé˜¶å¯¼æ•°

% num_MCS = 1e5;
% [Pf, msc] = time_MCS(mu_, sigma_, g, t, num_MCS); Pf is about 0.1828

%% %%%%%%%%%%%%%%% |åŒ…ç»œå‡½æ•°æ–¹æ³•æ±‚è§£| %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% æ„é€ ä»…ä¸æ—¶é—´æœ‰å…³çš„å‘é‡ b, b'
b0 = @(t) g(mu_, t);    b0_ = @(t) dgdt(mu_, t);                     % å¯¹åº”b0å¤„çš„å¯¼æ•°å€¼
bi  = @(t)  dgdx(mu_, t) .* sigma_d;    	 		                 % 10.3.2.1 å…¬å¼ä¸­, æ±‚è§£å‘é‡b
bi_ = @(t) dg_dxdt(mu_, t) .* sigma_d;                               % æ±‚è§£bçš„å¯¼æ•°å‘é‡
f = @(t) b0_(t) -  b0(t) .* (bi_(t) * bi(t)') ./  (bi(t) * bi(t)');   % æ±‚è§£åŒ…ç»œå‡½æ•°L , å¹¶ä»¥å…¶é›¶ç‚¹ä½œä¸ºé€‰æ‹©çš„ç‚¹

%% %%%%%%%%%%%%%%% æ±‚è§£åŒ…ç»œå‡½æ•°çš„å±•å¼€ç‚¹ u*çš„ä½ç½®,å¯¹åº”çš„få³ä¸ºåŒ…ç»œé¢  %%%%%%%%%%%%%%%%%%%%
% åˆ©ç”¨å…¬å¼æ±‚è§£ u*(t)çš„é›¶ç‚¹, å–å…¶ä¸­ä¸é‡å¤çš„ä½œä¸ºåŒ…ç»œé¢çš„è®¾è®¡ç‚¹
x = [];
for ti = tspan
    opts =  optimset('Display','off');
    [res, ~, exitflag, ~]= fzero(f,ti, opts);
    if (exitflag == 1)
        x = [x; res];
    else % failed to find solution
    end
end
clear res feval exitflag output

% å¯¹yä¸­çš„æ—¶é—´ç‚¹è¿›ç­›é€‰, å»é™¤æ±‚è§£åˆ°çš„é‡å¤æ—¶é—´ç‚¹å’Œæ—¶é—´èŒƒå›´ä»¥å¤–çš„éƒ¨åˆ†
x = round(x, 5);    % ä¿ç•™5ä½å°æ•°, æ–¹æ³•1 roundn = @(x,n) 10.^n .* round(x/10.^n); roundn(x, -5)
x = x(x >= tspan(1) & x <= tspan(end));
x = unique(x,"rows","stable");   % ç¬¬ä¸‰ä¸ªå‚æ•°stableä¿è¯uniqueä¹‹å, é¡ºåºä¸ä¼šæ”¹å˜


% æ±‚è§£åæ–¹å·®çŸ©é˜µçš„ mu å’Œ Sigma å¯¹åº”çš„å€¼, å¹¶ä¸”è®°ä¸º Mu_L å’Œ Sigma_L
if ~isempty(x)    
    Mu_L = [b0(tspan(1));   b0(x); b0(tspan(end))];  % å°†è§£å¾—çš„bi(x) = dg_dxæ’æˆåˆ—é˜µ
    ti = [tspan(1); x; tspan(end)];               % å¯¹åº”çš„ t
    Mu_L = unique(Mu_L,"rows","stable"); ti = unique(ti,"rows","stable");
else
	Mu_L = [b0(tspan(1)); b0(tspan(end))];
    % æ±‚è§£å¤±æ•ˆåŒ…ç»œé¢å¯¹åº”çš„bi, æ–¹æ³•æ˜¯
	ti = [tspan(1); tspan(end)];
end
Sigma_L = bi(ti) * bi(ti)';

% è®¡ç®—æ¯ä¸ªåŒ…ç»œç‚¹çš„ç¬æ—¶å¤±æ•ˆæ¦‚ç‡
Pf_arr = zeros(size(ti,1),1);
for i = 1:size(ti,1)
    Pf_arr(i) = 1 - normcdf( b0(ti(i))./sqrt(bi(ti(i)) * bi(ti(i))'));  % ä¸‹é¢æ˜¯b(ti)çš„æ¨¡ 
end

[Pf_arr, idx] = sort(Pf_arr, 1, "descend");  ti = ti(idx,:); % æŒ‰ç…§ä»å¤§åˆ°å°çš„æ–¹æ³•æ’ Pf, ti 
r_tmp = rank(Sigma_L); Pf_arr = Pf_arr(1:r_tmp,:); ti = ti(1:r_tmp,:); % å‰”é™¤å¤±æ•ˆæ¦‚ç‡å°çš„ç‚¹

%% %%%%%%%%%%%%%%%%% æ„é€ å¤šå…ƒæ­£æ€åˆ†å¸ƒå‡½æ•°, æ±‚è§£å¤±æ•ˆæ¦‚ç‡ %%%%%%%%%%%%%%%%%%%%
num_EFM = 1e5;
xp = mvnrnd(Mu_L', Sigma_L, num_EFM);          % ä½¿ç”¨å¤šå…ƒæ­£æ€æ¦‚ç‡å‡½æ•°ç”Ÿæˆä¸‰ä¸ªç‚¹ä¸‹çš„éšæœºæ ·æœ¬ç‚¹
Pf = mean(min(xp,[],2) < 0);  % å–ä»»æ„ä¸€ä¸ªå¤±æ•ˆ, åˆ™ç»“æ„éƒ½å¤±æ•ˆ
fprintf("Pf is %f", Pf);

```

```matlab fold title:æ¢æˆæ•°å€¼æ–¹æ³•æ±‚è§£å¯¼æ•°,æ•ˆæœåŸºæœ¬ç›¸åŒ(æ³¨æ„deltaç»™å®šä¸èƒ½å¤ªå°)
%% %%%%%%%%%%%%%%%%%%% åŒ…ç»œå‡½æ•°(Envelope Function Method)æ–¹æ³•æ±‚è§£æ—¶å˜å¯é æ€§çš„ç¤ºä¾‹ä»£ç  %%%%%%%%%%%%%%%%
%    10.12  æ—¶å˜åŠŸèƒ½å‡½æ•°  X1^2  X2 - 5 * X1 * t  + (X_2 + 1) * t^2 - 20 çš„ç®—ä¾‹   %%%
clear, clc;
mu_ = [3.5, 3.5];
sigma_d = [0.3, 0.3];
sigma_ = diag(sigma_d.^2);
tspan = (0:0.05:5-0.05)';

g = @(x, t) x(:,1).^2 .* x(:,2) - 5 .* x(:,1) .* t  + (x(:,2) + 1) .* t.^2 - 20;    % åŠŸèƒ½å‡½æ•°å®šä¹‰
% dgdt = @(x,t) -5 .* x(:,1) +  2 .* t .* (x(:,2) + 1);                   % åŠŸèƒ½å‡½æ•°å¯¹æ—¶é—´çš„å¯¼æ•°å€¼
% dgdx = @(x,t) [2.* x(:,1).* x(:,2)-5.*t, x(:,1).^2 + t.^2];             % å¯¹äºæ¯ä¸ª x å€¼çš„åå¯¼æ•°
% dg_dxdt = @ (x,t)  [-5,  2.* t];                                        % å¯¹äºdxdtçš„äºŒé˜¶å¯¼æ•°

delta_t = 1e-5; delta_x = diag(1e-5 * ones(1,2));
dgdt = @(x,t) (g(x,t + delta_t) - g(x,t))/delta_t;
dgdx = @(x,t) diffgx(x,t, g, delta_x);
dg_dxdt = @(x,t) diffgxt(x,t, g, delta_x, delta_t);

%% %%%%%%%%%%%%%%% |åŒ…ç»œå‡½æ•°æ–¹æ³•æ±‚è§£éƒ¨åˆ†| %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% æ„é€ ä»…ä¸æ—¶é—´æœ‰å…³çš„å‘é‡ b, b'
b0 = @(t) g(mu_, t);    b0_ = @(t) dgdt(mu_, t);                     % å¯¹åº”b0å¤„çš„å¯¼æ•°å€¼
bi  = @(t)  dgdx(mu_, t) .* sigma_d;    	 		                 % 10.3.2.1 å…¬å¼ä¸­, æ±‚è§£å‘é‡b
bi_ = @(t) dg_dxdt(mu_, t) .* sigma_d;                               % æ±‚è§£bçš„å¯¼æ•°å‘é‡
f = @(t) b0_(t) -  b0(t) .* (bi_(t) * bi(t)') ./  (bi(t) * bi(t)');  % æ±‚è§£åŒ…ç»œå‡½æ•°L , å¹¶ä»¥å…¶é›¶ç‚¹ä½œä¸ºé€‰ç”¨çš„ç‚¹

%% %%%%%%%%%%%%%%% æ±‚è§£åŒ…ç»œå‡½æ•°çš„å±•å¼€ç‚¹ u*çš„ä½ç½®,å¯¹åº”çš„få³ä¸ºåŒ…ç»œé¢  %%%%%%%%%%%%%%%%%%%%
% åˆ©ç”¨å…¬å¼æ±‚è§£ u*(t)çš„é›¶ç‚¹, å–å…¶ä¸­ä¸é‡å¤çš„ä½œä¸ºåŒ…ç»œé¢çš„è®¾è®¡ç‚¹
x = [];
for i = 1:size(tspan,1)
    t0 = tspan(i);
    opts =  optimset('Display','off');
    [res, ~, exitflag, ~]= fzero(f,t0, opts);
    if (exitflag == 1)
        x = [x; res];
    else % failed to find solution
    end
end
clear res feval exitflag output

% å¯¹yä¸­çš„æ—¶é—´ç‚¹è¿›ç­›é€‰, å»é™¤æ±‚è§£åˆ°çš„é‡å¤æ—¶é—´ç‚¹å’Œæ—¶é—´èŒƒå›´ä»¥å¤–çš„éƒ¨åˆ†
x = round(x, 5);    % ä¿ç•™5ä½å°æ•°, æ–¹æ³•1 roundn = @(x,n) 10.^n .* round(x/10.^n); roundn(x, -5)
x = x(x >= tspan(1) & x <= tspan(end));
x = unique(x,"rows","stable");   % ç¬¬ä¸‰ä¸ªå‚æ•°stableä¿è¯uniqueä¹‹å, é¡ºåºä¸ä¼šæ”¹å˜


% æ±‚è§£åæ–¹å·®çŸ©é˜µçš„ mu å’Œ Sigma å¯¹åº”çš„å€¼, å¹¶ä¸”è®°ä¸º Mu_L å’Œ Sigma_L
if ~isempty(x)    
    Mu_L = [b0(tspan(1));   b0(x); b0(tspan(end))];  % å°†è§£å¾—çš„bi(x) = dg_dxæ’æˆåˆ—é˜µ
    ti = [tspan(1); x; tspan(end)];               % å¯¹åº”çš„ t
    Mu_L = unique(Mu_L,"rows","stable"); ti = unique(ti,"rows","stable");
else
	Mu_L = [b0(tspan(1)); b0(tspan(end))];
    % æ±‚è§£å¤±æ•ˆåŒ…ç»œé¢å¯¹åº”çš„bi, æ–¹æ³•æ˜¯
	ti = [tspan(1); tspan(end)];
end
Sigma_L = bi(ti) * bi(ti)';

% è®¡ç®—æ¯ä¸ªåŒ…ç»œç‚¹çš„ç¬æ—¶å¤±æ•ˆæ¦‚ç‡
Pf_arr = zeros(size(ti,1),1);
for i = 1:size(ti,1)
    Pf_arr(i) = 1 - normcdf( b0(ti(i))./sqrt(bi(ti(i)) * bi(ti(i))'));  % ä¸‹é¢æ˜¯b(ti)çš„æ¨¡ 
end

[Pf_arr, idx] = sort(Pf_arr, 1, "descend");  ti = ti(idx,:); % æŒ‰ç…§ä»å¤§åˆ°å°çš„æ–¹æ³•æ’ Pf, ti 
r_tmp = rank(Sigma_L); Pf_arr = Pf_arr(1:r_tmp,:); ti = ti(1:r_tmp,:); % å‰”é™¤å¤±æ•ˆæ¦‚ç‡å°çš„ç‚¹

%% %%%%%%%%%%%%%%%%% æ„é€ å¤šå…ƒæ­£æ€åˆ†å¸ƒå‡½æ•°, æ±‚è§£å¤±æ•ˆæ¦‚ç‡ %%%%%%%%%%%%%%%%%%%%
num_EFM = 1e5;
xp = mvnrnd(Mu_L', Sigma_L, num_EFM);          % ä½¿ç”¨å¤šå…ƒæ­£æ€æ¦‚ç‡å‡½æ•°ç”Ÿæˆä¸‰ä¸ªç‚¹ä¸‹çš„éšæœºæ ·æœ¬ç‚¹
Pf = size(find(min(xp,[],2) < 0), 1)/num_EFM;  % å–ä»»æ„ä¸€ä¸ªå¤±æ•ˆ, åˆ™ç»“æ„éƒ½å¤±æ•ˆ

fprintf("Pf is %f", Pf); 

%% %%%%%%%%%%%%%%%% åŒ…ç»œå‡½æ•°å±•å¼€ç‚¹ %%%%%%%%%%%%%%%%%%%%%%%%%%% 
L  = @(u,t) b0  + bi  * u';           % æ±‚è§£åŒ…ç»œå‡½æ•° L(x, t) = 0 ç”¨çš„å‡½æ•°éƒ¨åˆ†
L_ = @(u,t) b0_ + bi_ * u';           % æ±‚è§£ L'(u, t);


% dgdx = @(x,t) (g(x + delta_x .*[1,0],t) - g(x,t))/delta_x;
function dgdx = diffgx(x,t, g, delta_x)
    n = size(x, 2);
    m = size(t, 1);
    dgdx = zeros(m,n);
    for i = 1:n
        dgdx(:,i) = (g(x + delta_x(i,:),t) - g(x, t))./delta_x(i,i);  % calculate 3 lines at a time 
    end
end

function dg_dxdt = diffgxt(x,t, g, delta_x, delta_t)
    n = size(x, 2);
    m = size(t, 1);
    dg_dxdt = zeros(m,n);
    % ref from computational fluid dynamics
    for i = 1:n
        dg_dxdt(:,i) = (g(x + delta_x(i,:), t+delta_t) + g(x - delta_x(i,:),t-delta_t)...
            - g(x + delta_x(i,:), t-delta_t) - g(x - delta_x(i,:), t+delta_t))./(4 * delta_x(i,i) *delta_t);
    end
end

```

## å››ã€æ—¶å˜å¯é æ€§åˆ†æçš„ä»£ç†æ¨¡å‹æ–¹æ³•
å¯¹äº**å¤§å‹å¤æ‚ç»“æ„ä»¥åŠéšå¼åŠŸèƒ½å‡½æ•°çš„æ—¶å˜å¯é æ€§åˆ†æé—®é¢˜**, æ•°å­—æ¨¡æ‹Ÿæ–¹æ³•å…·æœ‰å¾ˆå¤§çš„è®¡ç®—ä»£ä»·, åˆ™å¾€å¾€ä½¿ç”¨<b><mark style="background: transparent; color: blue">åŒå±‚ä»£ç†æ¨¡å‹æ–¹æ³•å’Œå•å±‚ä»£ç†æ¨¡å‹æ–¹æ³•</mark></b>æ¥è§£å†³é—®é¢˜ã€‚
### 1. åŒå±‚ä»£ç†æ¨¡å‹æ–¹æ³•
å°†æ—¶å˜å¯é æ€§åˆ†ææ±‚è§£è½¬åŒ–ä¸ºæ—¶ä¸å˜å¯é æ€§åˆ†æé—®é¢˜ã€‚æ­¤æ—¶å–æ¨è®·ä¸‹æ˜¯ç™¾å¹´åŠŸèƒ½å‡½æ•°æå°å€¼å¯¹åº”çš„æ—¶åˆ»ä¸º$T(X)$, åˆ™: 
$$T(X) = \left\{t | \min_{t}g(X,t), t\in [t_{0}, t_{s}] \right\}$$
è€Œå¯¹åº”æ—¶å˜å¯é æ€§æ±‚è§£è½¬æ¢ä¸ºæ—¶ä¸å˜, å³ä¸º
$$P_{f}(t_{0}, t_{s}) = P\left\{g(X, T(X)) \leq 0\right\} = P\left\{ G_{e}(X) \leq  0\right\}$$
åŒå±‚ä»£ç†æ¨¡å‹çš„åŸºæœ¬æ€è·¯ä¸º:
1. **å†…å±‚ä»£ç†æ¨¡å‹å»ºç«‹ç»™å®šæ ·æœ¬ç‚¹$x^{*}$çš„æ¡ä»¶ä¸‹,å¯¹åº”çš„$g(x^*, t)$å¯¹äºtçš„Krigingä»£ç†æ¨¡å‹**, 
2. å¤–å±‚åˆ©ç”¨$g_{K}(x^{*}, t)$å¾—åˆ°$x$çš„**æ‰€æœ‰è®­ç»ƒæ ·æœ¬$x^{T}$å¤„**çš„**æ—¶å˜åŠŸèƒ½å‡½æ•°å…³äºæ—¶é—´tçš„æå€¼**,å³
$$G_{e}(x^{T})= \min_{t \in [t_{0}, t_{s}]} g_{K}(x^{T}, t)\overset{æå€¼}{\longrightarrow}G_{eK}(x)$$
è·å–æå€¼åï¼Œé€šè¿‡$G_{eK}(x)$è®¡ç®—å¤±æ•ˆæ¦‚ç‡çš„ä¼°è®¡å€¼ã€‚å…¶ä¸­**å†…å±‚è‡ªé€‚åº”å»ºç«‹ç»™å®š$x^*$ä¸‹çš„$g(x^*, t)$çš„ä»£ç†æ¨¡å‹, è€Œå¤–å±‚åˆ©ç”¨å†…å±‚æä¾›çš„ä¸åŒçš„$x^*$å»ºç«‹ç»™å®š$t^*$ä¸‹çš„æå€¼ä¸$x$çš„å…³ç³»**, æœ€ç»ˆåªéœ€è¦**é€šè¿‡å¤–å±‚é¢„æµ‹ä¸åŒçš„$x$å€¼æ ·æœ¬æ˜¯å¦å¤±æ•ˆ**å³å¯ã€‚

#### (1) ç¬¬ä¸€å±‚ä»£ç†æ¨¡å‹å»ºç«‹
å®é™…ä½¿ç”¨ä¸­, é¦–å…ˆåœ¨$S^{t}$ä¸­**ç”Ÿæˆéšæœºè®­ç»ƒæ—¶åˆ»**å¹¶**è°ƒç”¨æ—¶å˜åŠŸèƒ½å‡½æ•°ç”Ÿæˆåˆå§‹æ ·æœ¬ç‚¹**, å»ºç«‹åˆå§‹ä»£ç†æ¨¡å‹, è€Œ**ä¸‹ä¸€ä¸ªæ›´æ–°çš„æ—¶åˆ»å¯ä»¥é‡‡ç”¨ä¸‹å¼çš„å­¦ä¹ å‡½æ•°è®¡ç®—**:
$$E(I(t)) = E[\max(g_{K}^{\min}(x)) - g_{K}(x^{*}, t), 0] =  \int_{-\infty}^{g_{K}^{\min}(x^{*})} (g_{K}^{\min}(x^{*}, t) ) \frac{1}{\sqrt{2\pi}\sigma _{g_{K}}(x^{*}, t)} \exp\left(- \frac{g_{K}(x^{*}, t) -  \mu_{g_{K}}(x^{*}, t)^{2}}{2 \sigma_{g_{K}}^{2} (x^{*}, t)}\right)d g_{K}(x^{*}, t)$$
å…¶ä¸­å–å½’ä¸€åŒ–çš„$g_K$å˜é‡ä¸º:
$$w= \frac{g_{K}(x^{*}, t) - \mu_{g_{K}}(x^{*}, t)}{\sigma_{g_{K}} (x^{*}, t)} \overset{ä»£å…¥ä¸Šå¼åŒ–ç®€}{\longrightarrow} è·å–ç§¯åˆ†å‡½æ•°$$
æœ€ç»ˆå¾—åˆ°å…¬å¼:
$$E(I(t)) = (g_{K}^{\min} (x^{*}) - \mu_{g_{K}} (x^{*}, t)) \Phi\left(\frac{g_{K}^{\min} (x^{*})- \mu_{g_{K}}(x^{*}, t)}{\sigma_{g_{K}}(x^{*}, t)}\right) + \sigma_{g_{K}}(x^{*}, t) \phi \left(\frac{g_{K}^{\min} (x^{*})- \mu_{g_{K}}(x^{*}, t)}{\sigma_{g_{K}}(x^{*}, t)}\right)$$
å…¶ä¸­$E(I(t))$ä»£è¡¨äº†$g_{K}(x^*, t)$**æœ€å°ç‚¹å¤„çš„å‡½æ•°å€¼å°äº$g_K^{\min}(x^*, t)$(å³å¤±æ•ˆ)çš„æƒ…å†µä¸‹, $g_K(x^*, t)$ä¸$g_K^{\min}(x^{*})$çš„å·®å¼‚å€¼çš„æœŸæœ›æ›´å¤§**ã€‚å³åœ¨æ—¶é—´è§‚å¯ŸåŸŸå†…, æœ€å°å€¼è¯†åˆ«ç²¾åº¦è´¡çŒ®æ›´å¤§ï¼Œæ¯ä¸€æ¬¡é€‰å–ä½¿$E(I(t))$æ›´å¤§çš„ç‚¹åŠ å…¥å’Œæ›´æ–°ä»£ç†æ¨¡å‹å³å¯ã€‚

ä¸€èˆ¬å–åˆ°$\max(E(I(t)) < C_B$æ—¶åœæ­¢è¿­ä»£ç¬¬ä¸€å±‚Krigingæ¨¡å‹, å¾€å¾€å–
$$C_{B} = 1\% \times \left| g_{K}^{\min}(x^{*})\right|$$
#### (2) ç¬¬äºŒå±‚ä»£ç†æ¨¡å‹å»ºç«‹
ä»ç„¶åœ¨$S_t$ä¸­éšæœºé€‰å–æ ·æœ¬ç‚¹å’Œè®¡ç®—,å½¢æˆåˆå§‹è®­ç»ƒé›†;
åˆ¤æ–­æå€¼å‡½æ•°ä¸é—¨é™å€¼0çš„å¤§å°å…³ç³»ï¼Œä½¿ç”¨æ”¹è¿›$C_A$å­¦ä¹ å‡½æ•°ä»£æ›¿Uå­¦ä¹ å‡½æ•°,
$$C_{A}(x) = (1 - \text{Pr}_{c}(x)) \times f_{X}(x) \times \sqrt{\sigma_{G_{eK}}(x)}\qquad \text{Pr}_{c}(x) = \Phi(\frac{|G_{eK}|(x)}{\sigma_{G_{eK}}(x)})$$
å…¶ä¸­Prä¸ºKrigingæ¨¡å‹åˆ¤æ–­$G_{e}(x)$æ­£è´Ÿå·çš„æ¦‚ç‡ï¼Œå¹¶é€‰å–æ›´æ–°æ ·æœ¬ç‚¹ä¸º:
$$x^u  = \text{argmax}_{x\in S}C_A(x)$$
å¹¶é€šè¿‡ä¸‹å¼è®¡ç®—åˆ¤åˆ«æ”¶æ•›æ€§(åˆ¤å®šç»ˆæ­¢æ¡ä»¶)
$$C_{K, MCS} = E[\text{Pr}_{c}]= \frac{1}{N^{x}} \sum^{N^{x}}_{i=1}\text{Pr}_{c}(x_{i})$$
å…¶ä¸­$C_{K, MCS}$å¯ä»¥è§£é‡Šä¸ºæ­£ç¡®åˆ¤å®šç¬¦å·çš„æ¦‚ç‡ã€‚å½“$C_{K,MCS} > C_{R}$(ä¸€èˆ¬å–0.99-0.999)æ—¶,åœæ­¢æ›´æ–°,å¦åˆ™æŒ‰ç…§ä¸Šè¿°æ›´æ–°æ ·æœ¬é€‰æ‹©å‡†åˆ™æ›´æ–°ã€‚
#### (3) å¤±æ•ˆæ¦‚ç‡è®¡ç®—
å¤±æ•ˆæ¦‚ç‡è®¡ç®—ä¸º:
$$\hat{P}_{f}(t_{0}, t_{s}) = \frac{1}{N^{x}}\sum^{N_{x}}_{i=1}I_{F}(G_{eK}(x_{i}))  = \frac{N_{f}}{N^{x}}$$
### 2. å•å±‚ä»£ç†æ¨¡å‹æ–¹æ³•
å¯¹äºå•å±‚ä»£ç†æ¨¡å‹æ–¹æ³•, æ˜¯ç›´æ¥é€šè¿‡å»ºç«‹ $g(x^*, t)$çš„ä»£ç†æ¨¡å‹, ç„¶åç›´æ¥é€šè¿‡æŠ½å–ç›¸åº”æ ·æœ¬ç‚¹, å¾—åˆ°å¯¹åº”ä»£ç†æ¨¡å‹çš„å¤±æ•ˆæ¦‚ç‡ã€‚
$$P_{f}(t_{0}, t_{s})  = Pr\left\{g(X, t)\leq 0, \exists  t \in [t_{0}, t_{s}] \right\} \approx \frac{\sum^{n}_{i=1}I_{F}(x_{i})}{N^{x}}$$
å…¶ä¸­æŒ‡ç¤ºå‡½æ•° $I_F(x_i)$ ä¸º:
$$I_F(x_{i})=\begin{cases}
1 \qquad  x_{i} \in  F \space (\exists t \in [t_{0}, t],  f(x, t) \leq  0) \\
0 \qquad  x_{i} \in  S \space (\forall t \in [t_{0}, t],  f(x, t) >  0))  
\end{cases} $$
å¦å¤–, æ­¤æ—¶å¯ä»¥æŒ‰ç…§ U_x > 2æ¥åˆ¤åˆ«æ”¶æ•›æ¡ä»¶ã€‚ä½†æ˜¯ç¼ºç‚¹æ˜¯å¿…é¡»ä½¿ç”¨æ›´åŠ å¤šçš„æ ·æœ¬ç‚¹

æ”¶æ•›æ€§æ£€æŸ¥:
æ ¹æ®$U_{\min}(x) \geq 2, U_{\min} < 2$å°†æ ·æœ¬åˆ†ä¸ºä¸¤ç»„ï¼Œ å…¶ä¸­
$$\hat{P}_{f} = \frac{N_{f1} + N_{f2}}{N^{x}}$$
æˆ‘ä»¬å– $N^*_{f2}$ ä¸ºç¬¬äºŒç»„æ ·æœ¬ä¸­å¤±æ•ˆæ ·æœ¬çš„å‡†ç¡®å€¼, è€Œç”±äº**ç¬¬ä¸€ç»„ä¸­å·²ç»æ˜¯$U_x \geq  2$çš„éƒ¨åˆ†äº†, æ‰€ä»¥æˆ‘ä»¬è®¤ä¸ºå…¶æ˜¯å‡†ç¡®å€¼, æ˜¾ç„¶, $N_f2^*$å·²ç»è®¡ç®—è¿‡**, å› æ­¤å¯ä»¥é€šè¿‡è¯¯å·®æœ€å¤§å€¼è®¡ç®—å‡º:

$$\varepsilon_{r}^{\max} = \max_{N_{f2}^{*} \in [0, N_{2}^{x}]} \left\{ \frac{N_{f2} - N_{f2}^{*}}{N_{f1} + N_{f2}} \times 100\%\right\}$$
å½“ $\varepsilon_r^\max\leq 5\%$ æ—¶, åœæ­¢è¿­ä»£ã€‚



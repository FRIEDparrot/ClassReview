## ä¸€ã€è’™ç‰¹å¡æ´›æ•°å­—æ¨¡æ‹Ÿå’Œéšæœºæ•°å‘ç”Ÿå™¨
### (1) å¸¸ç”¨éšæœºå˜é‡æŠ½æ ·å…¬å¼
è’™ç‰¹å¡ç½—æ³•ä¸»è¦ä¾æ®æ˜¯:
1. æ ·æœ¬çš„å‡å€¼æ”¶æ•›äºæ€»ä½“çš„å‡å€¼
2. äº‹ä»¶å‘ç”Ÿçš„é¢‘ç‡ä¾æ¦‚ç‡æ”¶æ•›äºå…¶å‘ç”Ÿæ¦‚ç‡;
é€šå¸¸äº§ç”Ÿ(0,1)åŒºé—´**å‡åŒ€ç‹¬ç«‹åˆ†å¸ƒçš„éšæœºæ ·æœ¬**, å¹¶**å°†è¿™äº›æ ·æœ¬è½¬æ¢ä¸ºæœä»å„ç§åˆ†å¸ƒçš„éšæœºæ ·æœ¬;** è€Œæœä»å…¶ä»–åˆ†å¸ƒçš„éšæœºå˜é‡çš„æ ·æœ¬æ˜¯é€šè¿‡(0,1)åŒºé—´å‡åŒ€ç‹¬ç«‹éšæœºåˆ†å¸ƒæ ·æœ¬è¿›è¡Œå®ç°çš„; 

å¸¸è§çš„éšæœºæŠ½æ ·æ–¹æ³•æœ‰**åå˜æ¢æ–¹æ³•ï¼Œç»„åˆæ³•ï¼Œå·ç§¯æ³•å’Œæ¥å—-æ‹’ç»æ–¹æ³•**; é¦–å…ˆå˜é‡$r_i$åœ¨$[0,1]$åŒºé—´å‡åŒ€å–å€¼, è€Œè®¾æˆ‘ä»¬**æ‰€éœ€è¦ç›®æ ‡å‡½æ•°çš„åˆ†å¸ƒ**ä¸º$F_{X}$; ç”±äºå˜æ¢ä¹‹ååˆ†å¸ƒå‡½æ•°ç›¸ç­‰, åˆ™æœ‰:
$$F_{X}(x_{i}) = U(r_{i}) = \begin{cases}
r_{i} \qquad  \\
0 \qquad 
\end{cases}$$
å› æ­¤æœ‰å…³ç³»:
$$x_{i} = F_{X}^{-1}(r_{i})$$
ä¾‹å¦‚, å¯¹äºå‡åŒ€åˆ†å¸ƒ, ç”±äº$F(x_i) = \frac{x-a}{b-a} = r$, å®¹æ˜“è·å–åˆ°:
$$x = r (b-a) + a$$
å…·ä½“çš„å…¬å¼åˆ—è¡¨å¦‚ä¸‹: 
![[attachments/Pasted image 20240228235739.png|800]]
### (2) å¸¸ç”¨æŠ½æ ·å‘½ä»¤ 
æˆ‘ä»¬å¸¸å¸¸åˆ©ç”¨å¦‚ä¸‹çš„matlabå‘½ä»¤è¿›è¡ŒæŠ½æ ·: 
```erlang
% å‡åŒ€æŠ½æ ·
X = unifrnd(a,b, n,1); % å‡åŒ€æŠ½æ ·, åé¢n,1è¡¨ç¤º n x 1å‘é‡
% æ­£æ€æŠ½æ · 
X = normrnd(mu, sigma, N,1); 
```

éœ€è¦è¯´æ˜çš„æ˜¯, å¯¹äºç®€å•éšæœºæ ·æœ¬ï¼Œå¾€å¾€ä¼šå‡ºç°æ ·æœ¬è¿‡åº¦èšé›†ç­‰ç­‰é—®é¢˜ï¼Œ è€Œè§£å†³æ–¹æ¡ˆæ˜¯ä½¿ç”¨æ‹‰ä¸è¶…ç«‹æ–¹æŠ½æ ·, èƒ½å¤Ÿä¿è¯æ ·æœ¬çš„ç›¸å¯¹å‡åŒ€æ€§; 
```erlang title:æ ‡å‡†å‡åŒ€åˆ†å¸ƒå’Œæ­£æ€åˆ†å¸ƒçš„æ‹‰ä¸è¶…ç«‹æ–¹æŠ½æ ·
X = lhdesign(N,1);
X = lhsnorm(mu, sigma^2, N,1); % æ­£æ€åˆ†å¸ƒçš„æ‹‰ä¸è¶…ç«‹æ–¹æŠ½æ ·, å¹¶ä½¿ç”¨mu, sigmaè¡¨ç¤ºå‡å€¼å’Œæ–¹å·®
```

**Sobol åºåˆ—æŠ½æ ·**: å¯¹äºsobolåºåˆ—æŠ½æ ·, å…¶ç€é‡äºåœ¨ç©ºé—´äº§ç”Ÿå‡åŒ€åˆ†å¸ƒ; å…¶ä¸­, å½“æ ·æœ¬ä¸ªæ•°ä¸º2çš„æ•´æ•°æ¬¡å¹‚æ—¶; 
```erlang
%skip the first Num1 values, and then retain every Num2+1 point
% æ ‡å‡†å‡åŒ€åˆ†å¸ƒçš„sobolåºåˆ—æŠ½æ ·:
X = sobolset(1, 'Skip', Num1, 'Leap', Num2);  % ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ç»´æ•° (Dimension )
% æ ‡å‡†å‡åŒ€åˆ†å¸ƒçš„Sobolåºåˆ—æŠ½æ ·:
q = qrandstream('sobol', n, 'Skip', Num1, 'Leap', Num2);   % ä¸sobolsetæ•ˆæœæƒ³é€š
% å¯¹åº”ä½¿ç”¨netå’Œä¸‹æ ‡å–è¡Œéƒ½å¯ä»¥è¿”å›æŠ½æ ·çš„ç‚¹çš„åæ ‡æ•°å€¼;
X0 = qrand(q,N);  % qrand(q,4), ç”Ÿæˆæ ‡å‡†å‡åŒ€åˆ†å¸ƒçš„æ ·æœ¬
X = norminv(X0);  % é€šè¿‡åæ­£æ€å‡½æ•°**å°†å‡åŒ€åˆ†å¸ƒæ˜ å°„ä¸ºæ­£æ€åˆ†å¸ƒ**;
```

## äºŒã€æ±‚è§£å¤±æ•ˆæ¦‚ç‡çš„Monte Carloæ–¹æ³•ä¸æ”¶æ•›æ€§åˆ†æ
### (1) æ±‚è§£å•æ¨¡å¼å¤±æ•ˆæ¦‚ç‡çš„ Monte Carlo æ³•åŠå…¶æ”¶æ•›æ€§
é¦–å…ˆè®¾ç»“æ„çš„åŠŸèƒ½å‡½æ•°ä¸º: 
$$Y = g(X) = g(X_{1}, X_{2}, \dots X_{n})$$
å…¶å¤±æ•ˆæ¦‚ç‡ä¸º: 
$$P_{f} = \int_{F} f_{X}(x) dx  = \int_{R^{n}} I_{F} f(x) dx$$
å…¶ä¸­$f_{X}(x)$ æ˜¯è¾“å…¥éšæœºå˜é‡$X = \left\{ X_1, X_2\dots X_n \right\}$çš„è”åˆæ¦‚ç‡å¯†åº¦å‡½æ•°; æ˜¾ç„¶, å˜é‡ç›¸äº’ç‹¬ç«‹æ—¶, å‚è€ƒ[[ğŸ“˜ClassNotes/ğŸ“Mathmatics/ğŸ£Probability Theory/ç¬¬ä¸‰ç«  å¤šç»´éšæœºå˜é‡åŠå…¶åˆ†å¸ƒ#(1) ç‹¬ç«‹éšæœºå˜é‡|ç‹¬ç«‹éšæœºå˜é‡]], æœ‰$f_{X} (x)= \prod_{i=1}^{n} f_{X_{i}} (x_{i})$, å³ç­‰äº**æ¯ä¸ªè¾“å…¥å˜é‡çš„è¾¹ç¼˜æ¦‚ç‡å¯†åº¦å‡½æ•°çš„ä¹˜ç§¯**;  è€Œ$I_{F}$ æ˜¯<b><mark style="background: transparent; color: blue">å¤±æ•ˆåŸŸæŒ‡ç¤ºå‡½æ•°</mark></b>ï¼Œ å¹¶ä¸”æœ‰

> [!NOTE] å…¬å¼è¡¥å……
> å¯¹äºéšæœºå˜é‡å‡½æ•°çš„æ•°å­¦æœŸæœ›ï¼Œ æœ‰å…¬å¼:
> $$E[g(x)] =  \int_{\alpha}^{\beta} g(x) f(x) dx$$
> å…¶ä¸­$f(x)$ä¸º$x$çš„åˆ†å¸ƒå‡½æ•°ï¼Œ è¿™ä¸ªè¯æ˜å¯ä»¥å‚è€ƒ[[ğŸ“˜ClassNotes/ğŸ“Mathmatics/ğŸ£Probability Theory/ç¬¬å››ç«  éšæœºå˜é‡çš„æ•°å­—ç‰¹å¾#(2) å¸¸è§åˆ†å¸ƒä¸å˜é‡å‡½æ•°çš„æ•°å­¦æœŸæœ›|å‡½æ•°æ•°å­¦æœŸæœ›çš„æ€§è´¨]] ; 
> è¿™ä¸ªæ€§è´¨æ˜¯éå¸¸å¸¸ç”¨çš„ä¸€ä¸ªè½¬æ¢

æ˜¾ç„¶**å¤±æ•ˆæ¦‚ç‡çš„ä¼°è®¡å€¼**å¯ä»¥ä½¿ç”¨å¤±æ•ˆåŸŸæŒ‡ç¤ºå‡½æ•°çš„æ ·æœ¬å€¼è½å…¥å¤±æ•ˆåŸŸå†…çš„æ ·æœ¬ä¸ªæ•°ä¸æ€»æ ·æœ¬ä¸ªæ•°ä¹‹æ¯”è¡¨ç¤º; å…¶ä¸­$I_{F}$ä¸ºå¤±æ•ˆåŸŸæŒ‡ç¤ºå‡½æ•°, åœ¨ç‚¹ä½äºå¤±æ•ˆåŸŸæ—¶, $I_{F} = 1$, å¦åˆ™$I_{F} = 0$, å› æ­¤æ˜¾ç„¶æœ‰:
$$\hat{P}_{f} = \frac{1}{N} \sum^{n}_{j=1} I_{F} (x_{j}) = \frac{N_{F}}{N}\tag{3.2.1}$$
å…¶ä¸­$N_{F}$ä¸ºå¤±æ•ˆçš„ç‚¹çš„ä¸ªæ•°ã€‚å› æ­¤æˆ‘ä»¬åªéœ€æ±‚è§£å¤±æ•ˆæ¦‚ç‡æ•°å­¦æœŸæœ›å³å¯ã€‚ ä¸¤è¾¹æ±‚è§£æ•°å­¦æœŸæœ›å¾—åˆ°: 
$$E(\hat{P}_{f}) = E\left( \frac{1}{N} \sum^{n}_{j=1} I_{F} (x_{j}) \right) = \frac{1}{N}\sum^{n}_{i=1} E[I_{F}(x_{j})] =E[I_{F}(x)]  = P_{f}$$
å› æ­¤, è’™ç‰¹å¡æ´›æ–¹æ³•è·å–çš„**å¤±æ•ˆæ¦‚ç‡ä¼°è®¡å€¼æ˜¯å¤±æ•ˆæ¦‚ç‡çš„æ— åä¼°è®¡**; å¦å¤–ï¼Œ å¯¹(3.2.1)ä¸¤è¾¹**åŒæ—¶æ±‚è§£æ–¹å·®**ï¼Œå¹¶<mark style="background: transparent; color: red">ä½¿ç”¨æ ·æœ¬æ–¹å·®ä»£æ›¿æ€»ä½“æ–¹å·®ï¼Œ å¯ä»¥å¾—åˆ°</mark>(å‚è€ƒ[[ğŸ“˜ClassNotes/ğŸ‘¨â€ğŸ”§Mechanics/ğŸ–¥ï¸Computational_Mechanics/ğŸš§ç»“æ„å¯é æ€§è®¾è®¡åŸºç¡€/æ¨å¯¼éƒ¨åˆ†/è’™ç‰¹å¡æ´›æ³•çš„æ ·æœ¬æ–¹å·®è¡¨ç¤ºæ¨å¯¼.pdf|è’™ç‰¹å¡æ´›æ³•çš„æ ·æœ¬æ–¹å·®è¡¨ç¤ºæ¨å¯¼.pdf]]): 
$$V[\hat{P}_{f}] = V\left[\frac{1}{N}\sum^{n}_{i=1} I_{F} (x_{i}) \right] \overset{ç»è¿‡è®¡ç®—}{\longrightarrow} \approx \frac{(\hat{P}_{f} - \hat{P}_{f}^{2})}{N - 1}$$
è€Œå¯¹åº”çš„**å˜å¼‚ç³»æ•°**$Cov[\hat{P}_f]$å®šä¹‰ä¸º$E(\hat{P}_f^{(s)})$ä¸$\sqrt{V[\hat{P}_{f}^{(s)}] }$ çš„æ¯”å€¼, ä¸æ˜¯**åæ–¹å·®**, å®¹æ˜“ä½¿ç”¨ä¸Šå¼è®¡ç®—å¾—åˆ°: 
$$\text{Cov}[\hat{P}_{f}] = \frac{\sqrt{V[P_{f}]}}{E[\hat{P}_{f}]} \approx \sqrt{\frac{1- \hat{P}_{f}}{(N -  1) \hat{P}_{f}}}$$
### (2) å¤šæ¨¡å¼å¤±æ•ˆä¸‹å¤±æ•ˆæ¦‚ç‡æ±‚è§£çš„ Monte Carlo æ–¹æ³•ä»¥åŠæ”¶æ•›æ€§åˆ†æ 
æˆ‘ä»¬è€ƒè™‘ç³»ç»Ÿçš„å¤±æ•ˆåŸŸ$F^{(s)}$æœ‰å¤šä¸ªæ¨¡å¼å…±åŒå†³å®šçš„æƒ…å½¢ï¼Œ è®¾ç³»ç»Ÿæœ‰lä¸ªå¤±æ•ˆæ¨¡å¼ï¼Œ å¯¹çš„åŠŸèƒ½å‡½æ•°åˆ†ä¸º$g_k (X)$, åˆ™æ˜¾ç„¶æœ‰å¤±æ•ˆåŸŸè®¡ç®—å…¬å¼:
$$\begin{cases}
F_{s} = \cup_{k = 1}^{l} F_{k}  \qquad  \text{Series}\\
F_{s} = \cap_{k = 1}^{l} F_{k} \qquad  \text{Parallel}
\end{cases}$$
å…¶ä¸­$F_{k} = \left\{ x: g_{k} (x) \leq  0 \right\}$ 
å¯¹äºå¤šå¤±æ•ˆæ¨¡å¼æƒ…å†µä¸‹ï¼Œ å¯ä»¥å°†ç³»ç»Ÿçš„å¤±æ•ˆæ¦‚ç‡$P_f^{(s)}$è¡¨ç¤ºä¸º:
$$P_{f}^{(s)} = \int_{F^{(s)}} f_{X}(x) dx  = \int_{R^{n}} I_{F^{(s)}}(x)f_{X}(x) dx  = E [I_{F^{(s)}} (x)]$$
è¿™ä¸å•æ¨¡å¼å¤±æ•ˆåŸŸæƒ…å†µå®Œå…¨ç±»ä¼¼ï¼Œ åŒæ—¶ï¼Œ ä¹Ÿå¯ä»¥ä½¿ç”¨ $N_{F}/N$ è·å–æ ·æœ¬çš„å¤±æ•ˆæ¦‚ç‡:
$$E(\hat{P}_{f}^{(s)})= P_{f}^{(s)}\qquad V[\hat{P}_{f}^{(s)}] = \frac{(\hat{P}_{f}^{(s)} - \hat{P}_{f}^{(s)2})}{N - 1}\qquad \text{Cov}[\hat{P}_{f}^{(s)}] = \sqrt{\frac{1- \hat{P}_{f}^{(s)}}{(N -  1) \hat{P}_{f}^{(s)}}}$$
<b><mark style="background: transparent; color: blue">éœ€è¦æ³¨æ„</mark></b>: å…¶ä¸­ç¬¬ä¸‰é¡¹$Cov[\hat{P}_f]$ä¸º**å˜å¼‚ç³»æ•°**, å®é™…ä¸Šæ˜¯$E(\hat{P}_f^{(s)})$ä¸$\sqrt{V[\hat{P}_{f}^{(s)}] }$ çš„æ¯”å€¼, ä¸æ˜¯**åæ–¹å·®**; 
## ä¸‰ã€ æ±‚è§£å¯é æ€§å±€éƒ¨çµæ•åº¦çš„åˆ†æä¸æ”¶æ•›åˆ†æ
### (1) å±€éƒ¨å¯é æ€§çµæ•åº¦çš„è®¡ç®—å…¬å¼
å¯¹äºä½†å¤±æ•ˆæ¨¡å¼å’Œå¤šå¤±æ•ˆæ¨¡å¼æƒ…å†µä¸‹çš„å¯é æ€§å±€éƒ¨çµæ•åº¦åˆ†æï¼Œ å…¶**å±€éƒ¨å¯é æ€§çµæ•åº¦å®ç°åŸç†æ˜¯ä¸€è‡´çš„**; è€Œ Monte Carlo è§£æ³•åŸç†ä¹ŸåŸºæœ¬ä¸€è‡´;

é¦–å…ˆï¼Œ å¯é æ€§å±€éƒ¨çµæ•åº¦å®šä¹‰ä¸ºå¤±æ•ˆæ¦‚ç‡$P_f$ å¯¹è¾“å…¥éšæœºå˜é‡$X_i$çš„ç¬¬$k$ä¸ªåˆ†å¸ƒå‚æ•°$\theta_{X_{i}}^{(k)}$, å…¶ä¸­**i = 1,2, ... n, ä¸ºè¾“å…¥å˜é‡çš„ä¸ªæ•°**(å³è¾“å…¥å˜é‡ä¸ºnä¸ª), **å¯¹åº”åœ°, $k$ä¸ºåˆ†å¸ƒå‚æ•°, ä¸€èˆ¬æŒ‡ké˜¶çŸ© , å³k = 1æ—¶ä¸ºå‡å€¼, k = 2æ—¶ä¸ºæ–¹å·®**;
$$\frac{\partial P_{f}}{\partial \theta_{X_{i}}^{(k)}} = \frac{\partial \int_{F}f_{X}(x) dx}{\partial \theta_{X_{i}}^{(k)}} = \int_{F}\frac{\partial f_{X} (x)}{\partial \theta_{X_{i}}^{(k)}}dx = \int_{R^{n}} I_{F}\frac{\partial f_{X} (x)}{\partial \theta_{X_{i}}^{(k)}}dx$$
å…¶ä¸­$f_{X}(x)$ä¸º**è¾“å…¥å˜é‡çš„è”åˆæ¦‚ç‡å¯†åº¦å‡½æ•°**ï¼Œé€šè¿‡ä¸Šä¸‹é…å‡‘ä¸€ä¸ª$f_{X}(x)$, ä¸Šå¼**è½¬æ¢ä¸ºæœŸæœ›å½¢å¼**ä¸º:
$$\boxed{\frac{\partial \hat{P}_{f}}{\partial \theta_{X_{i}}^{(k)}} = E\left[ \frac{\partial P_{f}}{\partial \theta_{X_{i}}^{(k)}} \right]= E\left[ \frac{I_{F}(x)}{f_{X} (x)} \frac{\partial f_{X}(x)}{\partial \theta_{X_{i}}^{(k)}} \right] = \frac{1}{N} \sum^{n}_{j=1}\left[  \frac{I_{F}(x_{j})}{f_{X} (x_{j})} \frac{\partial f_{X}(x_{j})}{\partial \theta_{X_{i}}^{(k)}}\right] = \frac{\partial \hat{P}_{f}}{\partial \theta_{X_{i}}^{(k)}}\tag{3.3.1.1}}$$
å¦å¤–ï¼Œçµæ•åº¦çš„æ–¹å·®æ˜¾ç„¶å¯ä»¥è®¡ç®—ä¸º:
$$V\left[  \frac{\partial \hat{P}_{f}}{\partial \theta_{X_{i}}^{(k)}} \right] \approx \frac{1}{N -1}\left[\frac{1}{N} \sum^{n}_{j=1} \left(\frac{I_{F} (x_{j})}{f_{X}(x_{j})}  \cdot \frac{\partial f_{X}(x_{j})}{\partial \theta_{X_{i}}^{(k)}}\right)^{2} - \left( \frac{\partial P_{f}}{\partial \theta_{X_{i}}^{(k)}}\right)^{2}\right]\tag{3.3.1.2}$$
å¯¹åº”åœ°ï¼Œ **å˜å¼‚ç³»æ•°**ä¸º:
$$\text{Cov} \left[\frac{\partial \hat{P}_{f}}{\partial \theta_{X_{i}}^{(k)}}\right] = \frac{\sqrt{V\left[\frac{\partial \hat{P}_{f}}{\partial \theta_{X_{i}}^{(k)}}\right]}}{\left| E\left[\frac{\partial \hat{P}_{f}}{\partial \theta_{X_{i}}^{(k)}}\right]\right|} \qquad  (å…¬å¼ç•¥å»)\tag{3.3.1.3}$$
### (2) ç›¸äº’ç‹¬ç«‹çš„æ­£æ€éšæœºå˜é‡æƒ…å†µ
ç‰¹åˆ«åœ°ï¼Œ æˆ‘ä»¬è€ƒè™‘å¯¹äº n ç»´<b><mark style="background: transparent; color: blue">ç›¸äº’ç‹¬ç«‹çš„æ­£æ€éšæœºå˜é‡</mark></b>çš„æƒ…å†µï¼Œ**==è”åˆæ¦‚ç‡å¯†åº¦å‡½æ•°$f_{X}(x)$å¯ä»¥å†™æˆæ¯ä¸ªè¾“å…¥å˜é‡çš„æ¦‚ç‡å¯†åº¦$f_{X_{i}}(x_{i}) (i = 1, 2, \dots  n)$çš„ä¹˜ç§¯==**; ä¸”$\theta_{X_{i}}^{(k)}$ä»…å’Œå¯¹åº”çš„æ¦‚ç‡å¯†åº¦$f_{X_{i}}(x_{i})$æœ‰å…³(å¯¹å…¶ä»–å˜é‡æ— å…³); åˆ™æ­¤æ—¶å¯é æ€§å±€éƒ¨çµæ•åº¦çš„ä¼°è®¡å€¼(å¼(3.3.1))å¯ä»¥æ”¹å†™ä¸º:
$$\frac{\partial \hat{P}_{f}}{\partial \theta_{X_{i}}^{(k)}}= \frac{1}{N}\sum^{n}_{j=1} \left\{\frac{I_{F}(x_{j})}{f_{X_{i}} (x_{ji})}\cdot  \frac{\partial f_{X_{i}}(x_{ji})}{\partial \theta_{X_{i}}^{(k)} } \right\}\tag{3.1.2}$$
éœ€è¦è¯´æ˜çš„æ˜¯ï¼Œ ç”±äºä»…å’Œ$f_{X_{i}}(x_{i})$æœ‰å…³, å–$x_{ji}$ä¸ºç¬¬$i$ä¸ªå˜é‡çš„ç¬¬$j$ä¸ªæ ·æœ¬;
é¦–å…ˆï¼Œ æˆ‘ä»¬å‡è®¾ $X_{i} \sim N(\mu_{X_{i}}, \sigma_{X_{i}}^{2})(i = 1, 2, \dots n)$, åˆ™ç»è¿‡[[ğŸ“˜ClassNotes/ğŸ‘¨â€ğŸ”§Mechanics/ğŸ–¥ï¸Computational_Mechanics/ğŸš§ç»“æ„å¯é æ€§è®¾è®¡åŸºç¡€/æ¨å¯¼éƒ¨åˆ†/å‡å€¼ä¸æ–¹å·®å±€éƒ¨çµæ•åº¦ä¼°è®¡.pdf|å‡å€¼ä¸æ–¹å·®å±€éƒ¨çµæ•åº¦ä¼°è®¡.pdf]]å¯ä»¥å¾—åˆ°:
$$\frac{1}{f_{X_{i}}(x_{ji})} \cdot \frac{\partial f_{X_{i}}(x_{ji})}{\partial \mu_{X_{i}}} = \frac{x_{ji} - \mu_{X_{i}}}{\sigma_{X_{i}}^{2}}\tag{1}$$
ä»¥åŠ
$$\frac{1}{f_{X_{i}}(x_{ji})} \cdot \frac{\partial f_{X_{i}}}{\partial \sigma_{X_{i}}}  = \frac{1}{\sigma_{X_{i}}}\left[\left(\frac{X_{ji} - \mu_{X_{i}}}{\sigma_{X_{i}}}\right)^{2} - 1 \right]\tag{2}$$
ä»£å…¥å¾—åˆ°<b><mark style="background: transparent; color: blue">å¯é æ€§å±€éƒ¨å‡å€¼çµæ•åº¦å’Œå¯é æ€§å±€éƒ¨æ–¹å·®çµæ•åº¦çš„è®¡ç®—å…¬å¼</mark></b>ä¸º:
$$\Large\boxed{\frac{\partial \hat{P}_{f}}{\partial \mu_{X_{i}}} = \frac{1}{N}\sum^{N}_{j=1}\left[ I_{F}(x_{j})\cdot\frac{x_{ji}- \mu_{X_{i}}}{\sigma_{X_{i}}^{2}}\right] }\tag{3.3.3}$$
$$\Large\boxed{\frac{\partial \hat{P}_{f}}{\partial \sigma_{X_{i}}} = \frac{1}{N}\sum^{N}_{i=1}\left\{ I_{F}(x_{j}) \cdot \frac{1}{\sigma_{X_{i}}}\left[ \left(\frac{x_{ji} - \mu_{X_{i}}}{\sigma_{X_{i}}} \right)^{2} - 1\right]\right\} }\tag{3.3.4}$$
å› æ­¤å¯ä»¥ç›´æ¥åˆ©ç”¨ä¼°è®¡**å¤±æ•ˆæ¦‚ç‡æ ·æœ¬ç‚¹ä¼°è®¡å¤„å¯é æ€§å±€éƒ¨çµæ•åº¦**, å¯ä»¥ç›´æ¥è·å–å¯é æ€§å±€çµæ•åº¦çš„ä¼°è®¡å€¼ã€‚
### (3) å°è£…å‡½æ•°
ä½¿ç”¨å¦‚ä¸‹çš„å°è£…å‡½æ•°å¯ä»¥æ–¹ä¾¿åœ°æ±‚è§£å¤±æ•ˆæ¦‚ç‡:
```matlab
function  [Pf, Pf_mu, Pf_sigma] = MCS_solu(mu_, sigma_, g, num_MCS)
% å…¶ä¸­ Pf_mu, Pf_sigma ä»…å¯¹ç›¸äº’ç‹¬ç«‹çš„æ­£æ€å˜é‡æ±‚è§£æœ‰æ•ˆ
sigma_d = sqrt(diag(sigma_))';
if (nargin == 3)
    num_MCS = 1e7;
end
n = size(mu_, 2);
xp = lhsnorm(mu_, sigma_, num_MCS,"on");
fail_points = find(g(xp) < 0);
fail_xp = xp(fail_points,:);

Pf = size(fail_points, 1)/num_MCS;
% Pf_Sigma = sqrt((Pf - Pf^2)/(num_MCS -1));
% Pf_Cov = Pf - Pf_Sigma;

z_i = (fail_xp - mu_)./sigma_d;
Pf_mu = sum(z_i ./ sigma_d) /num_MCS;
Pf_sigma = sum((z_i.^2 - 1) ./ sigma_d)/num_MCS;
end
```

## å››ã€æ­£æ€ç›¸å…³å˜é‡ä¸‹çš„å¯é æ–°ä½™å¯é æ€§å±€éƒ¨çµæ•åº¦çš„è®¡ç®—æ–¹æ³•
ç”±äºå®é™…æƒ…å†µä¸‹ï¼Œ å„ä¸ªè¾“å…¥å˜é‡å¾€å¾€æ˜¯ç›¸å…³çš„,  å³å…·æœ‰å¯¹åº”çš„ç›¸å…³ç³»æ•°ï¼Œ è€Œè¿™ä¼šå¯¹æœºæ„çš„å¯é æ€§äº§ç”Ÿé‡è¦çš„å½±å“; 
å¯¹äºè¿™ç§æƒ…å†µä¸‹ï¼Œ å¾€å¾€**ä½¿ç”¨Monte Carlo ç›´æ¥æ–¹æ³•å’ŒMonte Carlo è½¬æ¢æ³•ä¸¤ç§æ–¹æ³•è¿›è¡Œæ±‚è§£**;

> [!NOTE] æ³¨æ„
> è¿™é‡Œä¸åŸè¯¾æœ¬ä¸Šå…¬å¼ä¸åŒ, åšäº†éƒ¨åˆ†ä¿®æ”¹
### (1) æ­£æ€å˜é‡çš„ç‹¬ç«‹è½¬æ¢
é¦–å…ˆæ¨å¹¿$n$ç»´æ­£æ€åˆ†å¸ƒçš„ä¸€èˆ¬æƒ…å†µ:
æˆ‘ä»¬è€ƒè™‘**éæ ‡å‡†ç›¸å…³æ­£æ€è¾“å…¥å˜é‡**ä¸º$X= [X_1, X_2, \dots X_n]^T$, å¹¶è®¾æ¯ä¸ªå˜é‡å‡æœä»æ­£æ€åˆ†å¸ƒ$(\mu_{X_{i}},\sigma_{X_{i}})$åˆ™æœ‰$X$çš„<b><mark style="background: transparent; color: red">è”åˆæ¦‚ç‡å¯†åº¦å‡½æ•°</mark></b>å¯ä»¥ä½¿ç”¨ä¸‹å¼è¿›è¡Œè®¡ç®—:
$$\boxed{\large f_{X}(x) = (2\pi )^{- \frac{n}{2}} \left|C_{x}\right|^{-\frac{1}{2}} \exp \left[- \frac{1}{2}(x - \mu_{X})^{T}C_{X}^{-1}(x- \mu_{X}) \right]}\tag{3.4.1}$$
å…¶ä¸­$C_{x}$ä¸ºX çš„åæ–¹å·®çŸ©é˜µ, è€Œ$C_{x}^{-1}$ä¸ºé€†çŸ©é˜µ, å³ä¸ºå¯¹ç§°çš„å¯¹è§’çŸ©é˜µ;
$$C_{X} = \left[\begin{matrix}
 \sigma_{X_{1}}^{2}   & \rho_{X_{1}, X_{2}}\sigma_{X_{1}}\sigma_{X_{2}} & \dots &  \rho_{X_{1}, X_{n}\sigma_{X_{1}}\sigma_{X_{n}}}  \\ 
 \rho_{X_{2}, X_{1}}\sigma_{X_{1}}\sigma_{X_{2}} & \sigma_{X_{2}}^{2} &  & \vdots \\ 
 && \ddots & \vdots \\ 
 & \dots   & & \sigma_{X_{n}}^{2}
\end{matrix}\right]$$
å…¶ä¸­ $\rho$ ä¸ºå¯¹åº”çš„ç›¸å…³ç³»æ•°; 
æˆ‘ä»¬å–ä¸€ä¸ªçº¿æ€§çš„å˜æ¢$Y = A X + b$, å…¶ä¸­$X, b$å‡ä¸ºåˆ—å‘é‡, å…¶å‡å€¼å’Œåæ–¹å·®é˜µ(å‚è€ƒ[[ğŸ“˜ClassNotes/ğŸ“Mathmatics/ğŸ£Probability Theory/ç¬¬å››ç«  éšæœºå˜é‡çš„æ•°å­—ç‰¹å¾#(2) åæ–¹å·®çŸ©é˜µ|åæ–¹å·®çŸ©é˜µ]], æœ‰$C_{X} = E[(X - \mu_{X})(X - \mu_{X})^{T}]$)å˜ä¸º(å‚è€ƒ[[ğŸ“˜ClassNotes/ğŸ‘¨â€ğŸ”§Mechanics/ğŸ–¥ï¸Computational_Mechanics/ğŸš§ç»“æ„å¯é æ€§è®¾è®¡åŸºç¡€/æ¨å¯¼éƒ¨åˆ†/ç›¸å…³å˜é‡ä¸‹è½¬æ¢ä¸ºç‹¬ç«‹å˜é‡çš„å…¬å¼æ¨å¯¼.pdf|ç›¸å…³å˜é‡ä¸‹è½¬æ¢ä¸ºç‹¬ç«‹å˜é‡çš„å…¬å¼æ¨å¯¼.pdf]]): 
$$\mu_{Y}  = A\mu_{X} + b \qquad  C_{Y } = A C_{X} A^{T}$$
å‚è€ƒ[[ğŸ“˜ClassNotes/ğŸ“Mathmatics/ğŸ“linear algebra/ç¬¬äº”ç«  çŸ©é˜µçš„ç›¸ä¼¼å˜æ¢#å››ã€æ­£äº¤çŸ©é˜µ|æ­£äº¤çŸ©é˜µ]], æˆ‘ä»¬æ˜¾ç„¶æœ‰**çŸ©é˜µçš„æ­£äº¤åˆ†è§£**, å¿…ç„¶å­˜åœ¨ä¸€ä¸ªæ­£äº¤çŸ©é˜µä½¿å¾—:
$$C_{Y} = Q^{T}C_{X}Q$$
å…¶ä¸­$C_{Y} = \text{diag}\left\{ \lambda_{1} , \lambda_{2}, \dots  \lambda_{n} \right\}$;å…¶ä¸­$\left\{ \lambda_{1} , \lambda_{2}, \dots  \lambda_{n} \right\}$ä¸ºç‰¹å¾æ ¹, **æ˜¾ç„¶å–$A^{T} = Q$æ—¶$Y$çš„åæ–¹å·®çŸ©é˜µæ˜¯ä¸ªå¯¹è§’çŸ©é˜µ**, ä¸”æ ¹æ®æ­£äº¤æœ‰å…³ç³»:
$$\Large\boxed{C_{X} = A^T C_{Y} A}$$
å› æ­¤**æˆ‘ä»¬åªéœ€è°ƒç”¨MATLABä¸­çš„`eig`å‡½æ•°å°†çŸ©é˜µå…¶è¿›è¡Œæ­£äº¤åˆ†è§£**å³å¯å¾—åˆ°$A$å’Œ$C_Y$; å¹¶ä¸”å–$\mu_{Y} = 0$æ—¶, åˆ™æœ‰$b = -A\mu_{X}$; 
$$\Large \boxed{Y = A (X - \mu_{X})\qquad X = A^{T} Y + \mu_{X}}\tag{3.4.2}$$
> [!caution] æ³¨æ„
> åœ¨MATLABä¸­ï¼Œä½¿ç”¨eigå‡½æ•°å¾—åˆ°çš„æ˜¯ $A = V * D * V^T$, å› æ­¤éœ€è¦å°†ç»“æœè¿›è¡Œè½¬ç½®;

æ­¤æ—¶, æˆ‘ä»¬å¯ä»¥å…ˆä½¿ç”¨$Y$æ±‚è§£å‡ºæ¦‚ç‡å¯†åº¦$f_{Y}(y)$, ç„¶åå˜æ¢æˆä¸º$X$, å‚è€ƒ[[ğŸ“˜ClassNotes/ğŸ“Mathmatics/ğŸ£Probability Theory/ç¬¬äºŒç«  éšæœºå˜é‡åŠå…¶åˆ†å¸ƒ#ä¸‰ã€éšæœºå˜é‡å‡½æ•°çš„åˆ†å¸ƒè®¡ç®—|éšæœºå˜é‡å‡½æ•°çš„åˆ†å¸ƒè®¡ç®—]], åˆ™ç”±äº$\left|A^{T} \right| = \left| A^{-1}\right| = \frac{1}{|A|}$,ä¸Šå¼å˜æ¢ä¸º:
$$\Large\boxed{f_{Y}(y) = f_{X} (A^{T}y + \mu_{X}) \cdot |A|^{-1}}\tag{3.4.3}$$
### (2) ç›¸å…³å˜é‡åˆ†æå’Œå¯é æ€§å±€éƒ¨çµæ•åº¦åˆ†æçš„Monte Carloç›´æ¥æ³•
ç›´æ¥æ³•æ±‚è§£**ç›¸å…³æ­£æ€å˜é‡çš„æƒ…å†µä¸‹å¤±æ•ˆæ¦‚ç‡**ä»¥åŠå¯é å±€éƒ¨çµæ•åŸç†å’Œè¾“å…¥å˜é‡ç‹¬ç«‹çš„æƒ…å†µç±»ä¼¼; ä½¿ç”¨ç›¸å…³æ­£æ€å˜é‡çš„è”åˆæ¦‚ç‡å¯†åº¦å‡½æ•°ä»£æ›¿ç‹¬è¾“å…¥å˜é‡çš„ä¼°è®¡(åŒ3.3.1), å¾—åˆ°å¯é æ€§å±€éƒ¨çµæ•åº¦çš„ä¼°è®¡å¼:
$$\frac{\partial \hat{P}_{f}}{\partial \theta_{X_{i}}^{(k)}} = \frac{1}{N}\sum^{n}_{l=1}\left[\frac{I_{F}(x_{l})}{f_{X}(x_{l})}\cdot  \frac{\partial f_{X}(x_{l})}{\partial \theta_{X_{i}}^{(k)}}\right]\tag{3.4.4}$$
æ­¤æ—¶ï¼Œ é’ˆå¯¹æ­£æ€è¾“å…¥å˜é‡çš„è”åˆæ¦‚ç‡å¯†åº¦å‡½æ•°, ç›¸å¯¹äº[[#(2) ç›¸äº’ç‹¬ç«‹çš„æ­£æ€éšæœºå˜é‡æƒ…å†µ]], åˆ™æœ‰(å…¶ä¸­$x_{l}$ä¸ºè¡Œå‘é‡, å¯¹åº”$x$ä¸­ç¬¬$l$ä¸ªæ ·æœ¬çš„ç¬¬$s$è¡Œ): 
$$\frac{1}{f_{X}(x_{l})}\cdot \frac{\partial f_{X}(x_{l})}{\partial \mu_{X_{i}}} = \sum^{n}_{i=1}(C_{X})_{si}^{-1}(x_{ls} - \mu_{X_{s}})\tag{1}$$
$$\frac{1}{f_{X_{i}}(x_{l})}\frac{\partial f_{X} (x_{l})}{\partial \sigma_{X_{i}}}  = - \frac{1}{2}\left[(x_{l} - \mu_{X})\frac{\partial C_{X}^{-1}}{\partial \sigma_{X_{i}}} (x_{i} - \mu_{X})^{T} +  \frac{1}{|C_{X}|}\frac{\partial |C_{X}|}{\partial \sigma_{X_{i}}} \right]\tag{2}$$
$$\frac{1}{f_{X_{i}}(x_{l})} \frac{\partial f_{X}(x_{l})}{\partial \rho_{X_{i}X_{j}}} = -\frac{1}{2} \left[(x_{l} - \mu_{X})\frac{\partial C_{X}^{-1}}{\partial \rho_{X_{i} X_{j}}}(x_{l} - \mu_{X})^{T} + \frac{1}{|C_{X}|}\frac{\partial |C_{X}|}{\partial \rho_{X_{i} X_{j}}} \right]\tag{3}$$
æˆ‘ä»¬å–$x_{ls}$ä¸ºç¬¬ $l$ ä¸ªæ ·æœ¬çš„ç¬¬ $s$ ç»´å…ƒç´ (çŸ©é˜µä¸­å³ä¸º$x_{ls}$), å°†ä»¥ä¸Šä¸‰å¼ä»£å…¥å¼(3.4.4)ä¸­å¯ä»¥è·å¾—å¯¹åº”çš„å¯¹å‡å€¼ï¼Œ æ–¹å·®ä»¥åŠç›¸å…³ç³»æ•°çš„çµæ•åº¦(å¼å­ç•¥å»);

å¯¹äº**ç›¸å…³çš„æ­£æ€å˜é‡**ï¼Œ éš¾ä»¥è§£ææ¨å¯¼Monte Carlo æ–¹æ³•å¾—åˆ°çš„å¤±æ•ˆæ¦‚ç‡ä»¥åŠå¯é æ€§å±€éƒ¨çµæ•åº¦çš„ä¼°è®¡å€¼çš„å‡å€¼ï¼Œ æ–¹å·®å’Œå˜å¼‚ç³»æ•°ï¼›ä»è€Œæˆ‘ä»¬ä½¿ç”¨å¤šæ¬¡é‡å¤åˆ†ææ–¹æ³•æ±‚è§£å¯é æ€§ä¸**å¯é æ€§å±€éƒ¨çµæ•åº¦ä¼°è®¡å€¼**çš„æ”¶æ•›æ€§;  å…¶åŸºæœ¬æ–¹æ³•æ˜¯å…ˆè¯•ç”¨Monte Carloç›´æ¥æ³•æ±‚è§£å¾—åˆ°è¯•ä¸‹æ¦‚ç‡çš„$m$ä¸ªä¼°è®¡å€¼$\hat{P}_{f}^{(j)}$, ä»è€Œå†ä½¿ç”¨æ ·æœ¬ç‰¹å¾ä»£æ›¿æ€»ä½“ç‰¹å¾æ±‚è§£å¯¹åº”çš„å¤±æ•ˆæ¦‚ç‡ä¼°è®¡å€¼ç‰¹å¾; 
$$E[\hat{P}_{f}] \approx  \frac{1}{m} \sum^{n}_{j=1} \hat{P}_{f}^{(j)}$$
$$V[\hat{P}_{f}] \approx  \frac{1}{m-1}\left(\sum^{m}_{j=1} (\hat{P}_{f}^{(j)})^{2} - m \left[\frac{1}{m}\sum^{m}_{j=1} \hat{P}_{f}^{(j)} \right]^{2} \right)$$
$$\text{Cov}[\hat{P}_{f}] = \sqrt{V[\hat{P}_{f}]}/E[\hat{P}_{f}]$$
å…¶ä¸­ï¼Œ å¯ä»¥é€šè¿‡ç›´æ¥æ›¿æ¢$\hat{P}_{f}$ä¸º$\frac{\partial \hat{P}_{f}}{\partial \theta_{X_{i}}^{(k)}}$æ±‚è§£çµæ•åº¦ä¼°è®¡å€¼;

### (3) ç›¸å…³æ­£æ€å˜é‡çš„å¯é æ€§ä¸å¯é æ€§å±€éƒ¨çµæ•åº¦åˆ†æçš„Monte Carlo è½¬æ¢æ³•
é¦–å…ˆï¼Œå°†ç›¸å…³çš„æ­£æ€å˜é‡è½¬æ¢ä¸ºç‹¬ç«‹çš„æ­£æ€å˜é‡ï¼Œ å‚è€ƒ[[#(1) æ­£æ€å˜é‡çš„ç‹¬ç«‹è½¬æ¢]]éƒ¨åˆ†å³å¯; å‡è®¾ç›¸å…³çš„æ­£æ€å˜é‡ä¸º , è€Œå¯¹åº”çš„ç‹¬ç«‹æ­£æ€å˜é‡ä¸ºY, **é¦–å…ˆå¯ä»¥åœ¨è½¬æ¢ä¹‹åçš„ç‹¬ç«‹æ­£æ€ç©ºé—´ä¸­æ±‚è§£å¾—åˆ°ç‹¬ç«‹æ­£æ€å˜é‡æƒ…å†µçš„å±€éƒ¨çµæ•åº¦ä¼°è®¡å€¼**; ç„¶åæŒ‰ç…§å¤åˆæ±‚å¯¼æ³•åˆ™è½¬æ¢åˆ°X ç©ºé—´ä¸­ï¼Œå¯ä»¥å¾—åˆ°æ­£æ€å˜é‡æƒ…å†µä¸‹çš„å¯é æ€§å±€éƒ¨çµæ•ä¼°è®¡å€¼; 

é¦–å…ˆè®¾y çš„æ¦‚ç‡å¯†åº¦å‡½æ•°$f_{Y}(y)$ä¸º:
$$f_{Y} (y) = (2\pi)^{-\frac{n}{2}} |C_{Y}|^{- \frac{1}{2}} \exp \left(-\frac{1}{2} y^{T} c_{Y}^{-1} y\right)$$
å…¶ä¸­$C_Y$ä¸º**å¯¹è§’çŸ©é˜µ**; æ­¤æ—¶æ ¹æ®ä¸Šå¼æ±‚è§£å¾—åˆ°æ­£æ€å˜é‡çš„å¯é æ€§å±€éƒ¨çµæ•åº¦ä¼°è®¡å€¼ä¸º:
$$\frac{\partial \hat{P}_{f}}{\partial \theta_{Y}^{(k)}} = \frac{1}{N} \sum^{n}_{l=1} \left[  \frac{I_{F}(y_{l})}{f_{Y} (y_{l})} \frac{\partial f_{Y}(y_{l})}{\partial \theta_{Y_{i}}^{(k)}}\right]\tag{3.4.5}$$
<mark style="background: transparent; color: red">å…·ä½“å‡å€¼ï¼Œ æ–¹å·®å’Œæ ‡å‡†å·®çµæ•åº¦</mark>è®¡ç®—ä¸[[#(2) ç›¸äº’ç‹¬ç«‹çš„æ­£æ€éšæœºå˜é‡æƒ…å†µ]]ç»™å‡ºçš„(1), (2)å®Œå…¨ç›¸åŒ, ç›¸å…³ç³»æ•°çš„åå¯¼æ•°è®¡ç®—ç”±ä¸‹å¼ç»™å‡º:
$$\boxed {\frac{1}{f_{Y}(y_{l})}\frac{\partial f_{Y}(y_{l})}{\partial \rho_{Y_{i} Y_{j}}} = -\frac{1}{2}\left[(y_{l} - \mu_{Y})^{T} \frac{\partial C_{Y}^{-1}}{\partial \rho_{Y_{i}Y_{j}}} + \frac{1}{|C_{Y}|} \frac{\partial |C_{Y}|}{\partial \rho_{Y_{i} Y_{j}}} \right]}$$
å…¶ä¸­$Y$ä¸ºåˆ—å‘é‡, è€Œ$\mu_{Y}$ä¸ºå¯¹åº”çš„å‡å€¼(æ¯ä¸ªå‡å‡å»), å¦‚æœæ˜¯æ ‡å‡†æ­£æ€ç©ºé—´, åˆ™$\mu_Y = 0$

æ­¤æ—¶ï¼Œ å¯¹äºå˜é‡$Y$çš„å±€éƒ¨å¯é æ€§çµæ•åº¦å¯ä»¥æŒ‰ç…§(3.3.1-1åˆ°3.3.1-3)è®¡ç®—, å‚è€ƒ[[#(1) å±€éƒ¨å¯é æ€§çµæ•åº¦çš„è®¡ç®—å…¬å¼]];
æ ¹æ®å˜é‡$X$å’Œ$Y$çš„è½¬æ¢å…¬å¼$Y = AX + b$, åˆ™æœ‰å¯é æ€§å±€éƒ¨çµæ•åº¦ä¼°è®¡å€¼çš„å…¬å¼:
$$\frac{\partial \hat{P}_{f}}{\partial \mu_{X_{i}}} = \sum^{n}_{s=1} \left( \frac{\partial \hat{P}_{f}}{\partial \mu_{Y_{s}} }\frac{\partial \mu_{Y_{s}}}{\partial \mu_{X_{i}}} +\frac{\partial \hat{P}_{f}}{\partial \sigma_{Y_{s}}} \frac{\partial \sigma_{Y_{s}}}{\partial \mu_{X_{i}}}\right) + \sum^{n}_{s=1} \sum^{n}_{\begin{matrix}
r = 1 \\ r \neq s
\end{matrix}} \frac{\partial \hat{P}_{f}}{\partial \rho_{Y_{s}Y_{r}}} \frac{\partial \rho_{Y_{s} Y_{r}}}{\partial \mu_{X_{i}}}\tag{3.4.6-1}$$
$$\frac{\partial \hat{P}_{f}}{\partial \sigma_{X_{i}}} = \sum^{n}_{s=1} \left(\frac{\partial \hat{P}_{f}}{\partial \mu_{Y_{s}} }\frac{\partial \mu_{Y_{s}}}{\partial \sigma_{X_{i}}} +\frac{\partial \hat{P}_{f}}{\partial \sigma_{Y_{s}}} \frac{\partial \sigma_{Y_{s}}}{\partial \sigma_{X_{i}}}\right) + \sum^{n}_{s=1} \sum^{n}_{\begin{matrix}
r = 1 \\ r \neq s
\end{matrix}} \frac{\partial \hat{P}_{f}}{\partial \rho_{Y_{s}Y_{r}}} \frac{\partial \rho_{Y_{s} Y_{r}}}{\partial \sigma_{X_{i}}}\tag{3.4.6-2}$$
$$\frac{\partial \hat{P}_{f}}{\partial \rho_{X_{i}X_{j}}} = \sum^{n}_{s=1} \left(\frac{\partial \hat{P}_{f}}{\partial \mu_{Y_{s}} }\frac{\partial \mu_{Y_{s}}}{\partial \rho_{X_{i}X_{j}}} +\frac{\partial \hat{P}_{f}}{\partial \sigma_{Y_{s}}} \frac{\partial \sigma_{Y_{s}}}{\partial \rho_{X_{i}X_{j}}}\right) + \sum^{n}_{s=1} \sum^{n}_{\begin{matrix}
r = 1 \\ r \neq s
\end{matrix}} \frac{\partial \hat{P}_{f}}{\partial \rho_{Y_{s}Y_{r}}} \frac{\partial \rho_{Y_{s} Y_{r}}}{\partial \rho_{X_{i}X_{j}}}\tag{3.4.6-3}$$
æˆ‘ä»¬å‚è€ƒ[[#(1) æ­£æ€å˜é‡çš„ç‹¬ç«‹è½¬æ¢]], åˆ™æˆ‘ä»¬å½“å–$Y = A(X - \mu_{X})$ æ—¶, åˆ™æœ‰:
$$Y_{s} = a_{s1}x_{1} + a_{s2} x_{2} + \dots  + a_{sn} x_{n} + a_{s0}$$
$$Y_{r} = a_{r1} x_{1} + a_{r2}x_{2} + \dots  + a_{rn} x_{n} + a_{r0}$$
å…¶ä¸­å–$a_{s0} = - \sum^{n}_{k=1} a_{sk} \mu_k$, $a_{r0}$åŒç†; å¯¹åº”å‡å€¼å’Œæ–¹å·®æ˜¾ç„¶å¯ä»¥å‚è€ƒ[[ğŸ“˜ClassNotes/ğŸ‘¨â€ğŸ”§Mechanics/ğŸ–¥ï¸Computational_Mechanics/ğŸš§ç»“æ„å¯é æ€§è®¾è®¡åŸºç¡€/æ¨å¯¼éƒ¨åˆ†/ç›¸å…³å˜é‡ä¸‹è½¬æ¢ä¸ºç‹¬ç«‹å˜é‡çš„å…¬å¼æ¨å¯¼.pdf|ç›¸å…³å˜é‡ä¸‹è½¬æ¢ä¸ºç‹¬ç«‹å˜é‡çš„å…¬å¼æ¨å¯¼.pdf]]ä¸º:
$$\Large\boxed{\mu_{Y_{s}} = \sum^{n}_{k=1} a_{sk}\mu_{Xk} + a_{s0} = 0}\tag{3.4.7}$$
åŒæ—¶ç”±$c_{Y, ss} = \sum^{n}_{k=1} \sum^{n}_{l=1} a_{sk} c_{X, kl}a_{sl}$å¾—åˆ°ç¬¬sè¡Œæ•°æ®: 
$$\boxed{\Large \sigma_{Y_{s}}^{2} = \sum^{n}_{k=1} a_{sk}^{2} \sigma_{X_{k}}^{2} + \sum^{n}_{k=1}\sum^{n}_{l=1(l\neq k)}a_{sk} a_{sl} \rho_{X_{k} X_{l}} \sigma_{X_{k}} \sigma_{X_{l}}}\tag{3.4.8}$$

> [!NOTE] æ³¨æ„
> ä¸Šé¢çš„ä¸¤å¼è¡¨è¾¾äº†$\mu_{Y}, \sigma_{Y}$ å’Œ$\mu_X, \sigma_X, \rho_{X_{ij}}$çš„å…³ç³»

å› æ­¤æœ‰(ä¸‹å›¾ä¸­$b$å®é™…ä¸Šæ˜¯$a$): 
![[attachments/Pasted image 20240304105758.png]]
$$\Large\frac{\partial \sigma_{Y_{s}}}{\partial \sigma_{X_{i}}} = a_{si}^{2} + \frac{1}{\sigma_{Y_{i}}}\sum^{n}_{l=1}  a_{si} a_{sl} \rho_{X_{i} X_{l}} \sigma_{X_{l}} =  A^{2} \cdot   \mathcal{R} \cdot  $$

è€Œå¯¹äº$\rho_{Y_{s} Y_{r}}$å¯¹äºå„é¡¹çš„åå¯¼æ•°, å¯ä»¥å‚è€ƒè¯¾æœ¬ä¸Šçš„æ¨å¯¼è¿‡ç¨‹; 
åœ¨æ±‚è§£å‡ºæ¯ä¸€é¡¹åå¯¼æ•°ä¹‹åï¼Œ ä»£å…¥ä»¥ä¸‹å…¬å¼ : 
$$\frac{\partial \hat{P}_{f}}{\partial \mu_{X_{i}}} = \sum^{n}_{s=1} \frac{\partial \hat{P}_{f}}{\partial \mu_{Y_{s}}}\frac{\partial \mu_{Y_{s}}}{\partial \mu_{X_{i}}} = \sum^{n}_{s=1} \left.\frac{\partial \hat{P}_{f}}{\partial \mu_{Y}} \right|_{s} a_{si}\tag{3.4.10-1}$$
$$\frac{\partial \hat{P}_{f}}{\partial \sigma_{X_{i}}} = \sum^{n}_{s=1} \frac{\partial \hat{P}_{f}}{\partial \sigma_{Y_{s}}} \frac{\partial \sigma_{Y_{s}}}{\partial \sigma_{X_{i}}}  + \sum^{n}_{s=1} \sum^{n}_{r=1(r\neq s)} \frac{\partial \hat{P}_{f}}{\partial \rho_{Y_{s} Y_{r}}} \frac{\partial \rho_{Y_{s} Y_{r}}}{\partial \sigma_{X_{i}}}\tag{3.4.10-2}$$
$$\frac{\partial \hat{P}_{f}}{\partial \rho_{X_{i} X_{j}}} = \sum^{n}_{s=1} \frac{\partial \hat{P}_{f}}{\partial \sigma_{Y_{s} }}\frac{\partial \sigma_{Y_{s}}}{\partial \rho_{X_{i}X_{j}}} + \sum^{n}_{s=1}\sum^{n}_{r=1(r\neq s)} \frac{\partial \hat{P}_{f}}{\partial \rho_{Y_{s} Y_{r}} }\frac{\partial \rho_{Y_{s} Y_{r}}}{\partial \rho_{X_{i} X_{j}}} \tag{3.4.10-3}$$
å¦å¤–é™„ä¸Šæ±‚è§£çŸ©é˜µå¯¹æŸä¸ªæ–¹å·®æˆ–è€…åå¯¼æ•°çš„ä»£ç :

ä¸ºäº†åœ¨ç¼–ç¨‹ä¸­è¿›è¡Œç»Ÿä¸€ï¼Œ æˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªå˜é‡$Pf\_D$å­˜å‚¨å¯¹æ¯ä¸ªæ–¹å·®ä¸ç›¸å…³ç³»æ•°çš„å¯¼æ•°, ä¸‹é¢è®°ä¸º$P_{DY}$;
```erlang
Pf_D =
   0.001242025511472  -0.002343954296165
  -0.002343954296165   0.007350514612379
```

æˆ‘ä»¬å–å½’ä¸€åŒ–ç›¸å…³ç³»æ•°çŸ©é˜µ(æ–œå¯¹è§’ä¸º1, è€Œå…¶ä½™éƒ¨åˆ†ä¸ºæ¯ä¸€é¡¹ç›¸å…³ç³»æ•°çŸ©é˜µ)ä¸º$\mathcal{R}$,  è€Œ$A_{s}$è¡¨ç¤º$A$çŸ©é˜µä¸­çš„ç¬¬$s$è¡Œ, $A_{,s}$ä¸ºç¬¬såˆ—, åˆ™ä¸Šå¼å¯ä»¥è¡¨ç¤ºä¸º: 
$$\boldsymbol{P}_{\mu_{X}} = A_{,s}\cdot\boldsymbol{P}_{\mu_{Y}} $$
è€Œæˆ‘ä»¬å¦å¤–ä½¿ç”¨ä¸€ä¸ª $P_{RXY}$å­˜å‚¨æ¯ä¸ª$Y$ä¸­æ–¹å·®ä»¥åŠç›¸å…³ç³»æ•°å¯¹$X$ä¸­æ–¹å·®å’Œç›¸å…³ç³»æ•°çš„å¯¼æ•°ï¼Œ åˆ™$\mathcal{R}_{XY}(i,j)$æ˜¯ä»¥XçŸ©é˜µæ±‚å¯¼çš„å››ç»´çŸ©é˜µ, å¹¶ä¸”æœ‰: 
$$\large P_{DY} = \left[\begin{matrix}
\frac{\partial P_{f}}{\partial \sigma_{Y1}}  & \frac{\partial P_{f}}{\partial \rho_{Y1Y2}}   \\ \frac{\partial P_{f}}{\partial \rho_{Y_{1}Y_{2}}} & \ddots  \\ && \frac{\partial P_{f}}{\partial \sigma_{Yn}}
\end{matrix}\right]\qquad   \mathcal{R}_{XY}(i,j)  = \left[\begin{matrix}
\frac{\partial  \sigma_{Y1}}{\partial \rho_{i,j}} & \frac{\partial \rho_{Y1 Y2}}{\partial \rho_{ij}} &  \\  & \ddots\\  && \frac{\partial \sigma_{Y_{n}}}{\partial \rho_{ij}}
\end{matrix}\right]$$
äºæ˜¯æœ‰å…³ç³»: 
$$\Large\boxed{P_{DX}(i,j) = \sum_{s = 1}^{n} \sum^{n}_{r=1} P_{DY}\cdot  \mathcal{R}_{XY}(i,j)}$$
**åªéœ€ç”¨ä¸¤ä¸ªçŸ©é˜µç›´æ¥ç‚¹ä¹˜(æŒ‰å…ƒç´ ç›¸ä¹˜)å³å¯å¾—åˆ°ç»“æœ** 
> [!caution] è¯´æ˜
> ä¸Šè¿°ç»“è®ºå¯ä»¥æ¨å¹¿åˆ°ç¬¦åˆæ±‚å¯¼çš„çŸ©é˜µæƒ…å†µä¸‹

è€Œç¼–ç¨‹ä¸­æ¯”è¾ƒè®¡ç®—éº»çƒ¦çš„æ˜¯$\mathcal{R}_{XY}$å¦‚ä½•è¿›è¡Œè®¡ç®—, 


```erlang title:æ±‚è§£çŸ©é˜µå¯¹æ–¹å·®æˆ–è€…ç›¸å…³ç³»æ•°çš„ä»£ç éƒ¨åˆ†
%%%%%% æ ¹æ®åæ–¹å·®çŸ©é˜µè·å–çŸ©é˜µå’Œdetå¯¹æŸä¸ª\rhoæˆ–è€…sigma, æˆ–è€…å˜é‡å¯¼æ•°çš„ä»£ç  %%%%%%%
function [res_diff, res_invdiff, res_detdiff] = matrixdiff(D_X, row, col)
delta_x = 1e-8;  % å˜é‡å¢é‡

if (length(row) ~= length(col))
    error("the row array and col array must be match");
end
n  = size(D_X, 1);
m = length(row);  
sigma_d = sqrt(diag(D_X));            % æ±‚è§£æ¯ä¸ªsigma_;
Cov_Mat = D_X./(sigma_d * sigma_d');  % æ±‚è§£ç›¸å…³ç³»æ•°rhoçš„çŸ©é˜µ
C_x_inv = inv(D_X); C_x_det = det(D_X);

res_diff = zeros(n,n,m); res_invdiff = zeros(n,n,m); res_detdiff = zeros(m);

for i = 1:m
    if row(i)~=col(i) % æ±‚è§£ç›¸å…³ç³»æ•°çš„å¯¼æ•°(å¯¹ç§°å¢åŠ );
        a = row(i);  b = col(i);
        delta_mat = zeros (n,n); delta_mat(a,b) = delta_x; delta_mat(b,a) = delta_x;
        Cov_Mat_new = Cov_Mat + delta_mat; % å¢é‡
        sigma_d_new = sigma_d;
    else % æ±‚è§£æ–¹å·®çš„å¯¼æ•°
        a = row(i);
        delta_mat = zeros(1,n); delta_mat(i) = delta_x;
        sigma_d_new = sigma_d + delta_mat;
        Cov_Mat_new = Cov_Mat;
    end
    C_x_New = sigma_d_new * sigma_d_new' .* Cov_Mat_new;  % æ³¨æ„æ­¤å¤„ä½¿ç”¨.*
    C_x_inv_New = inv(C_x_New);
    C_x_det_New = det(C_x_New);
    
    res_diff(:,:,i) = (C_x_New - D_X)./ delta_x;
    res_invdiff(:,:,i) = (C_x_inv_New - C_x_inv) ./ delta_x;
    res_detdiff(i) = (C_x_det_New - C_x_det)/delta_x;
end
```

ä¸€èˆ¬è€Œè¨€ï¼Œ å¯¹äºMonteCarloç›´æ¥æ³•è€Œè¨€ï¼Œ å¿…é¡»**äº§ç”Ÿç›¸å…³çš„éšæœºæ ·æœ¬**ï¼Œ è€Œä¸€èˆ¬**ç›¸å…³çš„éšæœºæ ·æœ¬äº§ç”Ÿç›¸å¯¹äºç‹¬ç«‹æ ·æœ¬çš„äº§ç”Ÿæ›´åŠ å›°éš¾**, ä¸”**æ¨å¯¼ç»“æœæ”¶æ•›æ€§çš„è§£æè¡¨è¾¾å¼ä¹Ÿè¾ƒä¸ºå›°éš¾**; å¯ä»¥å¤šæ¬¡é‡å¤åˆ†æä¼°è®¡ç»“æœæ”¶æ•›æ€§; 

è€ŒMonteCarloè½¬æ¢æ³•ä¸éœ€è¦äº§ç”Ÿå¯¹åº”çš„æ ·æœ¬ç‚¹ï¼Œ è€Œåªéœ€è¦è§£æå˜æ¢å³å¯æ±‚è§£ï¼Œ ç¼ºç‚¹æ˜¯**å¿…é¡»æ±‚å¾—ç‹¬ç«‹æ­£æ€ç©ºé—´çš„åˆ†å¸ƒå‚æ•°å¯¹ç›¸å…³æ­£æ€ç©ºé—´çš„åˆ†å¸ƒå‚æ•°çš„åå¯¼æ•°**ï¼Œæ­¤æ—¶å¦‚æœé‡‡ç”¨ç›¸åŒçš„æ ·æœ¬ä¼°è®¡ç‹¬ç«‹ç©ºé—´çš„å¯é æ€§å±€éƒ¨çµæ•åº¦ï¼Œ ç”±äºå¯é æ€§å±€éƒ¨çµæ•åº¦çš„ä¼°è®¡å€¼ç›¸å…³æ€§ï¼Œ ä¼šé€ æˆ**è½¬æ¢åçš„å¯é æ€§å±€éƒ¨çµæ•åº¦ä¼°è®¡å€¼æ–¹å·®ä¼°è®¡çš„å›°éš¾**ï¼Œå› æ­¤ï¼Œä¹Ÿåªèƒ½é€šè¿‡å¤šæ¬¡é‡å¤ä¼°è®¡è·å–å…¶æ”¶æ•›æ€§;

```erlang title:MonteCarloæ±‚è§£ç¤ºä¾‹ä»£ç 
% è€ƒè™‘åŠŸèƒ½å‡½æ•° g(X) = 4X1 -3.9998X2  + 4X3 - X4
% å‡å€¼å‘é‡å’Œæ–¹å·®å‘é‡åœ¨ä¸‹é¢ç»™å‡ºå®šä¹‰
clear, clc;
g = @(x) 4 .* x(:,1) - 3.9998 .* x(:,2) + 4.*x(:,3) - x(:,4);
mu_ = [83.5, 83.5, 83.5, 150];
cov_ = [0.12, 0.12 , 0.12, 0.25];

delta_x = 0.0001;
sigma_ = cov_ .* mu_;
% ä¸€æ¬¡äºŒé˜¶çŸ©æ³•(FOSM)å’ŒAFOSMçš„ç²¾ç¡®è§£ä¸º:Pf = 0.009844, 
% mean sensitivity: -0.001333, 0.001333, -0.001333, 0.000333
% variance sensitivity: 0.001579, 0.001579, 0.001579, 0.000369 
%% *************** è’™ç‰¹å¡æ´›æ–¹æ³•æ±‚è§£éƒ¨åˆ† **************
n = size(mu_, 2);

num_MCS = 1e7;
xp = lhsnorm(mu_, diag(sigma_.^2), num_MCS, "on");  % æ‹‰ä¸è¶…ç«‹æ–¹æŠ½æ ·

fail_points = find(g(xp) < 0);
Fp = size(fail_points, 1)/num_MCS;
Fp_Sigma = sqrt((Fp - Fp^2)/(num_MCS -1));
Fp_Cov = Fp - Fp_Sigma;

sprintf("failure property: %f, Cov:%f", Fp, Fp_Cov)

%% **** æ±‚è§£å‡å€¼å¯é æ€§å±€éƒ¨çµæ•åº¦å’Œæ–¹å·®å¯é æ€§çµæ•åº¦ **** %% 
% é¦–å…ˆå–å‡ºæŠ½æ ·ç‚¹ä¸­çš„å…¨éƒ¨å¤±æ•ˆç‚¹, ä½¿ç”¨ç‹¬ç«‹æ­£æ€åˆ†å¸ƒå˜é‡å…¬å¼è®¡ç®—å‡å€¼å’Œæ–¹å·®
sample_ = xp(fail_points, :);  % å¤±æ•ˆç‚¹æ•°æ®

mean_sensitivity = zeros(1,n);
variance_sensitivity = zeros(1, n);
for i = 1:4
    temp = zeros(1,n); temp(i) = delta_x;
    mean_sensitivity(i) = sum((sample_(:,i) - mu_(i))./(sigma_(i).^2))/num_MCS;  % è®¡ç®— dg_dx_(i) , å¯¹åº”å…¬å¼3.3.3
    variance_sensitivity(i) = sum(1./sigma_(i) .*(((sample_(:,i) - mu_(i))./sigma_(i)).^2 -1))/num_MCS;
end

disp(vpa(mean_sensitivity, 6));
disp(vpa(variance_sensitivity, 6));

```

`````ad-note
title: ç¼–ç¨‹æ˜“é”™ç‚¹
collapse: open

```erlang 
sample_ = yp(fail_points,:);   %%%%%%  å–é”™è¯¯sampleä¸€å®šä¸è¦å¿˜äº†æ•´ä½“å–è¡Œ -> å¦åˆ™ä»…æœ‰ç»“æœé”™è¯¯ï¼Œ éš¾ä»¥æŸ¥å‡º 
```
é”™è¯¯ä»£ç  sample_ = Y(fail_points) -> ç¬¬ä¸€ä¸ªé”™è¯¯æ˜¯å˜é‡(ä¸èƒ½å†™æˆç»“æœY)ï¼Œ ç¬¬äºŒä¸ªæ˜¯å–è¡Œ 
`````

`````ad-note
title: 常见方法
collapse: open
主要方法包括摄动法，谐波平衡法，平均法，多尺度法， H-B方法， POD本征正交分解方法等等
`````

## 一、 正规摄动法
### (1) 正规摄动法

`````ad-note
title: 实例引入
collapse: close
对于振动问题的非线性系统求解， 往往找不到精确解，需要使用数值方法进行求解
例如在单摆做小幅度运动时， 有：
$$\ddot{\varphi} + \frac{g}{a} \sin \varphi = 0$$
对于大幅运动时，解不封闭， 其周期$T$和初始周期$T_0 = \frac{2\pi}{\omega_0}$有如下关系
1. 摆角越大，周期越大
2. 随摆角的增加，摆的波形趋于矩形

将所得结果进行一阶近似的泰勒展开
$$\sin \varphi = \varphi - \frac{1}{6}\varphi^3$$

此时, 我们令 $\omega_0 =\sqrt{\frac{g}{a}}$， 则容易得到: 
$$\varphi = \frac{\dot{\varphi}_0}{\omega_0} \sin \omega_0 t  + \varphi_0 \cos \omega t$$
`````

将非线性系统的解按照小参数$\varepsilon$的幂次展开的方法，称为<mark style="background: transparent; color: yellow">摄动法</mark>或者<mark style="background: transparent; color: yellow">小参数法</mark>。
$$\boxed{\Large\ddot{x} + \omega_0^2 x = F(t) + \varepsilon f(x,\dot{x})}$$
其中，$f$为扰动，$\varepsilon$为小量，则系统为**弱非线性系统**。
其中，当$\varepsilon = 0$时，上式退化为固有频率为$\omega_0$的线性系统
$$\Large\boxed{\ddot{x} + \omega_0^2 x = F(t)}$$
上式称为原非线性系统的==派生系统==

对于线性的派生系统有周期解$x_0(t)$，若实验观测得到**原非线性系统**也存在周期解，可以认为，<mark style="background: transparent; color: yellow">周期解</mark>是**线性派生系统的解**加以修正得到。 
$$x(t, \varepsilon) = x_0(t) + \varepsilon x_1(t) + \varepsilon^2x_2(t) + \dots$$
**代入非线性系统**即可对原有的解进行修正
使用展开进行<u>正规摄动法</u>，对$x, \dot{x}$进行展开，有:
$$\Delta  x  = \varepsilon x_1  + \varepsilon^2 x_2  + \varepsilon^3 x_3  + ...$$
$$\Delta \dot{x} = \varepsilon \dot{x}_1 +  \varepsilon^2 \dot{x}_2 + ...$$

$$\Large{
\begin{matrix}
f(x,\dot{x}) =  \\ \\ \\ \\ \\ \\ 
\end{matrix} \begin{matrix} 
f(x_0,\dot{x}_0) + \frac{\partial f(x,\dot{x}_0)}{\partial x}(\varepsilon x_1 (t) + \varepsilon^2 x_2(t) + ...) \hfill  \\
+\frac{\partial f(x_0, \dot{x}_0)}{\partial \dot{x}}(\varepsilon \dot{x}_1(t) + \varepsilon^2 \dot{x}_2(t) +...)  \hfill \\ 
+ \frac{1}{2!}\frac{\partial^2 f(x,\dot{x}_0)}{\partial x^2}(\varepsilon x_1(t) + \varepsilon^2 x_2(t) + \varepsilon^3 x_3 (t) + ...) \hfill \\
+ \frac{1}{2}\frac{\partial^2 f(x,\dot{x}_0)}{\partial x \partial \dot{x}} (\varepsilon x_1(t) + \varepsilon^2 x_2(t) + ...)(\varepsilon \dot{x}_1(t) + \varepsilon\dot{x}_2(t)) +...) \hfill \\
+ \frac{1}{2}\frac{\partial^2 f(x,\dot{x}_0)}{\partial ^2 \dot{x}^2} (..... \hfill
\end{matrix}}$$
上述方程对任意的$\varepsilon$均成立，则要求方程两边$\varepsilon$的<mark style="background: transparent; color: yellow">同幂次系数相等</mark>， 导出**近似解的线性微分方程组**为
$$\boxed{\begin{cases}
\varepsilon^0 : \ddot{x} + \omega_0^2 x_0 = F(t)  \\ 
\varepsilon^1 : \ddot{x}_1 + \omega_0^2 x_1 = f(x_0,\dot{x}_0) \\
\varepsilon^2 : \ddot{x}_2 + \omega_0^2 x_2 =  x_1\frac{\partial f(x_0,\dot{x}_0) }{\partial x} + \dot{x}_1 \frac{\partial f(x_0 , \dot{x}_0)}{\partial \dot{x}} \\ ... 
\end{cases}}$$
将上式代入非线性系统， 有： 
$$\ddot{x}_0 (t) + \varepsilon \ddot{x}_1(t)  + \varepsilon^2 \ddot{x}^2(t) + ... + \omega_0^2 \left[ x_0(t) +\varepsilon x_1(t) + \varepsilon^2 x_2(t) +... \right] = F(t) + \varepsilon f(x,\dot{x})$$

求解非线性系统的周期解时， 通过迭代计算先解出$\ddot{x}_0$,代入可以分别解出$x_1, x_2,...$最终可以得到周期解为
$$x(t, \varepsilon) = x_0(t) + \varepsilon x_1(t) + \varepsilon^2 x_2(t) +...$$

### (2) Duffing 方程的非共振受迫振动
`````ad-note
title: 补充: 振动的相关概念 
collapse: close

分频($\frac{1}{3}\omega$)和倍频($2\omega$)
- 分频 (downsampling)：将原始信号的采样率降低，相当于将信号的频率范围缩小，从而减少数据量和计算量。在数字信号处理中，通常使用低通滤波器对原始信号进行滤波，去除高频部分，然后对滤波后的信号进行抽样，从而实现分频操作。

- 倍频 (upsampling)：将原始信号的采样率提高，相当于将信号的频率范围扩大，从而提高信号的精度和分辨率。在数字信号处理中，通常使用插值算法对原始信号进行插值，从而得到更多的采样点，然后使用高通滤波器对插值后的信号进行滤波，去除低频部分，从而实现倍频操作。
非线性系统在频率为$\omega$的激励下，产生的响应包括 $\omega, 3\omega, 5\omega$ 等等频率的高次谐波， 称为倍频响应
注意: 激励频率为$\omega$，往往使用

- 主共振 (fundamental resonance)：系统在自然频率上振动的情况，此时系统的振幅最大。
- 内共振 (internal resonance)：系统中存在多个自由度，其中一个自由度的振动会影响到另一个自由度的振动的现象。
- 组合共振 (combination resonance)：系统中存在多个自由度，这些自由度的振动频率之间存在简单的数学关系，导致它们在某些特定频率上同时共振的现象。
- 谐波共振 (harmonic resonance)：系统在某个整数倍于主频的频率上发生共振的现象。
- 超谐共振 (superharmonic resonance)：系统在某个**非整数倍于主频但是大于主频的频率上发生共振**的现象。
- 亚谐共振 (subharmonic resonance)：系统在某个非整数倍于主频但是小于主频的频率上发生共振的现象。
`````
Duffing方程的形式为： 
$$\boxed{\ddot{x} + \omega_0^2(x + \varepsilon x^3) = F\cos \omega t}$$
上式可以变型为：
$$\ddot{x} + \omega_0^2 x = F\cos \omega t - \varepsilon\omega_0^2 x^3$$
其中，弱非线性项为$-\varepsilon\omega^2_0 x^3$，代入上述公式， 其级数解为：
$$x(t,  \varepsilon) = x_0(t) + \varepsilon x_1(t) + \varepsilon^2x_2(t) + ...$$
容易列写出**微分方程**为
![[Excalidraw/第二章、流固耦合中的基本解题方法 2023-05-09 15.10.00|400]]
通过[[📘ClassNotes/👨‍🔧Mechanics/🌊Thermal and Fluid dynamics/🛩️Fluid structure interaction/补充/非共振受迫振动的推导.pdf|非共振受迫振动的推导.pdf]]得到
零次近似方程为线性系统的受迫振动方程:
$$x_0 = A_0 \cos (\omega_0 t + \theta_0) + A\cos \omega t$$
使用机械振动中的求解过程, 容易得到
$$A  = \frac{F}{\omega_0^2 - \omega^2} $$
代入近似方程得到$x_0$，再代入$x_1$的式子, 再代入$x_2$，以此类推
对于一阶的方程， 会产生$\cos 3 \omega t$项， 此时我们使用三次余弦的变换公式:
$$\boxed{\cos^3 \omega t  = \frac{1}{4} \cos \omega t  + \frac{3}{4} \cos 3\omega t}$$
代入一阶方程并可以推导得
$$x_1 = B_1 \cos \omega t + B_2 \cos 3 \omega t$$
其中
$$B_1 = -\frac{3 \omega_0^2 A^3}{4(\omega_0^2 - \omega^2)} \qquad  B_2 = -\frac{\omega_0^2 A^3}{4(\omega_0^2 - 9 \omega^2)}$$
代入得到式 (2) 中, 有:
$$x_2 = C_1 \cos \omega t + C_2 \cos 3\omega t + C_3  \cos 5 \omega t$$
$$C_1 = -3 \omega_0^2 A^2 \left( \frac{3}{4} B_1 - \frac{1}{4}B_2\right) \qquad  C_2 = -\frac{3 \omega^2_0 A}{4(\omega_0^2 - 9 \omega^2)} (B_1 - 2B_2) \qquad  C_3 = - \frac{3\omega_0^2 A^2 B_2}{4(\omega_0^2 - 25 \omega^2)}$$
若 Duffing 方程受到两个不同频率的简谐激励，即:
$$\ddot{x} + \omega_0^2(x + \varepsilon x^3) = F_1 \cos \omega_1 t + F_2\cos \omega_2 t$$
特解(自由振动解)为$x = A\cos\omega t$
对于<mark style="background: transparent; color: red">激励频率和固有频率重合的情况</mark>，会导致<u>振幅对时间无限增加的项</u>， ==随时间不断增长的项==称为**久期项**
对于一般的振动，为了保持稳定，，**必须保证久期项为0**


## 二、 奇异摄动法(LP摄动法)
### (1) 奇异摄动法解Duffing方程自由振动
1. 久期项的概念: 久期项是存在激励频率和固有频率重合的项，久期项的出现反映出，正则摄动法的缺陷， 
为了消除久期项，提出了LP(奇异摄动法)， 即 Lindstedt-Poincare 方法
$$\ddot{x} + \omega_0^2 (x + \varepsilon x^3) = 0$$
L-P方法的基本思想是， <u>认为非线性系统的固有频率并不等于派生系统的固有频率</u>，而也是小参数$\varepsilon$的未知数，除了**将$x_0$展开成$\varepsilon$的幂级数以外**， 即
$$x = x_0 + \varepsilon x_1 + \varepsilon^2 x_2 + ...$$
还需要将<mark style="background: transparent; color: red">频率也展开成</mark>$\varepsilon$的幂级数
$$\Large\boxed{\omega = \omega_0  + \varepsilon \omega_1 + \varepsilon ^2\omega_2 + ...}$$

此时 `->` 我们考虑: 对于Duffing 方程的自由振动，有: 
$$\ddot{x} + \omega_0^2 (x + \varepsilon x^3) = 0$$
此时，<mark style="background: transparent; color: red">将时间进行无量纲化</mark>，令$t = \omega \tau$, 得到:
$$\Large\boxed{\omega^2 x'' + \omega_0^2 (x + \varepsilon x^3) = 0}$$
其中, $x''$是x 对于$\tau$的二阶导数。
将上式中的解和频率展开为$\varepsilon$的幂级数:
$$x = x_0  + \varepsilon x_1 +\varepsilon^2 x_2 + ... \qquad  \omega = \omega_0 + \varepsilon \omega_1 + \varepsilon^2 \omega_2 + ...$$
并代入上述的无量纲化方程，得到: 
$$(\omega_0 + \varepsilon \omega_1 + \varepsilon^2\omega_2  +...)^2(x_0'' + \varepsilon x_1'' + \varepsilon^2 x_2'' + ...)  + \omega_0^2 (x + \varepsilon x^3) = 0$$
此时将原系统展开为$\varepsilon$的幂级数, 取$\omega^2 = \omega_0^2 (1+\varepsilon_1 \sigma_1 + \varepsilon^2 \sigma_2 +...)$则得到
$$\omega_0^2 (1 + \varepsilon_1 \sigma_1 + \varepsilon^2 \sigma_2 +...)x'' + \omega_0^2(x + \varepsilon x^3) = 0$$
则有:
$$x + \varepsilon x^3  + x'' (1 + \varepsilon \sigma_1 + \varepsilon^2 \sigma_2 +...) = 0$$
将$x , \varepsilon x^3$ 展开得到组合方程:
$$\begin{cases}
x'' + x_0 = 0 \\
x_1''  + \sigma_1 x''_0  + x_1 + x_0^3 = 0 \\
x_2'' + \sigma_1 x_1'' + \sigma_2 x_0''  + x_2  + 3 x_0^2 x_1= 0
\end{cases} \tag{1}$$
其中，各个方程的初始条件为 :
$$\begin{matrix}
x_0(0) = A  , \quad  x'(0) = 0 \\
x_1(0) =  0 , \quad  x'_1(0) = 0\\
x_2(0) = 0, \quad  x'_2(0) = 0
\end{matrix}$$
此时由方程(1) 得到: 
$$x_0  = A\cos \phi$$
代入一次近似方程，得到(其中注意$\cos$的求导):
$$x_1'' + x_1  -  \sigma_1 A \cos \phi + A^3 \cos^3\phi = 0$$
将$\cos^3\phi$展开，得到其中的久期项为
$$x_1 ''  + x_1 = \sigma_1 A \cos \phi  - \frac{3}{4} A^3 \cos \phi - \frac{1}{4} A^3\cos 3\phi$$
则久期项$\cos \phi$项的系数必定为0，有:
$$\sigma_1 - \frac{3}{4}A^3 = 0 \rightarrow  \sigma_1 = \frac{3}{4}A^3$$
将$\sigma_1$代入方程(1)中解出第二个方程， 同理可以解出第三个方程，解过程中，每一次保证久期项的系数为0
分别求得$\sigma_1, \sigma_2, ...$之后，最终可以得到自由振动频率与振幅的关系: 
$$\omega^2  = \omega_0^2 (1 + \varepsilon \frac{3}{4}A^2 - \varepsilon^2 \frac{3A^4}{128} + ... )$$
此时，对于单摆的大幅摆动，结果如下:
![[Excalidraw/第二章 流固耦合中的基本解题方法 2023-06-16 09.55.44|400]]
### (2) Duffing 方程主共振
我们考虑Duffing 方程的**受迫振动部分**
$$\ddot{x} + 2 \zeta \omega_0 \dot{x} + \omega_0^2 (x + \varepsilon x^3) = \varepsilon F_0 \cos (\omega t + \theta)$$
此时， ==阻尼项， 激振力频率和派生系统的固有频率==之差均与小参数同一数量级, 可以将$\omega$展开为
$$\zeta  = \varepsilon \zeta_1 \qquad \omega^2  = \omega_0^2 (1 + \varepsilon \sigma_1)$$
此时， 令$\omega t = \varphi$, $F_0 = \omega_0^2 B_1$
此时将原系统展开为$\varepsilon$的幂级数$x = x_0 + \varepsilon x_1 + \varepsilon^2x_2 +...$
此时代入Duffing 方程: 
$$\begin{matrix}
\ddot{x}_0 + x_0 = 0  \\
\ddot{x}_1  + x_1 = - \sigma_1 \dot{x}_0 - 2 \zeta_1 \dot{x}_0 - x_0^3 + B_1(\cos \theta \cos \varphi + \sin \theta \sin \varphi)
\end{matrix}$$
从而得到零次的近似解:
$$x_0 = A\cos \varphi$$
然后将$x_0$代入$x_1$的方程中, 得到: 
$$\ddot{x}_1 + x_1 = \left(\sigma_1 A - \frac{3}{4}A^3 + B_1 \cos \theta \right)\cos \varphi + (2\zeta_1 A -B_1 \sin \theta) \sin \varphi - \frac{1}{4} A^3 \cos 3\varphi$$
此时， 为了保证解的周期性, **久期项为0** `->` 此时$\sin \varphi, \cos \varphi$ 的系数必须全部为零, 从而有
$$2 \zeta_1 A - B_1\sin \theta = 0 \qquad  \sigma_1 A - \frac{3}{4}A^3 + B_1 \cos \theta = 0$$
此时，消去待定参数$\theta$, 得到:
$$\left(\frac{3}{4} A^2 - \sigma_1\right)^2 + (2 \zeta_1)^2 = \frac{B_1^2}{A^2}$$
可以解出振幅， 从而得到弯曲的幅频曲线

### (3) Duffing 方程的亚谐共振
实践中观察到，当**固有频率**接近于**激励频率**的1/3时， 往往也会引发强烈共振， 称为1/3亚谐共振。

其中， 亚谐共振通常由较强的激励引起，考虑: 
$$\ddot{x} + \omega_0^2 x  + \varepsilon x^3 = F_0 \cos \omega t$$
其中, 发生亚谐共振时，$\omega_0$和$\frac{\omega}{3}$基本相同, 即**相差与$\varepsilon$同数量级**, 此时我们令
$$\boxed{\left(\frac{\omega}{3}\right)^2 = \omega_0^2 + \varepsilon \sigma_1}$$
将原来的系统展开成$\varepsilon$幂级数， 则有
$$\begin{matrix}
\ddot{x}_0 + \left(\frac{\omega}{3}\right)^2x_0 = F_0 \cos \omega t \\ 
\ddot{x}_1 + \left(\frac{\omega}{3}\right)^2x_1 = \sigma_1 x_0 - x_0^3
\end{matrix}$$
此时解出$x_0$, 则零次方程的解**由$\frac{\omega}{3}$的自由振动和$\varepsilon$频率的受迫振动组成**
$$\boxed{x_0 = A_{\frac{1}{3}} \cos \frac{1}{3}\omega t + A \cos \omega t}$$
其中，受迫振动的振幅为: 
$$A = -\frac{9 F_0}{8 \omega^2}$$
此时将零次方程的解代入一次方程，并且令久期项$\cos (\frac{\omega t}{3})$的系数为0, 则得到:
$$A_{1/3} = 0 \qquad \text{}$$
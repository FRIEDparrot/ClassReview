模型建立如图 :
![[Excalidraw/实验2 内置方形体的突然扩张 2023-04-20 20.26.09|450]]
首先是无旋流: 
$$\frac{\partial^2 \psi}{\partial x^2} + \frac{\partial^2 \psi}{\partial y^2} = 0$$
而由流函数计算速度公式为：
$$u= \frac{\partial \psi}{\partial y}\qquad v = -\frac{\partial \psi}{\partial x}$$
离散使用的点松弛迭代计算公式：
$$\psi_{ij}^{n+1} = \psi_{i,j}^n + \frac{\omega}{2(1+\beta^2)}\left[\psi_{i+1}^{n} + \psi_{i-1,j}^{n+1} + \beta^2 \psi_{i,j+1}^n + \beta^2 \psi_{i,j-1} ^{n+1} - 2(1+\beta^2) \psi_{i,j}^n\right]$$
边界条件: 
1. 流函数在流线上的值为定值(给定ABCEF上$\psi =0$,$HG\rightarrow \psi =1$)
2. 进口速度为$u$
3. 出口$v =\frac{\partial \psi}{\partial x} =0$ 
$$\begin{cases}
AB : \psi(i,1) = 0, i =1\rightarrow IM1 \\
BC: \psi(IM1,j) = 0, j=1\rightarrow JM2 \\
CD: \psi(i,JM_2) = 0, i = IM1\rightarrow IM2\\
DE: \psi(IM2, j) = 0, j = JM2 \rightarrow 1 \\
EF: \psi(i, 1) = 0, i = IM2\rightarrow JM\\
FG: \frac{\partial \psi}{\partial y}(IM,j) =  0, \text{that is}, \psi(IM,j) = \psi(IM-1,j) , j  = 1 \rightarrow JM
\end{cases}
$$

##  一、空间问题的有限元法
### (1) 基本四面体单元的分析
受任意空间载荷的任意形状的几何体，受对称于轴线载荷作用的回转体等等，主要介绍**空间问题和轴对称问题**， 主要的困难是空间网格的自动生成（离散化不直观）和轴对称问题的简化（自由度的增加）
![[Excalidraw/第四章 空间问题 2023-04-17 08.39.15|200]]
三维应力状态的表示方法：
1. 位移函数
$$\begin{cases}
u = u(x,y,z) \\
v = v(x,y,z) \\
w = w(x,y,z)
\end{cases}$$
2. 应变情况
利用[[📘ClassNotes/👨‍🔧Mechanics/🔨Theory of Elasticity/弹性力学部分/第三章：应变/1. 变形与应变的概念#二、应变几何方程|应变几何方程]],得到三维应变方程的矩阵表示: 
$$\left\{\xi \right\} = \left\{\begin{matrix}
\varepsilon_x \\ \varepsilon_y \\ \varepsilon_z \\ \gamma_{xy} \\ \gamma_{yz} \\ \gamma_{xz} 
\end{matrix} \right\} = \left[\begin{matrix}
\frac{\partial }{\partial x} \\
& \frac{\partial }{\partial y} \\
&& \frac{\partial }{\partial z} \\
\frac{\partial }{\partial y} & \frac{\partial }{\partial x} \\ 
& \frac{\partial }{\partial z} &\frac{\partial }{\partial y}\\
\frac{\partial }{\partial z} &&\frac{\partial }{\partial x}
\end{matrix}\right] \left\{ \begin{matrix}
u \\ v \\ w
\end{matrix}\right\}$$
3. 应力分量
$$\left\{\sigma \right\} = \left[\begin{matrix}
\sigma_x & \sigma_y & \sigma_z & \tau_{xy} &  \tau_{yx} & \tau_{zx}
\end{matrix}\right]^T$$
其中在三维应力状态下，弹性矩阵可以表示为(其中$[D]$较复杂,略)
$$\left\{ \sigma\right\} = [D] \left\{ \varepsilon\right\}$$

使用四面体单元为基本单元， **共有12个自由度**
设定位移模式有12个待定系数，为：
$$\begin{cases}
u(x,y,z) = a_1 + a_2 x + a_3 y  + a_4 z \\
v(x,y,z) = a_5 + a_6 x +a_7 y + a_8 z \\
w(x,y,z) = a_9 + a_{10} x + a_{11} y + a_{12} z
\end{cases}$$
即有$\left\{ \delta_i\right\}$为12x1的列向量，A为12 x 12 的系数阵
$$\left\{\delta_i \right\}= [A] \left\{ a\right\}$$
将12个节点的位移进行分别代入， 可以解得12个待定系数， 代入得到：
$$\left\{ \delta \right\} = [M][A]^{-1}\left\{\delta_i\right\}$$
令$[M] [A]^{-1} = [N]$
得到
$$\left\{\delta\right\} = \left[\begin{matrix}
[N_k]  & [N_l] & [N_m] & [N_n]
\end{matrix}\right]\left\{\delta_i\right\} \quad\text{where} \quad  \left[N_i\right] = \left[\begin{matrix}
N_i & 0 & 0 \\
0 & N_i & 0 \\
0 & 0 & N_i
\end{matrix}\right]$$
其中, $N_i$的计算公式为: 
$$N_i =  \frac{1}{6V}\left(a_i + b_i x + c_iy + d_iz\right)$$
其中$V$为四面体的体积，而体积可以通过系数矩阵如图计算
$$6V = |\Lambda|  = \left[\begin{matrix}
1 & x_k & y_k & z_k \\
1 & x_l & y_l & z_l \\
1 & x_m & y_m & z_m \\
1 & x_n & y_n & z_n \\
\end{matrix}\right]$$
在上式中， $a_i, b_i,c_i,d_i$也是同理通过系数矩阵求解得到的
![[Excalidraw/第四章 空间问题的有限元法 2023-03-29 09.25.49|250]]

`````ad-caution
title: 通过系数矩阵面积计算的注意事项
collapse: open
由于坐标系是右手系，为了能够让四边体的体积计算为正， 单元的四个节点排列的顺序必须是按逆时针排列的，即由$n$点看$klm$平面，，应当使$k,l,m$为逆时针排列 
`````
因此有应变计算公式: 
$$\left\{\varepsilon\right\} = \nabla  \cdot[N] \left\{\delta\right\}^e = [B]\left\{\delta\right\}^e = [B_k \space B_l\space B_m\space B_n]$$
其中有公式计算方法
$$[B_i] = \frac{1}{6V}\left[\begin{matrix}
b_i \\
& c_i \\
&& d_i \\
c_i & b_i \\
& d_i & c_i \\
d_i & &b_i
\end{matrix}\right]\qquad  i = k,l,m,n$$
仍然按照和二维问题完全相同的推导方法，得到按节点4 x 4 (x3) 分块的刚度矩阵$[k]$， 并假设中间的数是常数，不随坐标改变，则 : 
$$[k]^e = \iiint_V[B]^T [D] [B] dV = [B]^T[D] [B] V^e$$
其中有部分分块的矩阵计算公式：
$$\boxed{[k_{rs}] = [B_r]^T [D] [B_s]V^e}$$
`````ad-tip
title: 载荷分配的方法 
collapse: open
将载荷从<mark style="background: transparent; color: yellow">分布的体积力和均布面力等等分配到节点上</mark>

**1) 对于均布体积力，计算出全部的体积力，每个节点平均分配$\frac{F}{4}$**

**2) 对于均布的面积力，则将面积力均匀分配到面的节点上，对于三角形面，则每个分配$\frac{F}{3}$**

**3) 非均布的体积力和面积力的分配：**
按照做功相等的原则进行等效分配:
$$\left\{Q_V\right\} = \int_{V^e} [N]^T \left\{ q\right\}dV\qquad \left\{Q_S\right\}^e = \int_{S^e} [N]^T \left\{p\right\} dS$$

`````

### (2) 轴对称问题的分析计算
#### 1. 形状函数计算
轴对称问题也称为<mark style="background: transparent; color: yellow">二维半问题</mark>
1. 几何条件对称
2. 载荷对称
3. 约束对称

过$z$轴的任一子午面都是对称面，其上任一点$p$只在该平面上位移，应力和应变仅和$r,z$有关，并和$\theta$无关。我们设对于圆环的**径向和环向位移**分别为$u,w$
$$\begin{cases}
u = u(r,z) \\
w = w(r,z)
\end{cases}$$
其中<mark style="background: transparent; color: yellow">任意一点的位移模式</mark>为(其中)：
$$\left\{\begin{matrix}
u \\ w 
\end{matrix} \right\} = [N]\left\{ \delta\right\}^e$$
#### 2. 应变和应力计算
对于轴对称问题的应变，除了截面内的应变
$$\varepsilon_r = \frac{\partial u}{\partial r} \quad \varepsilon_z = \frac{\partial w}{\partial z} \quad \gamma_{rz} = \frac{\partial u}{\partial z} + \frac{\partial w}{\partial r}$$
对于圆周上面各点都有径向位移$u$时，则有环向变形：
$$\varepsilon_{\theta} = \frac{u}{r}$$
则定义应变向量：
$$\boxed{\left\{\varepsilon\right\} =\left\{\begin{matrix}
\varepsilon_r & \varepsilon_\theta & \varepsilon_z &\gamma_{xz}
\end{matrix}\right\}}$$
其中
$$\varepsilon_r = \frac{\partial u}{\partial r} \quad\varepsilon_{\theta} = \frac{u}{r}\quad  \varepsilon_z = \frac{\partial w}{\partial z} \qquad  \gamma_{rz} = \frac{\partial u}{\partial z} + \frac{\partial w}{\partial r}$$
或
$$\left\{\varepsilon\right\} = \left\{ \begin{matrix}
\frac{\partial }{\partial r} & 0 \\
\frac{1}{r} &  0 \\ 
0 & \frac{\partial}{\partial z} \\
\frac{\partial }{\partial z} & \frac{\partial }{\partial r}
\end{matrix}\right\}\left\{\begin{matrix}
u \\ w
\end{matrix} \right\}$$
代入节点位移公式，得到：
$$\boxed{\left\{\varepsilon\right\} = \left[\begin{matrix}
B_i & B_j & B_m
\end{matrix}\right]\left\{\delta\right\}^e}$$
其中: 
$$\left[B_i\right] = \frac{1}{2\Delta} \left[\begin{matrix}
b_i & 0 \\
f_i & 0 \\
0  & c_i \\
c_i & b_i
\end{matrix}\right]$$
而应力分量为：
$$[\sigma] = \left\{ \sigma_r \quad  \sigma_{\theta} \quad  \sigma_{z} \quad   \tau_{\theta z} \right\}$$
因此在应变矩阵中，会多出一项$f_i$, 并有其中
$$f_i = \frac{a_i}{r} + b_i + \frac{c_i}{r}z$$
因此当$r\rightarrow 0$时，$f$不存在, 此时需要**做近似处理**
对于单元刚度矩阵: 
$$\Large[K]_{6\times 6}^e = 2\pi \iint [B]^T[D][B] rdrdz$$
此时由于不是常数，需要进行数值积分处理

#### 2. 载荷分配
##### (1) 表面压力
对于$e$单元表面受到表面压力分布:  
$$\left\{Q \right\}^e = \int_{S_{\sigma}^e}[N]^T\left\{\begin{matrix}
p_r \\ p_z
\end{matrix} \right\} dS$$
其中
$$dS = 2\pi r dl$$
得到 : 
$$\boxed{\Large\left\{Q \right\}^e = \int_{S_{\sigma}^e}2\pi [N]^T\left\{\begin{matrix}
p_r \\ p_z
\end{matrix} \right\} rdl}$$
其中$[N]^T$为形状函数，而

$$p_r = -p \cos \alpha\qquad  p_z = -p\sin \alpha$$

![[Excalidraw/第四章 空间问题的有限元法 2023-04-10 08.47.39|250]]

##### (2) 离心力
按照做功等效的方法： <mark style="background: transparent; color: yellow">利用力的做功相等进行积分</mark>
在x, z方向的分配到节点的载荷为：
$$Q_e = \int_{V^e}[N]^T\left\{ \begin{matrix}
\omega^2 \rho r \\ 0
\end{matrix}\right\}dV\qquad dV = 2\pi r drdz$$
其中，$\rho$为材料密度
$$\Large\left\{ Q\right\}^e = 2\pi \omega^2 \int_{S^e}\left[\begin{matrix}
N_l & 0 & N_m & 0 & N_n & 0
\end{matrix}\right]^T \rho r^2drdz$$

##### (3) 求积问题
由于单元刚度矩阵需要计算三角形域内的面内积分， 可以使用近似算法: 
$$\Large\boxed{F = \int_{S^e} f(r,z) drdz  = \frac{\Delta }{3}(f_l + f_m +f_n)}$$
其中$f_l ,f_m ,f_n$为对应的部分在$l,m,n$处的函数值
有时也可以使用
$$\boxed{F = \int_{S^e} f(r,z) drdz  = \Delta  f(\frac{r_l + r_m + r_n}{3}, \frac{z_l + z_m + z_n}{3})}$$
也可以使用分区积分再求和的方法


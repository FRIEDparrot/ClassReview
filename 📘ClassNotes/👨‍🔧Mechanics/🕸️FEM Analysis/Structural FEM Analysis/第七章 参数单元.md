提高有限元精度的两种方法：
1. 加密网格(H方法)
2. 使用高精度的单元类型，提高有限元的计算精度(P方法)

## 一、平面四节点等参元
1. 引入任意形状的单元
2. 进行映射， 通过映射法则实现不同的单元变换为等参元
3. 建立坐标变换进行等参元变换 

将任意形状的单元映射为正方形单元， 在整体坐标系下的四边形单元可以变换为四边形单元

称$\xi,\eta$平面的正方形单元称为基本单元或者母单元，而将$x,y$平面内的任意四边形称为子单元
$$\left\{\begin{matrix}
x \\ y
\end{matrix}\right\} = [f(x_1, y_1, x_2, y_2, x_3, y_3, x_4,y_4)]\left\{ \xi 
,\eta\right\}$$
将单元内的任意节点的坐标，使用<mark style="background: transparent; color: yellow">四个节点的插值函数(即形函数)进行表示</mark>， 并使用$\xi, \eta$ 表征形函数。
$$\left\{\begin{matrix}x \\ y 
\end{matrix}\right\} = \sum^{4}_{i=1} N_i \left\{\begin{matrix}
x_i \\ y_i 
\end{matrix} \right\}$$
对于使用位移模式，形状函数为: 
$$\begin{matrix}
N_1 = \frac{1}{4} \left(1 - \frac{x}{a} \right)\left( 1 -\frac{y}{b}\right) \\
N_2 = \frac{1}{4} \left(1 + \frac{x}{a} \right)\left( 1 - \frac{y}{b} \right) \\
....
\end{matrix}$$
采用相同的插值函数使用单元的节点位移在单元进行插值而表示单元中每一点的位移 ，这种单元称为等参单元


平面四节点等参元的刚度矩阵可以表示为：
$$[k]^e =  \int_{\Omega^e} [B]^T [D][B] h d\Omega$$
其中$[B]$为应变矩阵
$$d\Omega = \left|\overrightarrow{AB} \times \overrightarrow{AC} \right|$$
为面积微元，需要变换成$d\xi, d\eta$来表示, 
下面是一个MATLAB计算四节点单元的刚度示例：

$$\begin{cases}
\overline{AB} = \frac{\partial \bar{r}}{\partial \xi} d\xi  = \left(\frac{\partial x}{\partial \xi}\vec{i} + \frac{\partial y}{\partial \xi}\vec{j} \right) \\
\overline{BC} = \frac{\partial \bar{r}}{\partial \eta} d\eta = \left( \frac{\partial x}{\partial \eta} \vec{i} + \frac{\partial y}{\partial \eta} \vec{j}\right)
\end{cases}$$
则得到：
$$[k]^e = \int^{1}_{-1}\int^{1}_{-1} f(x) dx$$

`````ad-note 
title: 四节点等参元刚度矩阵的MATLAB代码实现
collapse: close
```erlang
% 四节点单元刚度矩阵函数 E杨氏模量, nu 泊松比, h板厚度
function Ke = Elem401(E,nu,h)
syms x
syms y

M = [
    [1, x, y, x*y,0,0,0,0]
    [0,0,0,0, 1, x, y, x*y]
    ];

loc_e = [-1, -1, 1, -1, 1,1,-1, 1]; % 注意是逆时针取节点

A = [
    [1 -1 -1 1 0 0 0 0]
    [0 0 0 0 1 -1 -1 1]
    [1 1 -1 -1 0 0 0 0]
    [0 0 0 0 1 1 -1 -1]
    [1 1 1 1 0 0 0 0]
    [0 0 0 0 1 1 1 1]
    [1 -1 1 -1 0 0 0 0]
    [0 0 0 0 1 -1 1 -1]
    ];

N = M/A;  % M * inv(A) , 为形状函数矩阵
% 对x, y等参变量求导并得到对应的应变矩阵
N_x = diff(N,x);
N_y = diff(N,y);

B = [N_x(1,:)
     N_y(2,:)
     N_y(1,:) + N_x(2,:)
     ];
clear N_x N_y

D = E * h/(1-nu^2) * [
[1 nu 0]
[nu 1 0]
[0 0 (1- nu)/2]
];

k_e = transpose(B) * D * B;
Ke = vpa(int(int(k_e,x,[-1, 1]), y, [-1,1]), 4);  % 积分求解对应的四节点刚度矩阵
end
```

`````

1. 高精度
2. 拟合复杂边界
3. 能够有效拟合复杂单元

20节点三维等参单元， 分布如图: 
![[Excalidraw/第七章 参数单元 2023-04-24 10.04.29|200]]

 等参单元满足相容性和完备性要求 ， 在有限元近似解上是收敛的
 
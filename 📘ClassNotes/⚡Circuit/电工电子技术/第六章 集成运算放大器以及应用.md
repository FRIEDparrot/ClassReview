## 一、集成运算放大器原理
### (1) 基本结构
运算放大器是一种由电阻，晶体管，电容和二极管构成的用于<u>执行加减乘除与微积分运算</u>的有源电路元件。常见的集成运算放大器型号有F007(LM741), LM324和AD8628等等, 一般的集成运算放大器有7个引脚(8空引脚), <mark style="background: transparent; color: red">其中1,5为平衡引脚</mark>, , 而4,7为-VCC与VCC输入, <mark style="background: transparent; color: red">2,3 分别为反相和同相输入引脚, 6为输出引脚</mark> 
![[Excalidraw/第十一章 含有运算放大器的电路分析 2023-09-20 22.36.22|1100]]
下图给出了一个简单的集成运算放大器结构
![[Excalidraw/第六章 集成运算放大器以及应用 2023-11-28 20.42.30|900]]
参考[[📘ClassNotes/⚡Circuit/电工电子技术/第五章 基本放大电路|第五章 基本放大电路]], 显然输入级为差分电路(双管输入单管输出), 中间级为射极输出器, 输出级为甲乙类OCL功放电路。
放大器的输入包括<b><mark style="background: transparent; color: blue">同相输入， 反相输入， 差分输入</mark></b>三种方式。

### (2) 理想运算放大器的伏安特性
对于运算放大器而言，<mark style="background: transparent; color: red">具有很高的开环放大倍数和输入电阻, 而输出电阻很小</mark>。可以

| 参数                | 典型范围             | 理想值   |
| ------------------- | -------------------- | -------- |
| 开环电压放大倍数$A$ | $10^{5}\sim 10^{8}$  | $\infty$ |
| 输入电阻            | $10^{5}\sim 10^{13}$ | $\infty$ |
| 输出电阻            | $10\sim 100$         | 0        |
由于输入电阻可达几百$k \Omega$, 则我们可以认为<mark style="background: transparent; color: red">运算放大器的两个输入端电流均为0</mark>, 即有"虚断":
$$\Large \boxed {i_{+}  = i_{-} = 0}$$
而理想集成运算放大器的开环放大倍数为有限值, 则$u_{i} \approx \frac{u_{o}}{A}$, 从而集成运放两输入端电势相等: 
$$\Large \boxed {V_{-} = V_{+}}$$
该等效电路的绘制参考[[Excalidraw/第十一章 含有运算放大器的电路分析 2023-09-20 22.53.28|理想运算放大器的等效电路]] 
`````ad-caution 
title: 重要说明
collapse: open
运算放大器的工作输出电压不超过$U_{CC}$, 从而有**正饱和和负饱和**两种情况， **在非饱和区间中，控制电压$u_2$和$u_1$是线性关系的**, 从而有下图的工作曲线。
在开环的电路中，运算放大器都是工作在饱和区的, 即有上图中$u_{o} \approx U_{CC}$
而<mark style="background: transparent; color: red">一般只有带反馈的放大器是工作在线性区的</mark>
`````
![[Excalidraw/第十一章 含有运算放大器的电路分析 2023-09-20 23.59.12|600]]

### (3) 集成运放的主要参数
1. 开环放大倍数$A_{uo}$ : 指电路没有外接反馈时的放大倍数,  常使用dB表示。并有:
$$A_{uo} \approx 20 \lg \left|\frac{u_{o}}{u_{d}}\right| \text{dB}$$
一般的运放$A_{uo} \approx 140 dB, 10^{4} \sim 10^{7}$ 
2. 最大输出电压$U_{opp}$ : 保证输出电压和输入电压失真不超过允许值时的最大输出电压
3. 输入失调电压$U_{io}$ : 当输入电压为0时的输出电压$u_{o}$为失调电压。
4. 输入失调电流$I_{opp}$ : 输入信号为0时, 两个输入端的静态电流之差。
5. 输入偏置电流$I_{iB}$ : 输入信号为0时, 两个输入端静态电流的平均值， 大小与$\beta$ 有关, 一般为数百nA 
6. 最大共模输入电压$U_{ICM}$ : 输入端承受的最大电压值, 如果超过会导致反向击穿。
7. 输入电阻和输出电阻等 

### (4) 使用集成运放时注意的问题
注意事项包括<mark style="background: transparent; color: red">选件，调零，消振和保护</mark>。
选件时, 当输入信号微弱时，应当选取**高输入电阻， 高共模抑制比，高开环放大倍数和低温漂**的放大器。
调零时注意: 不能在开环状态下调零， 且对于正负电源供电的运算放大器应当保持正负电源对称。 
消振和保护主要是**防止运算放大器内部的自激振荡**, <b><mark style="background: transparent; color: blue">消振的方法是外接RC消振电路或者消振电容</mark></b>。其中<mark style="background: transparent; color: red">保护主要有电源保护, 输入端保护，输出端保护和扩大输出电流(加互补对称电路)</mark>。
![[Excalidraw/第六章 集成运算放大器以及应用 2023-12-01 09.12.17|450]]


## 二、反馈与集成运算放大器的反馈
### (1) 反馈概念与基本反馈模型
**反馈概念**: <mark style="background: transparent; color: red">将放大电路的信号的一部分或者全部引回到输出端</mark>, 与输入信号叠加称为反馈。
正反馈和负反馈: ==主要看引回的输入信号的相位关系==, **相同则正反馈, 加强输入信号, 相反则负反馈**, 削弱输入信号。
![[Excalidraw/第六章 集成运算放大器以及应用 2023-11-29 13.23.03|450]]
我们以**负反馈的闭环放大系数计算**说明反馈电路的参数计算, 首先有关系
$$A = \frac{X_{o}}{X_{d}}\qquad F = \frac{X_{f}}{X_{o}} \qquad  X_{d} = X_{i} - X_{f}$$
从而得到<b><mark style="background: transparent; color: blue">闭环放大系数</mark></b> 
$$\frac{X_{o}}{X_{i}}= \frac{A X_{d}}{X_{d}+ F \cdot A X_{d}} = \frac{A}{1 + AF}$$
其中$|1 + AF| >1$时称为负反馈(>>1 为深度负反馈), 而$|1 + AF| <1$为正反馈, 当$AF= -1$时, $|1 + AF|= 0$, 称为电路产生自激振荡。
`````ad-note
title: 反馈类型的定义
collapse: open
我们需要判断四个(交直流, 串并联, 电流电压, 正负反馈), 其定义在下方给出: 
1. 正反馈和负反馈: 如果**反馈极性相同， 则为正反馈， 相反则负反馈**, 
使用瞬时极性法判断正负反馈。需要注意三极管/MOS管的**集电极和基极是反相的，而发射极和基极同相**(看电流方向), 以下图为例，有:
![[Excalidraw/第六章 集成运算放大器以及应用 2023-11-29 09.21.21|500]]
2. 直流反馈和交流反馈: 如果反馈电路反映了放大电路中的直流量变化，则为直流反馈， 如果反映的是交流量变化， 则为交流反馈 
3. 电压反馈和电流反馈: 取决于**反馈电路和放大电路的输出回路连接方式**， 如果**反馈电路和负载是串联**状态， 则为电流反馈，如果并联则电压反馈
也可以短接输出考察反馈特性，如果短接输出后， 反馈为0，则为并联反馈，如果短接之后，反馈仍然可以不为零， 则为串联反馈
4. 串联反馈和并联反馈: 取决于**反馈电路和放大电路的输入回路连接方式**, 即<b><mark style="background: transparent; color: blue">输入信号, 净输入信号和反馈信号的关系。</mark></b>如果是串联连接， 则为串联反馈， 如果是并联连接， 为电压反馈
注意判断反馈时需要找到$R_{f}$或者$U_{f}$

说明 : 对于三级管， 输入信号为$u_{i}$, 而**净输入信号为**$u_{BE}$或者$I_{B}$, 具体视反馈情况而言, 以[[📘ClassNotes/⚡Circuit/电工电子技术/第五章 基本放大电路#三、分压式偏置电路|分压式偏置电路]]而言, 为了稳定的电流是$I_{C}$, 则有关系:   
$$I_{C} \rightarrow X_{o} \qquad V_{B} = u_{i} = X_{i}\qquad V_{E} = I_{E} R_{E} = X_{f} \qquad u_{BE}  = X_{i} - X_{f}$$
容易判断出分压式偏置电路是**串联电流负反馈**(由于是在端口处电压相加减) 
`````

<b><mark style="background: transparent; color: red">四种基本的反馈结构模型</mark></b>如下图所示: 
![[Excalidraw/第六章 集成运算放大器以及应用 2023-11-29 20.18.57|800]]

### (2) 运算放大器的反馈类型判断
**对于运算放大器的判断方法**如下(注意第四种仅是简便方法): 
![[Excalidraw/第六章 集成运算放大器以及应用 2023-11-29 09.29.18|650]]
因此我们给出下列的**运算放大器典型反馈电路**(分析已经在图中给出, 电压反馈同相，电流反馈反相, 因此串联一般接"+", 并联一般接"-"): 
![[Excalidraw/第六章 集成运算放大器以及应用 2023-11-29 18.17.32|900]]
需要说明的是, 直流的反馈是起到稳定静态工作点的作用，而**交流反馈是起到稳定工作点(稳定工作电压或者电流)的作用**, 一般使用**电压串联反馈方法稳定输出电压**, **电流串联反馈方法稳定电流**(这是由于输入一般都视为电压源, 因此串联方法可以稳定$u_d$, 从而起到稳定输出的作用, 而**电压负反馈可以稳定输出电压, 电流负反馈可以稳定输出电流**)

### (3) 反馈现象对电路的影响
#### 1. 降低放大倍数
参考[[#(1) 反馈概念与基本反馈模型]]显然有闭环放大倍数
$$\frac{X_{o}}{X_{i}} = \frac{A}{1 + AF}$$
显然$AF =  x_{f}/x_{d}$
#### 2. 提高放大倍数的稳定性
考察**放大倍数的稳定性**时, 只需考虑开环放大倍数$A$增大$dA$时闭环放大倍数$A_f$的变化情况
$$A_{f} = \frac{A}{1 + AF}\qquad dA_{f} = \frac{(1 + AF) - AF}{(1 + AF)^{2}}dA = \frac{1}{(1 + AF)^{2}} dA $$
则**我们取变化的百分比为稳定性**,计算为: 
$$\frac{dA_{f}}{A_{f}} = \frac{1}{(1 + AF)}\frac{dA}{A}$$
即**稳定性提升$1 + AF$倍**
#### 3. 改善非线性失真
对于运算放大器附近有磁场或者电场存在时， 会导致感应电压干扰， 负反馈可以起到稳定电压的作用， 从而降低非线性失真干扰。 
注意只能改善非线性失真，但不能消除失真。
#### 4. 展宽通频带
![[Excalidraw/第六章 集成运算放大器以及应用 2023-11-29 22.17.47|300]]
有关系
$$BW_{f} = (1 + AF) BW$$
#### 5. 改变输入和输出电阻

| 负反馈方式 | 电压并联 | 电压串联 | 电流并联 | 电流串联 |
| ---------- | -------- | -------- | -------- | -------- |
| 输入电阻   | 减小     | 增大     | 减小     | 增大     |
| 输出电阻   | 减小     | 减小     | 增大     | 增大     | 

## 三、集成运算放大器的线性应用
<mark style="background: transparent; color: red">集成运算放大器线性应用即使放大器工作在线性区</mark>, 即带有反馈的运算放大器分析和设计。 
### (1) 比例运算和加减电路
利用[[#(2) 理想运算放大器的伏安特性|运算放大器的伏安特性]]很容易得到如下的设计:
![[attachments/Pasted image 20231130164030.png|900]]
其中,只需利用输入端电流为0电压相等分析即可, 容易推导出:
$$1: u_{o} = - \frac{R_{f1}}{R_{1}} u_{i}\qquad  2: u_{o} = \frac{R_{f2}}{R_{2}} u_{i} \qquad  3: u_{o} = u_{i}$$
![[attachments/Pasted image 20231130164435.png|550]]
**加法运算**电路: 
$$\Large {u_{o} = - R_{f4} \left(\frac{u_{i1}}{R_{i1}} + \frac{u_{i2}}{R_{i2}} + \frac{u_{i3}}{R_{i3}}\right)}s$$
**减法运算**电路: 
$$\Large \boxed{u_{o} = u_{i1} \frac{R_{33}}{R_{32} +  R_{33}} \left(1 + \frac{R_{f3}}{R_{31}}\right) - u_{i2} \frac{R_{f3}}{R_{31}}\xlongequal{R_{33} = R_{f3}, R_{32} = R_{31}} \frac{R_{f3}}{R_{31}} (u_{i1}- u_{i2} ) }$$
### (2) 微积分运算电路 
![[Excalidraw/第六章 集成运算放大器以及应用 2023-11-30 16.59.28|800]]
利用电容的特性: 
$$i = C \frac{du}{dt}\qquad u = \frac{1}{C} \int i dt$$
**积分运算**电路: 
$$u_{o} =-\frac{1}{R_{3}C}\int u_{i} dt$$
**微分运算**电路:
$$u_{o} = - R_{7}C \frac{du_{i}}{dt}$$
## 四、集成运算放大器的非线性应用
### (1) 电压比较电路
当运算放大器不加反馈时, 是工作在饱和状态的,  相当于一个正负极电压的**比较器**, 此时只要接入双向稳压二极管(不算反馈, 由于哪一边都是断路), 则可以起到电压限幅的作用, 
![[Excalidraw/第六章 集成运算放大器以及应用 2023-11-30 20.05.12|900]]
此时, 我们可以使用上述的结构作为电压比较或者过零比较电路。

### (2) 信号发生器电路 
![[Excalidraw/第六章 集成运算放大器以及应用 2023-11-30 20.25.23|550]]
上图是一个**矩形波发生电路(由于含有多种谐波成分, 也称为多谐振荡电路)**, 其中设$u_{c}$为输入, 则该网络使用**电压串联负反馈**。由于是工作在饱和状态的, 我们首先设初始时, 电路的输入电压$u_{c}$处在峰值, 反馈电压听过下方分压$u_{f}$在实现电压负反馈, 而使用双向稳压二极管使得输出被钳制在$U_{z}$或者$- U_{z}$
$$U_{+} =  U_{f} = \frac{R_{18}}{R_{14}+ R_{18}} U_{z}\qquad  U_{-} = - \frac{R_{18}}{R_{14} + R_{18}} U_{z}$$
参考[[attachments/Pasted image 20231130225531.png|信号发生器电路仿真图]], 可以得到如下仿真波形(中间为输入三角波,下方为稳压二极管处产生的矩形波), **当$u_c$略大于$u_{+}$时, 即发生跃变**。
![[attachments/Pasted image 20231130225454.png|600]]
输出矩形波的周期和频率计算为:
$$T = 2R_{F} C\ln \left(1 + \frac{2 R_{2}}{R_{1}}\right)\qquad f = \frac{1}{2R_{f} C \ln \left(1 + \frac{2 R_{2}}{R_{1}}\right)}$$
其中$R_{F} C$为**时间常数, 通过改变$R_{F}C$可以改变输出的正弦波频率**。

### (3) RC 正弦波振荡选频电路 
参考[[#(1) 反馈概念与基本反馈模型]], 当反馈电路满足条件
$$|AF| = 1$$
时, 称为**自激振荡电路**。
显然在**自激振荡发生**时有关系:
$$A = \frac{\dot{U}_{o}}{\dot{U}_{i}} = \frac{\dot{U}_{o}}{\dot{U}_{f}}$$
此时, 由于$AF = |A|  |F|\angle\varphi_{A} + \varphi_{F} = 1$, 则有 
$$\Large \boxed{|AF| = 1, \varphi_{A} + \varphi_{F} = 2n \pi}$$
上式称为<b><mark style="background: transparent; color: blue">自激振荡条件</mark></b>。因此反馈电压与输入电压相位相同, 必须为正反馈。需要注意的是, 实际电路是从$|AF| > 1$到$|AF| = 1$的自激振荡建立过程, 过程中$A$由于晶体管非线性逐渐降低。

**选频电路**是**对所需频率的信号进行放大, 而对 其他的频率加以抑制**的电路, 基本原理是**反馈系数达到最大**
![[Excalidraw/第六章 集成运算放大器以及应用 2023-12-01 09.44.07|700]]
振荡电路如左图, 显然是**电压串联负反馈**类型(由$R, R_{3}$组成负反馈), 从而控制$|AF| \geq  1$, 称为**起振条件或者幅值条件**。左侧电路有四个桥臂$R_{1} C_{1}, R_{2} C_{2}, R_{F} , R_{3}$构成电桥。也称为文氏桥式振荡电路。

我们常常取左侧部分$R_{1} = R_{2} = R, C_{1}= C_{2} = C$
通过[[📘ClassNotes/⚡Circuit/电工电子技术/补充部分/RC选频电路串并联谐振相关推导.pdf|RC选频电路串并联谐振相关推导.pdf]]可以推导出带有运放的**谐振频率**以及谐振时的反馈系数为:
$$\Large\boxed{\omega_{0}= \frac{1}{RC}\qquad  F_{\omega 0} = F_{\max} = \frac{1}{3} = \frac{U_{i}}{U_{o}}}$$
并且有谐振时的关系: $R_{F}  = 2R_{3}$ 

当取$C_2 = C_3  = C, R_4 = R_5 = R$时, 有关系: 


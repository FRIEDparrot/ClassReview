**Linux 主机通过 Wi-Fi 连接到局域网**，而你有一台 **公网 IP 的云服务器**。如果公网服务器需要作为前端来访问后端数据库服务器（即 Linux 主机），这种情况下是可以通过 **FRP** 实现内网穿透的。

### **关键要点**：
- **公网服务器（云服务器）**：作为 FRP 的服务端，负责接收来自客户端的连接请求，并将流量转发到 Linux 主机。
- **Linux 主机（Wi-Fi 连接）**：通过 FRP 客户端将内网服务暴露到公网服务器，使得公网服务器可以访问它。

### **总体方案**：
1. **FRP 服务端部署（公网服务器）**：公网服务器上运行 `frps`，它将接收来自 FRP 客户端（Linux 主机）的连接请求。
2. **FRP 客户端部署（Linux 主机）**：Linux 主机通过 Wi-Fi 连接到局域网，并运行 `frpc` 客户端，将其服务暴露给公网服务器。
3. **公网服务器作为前端访问后端（数据库）**：公网服务器通过 FRP 服务端访问 Linux 主机的数据库或其他后端服务。

### **步骤 1：在公网服务器上配置 FRP 服务端 (`frps`)**
1. **下载和解压 FRP**：
   下载适合你云服务器的 FRP 版本，并解压。

2. **配置 FRP 服务端 (`frps.ini`)**：
   编辑 `frps.ini` 配置文件：

```ini
[common]
bind_port = 7000        # 服务端监听端口
dashboard_port = 7500   # （可选）Web 管理界面端口
dashboard_user = admin  # 管理界面用户名
dashboard_pwd = admin   # 管理界面密码
```

3. **启动 FRP 服务端**：
   在云服务器上启动 `frps`：

```bash
./frps -c frps.ini
```

   确保 `7000` 和 `7500` 端口对外开放，并且服务器可以接受流量。

---

### **步骤 2：在 Linux 主机上配置 FRP 客户端 (`frpc`)**
1. **下载和解压 FRP**：
   在 Linux 主机上下载并解压 FRP。

2. **配置 FRP 客户端 (`frpc.ini`)**：
   在 Linux 主机上编辑 `frpc.ini` 配置文件，将其连接到公网服务器（云服务器）：

```ini
[common]
server_addr = 公网服务器IP       # 公网服务器的 IP
server_port = 7000              # 公网服务器监听的端口

[mysql]
type = tcp
local_ip = 127.0.0.1            # 本地 MySQL 服务地址
local_port = 3306               # 本地 MySQL 服务端口
remote_port = 6000              # 映射到公网的端口
```

   - `local_ip` 和 `local_port` 是 Linux 主机上的数据库地址和端口。
   - `remote_port` 是公网服务器上暴露的端口，客户端可以通过此端口访问 Linux 主机的 MySQL 服务。

3. **启动 FRP 客户端**：
   在 Linux 主机上启动 `frpc`：

```bash
./frpc -c frpc.ini
```

---

### **步骤 3：公网服务器作为前端访问后端（数据库）**
1. **访问数据库**：
   公网服务器上的前端应用可以通过访问 FRP 映射的端口（`6000`）来连接 Linux 主机上的 MySQL 数据库。

例如，连接数据库时使用以下 IP 和端口：
```bash
mysql -h 公网服务器IP -P 6000 -u 用户名 -p
```

2. **配置数据库防火墙**：
   确保数据库和 Linux 主机的防火墙允许连接。你可能需要在 Linux 上调整防火墙规则（如果启用了）。

---

### **步骤 4：确认网络设置**
1. **确认 FRP 配置正确**：确保 `frps` 服务端和 `frpc` 客户端配置文件中的 IP 和端口设置正确。
2. **检查网络通路**：
   - 在 Linux 主机上通过 `ping` 测试公网服务器是否可访问。
   - 确保公网上的端口（如 `7000`、`6000`）对外开放，并正确转发。

---

### **附加说明：路由设置**
如果你的云服务器和 Linux 主机分别位于不同的网络中（例如，云服务器有公网 IP，Linux 主机通过 Wi-Fi 连接到局域网），FRP 会处理大部分的流量转发工作。但是，如果网络环境复杂（例如，有多个网关），你可能需要：
- 确保 Linux 主机能够访问公网服务器的 IP（检查路由设置）。
- 如果需要，调整云服务器或路由器的端口转发规则，以确保 FRP 的流量能够正确到达 Linux 主机。

---

### **总结**
- **云服务器作为 FRP 服务端**，接受来自 **Linux 主机** 的连接。
- **Linux 主机通过 FRP 客户端**，将其数据库或其他服务暴露到公网服务器。
- **公网服务器上的前端应用** 通过 FRP 转发的端口访问 Linux 主机的数据库。

这样就可以实现内网穿透，让公网服务器（作为前端）访问 Linux 主机的后端服务（如数据库）。





要在 **UFW**（Uncomplicated Firewall）上开放指定的端口（如 `6500`），以便其他设备可以通过此端口访问服务，请按照以下步骤操作：

---

### **步骤 1：查看 UFW 状态**
检查 UFW 是否启用，以及现有规则：
```bash
sudo ufw status
```
- 如果显示 **inactive**，需要先启用 UFW。
- 如果已经启用，确保当前规则不会影响你的服务。

---

### **步骤 2：允许 `6500` 端口的流量**
执行以下命令以开放端口 `6500`：
```bash
sudo ufw allow 6500
```

- **允许 TCP**（默认是 TCP）：
  ```bash
  sudo ufw allow 6500/tcp
  ```
- 如果服务使用的是 **UDP**：
  ```bash
  sudo ufw allow 6500/udp
  ```

---

### **步骤 3：重启 UFW**
更新防火墙规则后，确保 UFW 正常运行：
```bash
sudo ufw reload
```

---

### **步骤 4：验证端口是否开放**
使用以下命令验证端口状态：
```bash
sudo ufw status numbered
```

你应该看到类似的输出，显示 `6500` 已被允许：
```
To                         Action      From
--                         ------      ----
6500                       ALLOW       Anywhere
6500 (v6)                  ALLOW       Anywhere (v6)
```

或者通过以下命令检查端口是否监听：
```bash
sudo netstat -tuln | grep 6500
```

---

### **步骤 5：测试端口连通性**
从外部设备检查是否可以访问端口 `6500`：
```bash
telnet <服务器IP> 6500
```

如果返回连接成功 (`Connected`)，说明端口已正确开放并可访问。

---

### **注意事项**
1. **检查服务是否绑定到 `6500`**：
   确保在服务器上运行的服务（如 FRP 服务端）已绑定到 `6500` 端口。
   - 检查服务是否监听：
     ```bash
     sudo netstat -tuln | grep 6500
     ```
   - 如果没有绑定，检查服务配置（如 `frps.ini`）。

2. **云服务商安全组设置**：
   如果你的云服务器使用安全组（如阿里云、腾讯云等），需要在云控制台中开放对应端口（`6500`）。UFW 只控制本地防火墙，但云控制台的安全组规则会影响公网访问。

3. **确保 FRP 服务正常运行**：
   - 检查 `frps` 是否正在监听 `6500`。
   - 确保 FRP 客户端（`frpc`）已正确连接到服务端。

---

### 完整命令示例
```bash
# 开放 6500 端口
sudo ufw allow 6500/tcp

# 重启 UFW 以应用规则
sudo ufw reload

# 检查端口是否已开放
sudo ufw status numbered
```


需要说明的是, 对于工作站 mysql 主机的配置, 为了安全起见, 仅允许从联网主机地址进行访问, 不允许动态 ip 地址的 pc 访问,  这会增加风险。


LINUX 服务器上采用 
```sh
sudo apt install mysql-client
```


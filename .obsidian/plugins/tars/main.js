/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var up=Object.create;var Ts=Object.defineProperty;var fp=Object.getOwnPropertyDescriptor;var dp=Object.getOwnPropertyNames;var hp=Object.getPrototypeOf,pp=Object.prototype.hasOwnProperty;var I=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),Cc=(t,e)=>{for(var r in e)Ts(t,r,{get:e[r],enumerable:!0})},xc=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let s of dp(e))!pp.call(t,s)&&s!==r&&Ts(t,s,{get:()=>e[s],enumerable:!(n=fp(e,s))||n.enumerable});return t};var mp=(t,e,r)=>(r=t!=null?up(hp(t)):{},xc(e||!t||!t.__esModule?Ts(r,"default",{value:t,enumerable:!0}):r,t)),gp=t=>xc(Ts({},"__esModule",{value:!0}),t);var de=I(be=>{"use strict";be.__esModule=!0;be.extend=gd;be.indexOf=Kw;be.escapeExpression=Vw;be.isEmpty=Ww;be.createFrame=Jw;be.blockParams=$w;be.appendContextPath=Gw;var qw={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;","=":"&#x3D;"},Uw=/[&<>"'`=]/g,Hw=/[&<>"'`=]/;function jw(t){return qw[t]}function gd(t){for(var e=1;e<arguments.length;e++)for(var r in arguments[e])Object.prototype.hasOwnProperty.call(arguments[e],r)&&(t[r]=arguments[e][r]);return t}var Ol=Object.prototype.toString;be.toString=Ol;var Pl=function(e){return typeof e=="function"};Pl(/x/)&&(be.isFunction=Pl=function(t){return typeof t=="function"&&Ol.call(t)==="[object Function]"});be.isFunction=Pl;var yd=Array.isArray||function(t){return t&&typeof t=="object"?Ol.call(t)==="[object Array]":!1};be.isArray=yd;function Kw(t,e){for(var r=0,n=t.length;r<n;r++)if(t[r]===e)return r;return-1}function Vw(t){if(typeof t!="string"){if(t&&t.toHTML)return t.toHTML();if(t==null)return"";if(!t)return t+"";t=""+t}return Hw.test(t)?t.replace(Uw,jw):t}function Ww(t){return!t&&t!==0?!0:!!(yd(t)&&t.length===0)}function Jw(t){var e=gd({},t);return e._parent=t,e}function $w(t,e){return t.path=e,t}function Gw(t,e){return(t?t+".":"")+e}});var Ae=I(($o,wd)=>{"use strict";$o.__esModule=!0;var Tl=["description","fileName","lineNumber","endLineNumber","message","name","number","stack"];function Il(t,e){var r=e&&e.loc,n=void 0,s=void 0,o=void 0,i=void 0;r&&(n=r.start.line,s=r.end.line,o=r.start.column,i=r.end.column,t+=" - "+n+":"+o);for(var a=Error.prototype.constructor.call(this,t),l=0;l<Tl.length;l++)this[Tl[l]]=a[Tl[l]];Error.captureStackTrace&&Error.captureStackTrace(this,Il);try{r&&(this.lineNumber=n,this.endLineNumber=s,Object.defineProperty?(Object.defineProperty(this,"column",{value:o,enumerable:!0}),Object.defineProperty(this,"endColumn",{value:i,enumerable:!0})):(this.column=o,this.endColumn=i))}catch(c){}}Il.prototype=new Error;$o.default=Il;wd.exports=$o.default});var bd=I((Go,_d)=>{"use strict";Go.__esModule=!0;var kl=de();Go.default=function(t){t.registerHelper("blockHelperMissing",function(e,r){var n=r.inverse,s=r.fn;if(e===!0)return s(this);if(e===!1||e==null)return n(this);if(kl.isArray(e))return e.length>0?(r.ids&&(r.ids=[r.name]),t.helpers.each(e,r)):n(this);if(r.data&&r.ids){var o=kl.createFrame(r.data);o.contextPath=kl.appendContextPath(r.data.contextPath,r.name),r={data:o}}return s(e,r)})};_d.exports=Go.default});var Ed=I((zo,Sd)=>{"use strict";zo.__esModule=!0;function zw(t){return t&&t.__esModule?t:{default:t}}var gs=de(),Xw=Ae(),Yw=zw(Xw);zo.default=function(t){t.registerHelper("each",function(e,r){if(!r)throw new Yw.default("Must pass iterator to #each");var n=r.fn,s=r.inverse,o=0,i="",a=void 0,l=void 0;r.data&&r.ids&&(l=gs.appendContextPath(r.data.contextPath,r.ids[0])+"."),gs.isFunction(e)&&(e=e.call(this)),r.data&&(a=gs.createFrame(r.data));function c(p,g,w){a&&(a.key=p,a.index=g,a.first=g===0,a.last=!!w,l&&(a.contextPath=l+p)),i=i+n(e[p],{data:a,blockParams:gs.blockParams([e[p],p],[l+p,null])})}if(e&&typeof e=="object")if(gs.isArray(e))for(var f=e.length;o<f;o++)o in e&&c(o,o,o===e.length-1);else if(typeof Symbol=="function"&&e[Symbol.iterator]){for(var u=[],d=e[Symbol.iterator](),h=d.next();!h.done;h=d.next())u.push(h.value);e=u;for(var f=e.length;o<f;o++)c(o,o,o===e.length-1)}else(function(){var p=void 0;Object.keys(e).forEach(function(g){p!==void 0&&c(p,o-1),p=g,o++}),p!==void 0&&c(p,o-1,!0)})();return o===0&&(i=s(this)),i})};Sd.exports=zo.default});var Cd=I((Xo,vd)=>{"use strict";Xo.__esModule=!0;function Qw(t){return t&&t.__esModule?t:{default:t}}var Zw=Ae(),e_=Qw(Zw);Xo.default=function(t){t.registerHelper("helperMissing",function(){if(arguments.length!==1)throw new e_.default('Missing helper: "'+arguments[arguments.length-1].name+'"')})};vd.exports=Xo.default});var Pd=I((Yo,Rd)=>{"use strict";Yo.__esModule=!0;function t_(t){return t&&t.__esModule?t:{default:t}}var xd=de(),r_=Ae(),Ad=t_(r_);Yo.default=function(t){t.registerHelper("if",function(e,r){if(arguments.length!=2)throw new Ad.default("#if requires exactly one argument");return xd.isFunction(e)&&(e=e.call(this)),!r.hash.includeZero&&!e||xd.isEmpty(e)?r.inverse(this):r.fn(this)}),t.registerHelper("unless",function(e,r){if(arguments.length!=2)throw new Ad.default("#unless requires exactly one argument");return t.helpers.if.call(this,e,{fn:r.inverse,inverse:r.fn,hash:r.hash})})};Rd.exports=Yo.default});var Td=I((Qo,Od)=>{"use strict";Qo.__esModule=!0;Qo.default=function(t){t.registerHelper("log",function(){for(var e=[void 0],r=arguments[arguments.length-1],n=0;n<arguments.length-1;n++)e.push(arguments[n]);var s=1;r.hash.level!=null?s=r.hash.level:r.data&&r.data.level!=null&&(s=r.data.level),e[0]=s,t.log.apply(t,e)})};Od.exports=Qo.default});var kd=I((Zo,Id)=>{"use strict";Zo.__esModule=!0;Zo.default=function(t){t.registerHelper("lookup",function(e,r,n){return e&&n.lookupProperty(e,r)})};Id.exports=Zo.default});var Ld=I((ei,Nd)=>{"use strict";ei.__esModule=!0;function n_(t){return t&&t.__esModule?t:{default:t}}var ys=de(),s_=Ae(),o_=n_(s_);ei.default=function(t){t.registerHelper("with",function(e,r){if(arguments.length!=2)throw new o_.default("#with requires exactly one argument");ys.isFunction(e)&&(e=e.call(this));var n=r.fn;if(ys.isEmpty(e))return r.inverse(this);var s=r.data;return r.data&&r.ids&&(s=ys.createFrame(r.data),s.contextPath=ys.appendContextPath(r.data.contextPath,r.ids[0])),n(e,{data:s,blockParams:ys.blockParams([e],[s&&s.contextPath])})})};Nd.exports=ei.default});var Nl=I(ti=>{"use strict";ti.__esModule=!0;ti.registerDefaultHelpers=b_;ti.moveHelperToHooks=S_;function dr(t){return t&&t.__esModule?t:{default:t}}var i_=bd(),a_=dr(i_),l_=Ed(),c_=dr(l_),u_=Cd(),f_=dr(u_),d_=Pd(),h_=dr(d_),p_=Td(),m_=dr(p_),g_=kd(),y_=dr(g_),w_=Ld(),__=dr(w_);function b_(t){a_.default(t),c_.default(t),f_.default(t),h_.default(t),m_.default(t),y_.default(t),__.default(t)}function S_(t,e,r){t.helpers[e]&&(t.hooks[e]=t.helpers[e],r||delete t.helpers[e])}});var Dd=I((ri,Md)=>{"use strict";ri.__esModule=!0;var E_=de();ri.default=function(t){t.registerDecorator("inline",function(e,r,n,s){var o=e;return r.partials||(r.partials={},o=function(i,a){var l=n.partials;n.partials=E_.extend({},l,r.partials);var c=e(i,a);return n.partials=l,c}),r.partials[s.args[0]]=s.fn,o})};Md.exports=ri.default});var Bd=I(Ll=>{"use strict";Ll.__esModule=!0;Ll.registerDefaultDecorators=A_;function v_(t){return t&&t.__esModule?t:{default:t}}var C_=Dd(),x_=v_(C_);function A_(t){x_.default(t)}});var Ml=I((ni,Fd)=>{"use strict";ni.__esModule=!0;var R_=de(),pn={methodMap:["debug","info","warn","error"],level:"info",lookupLevel:function(e){if(typeof e=="string"){var r=R_.indexOf(pn.methodMap,e.toLowerCase());r>=0?e=r:e=parseInt(e,10)}return e},log:function(e){if(e=pn.lookupLevel(e),typeof console!="undefined"&&pn.lookupLevel(pn.level)<=e){var r=pn.methodMap[e];console[r]||(r="log");for(var n=arguments.length,s=Array(n>1?n-1:0),o=1;o<n;o++)s[o-1]=arguments[o];console[r].apply(console,s)}}};ni.default=pn;Fd.exports=ni.default});var qd=I(Dl=>{"use strict";Dl.__esModule=!0;Dl.createNewLookupObject=O_;var P_=de();function O_(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return P_.extend.apply(void 0,[Object.create(null)].concat(e))}});var Bl=I(ws=>{"use strict";ws.__esModule=!0;ws.createProtoAccessControl=N_;ws.resultIsAllowed=L_;ws.resetLoggedProperties=D_;function T_(t){return t&&t.__esModule?t:{default:t}}var Ud=qd(),I_=Ml(),k_=T_(I_),si=Object.create(null);function N_(t){var e=Object.create(null);e.constructor=!1,e.__defineGetter__=!1,e.__defineSetter__=!1,e.__lookupGetter__=!1;var r=Object.create(null);return r.__proto__=!1,{properties:{whitelist:Ud.createNewLookupObject(r,t.allowedProtoProperties),defaultValue:t.allowProtoPropertiesByDefault},methods:{whitelist:Ud.createNewLookupObject(e,t.allowedProtoMethods),defaultValue:t.allowProtoMethodsByDefault}}}function L_(t,e,r){return Hd(typeof t=="function"?e.methods:e.properties,r)}function Hd(t,e){return t.whitelist[e]!==void 0?t.whitelist[e]===!0:t.defaultValue!==void 0?t.defaultValue:(M_(e),!1)}function M_(t){si[t]!==!0&&(si[t]=!0,k_.default.log("error",'Handlebars: Access has been denied to resolve the property "'+t+`" because it is not an "own property" of its parent.
You can add a runtime option to disable the check or this warning:
See https://handlebarsjs.com/api-reference/runtime-options.html#options-to-control-prototype-access for details`))}function D_(){Object.keys(si).forEach(function(t){delete si[t]})}});var ii=I(Ye=>{"use strict";Ye.__esModule=!0;Ye.HandlebarsEnvironment=Ul;function jd(t){return t&&t.__esModule?t:{default:t}}var hr=de(),B_=Ae(),Fl=jd(B_),F_=Nl(),q_=Bd(),U_=Ml(),oi=jd(U_),H_=Bl(),j_="4.7.8";Ye.VERSION=j_;var K_=8;Ye.COMPILER_REVISION=K_;var V_=7;Ye.LAST_COMPATIBLE_COMPILER_REVISION=V_;var W_={1:"<= 1.0.rc.2",2:"== 1.0.0-rc.3",3:"== 1.0.0-rc.4",4:"== 1.x.x",5:"== 2.0.0-alpha.x",6:">= 2.0.0-beta.1",7:">= 4.0.0 <4.3.0",8:">= 4.3.0"};Ye.REVISION_CHANGES=W_;var ql="[object Object]";function Ul(t,e,r){this.helpers=t||{},this.partials=e||{},this.decorators=r||{},F_.registerDefaultHelpers(this),q_.registerDefaultDecorators(this)}Ul.prototype={constructor:Ul,logger:oi.default,log:oi.default.log,registerHelper:function(e,r){if(hr.toString.call(e)===ql){if(r)throw new Fl.default("Arg not supported with multiple helpers");hr.extend(this.helpers,e)}else this.helpers[e]=r},unregisterHelper:function(e){delete this.helpers[e]},registerPartial:function(e,r){if(hr.toString.call(e)===ql)hr.extend(this.partials,e);else{if(typeof r=="undefined")throw new Fl.default('Attempting to register a partial called "'+e+'" as undefined');this.partials[e]=r}},unregisterPartial:function(e){delete this.partials[e]},registerDecorator:function(e,r){if(hr.toString.call(e)===ql){if(r)throw new Fl.default("Arg not supported with multiple decorators");hr.extend(this.decorators,e)}else this.decorators[e]=r},unregisterDecorator:function(e){delete this.decorators[e]},resetLoggedPropertyAccesses:function(){H_.resetLoggedProperties()}};var J_=oi.default.log;Ye.log=J_;Ye.createFrame=hr.createFrame;Ye.logger=oi.default});var Vd=I((ai,Kd)=>{"use strict";ai.__esModule=!0;function Hl(t){this.string=t}Hl.prototype.toString=Hl.prototype.toHTML=function(){return""+this.string};ai.default=Hl;Kd.exports=ai.default});var Wd=I(jl=>{"use strict";jl.__esModule=!0;jl.wrapHelper=$_;function $_(t,e){if(typeof t!="function")return t;var r=function(){var s=arguments[arguments.length-1];return arguments[arguments.length-1]=e(s),t.apply(this,arguments)};return r}});var Xd=I(Nt=>{"use strict";Nt.__esModule=!0;Nt.checkRevision=Z_;Nt.template=eb;Nt.wrapProgram=li;Nt.resolvePartial=tb;Nt.invokePartial=rb;Nt.noop=Gd;function G_(t){return t&&t.__esModule?t:{default:t}}function z_(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}var X_=de(),ut=z_(X_),Y_=Ae(),ft=G_(Y_),dt=ii(),Jd=Nl(),Q_=Wd(),$d=Bl();function Z_(t){var e=t&&t[0]||1,r=dt.COMPILER_REVISION;if(!(e>=dt.LAST_COMPATIBLE_COMPILER_REVISION&&e<=dt.COMPILER_REVISION))if(e<dt.LAST_COMPATIBLE_COMPILER_REVISION){var n=dt.REVISION_CHANGES[r],s=dt.REVISION_CHANGES[e];throw new ft.default("Template was precompiled with an older version of Handlebars than the current runtime. Please update your precompiler to a newer version ("+n+") or downgrade your runtime to an older version ("+s+").")}else throw new ft.default("Template was precompiled with a newer version of Handlebars than the current runtime. Please update your runtime to a newer version ("+t[1]+").")}function eb(t,e){if(!e)throw new ft.default("No environment passed to template");if(!t||!t.main)throw new ft.default("Unknown template object: "+typeof t);t.main.decorator=t.main_d,e.VM.checkRevision(t.compiler);var r=t.compiler&&t.compiler[0]===7;function n(i,a,l){l.hash&&(a=ut.extend({},a,l.hash),l.ids&&(l.ids[0]=!0)),i=e.VM.resolvePartial.call(this,i,a,l);var c=ut.extend({},l,{hooks:this.hooks,protoAccessControl:this.protoAccessControl}),f=e.VM.invokePartial.call(this,i,a,c);if(f==null&&e.compile&&(l.partials[l.name]=e.compile(i,t.compilerOptions,e),f=l.partials[l.name](a,c)),f!=null){if(l.indent){for(var u=f.split(`
`),d=0,h=u.length;d<h&&!(!u[d]&&d+1===h);d++)u[d]=l.indent+u[d];f=u.join(`
`)}return f}else throw new ft.default("The partial "+l.name+" could not be compiled when running in runtime-only mode")}var s={strict:function(a,l,c){if(!a||!(l in a))throw new ft.default('"'+l+'" not defined in '+a,{loc:c});return s.lookupProperty(a,l)},lookupProperty:function(a,l){var c=a[l];if(c==null||Object.prototype.hasOwnProperty.call(a,l)||$d.resultIsAllowed(c,s.protoAccessControl,l))return c},lookup:function(a,l){for(var c=a.length,f=0;f<c;f++){var u=a[f]&&s.lookupProperty(a[f],l);if(u!=null)return a[f][l]}},lambda:function(a,l){return typeof a=="function"?a.call(l):a},escapeExpression:ut.escapeExpression,invokePartial:n,fn:function(a){var l=t[a];return l.decorator=t[a+"_d"],l},programs:[],program:function(a,l,c,f,u){var d=this.programs[a],h=this.fn(a);return l||u||f||c?d=li(this,a,h,l,c,f,u):d||(d=this.programs[a]=li(this,a,h)),d},data:function(a,l){for(;a&&l--;)a=a._parent;return a},mergeIfNeeded:function(a,l){var c=a||l;return a&&l&&a!==l&&(c=ut.extend({},l,a)),c},nullContext:Object.seal({}),noop:e.VM.noop,compilerInfo:t.compiler};function o(i){var a=arguments.length<=1||arguments[1]===void 0?{}:arguments[1],l=a.data;o._setup(a),!a.partial&&t.useData&&(l=nb(i,l));var c=void 0,f=t.useBlockParams?[]:void 0;t.useDepths&&(a.depths?c=i!=a.depths[0]?[i].concat(a.depths):a.depths:c=[i]);function u(d){return""+t.main(s,d,s.helpers,s.partials,l,f,c)}return u=zd(t.main,u,s,a.depths||[],l,f),u(i,a)}return o.isTop=!0,o._setup=function(i){if(i.partial)s.protoAccessControl=i.protoAccessControl,s.helpers=i.helpers,s.partials=i.partials,s.decorators=i.decorators,s.hooks=i.hooks;else{var a=ut.extend({},e.helpers,i.helpers);sb(a,s),s.helpers=a,t.usePartial&&(s.partials=s.mergeIfNeeded(i.partials,e.partials)),(t.usePartial||t.useDecorators)&&(s.decorators=ut.extend({},e.decorators,i.decorators)),s.hooks={},s.protoAccessControl=$d.createProtoAccessControl(i);var l=i.allowCallsToHelperMissing||r;Jd.moveHelperToHooks(s,"helperMissing",l),Jd.moveHelperToHooks(s,"blockHelperMissing",l)}},o._child=function(i,a,l,c){if(t.useBlockParams&&!l)throw new ft.default("must pass block params");if(t.useDepths&&!c)throw new ft.default("must pass parent depths");return li(s,i,t[i],a,0,l,c)},o}function li(t,e,r,n,s,o,i){function a(l){var c=arguments.length<=1||arguments[1]===void 0?{}:arguments[1],f=i;return i&&l!=i[0]&&!(l===t.nullContext&&i[0]===null)&&(f=[l].concat(i)),r(t,l,t.helpers,t.partials,c.data||n,o&&[c.blockParams].concat(o),f)}return a=zd(r,a,t,i,n,o),a.program=e,a.depth=i?i.length:0,a.blockParams=s||0,a}function tb(t,e,r){return t?!t.call&&!r.name&&(r.name=t,t=r.partials[t]):r.name==="@partial-block"?t=r.data["partial-block"]:t=r.partials[r.name],t}function rb(t,e,r){var n=r.data&&r.data["partial-block"];r.partial=!0,r.ids&&(r.data.contextPath=r.ids[0]||r.data.contextPath);var s=void 0;if(r.fn&&r.fn!==Gd&&function(){r.data=dt.createFrame(r.data);var o=r.fn;s=r.data["partial-block"]=function(a){var l=arguments.length<=1||arguments[1]===void 0?{}:arguments[1];return l.data=dt.createFrame(l.data),l.data["partial-block"]=n,o(a,l)},o.partials&&(r.partials=ut.extend({},r.partials,o.partials))}(),t===void 0&&s&&(t=s),t===void 0)throw new ft.default("The partial "+r.name+" could not be found");if(t instanceof Function)return t(e,r)}function Gd(){return""}function nb(t,e){return(!e||!("root"in e))&&(e=e?dt.createFrame(e):{},e.root=t),e}function zd(t,e,r,n,s,o){if(t.decorator){var i={};e=t.decorator(e,i,r,n&&n[0],s,o,n),ut.extend(e,i)}return e}function sb(t,e){Object.keys(t).forEach(function(r){var n=t[r];t[r]=ob(n,e)})}function ob(t,e){var r=e.lookupProperty;return Q_.wrapHelper(t,function(n){return ut.extend({lookupProperty:r},n)})}});var Kl=I((ci,Yd)=>{"use strict";ci.__esModule=!0;ci.default=function(t){(function(){typeof globalThis!="object"&&(Object.prototype.__defineGetter__("__magic__",function(){return this}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__)})();var e=globalThis.Handlebars;t.noConflict=function(){return globalThis.Handlebars===t&&(globalThis.Handlebars=e),t}};Yd.exports=ci.default});var rh=I((ui,th)=>{"use strict";ui.__esModule=!0;function Wl(t){return t&&t.__esModule?t:{default:t}}function Jl(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}var ib=ii(),Qd=Jl(ib),ab=Vd(),lb=Wl(ab),cb=Ae(),ub=Wl(cb),fb=de(),Vl=Jl(fb),db=Xd(),Zd=Jl(db),hb=Kl(),pb=Wl(hb);function eh(){var t=new Qd.HandlebarsEnvironment;return Vl.extend(t,Qd),t.SafeString=lb.default,t.Exception=ub.default,t.Utils=Vl,t.escapeExpression=Vl.escapeExpression,t.VM=Zd,t.template=function(e){return Zd.template(e,t)},t}var _s=eh();_s.create=eh;pb.default(_s);_s.default=_s;ui.default=_s;th.exports=ui.default});var $l=I((fi,sh)=>{"use strict";fi.__esModule=!0;var nh={helpers:{helperExpression:function(e){return e.type==="SubExpression"||(e.type==="MustacheStatement"||e.type==="BlockStatement")&&!!(e.params&&e.params.length||e.hash)},scopedId:function(e){return/^\.|this\b/.test(e.original)},simpleId:function(e){return e.parts.length===1&&!nh.helpers.scopedId(e)&&!e.depth}}};fi.default=nh;sh.exports=fi.default});var ih=I((di,oh)=>{"use strict";di.__esModule=!0;var mb=function(){var t={trace:function(){},yy:{},symbols_:{error:2,root:3,program:4,EOF:5,program_repetition0:6,statement:7,mustache:8,block:9,rawBlock:10,partial:11,partialBlock:12,content:13,COMMENT:14,CONTENT:15,openRawBlock:16,rawBlock_repetition0:17,END_RAW_BLOCK:18,OPEN_RAW_BLOCK:19,helperName:20,openRawBlock_repetition0:21,openRawBlock_option0:22,CLOSE_RAW_BLOCK:23,openBlock:24,block_option0:25,closeBlock:26,openInverse:27,block_option1:28,OPEN_BLOCK:29,openBlock_repetition0:30,openBlock_option0:31,openBlock_option1:32,CLOSE:33,OPEN_INVERSE:34,openInverse_repetition0:35,openInverse_option0:36,openInverse_option1:37,openInverseChain:38,OPEN_INVERSE_CHAIN:39,openInverseChain_repetition0:40,openInverseChain_option0:41,openInverseChain_option1:42,inverseAndProgram:43,INVERSE:44,inverseChain:45,inverseChain_option0:46,OPEN_ENDBLOCK:47,OPEN:48,mustache_repetition0:49,mustache_option0:50,OPEN_UNESCAPED:51,mustache_repetition1:52,mustache_option1:53,CLOSE_UNESCAPED:54,OPEN_PARTIAL:55,partialName:56,partial_repetition0:57,partial_option0:58,openPartialBlock:59,OPEN_PARTIAL_BLOCK:60,openPartialBlock_repetition0:61,openPartialBlock_option0:62,param:63,sexpr:64,OPEN_SEXPR:65,sexpr_repetition0:66,sexpr_option0:67,CLOSE_SEXPR:68,hash:69,hash_repetition_plus0:70,hashSegment:71,ID:72,EQUALS:73,blockParams:74,OPEN_BLOCK_PARAMS:75,blockParams_repetition_plus0:76,CLOSE_BLOCK_PARAMS:77,path:78,dataName:79,STRING:80,NUMBER:81,BOOLEAN:82,UNDEFINED:83,NULL:84,DATA:85,pathSegments:86,SEP:87,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",14:"COMMENT",15:"CONTENT",18:"END_RAW_BLOCK",19:"OPEN_RAW_BLOCK",23:"CLOSE_RAW_BLOCK",29:"OPEN_BLOCK",33:"CLOSE",34:"OPEN_INVERSE",39:"OPEN_INVERSE_CHAIN",44:"INVERSE",47:"OPEN_ENDBLOCK",48:"OPEN",51:"OPEN_UNESCAPED",54:"CLOSE_UNESCAPED",55:"OPEN_PARTIAL",60:"OPEN_PARTIAL_BLOCK",65:"OPEN_SEXPR",68:"CLOSE_SEXPR",72:"ID",73:"EQUALS",75:"OPEN_BLOCK_PARAMS",77:"CLOSE_BLOCK_PARAMS",80:"STRING",81:"NUMBER",82:"BOOLEAN",83:"UNDEFINED",84:"NULL",85:"DATA",87:"SEP"},productions_:[0,[3,2],[4,1],[7,1],[7,1],[7,1],[7,1],[7,1],[7,1],[7,1],[13,1],[10,3],[16,5],[9,4],[9,4],[24,6],[27,6],[38,6],[43,2],[45,3],[45,1],[26,3],[8,5],[8,5],[11,5],[12,3],[59,5],[63,1],[63,1],[64,5],[69,1],[71,3],[74,3],[20,1],[20,1],[20,1],[20,1],[20,1],[20,1],[20,1],[56,1],[56,1],[79,2],[78,1],[86,3],[86,1],[6,0],[6,2],[17,0],[17,2],[21,0],[21,2],[22,0],[22,1],[25,0],[25,1],[28,0],[28,1],[30,0],[30,2],[31,0],[31,1],[32,0],[32,1],[35,0],[35,2],[36,0],[36,1],[37,0],[37,1],[40,0],[40,2],[41,0],[41,1],[42,0],[42,1],[46,0],[46,1],[49,0],[49,2],[50,0],[50,1],[52,0],[52,2],[53,0],[53,1],[57,0],[57,2],[58,0],[58,1],[61,0],[61,2],[62,0],[62,1],[66,0],[66,2],[67,0],[67,1],[70,1],[70,2],[76,1],[76,2]],performAction:function(s,o,i,a,l,c,f){var u=c.length-1;switch(l){case 1:return c[u-1];case 2:this.$=a.prepareProgram(c[u]);break;case 3:this.$=c[u];break;case 4:this.$=c[u];break;case 5:this.$=c[u];break;case 6:this.$=c[u];break;case 7:this.$=c[u];break;case 8:this.$=c[u];break;case 9:this.$={type:"CommentStatement",value:a.stripComment(c[u]),strip:a.stripFlags(c[u],c[u]),loc:a.locInfo(this._$)};break;case 10:this.$={type:"ContentStatement",original:c[u],value:c[u],loc:a.locInfo(this._$)};break;case 11:this.$=a.prepareRawBlock(c[u-2],c[u-1],c[u],this._$);break;case 12:this.$={path:c[u-3],params:c[u-2],hash:c[u-1]};break;case 13:this.$=a.prepareBlock(c[u-3],c[u-2],c[u-1],c[u],!1,this._$);break;case 14:this.$=a.prepareBlock(c[u-3],c[u-2],c[u-1],c[u],!0,this._$);break;case 15:this.$={open:c[u-5],path:c[u-4],params:c[u-3],hash:c[u-2],blockParams:c[u-1],strip:a.stripFlags(c[u-5],c[u])};break;case 16:this.$={path:c[u-4],params:c[u-3],hash:c[u-2],blockParams:c[u-1],strip:a.stripFlags(c[u-5],c[u])};break;case 17:this.$={path:c[u-4],params:c[u-3],hash:c[u-2],blockParams:c[u-1],strip:a.stripFlags(c[u-5],c[u])};break;case 18:this.$={strip:a.stripFlags(c[u-1],c[u-1]),program:c[u]};break;case 19:var d=a.prepareBlock(c[u-2],c[u-1],c[u],c[u],!1,this._$),h=a.prepareProgram([d],c[u-1].loc);h.chained=!0,this.$={strip:c[u-2].strip,program:h,chain:!0};break;case 20:this.$=c[u];break;case 21:this.$={path:c[u-1],strip:a.stripFlags(c[u-2],c[u])};break;case 22:this.$=a.prepareMustache(c[u-3],c[u-2],c[u-1],c[u-4],a.stripFlags(c[u-4],c[u]),this._$);break;case 23:this.$=a.prepareMustache(c[u-3],c[u-2],c[u-1],c[u-4],a.stripFlags(c[u-4],c[u]),this._$);break;case 24:this.$={type:"PartialStatement",name:c[u-3],params:c[u-2],hash:c[u-1],indent:"",strip:a.stripFlags(c[u-4],c[u]),loc:a.locInfo(this._$)};break;case 25:this.$=a.preparePartialBlock(c[u-2],c[u-1],c[u],this._$);break;case 26:this.$={path:c[u-3],params:c[u-2],hash:c[u-1],strip:a.stripFlags(c[u-4],c[u])};break;case 27:this.$=c[u];break;case 28:this.$=c[u];break;case 29:this.$={type:"SubExpression",path:c[u-3],params:c[u-2],hash:c[u-1],loc:a.locInfo(this._$)};break;case 30:this.$={type:"Hash",pairs:c[u],loc:a.locInfo(this._$)};break;case 31:this.$={type:"HashPair",key:a.id(c[u-2]),value:c[u],loc:a.locInfo(this._$)};break;case 32:this.$=a.id(c[u-1]);break;case 33:this.$=c[u];break;case 34:this.$=c[u];break;case 35:this.$={type:"StringLiteral",value:c[u],original:c[u],loc:a.locInfo(this._$)};break;case 36:this.$={type:"NumberLiteral",value:Number(c[u]),original:Number(c[u]),loc:a.locInfo(this._$)};break;case 37:this.$={type:"BooleanLiteral",value:c[u]==="true",original:c[u]==="true",loc:a.locInfo(this._$)};break;case 38:this.$={type:"UndefinedLiteral",original:void 0,value:void 0,loc:a.locInfo(this._$)};break;case 39:this.$={type:"NullLiteral",original:null,value:null,loc:a.locInfo(this._$)};break;case 40:this.$=c[u];break;case 41:this.$=c[u];break;case 42:this.$=a.preparePath(!0,c[u],this._$);break;case 43:this.$=a.preparePath(!1,c[u],this._$);break;case 44:c[u-2].push({part:a.id(c[u]),original:c[u],separator:c[u-1]}),this.$=c[u-2];break;case 45:this.$=[{part:a.id(c[u]),original:c[u]}];break;case 46:this.$=[];break;case 47:c[u-1].push(c[u]);break;case 48:this.$=[];break;case 49:c[u-1].push(c[u]);break;case 50:this.$=[];break;case 51:c[u-1].push(c[u]);break;case 58:this.$=[];break;case 59:c[u-1].push(c[u]);break;case 64:this.$=[];break;case 65:c[u-1].push(c[u]);break;case 70:this.$=[];break;case 71:c[u-1].push(c[u]);break;case 78:this.$=[];break;case 79:c[u-1].push(c[u]);break;case 82:this.$=[];break;case 83:c[u-1].push(c[u]);break;case 86:this.$=[];break;case 87:c[u-1].push(c[u]);break;case 90:this.$=[];break;case 91:c[u-1].push(c[u]);break;case 94:this.$=[];break;case 95:c[u-1].push(c[u]);break;case 98:this.$=[c[u]];break;case 99:c[u-1].push(c[u]);break;case 100:this.$=[c[u]];break;case 101:c[u-1].push(c[u]);break}},table:[{3:1,4:2,5:[2,46],6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{1:[3]},{5:[1,4]},{5:[2,2],7:5,8:6,9:7,10:8,11:9,12:10,13:11,14:[1,12],15:[1,20],16:17,19:[1,23],24:15,27:16,29:[1,21],34:[1,22],39:[2,2],44:[2,2],47:[2,2],48:[1,13],51:[1,14],55:[1,18],59:19,60:[1,24]},{1:[2,1]},{5:[2,47],14:[2,47],15:[2,47],19:[2,47],29:[2,47],34:[2,47],39:[2,47],44:[2,47],47:[2,47],48:[2,47],51:[2,47],55:[2,47],60:[2,47]},{5:[2,3],14:[2,3],15:[2,3],19:[2,3],29:[2,3],34:[2,3],39:[2,3],44:[2,3],47:[2,3],48:[2,3],51:[2,3],55:[2,3],60:[2,3]},{5:[2,4],14:[2,4],15:[2,4],19:[2,4],29:[2,4],34:[2,4],39:[2,4],44:[2,4],47:[2,4],48:[2,4],51:[2,4],55:[2,4],60:[2,4]},{5:[2,5],14:[2,5],15:[2,5],19:[2,5],29:[2,5],34:[2,5],39:[2,5],44:[2,5],47:[2,5],48:[2,5],51:[2,5],55:[2,5],60:[2,5]},{5:[2,6],14:[2,6],15:[2,6],19:[2,6],29:[2,6],34:[2,6],39:[2,6],44:[2,6],47:[2,6],48:[2,6],51:[2,6],55:[2,6],60:[2,6]},{5:[2,7],14:[2,7],15:[2,7],19:[2,7],29:[2,7],34:[2,7],39:[2,7],44:[2,7],47:[2,7],48:[2,7],51:[2,7],55:[2,7],60:[2,7]},{5:[2,8],14:[2,8],15:[2,8],19:[2,8],29:[2,8],34:[2,8],39:[2,8],44:[2,8],47:[2,8],48:[2,8],51:[2,8],55:[2,8],60:[2,8]},{5:[2,9],14:[2,9],15:[2,9],19:[2,9],29:[2,9],34:[2,9],39:[2,9],44:[2,9],47:[2,9],48:[2,9],51:[2,9],55:[2,9],60:[2,9]},{20:25,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:36,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{4:37,6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],39:[2,46],44:[2,46],47:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{4:38,6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],44:[2,46],47:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{15:[2,48],17:39,18:[2,48]},{20:41,56:40,64:42,65:[1,43],72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{4:44,6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],47:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{5:[2,10],14:[2,10],15:[2,10],18:[2,10],19:[2,10],29:[2,10],34:[2,10],39:[2,10],44:[2,10],47:[2,10],48:[2,10],51:[2,10],55:[2,10],60:[2,10]},{20:45,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:46,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:47,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:41,56:48,64:42,65:[1,43],72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{33:[2,78],49:49,65:[2,78],72:[2,78],80:[2,78],81:[2,78],82:[2,78],83:[2,78],84:[2,78],85:[2,78]},{23:[2,33],33:[2,33],54:[2,33],65:[2,33],68:[2,33],72:[2,33],75:[2,33],80:[2,33],81:[2,33],82:[2,33],83:[2,33],84:[2,33],85:[2,33]},{23:[2,34],33:[2,34],54:[2,34],65:[2,34],68:[2,34],72:[2,34],75:[2,34],80:[2,34],81:[2,34],82:[2,34],83:[2,34],84:[2,34],85:[2,34]},{23:[2,35],33:[2,35],54:[2,35],65:[2,35],68:[2,35],72:[2,35],75:[2,35],80:[2,35],81:[2,35],82:[2,35],83:[2,35],84:[2,35],85:[2,35]},{23:[2,36],33:[2,36],54:[2,36],65:[2,36],68:[2,36],72:[2,36],75:[2,36],80:[2,36],81:[2,36],82:[2,36],83:[2,36],84:[2,36],85:[2,36]},{23:[2,37],33:[2,37],54:[2,37],65:[2,37],68:[2,37],72:[2,37],75:[2,37],80:[2,37],81:[2,37],82:[2,37],83:[2,37],84:[2,37],85:[2,37]},{23:[2,38],33:[2,38],54:[2,38],65:[2,38],68:[2,38],72:[2,38],75:[2,38],80:[2,38],81:[2,38],82:[2,38],83:[2,38],84:[2,38],85:[2,38]},{23:[2,39],33:[2,39],54:[2,39],65:[2,39],68:[2,39],72:[2,39],75:[2,39],80:[2,39],81:[2,39],82:[2,39],83:[2,39],84:[2,39],85:[2,39]},{23:[2,43],33:[2,43],54:[2,43],65:[2,43],68:[2,43],72:[2,43],75:[2,43],80:[2,43],81:[2,43],82:[2,43],83:[2,43],84:[2,43],85:[2,43],87:[1,50]},{72:[1,35],86:51},{23:[2,45],33:[2,45],54:[2,45],65:[2,45],68:[2,45],72:[2,45],75:[2,45],80:[2,45],81:[2,45],82:[2,45],83:[2,45],84:[2,45],85:[2,45],87:[2,45]},{52:52,54:[2,82],65:[2,82],72:[2,82],80:[2,82],81:[2,82],82:[2,82],83:[2,82],84:[2,82],85:[2,82]},{25:53,38:55,39:[1,57],43:56,44:[1,58],45:54,47:[2,54]},{28:59,43:60,44:[1,58],47:[2,56]},{13:62,15:[1,20],18:[1,61]},{33:[2,86],57:63,65:[2,86],72:[2,86],80:[2,86],81:[2,86],82:[2,86],83:[2,86],84:[2,86],85:[2,86]},{33:[2,40],65:[2,40],72:[2,40],80:[2,40],81:[2,40],82:[2,40],83:[2,40],84:[2,40],85:[2,40]},{33:[2,41],65:[2,41],72:[2,41],80:[2,41],81:[2,41],82:[2,41],83:[2,41],84:[2,41],85:[2,41]},{20:64,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{26:65,47:[1,66]},{30:67,33:[2,58],65:[2,58],72:[2,58],75:[2,58],80:[2,58],81:[2,58],82:[2,58],83:[2,58],84:[2,58],85:[2,58]},{33:[2,64],35:68,65:[2,64],72:[2,64],75:[2,64],80:[2,64],81:[2,64],82:[2,64],83:[2,64],84:[2,64],85:[2,64]},{21:69,23:[2,50],65:[2,50],72:[2,50],80:[2,50],81:[2,50],82:[2,50],83:[2,50],84:[2,50],85:[2,50]},{33:[2,90],61:70,65:[2,90],72:[2,90],80:[2,90],81:[2,90],82:[2,90],83:[2,90],84:[2,90],85:[2,90]},{20:74,33:[2,80],50:71,63:72,64:75,65:[1,43],69:73,70:76,71:77,72:[1,78],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{72:[1,79]},{23:[2,42],33:[2,42],54:[2,42],65:[2,42],68:[2,42],72:[2,42],75:[2,42],80:[2,42],81:[2,42],82:[2,42],83:[2,42],84:[2,42],85:[2,42],87:[1,50]},{20:74,53:80,54:[2,84],63:81,64:75,65:[1,43],69:82,70:76,71:77,72:[1,78],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{26:83,47:[1,66]},{47:[2,55]},{4:84,6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],39:[2,46],44:[2,46],47:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{47:[2,20]},{20:85,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{4:86,6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],47:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{26:87,47:[1,66]},{47:[2,57]},{5:[2,11],14:[2,11],15:[2,11],19:[2,11],29:[2,11],34:[2,11],39:[2,11],44:[2,11],47:[2,11],48:[2,11],51:[2,11],55:[2,11],60:[2,11]},{15:[2,49],18:[2,49]},{20:74,33:[2,88],58:88,63:89,64:75,65:[1,43],69:90,70:76,71:77,72:[1,78],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{65:[2,94],66:91,68:[2,94],72:[2,94],80:[2,94],81:[2,94],82:[2,94],83:[2,94],84:[2,94],85:[2,94]},{5:[2,25],14:[2,25],15:[2,25],19:[2,25],29:[2,25],34:[2,25],39:[2,25],44:[2,25],47:[2,25],48:[2,25],51:[2,25],55:[2,25],60:[2,25]},{20:92,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:74,31:93,33:[2,60],63:94,64:75,65:[1,43],69:95,70:76,71:77,72:[1,78],75:[2,60],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:74,33:[2,66],36:96,63:97,64:75,65:[1,43],69:98,70:76,71:77,72:[1,78],75:[2,66],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:74,22:99,23:[2,52],63:100,64:75,65:[1,43],69:101,70:76,71:77,72:[1,78],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:74,33:[2,92],62:102,63:103,64:75,65:[1,43],69:104,70:76,71:77,72:[1,78],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{33:[1,105]},{33:[2,79],65:[2,79],72:[2,79],80:[2,79],81:[2,79],82:[2,79],83:[2,79],84:[2,79],85:[2,79]},{33:[2,81]},{23:[2,27],33:[2,27],54:[2,27],65:[2,27],68:[2,27],72:[2,27],75:[2,27],80:[2,27],81:[2,27],82:[2,27],83:[2,27],84:[2,27],85:[2,27]},{23:[2,28],33:[2,28],54:[2,28],65:[2,28],68:[2,28],72:[2,28],75:[2,28],80:[2,28],81:[2,28],82:[2,28],83:[2,28],84:[2,28],85:[2,28]},{23:[2,30],33:[2,30],54:[2,30],68:[2,30],71:106,72:[1,107],75:[2,30]},{23:[2,98],33:[2,98],54:[2,98],68:[2,98],72:[2,98],75:[2,98]},{23:[2,45],33:[2,45],54:[2,45],65:[2,45],68:[2,45],72:[2,45],73:[1,108],75:[2,45],80:[2,45],81:[2,45],82:[2,45],83:[2,45],84:[2,45],85:[2,45],87:[2,45]},{23:[2,44],33:[2,44],54:[2,44],65:[2,44],68:[2,44],72:[2,44],75:[2,44],80:[2,44],81:[2,44],82:[2,44],83:[2,44],84:[2,44],85:[2,44],87:[2,44]},{54:[1,109]},{54:[2,83],65:[2,83],72:[2,83],80:[2,83],81:[2,83],82:[2,83],83:[2,83],84:[2,83],85:[2,83]},{54:[2,85]},{5:[2,13],14:[2,13],15:[2,13],19:[2,13],29:[2,13],34:[2,13],39:[2,13],44:[2,13],47:[2,13],48:[2,13],51:[2,13],55:[2,13],60:[2,13]},{38:55,39:[1,57],43:56,44:[1,58],45:111,46:110,47:[2,76]},{33:[2,70],40:112,65:[2,70],72:[2,70],75:[2,70],80:[2,70],81:[2,70],82:[2,70],83:[2,70],84:[2,70],85:[2,70]},{47:[2,18]},{5:[2,14],14:[2,14],15:[2,14],19:[2,14],29:[2,14],34:[2,14],39:[2,14],44:[2,14],47:[2,14],48:[2,14],51:[2,14],55:[2,14],60:[2,14]},{33:[1,113]},{33:[2,87],65:[2,87],72:[2,87],80:[2,87],81:[2,87],82:[2,87],83:[2,87],84:[2,87],85:[2,87]},{33:[2,89]},{20:74,63:115,64:75,65:[1,43],67:114,68:[2,96],69:116,70:76,71:77,72:[1,78],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{33:[1,117]},{32:118,33:[2,62],74:119,75:[1,120]},{33:[2,59],65:[2,59],72:[2,59],75:[2,59],80:[2,59],81:[2,59],82:[2,59],83:[2,59],84:[2,59],85:[2,59]},{33:[2,61],75:[2,61]},{33:[2,68],37:121,74:122,75:[1,120]},{33:[2,65],65:[2,65],72:[2,65],75:[2,65],80:[2,65],81:[2,65],82:[2,65],83:[2,65],84:[2,65],85:[2,65]},{33:[2,67],75:[2,67]},{23:[1,123]},{23:[2,51],65:[2,51],72:[2,51],80:[2,51],81:[2,51],82:[2,51],83:[2,51],84:[2,51],85:[2,51]},{23:[2,53]},{33:[1,124]},{33:[2,91],65:[2,91],72:[2,91],80:[2,91],81:[2,91],82:[2,91],83:[2,91],84:[2,91],85:[2,91]},{33:[2,93]},{5:[2,22],14:[2,22],15:[2,22],19:[2,22],29:[2,22],34:[2,22],39:[2,22],44:[2,22],47:[2,22],48:[2,22],51:[2,22],55:[2,22],60:[2,22]},{23:[2,99],33:[2,99],54:[2,99],68:[2,99],72:[2,99],75:[2,99]},{73:[1,108]},{20:74,63:125,64:75,65:[1,43],72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{5:[2,23],14:[2,23],15:[2,23],19:[2,23],29:[2,23],34:[2,23],39:[2,23],44:[2,23],47:[2,23],48:[2,23],51:[2,23],55:[2,23],60:[2,23]},{47:[2,19]},{47:[2,77]},{20:74,33:[2,72],41:126,63:127,64:75,65:[1,43],69:128,70:76,71:77,72:[1,78],75:[2,72],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{5:[2,24],14:[2,24],15:[2,24],19:[2,24],29:[2,24],34:[2,24],39:[2,24],44:[2,24],47:[2,24],48:[2,24],51:[2,24],55:[2,24],60:[2,24]},{68:[1,129]},{65:[2,95],68:[2,95],72:[2,95],80:[2,95],81:[2,95],82:[2,95],83:[2,95],84:[2,95],85:[2,95]},{68:[2,97]},{5:[2,21],14:[2,21],15:[2,21],19:[2,21],29:[2,21],34:[2,21],39:[2,21],44:[2,21],47:[2,21],48:[2,21],51:[2,21],55:[2,21],60:[2,21]},{33:[1,130]},{33:[2,63]},{72:[1,132],76:131},{33:[1,133]},{33:[2,69]},{15:[2,12],18:[2,12]},{14:[2,26],15:[2,26],19:[2,26],29:[2,26],34:[2,26],47:[2,26],48:[2,26],51:[2,26],55:[2,26],60:[2,26]},{23:[2,31],33:[2,31],54:[2,31],68:[2,31],72:[2,31],75:[2,31]},{33:[2,74],42:134,74:135,75:[1,120]},{33:[2,71],65:[2,71],72:[2,71],75:[2,71],80:[2,71],81:[2,71],82:[2,71],83:[2,71],84:[2,71],85:[2,71]},{33:[2,73],75:[2,73]},{23:[2,29],33:[2,29],54:[2,29],65:[2,29],68:[2,29],72:[2,29],75:[2,29],80:[2,29],81:[2,29],82:[2,29],83:[2,29],84:[2,29],85:[2,29]},{14:[2,15],15:[2,15],19:[2,15],29:[2,15],34:[2,15],39:[2,15],44:[2,15],47:[2,15],48:[2,15],51:[2,15],55:[2,15],60:[2,15]},{72:[1,137],77:[1,136]},{72:[2,100],77:[2,100]},{14:[2,16],15:[2,16],19:[2,16],29:[2,16],34:[2,16],44:[2,16],47:[2,16],48:[2,16],51:[2,16],55:[2,16],60:[2,16]},{33:[1,138]},{33:[2,75]},{33:[2,32]},{72:[2,101],77:[2,101]},{14:[2,17],15:[2,17],19:[2,17],29:[2,17],34:[2,17],39:[2,17],44:[2,17],47:[2,17],48:[2,17],51:[2,17],55:[2,17],60:[2,17]}],defaultActions:{4:[2,1],54:[2,55],56:[2,20],60:[2,57],73:[2,81],82:[2,85],86:[2,18],90:[2,89],101:[2,53],104:[2,93],110:[2,19],111:[2,77],116:[2,97],119:[2,63],122:[2,69],135:[2,75],136:[2,32]},parseError:function(s,o){throw new Error(s)},parse:function(s){var o=this,i=[0],a=[null],l=[],c=this.table,f="",u=0,d=0,h=0,p=2,g=1;this.lexer.setInput(s),this.lexer.yy=this.yy,this.yy.lexer=this.lexer,this.yy.parser=this,typeof this.lexer.yylloc=="undefined"&&(this.lexer.yylloc={});var w=this.lexer.yylloc;l.push(w);var b=this.lexer.options&&this.lexer.options.ranges;typeof this.yy.parseError=="function"&&(this.parseError=this.yy.parseError);function _(Ee){i.length=i.length-2*Ee,a.length=a.length-Ee,l.length=l.length-Ee}function C(){var Ee;return Ee=o.lexer.lex()||1,typeof Ee!="number"&&(Ee=o.symbols_[Ee]||Ee),Ee}for(var R,E,T,P,B,k,M={},F,N,le,he;;){if(T=i[i.length-1],this.defaultActions[T]?P=this.defaultActions[T]:((R===null||typeof R=="undefined")&&(R=C()),P=c[T]&&c[T][R]),typeof P=="undefined"||!P.length||!P[0]){var ee="";if(!h){he=[];for(F in c[T])this.terminals_[F]&&F>2&&he.push("'"+this.terminals_[F]+"'");this.lexer.showPosition?ee="Parse error on line "+(u+1)+`:
`+this.lexer.showPosition()+`
Expecting `+he.join(", ")+", got '"+(this.terminals_[R]||R)+"'":ee="Parse error on line "+(u+1)+": Unexpected "+(R==1?"end of input":"'"+(this.terminals_[R]||R)+"'"),this.parseError(ee,{text:this.lexer.match,token:this.terminals_[R]||R,line:this.lexer.yylineno,loc:w,expected:he})}}if(P[0]instanceof Array&&P.length>1)throw new Error("Parse Error: multiple actions possible at state: "+T+", token: "+R);switch(P[0]){case 1:i.push(R),a.push(this.lexer.yytext),l.push(this.lexer.yylloc),i.push(P[1]),R=null,E?(R=E,E=null):(d=this.lexer.yyleng,f=this.lexer.yytext,u=this.lexer.yylineno,w=this.lexer.yylloc,h>0&&h--);break;case 2:if(N=this.productions_[P[1]][1],M.$=a[a.length-N],M._$={first_line:l[l.length-(N||1)].first_line,last_line:l[l.length-1].last_line,first_column:l[l.length-(N||1)].first_column,last_column:l[l.length-1].last_column},b&&(M._$.range=[l[l.length-(N||1)].range[0],l[l.length-1].range[1]]),k=this.performAction.call(M,f,d,u,this.yy,P[1],a,l),typeof k!="undefined")return k;N&&(i=i.slice(0,-1*N*2),a=a.slice(0,-1*N),l=l.slice(0,-1*N)),i.push(this.productions_[P[1]][0]),a.push(M.$),l.push(M._$),le=c[i[i.length-2]][i[i.length-1]],i.push(le);break;case 3:return!0}}return!0}},e=function(){var n={EOF:1,parseError:function(o,i){if(this.yy.parser)this.yy.parser.parseError(o,i);else throw new Error(o)},setInput:function(o){return this._input=o,this._more=this._less=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var o=this._input[0];this.yytext+=o,this.yyleng++,this.offset++,this.match+=o,this.matched+=o;var i=o.match(/(?:\r\n?|\n).*/g);return i?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),o},unput:function(o){var i=o.length,a=o.split(/(?:\r\n?|\n)/g);this._input=o+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-i-1),this.offset-=i;var l=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),a.length-1&&(this.yylineno-=a.length-1);var c=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:a?(a.length===l.length?this.yylloc.first_column:0)+l[l.length-a.length].length-a[0].length:this.yylloc.first_column-i},this.options.ranges&&(this.yylloc.range=[c[0],c[0]+this.yyleng-i]),this},more:function(){return this._more=!0,this},less:function(o){this.unput(this.match.slice(o))},pastInput:function(){var o=this.matched.substr(0,this.matched.length-this.match.length);return(o.length>20?"...":"")+o.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var o=this.match;return o.length<20&&(o+=this._input.substr(0,20-o.length)),(o.substr(0,20)+(o.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var o=this.pastInput(),i=new Array(o.length+1).join("-");return o+this.upcomingInput()+`
`+i+"^"},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var o,i,a,l,c,f;this._more||(this.yytext="",this.match="");for(var u=this._currentRules(),d=0;d<u.length&&(a=this._input.match(this.rules[u[d]]),!(a&&(!i||a[0].length>i[0].length)&&(i=a,l=d,!this.options.flex)));d++);return i?(f=i[0].match(/(?:\r\n?|\n).*/g),f&&(this.yylineno+=f.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:f?f[f.length-1].length-f[f.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+i[0].length},this.yytext+=i[0],this.match+=i[0],this.matches=i,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._input=this._input.slice(i[0].length),this.matched+=i[0],o=this.performAction.call(this,this.yy,this,u[l],this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),o||void 0):this._input===""?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+`. Unrecognized text.
`+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var o=this.next();return typeof o!="undefined"?o:this.lex()},begin:function(o){this.conditionStack.push(o)},popState:function(){return this.conditionStack.pop()},_currentRules:function(){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules},topState:function(){return this.conditionStack[this.conditionStack.length-2]},pushState:function(o){this.begin(o)}};return n.options={},n.performAction=function(o,i,a,l){function c(u,d){return i.yytext=i.yytext.substring(u,i.yyleng-d+u)}var f=l;switch(a){case 0:if(i.yytext.slice(-2)==="\\\\"?(c(0,1),this.begin("mu")):i.yytext.slice(-1)==="\\"?(c(0,1),this.begin("emu")):this.begin("mu"),i.yytext)return 15;break;case 1:return 15;case 2:return this.popState(),15;break;case 3:return this.begin("raw"),15;break;case 4:return this.popState(),this.conditionStack[this.conditionStack.length-1]==="raw"?15:(c(5,9),"END_RAW_BLOCK");case 5:return 15;case 6:return this.popState(),14;break;case 7:return 65;case 8:return 68;case 9:return 19;case 10:return this.popState(),this.begin("raw"),23;break;case 11:return 55;case 12:return 60;case 13:return 29;case 14:return 47;case 15:return this.popState(),44;break;case 16:return this.popState(),44;break;case 17:return 34;case 18:return 39;case 19:return 51;case 20:return 48;case 21:this.unput(i.yytext),this.popState(),this.begin("com");break;case 22:return this.popState(),14;break;case 23:return 48;case 24:return 73;case 25:return 72;case 26:return 72;case 27:return 87;case 28:break;case 29:return this.popState(),54;break;case 30:return this.popState(),33;break;case 31:return i.yytext=c(1,2).replace(/\\"/g,'"'),80;break;case 32:return i.yytext=c(1,2).replace(/\\'/g,"'"),80;break;case 33:return 85;case 34:return 82;case 35:return 82;case 36:return 83;case 37:return 84;case 38:return 81;case 39:return 75;case 40:return 77;case 41:return 72;case 42:return i.yytext=i.yytext.replace(/\\([\\\]])/g,"$1"),72;break;case 43:return"INVALID";case 44:return 5}},n.rules=[/^(?:[^\x00]*?(?=(\{\{)))/,/^(?:[^\x00]+)/,/^(?:[^\x00]{2,}?(?=(\{\{|\\\{\{|\\\\\{\{|$)))/,/^(?:\{\{\{\{(?=[^/]))/,/^(?:\{\{\{\{\/[^\s!"#%-,\.\/;->@\[-\^`\{-~]+(?=[=}\s\/.])\}\}\}\})/,/^(?:[^\x00]+?(?=(\{\{\{\{)))/,/^(?:[\s\S]*?--(~)?\}\})/,/^(?:\()/,/^(?:\))/,/^(?:\{\{\{\{)/,/^(?:\}\}\}\})/,/^(?:\{\{(~)?>)/,/^(?:\{\{(~)?#>)/,/^(?:\{\{(~)?#\*?)/,/^(?:\{\{(~)?\/)/,/^(?:\{\{(~)?\^\s*(~)?\}\})/,/^(?:\{\{(~)?\s*else\s*(~)?\}\})/,/^(?:\{\{(~)?\^)/,/^(?:\{\{(~)?\s*else\b)/,/^(?:\{\{(~)?\{)/,/^(?:\{\{(~)?&)/,/^(?:\{\{(~)?!--)/,/^(?:\{\{(~)?![\s\S]*?\}\})/,/^(?:\{\{(~)?\*?)/,/^(?:=)/,/^(?:\.\.)/,/^(?:\.(?=([=~}\s\/.)|])))/,/^(?:[\/.])/,/^(?:\s+)/,/^(?:\}(~)?\}\})/,/^(?:(~)?\}\})/,/^(?:"(\\["]|[^"])*")/,/^(?:'(\\[']|[^'])*')/,/^(?:@)/,/^(?:true(?=([~}\s)])))/,/^(?:false(?=([~}\s)])))/,/^(?:undefined(?=([~}\s)])))/,/^(?:null(?=([~}\s)])))/,/^(?:-?[0-9]+(?:\.[0-9]+)?(?=([~}\s)])))/,/^(?:as\s+\|)/,/^(?:\|)/,/^(?:([^\s!"#%-,\.\/;->@\[-\^`\{-~]+(?=([=~}\s\/.)|]))))/,/^(?:\[(\\\]|[^\]])*\])/,/^(?:.)/,/^(?:$)/],n.conditions={mu:{rules:[7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44],inclusive:!1},emu:{rules:[2],inclusive:!1},com:{rules:[6],inclusive:!1},raw:{rules:[3,4,5],inclusive:!1},INITIAL:{rules:[0,1,44],inclusive:!0}},n}();t.lexer=e;function r(){this.yy={}}return r.prototype=t,t.Parser=r,new r}();di.default=mb;oh.exports=di.default});var zl=I((mi,ch)=>{"use strict";mi.__esModule=!0;function gb(t){return t&&t.__esModule?t:{default:t}}var yb=Ae(),Gl=gb(yb);function hi(){this.parents=[]}hi.prototype={constructor:hi,mutating:!1,acceptKey:function(e,r){var n=this.accept(e[r]);if(this.mutating){if(n&&!hi.prototype[n.type])throw new Gl.default('Unexpected node type "'+n.type+'" found when accepting '+r+" on "+e.type);e[r]=n}},acceptRequired:function(e,r){if(this.acceptKey(e,r),!e[r])throw new Gl.default(e.type+" requires "+r)},acceptArray:function(e){for(var r=0,n=e.length;r<n;r++)this.acceptKey(e,r),e[r]||(e.splice(r,1),r--,n--)},accept:function(e){if(e){if(!this[e.type])throw new Gl.default("Unknown type: "+e.type,e);this.current&&this.parents.unshift(this.current),this.current=e;var r=this[e.type](e);if(this.current=this.parents.shift(),!this.mutating||r)return r;if(r!==!1)return e}},Program:function(e){this.acceptArray(e.body)},MustacheStatement:pi,Decorator:pi,BlockStatement:ah,DecoratorBlock:ah,PartialStatement:lh,PartialBlockStatement:function(e){lh.call(this,e),this.acceptKey(e,"program")},ContentStatement:function(){},CommentStatement:function(){},SubExpression:pi,PathExpression:function(){},StringLiteral:function(){},NumberLiteral:function(){},BooleanLiteral:function(){},UndefinedLiteral:function(){},NullLiteral:function(){},Hash:function(e){this.acceptArray(e.pairs)},HashPair:function(e){this.acceptRequired(e,"value")}};function pi(t){this.acceptRequired(t,"path"),this.acceptArray(t.params),this.acceptKey(t,"hash")}function ah(t){pi.call(this,t),this.acceptKey(t,"program"),this.acceptKey(t,"inverse")}function lh(t){this.acceptRequired(t,"name"),this.acceptArray(t.params),this.acceptKey(t,"hash")}mi.default=hi;ch.exports=mi.default});var fh=I((gi,uh)=>{"use strict";gi.__esModule=!0;function wb(t){return t&&t.__esModule?t:{default:t}}var _b=zl(),bb=wb(_b);function Qe(){var t=arguments.length<=0||arguments[0]===void 0?{}:arguments[0];this.options=t}Qe.prototype=new bb.default;Qe.prototype.Program=function(t){var e=!this.options.ignoreStandalone,r=!this.isRootSeen;this.isRootSeen=!0;for(var n=t.body,s=0,o=n.length;s<o;s++){var i=n[s],a=this.accept(i);if(a){var l=Xl(n,s,r),c=Yl(n,s,r),f=a.openStandalone&&l,u=a.closeStandalone&&c,d=a.inlineStandalone&&l&&c;a.close&&pr(n,s,!0),a.open&&Lt(n,s,!0),e&&d&&(pr(n,s),Lt(n,s)&&i.type==="PartialStatement"&&(i.indent=/([ \t]+$)/.exec(n[s-1].original)[1])),e&&f&&(pr((i.program||i.inverse).body),Lt(n,s)),e&&u&&(pr(n,s),Lt((i.inverse||i.program).body))}}return t};Qe.prototype.BlockStatement=Qe.prototype.DecoratorBlock=Qe.prototype.PartialBlockStatement=function(t){this.accept(t.program),this.accept(t.inverse);var e=t.program||t.inverse,r=t.program&&t.inverse,n=r,s=r;if(r&&r.chained)for(n=r.body[0].program;s.chained;)s=s.body[s.body.length-1].program;var o={open:t.openStrip.open,close:t.closeStrip.close,openStandalone:Yl(e.body),closeStandalone:Xl((n||e).body)};if(t.openStrip.close&&pr(e.body,null,!0),r){var i=t.inverseStrip;i.open&&Lt(e.body,null,!0),i.close&&pr(n.body,null,!0),t.closeStrip.open&&Lt(s.body,null,!0),!this.options.ignoreStandalone&&Xl(e.body)&&Yl(n.body)&&(Lt(e.body),pr(n.body))}else t.closeStrip.open&&Lt(e.body,null,!0);return o};Qe.prototype.Decorator=Qe.prototype.MustacheStatement=function(t){return t.strip};Qe.prototype.PartialStatement=Qe.prototype.CommentStatement=function(t){var e=t.strip||{};return{inlineStandalone:!0,open:e.open,close:e.close}};function Xl(t,e,r){e===void 0&&(e=t.length);var n=t[e-1],s=t[e-2];if(!n)return r;if(n.type==="ContentStatement")return(s||!r?/\r?\n\s*?$/:/(^|\r?\n)\s*?$/).test(n.original)}function Yl(t,e,r){e===void 0&&(e=-1);var n=t[e+1],s=t[e+2];if(!n)return r;if(n.type==="ContentStatement")return(s||!r?/^\s*?\r?\n/:/^\s*?(\r?\n|$)/).test(n.original)}function pr(t,e,r){var n=t[e==null?0:e+1];if(!(!n||n.type!=="ContentStatement"||!r&&n.rightStripped)){var s=n.value;n.value=n.value.replace(r?/^\s+/:/^[ \t]*\r?\n?/,""),n.rightStripped=n.value!==s}}function Lt(t,e,r){var n=t[e==null?t.length-1:e-1];if(!(!n||n.type!=="ContentStatement"||!r&&n.leftStripped)){var s=n.value;return n.value=n.value.replace(r?/\s+$/:/[ \t]+$/,""),n.leftStripped=n.value!==s,n.leftStripped}}gi.default=Qe;uh.exports=gi.default});var dh=I(Re=>{"use strict";Re.__esModule=!0;Re.SourceLocation=vb;Re.id=Cb;Re.stripFlags=xb;Re.stripComment=Ab;Re.preparePath=Rb;Re.prepareMustache=Pb;Re.prepareRawBlock=Ob;Re.prepareBlock=Tb;Re.prepareProgram=Ib;Re.preparePartialBlock=kb;function Sb(t){return t&&t.__esModule?t:{default:t}}var Eb=Ae(),Ql=Sb(Eb);function Zl(t,e){if(e=e.path?e.path.original:e,t.path.original!==e){var r={loc:t.path.loc};throw new Ql.default(t.path.original+" doesn't match "+e,r)}}function vb(t,e){this.source=t,this.start={line:e.first_line,column:e.first_column},this.end={line:e.last_line,column:e.last_column}}function Cb(t){return/^\[.*\]$/.test(t)?t.substring(1,t.length-1):t}function xb(t,e){return{open:t.charAt(2)==="~",close:e.charAt(e.length-3)==="~"}}function Ab(t){return t.replace(/^\{\{~?!-?-?/,"").replace(/-?-?~?\}\}$/,"")}function Rb(t,e,r){r=this.locInfo(r);for(var n=t?"@":"",s=[],o=0,i=0,a=e.length;i<a;i++){var l=e[i].part,c=e[i].original!==l;if(n+=(e[i].separator||"")+l,!c&&(l===".."||l==="."||l==="this")){if(s.length>0)throw new Ql.default("Invalid path: "+n,{loc:r});l===".."&&o++}else s.push(l)}return{type:"PathExpression",data:t,depth:o,parts:s,original:n,loc:r}}function Pb(t,e,r,n,s,o){var i=n.charAt(3)||n.charAt(2),a=i!=="{"&&i!=="&",l=/\*/.test(n);return{type:l?"Decorator":"MustacheStatement",path:t,params:e,hash:r,escaped:a,strip:s,loc:this.locInfo(o)}}function Ob(t,e,r,n){Zl(t,r),n=this.locInfo(n);var s={type:"Program",body:e,strip:{},loc:n};return{type:"BlockStatement",path:t.path,params:t.params,hash:t.hash,program:s,openStrip:{},inverseStrip:{},closeStrip:{},loc:n}}function Tb(t,e,r,n,s,o){n&&n.path&&Zl(t,n);var i=/\*/.test(t.open);e.blockParams=t.blockParams;var a=void 0,l=void 0;if(r){if(i)throw new Ql.default("Unexpected inverse block on decorator",r);r.chain&&(r.program.body[0].closeStrip=n.strip),l=r.strip,a=r.program}return s&&(s=a,a=e,e=s),{type:i?"DecoratorBlock":"BlockStatement",path:t.path,params:t.params,hash:t.hash,program:e,inverse:a,openStrip:t.strip,inverseStrip:l,closeStrip:n&&n.strip,loc:this.locInfo(o)}}function Ib(t,e){if(!e&&t.length){var r=t[0].loc,n=t[t.length-1].loc;r&&n&&(e={source:r.source,start:{line:r.start.line,column:r.start.column},end:{line:n.end.line,column:n.end.column}})}return{type:"Program",body:t,strip:{},loc:e}}function kb(t,e,r,n){return Zl(t,r),{type:"PartialBlockStatement",name:t.path,params:t.params,hash:t.hash,program:e,openStrip:t.strip,closeStrip:r&&r.strip,loc:this.locInfo(n)}}});var mh=I(bs=>{"use strict";bs.__esModule=!0;bs.parseWithoutProcessing=ph;bs.parse=Ub;function Nb(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function hh(t){return t&&t.__esModule?t:{default:t}}var Lb=ih(),ec=hh(Lb),Mb=fh(),Db=hh(Mb),Bb=dh(),Fb=Nb(Bb),qb=de();bs.parser=ec.default;var yi={};qb.extend(yi,Fb);function ph(t,e){if(t.type==="Program")return t;ec.default.yy=yi,yi.locInfo=function(n){return new yi.SourceLocation(e&&e.srcName,n)};var r=ec.default.parse(t);return r}function Ub(t,e){var r=ph(t,e),n=new Db.default(e);return n.accept(r)}});var _h=I(Cs=>{"use strict";Cs.__esModule=!0;Cs.Compiler=tc;Cs.precompile=Vb;Cs.compile=Wb;function yh(t){return t&&t.__esModule?t:{default:t}}var Hb=Ae(),Es=yh(Hb),vs=de(),jb=$l(),Ss=yh(jb),Kb=[].slice;function tc(){}tc.prototype={compiler:tc,equals:function(e){var r=this.opcodes.length;if(e.opcodes.length!==r)return!1;for(var n=0;n<r;n++){var s=this.opcodes[n],o=e.opcodes[n];if(s.opcode!==o.opcode||!wh(s.args,o.args))return!1}r=this.children.length;for(var n=0;n<r;n++)if(!this.children[n].equals(e.children[n]))return!1;return!0},guid:0,compile:function(e,r){return this.sourceNode=[],this.opcodes=[],this.children=[],this.options=r,this.stringParams=r.stringParams,this.trackIds=r.trackIds,r.blockParams=r.blockParams||[],r.knownHelpers=vs.extend(Object.create(null),{helperMissing:!0,blockHelperMissing:!0,each:!0,if:!0,unless:!0,with:!0,log:!0,lookup:!0},r.knownHelpers),this.accept(e)},compileProgram:function(e){var r=new this.compiler,n=r.compile(e,this.options),s=this.guid++;return this.usePartial=this.usePartial||n.usePartial,this.children[s]=n,this.useDepths=this.useDepths||n.useDepths,s},accept:function(e){if(!this[e.type])throw new Es.default("Unknown type: "+e.type,e);this.sourceNode.unshift(e);var r=this[e.type](e);return this.sourceNode.shift(),r},Program:function(e){this.options.blockParams.unshift(e.blockParams);for(var r=e.body,n=r.length,s=0;s<n;s++)this.accept(r[s]);return this.options.blockParams.shift(),this.isSimple=n===1,this.blockParams=e.blockParams?e.blockParams.length:0,this},BlockStatement:function(e){gh(e);var r=e.program,n=e.inverse;r=r&&this.compileProgram(r),n=n&&this.compileProgram(n);var s=this.classifySexpr(e);s==="helper"?this.helperSexpr(e,r,n):s==="simple"?(this.simpleSexpr(e),this.opcode("pushProgram",r),this.opcode("pushProgram",n),this.opcode("emptyHash"),this.opcode("blockValue",e.path.original)):(this.ambiguousSexpr(e,r,n),this.opcode("pushProgram",r),this.opcode("pushProgram",n),this.opcode("emptyHash"),this.opcode("ambiguousBlockValue")),this.opcode("append")},DecoratorBlock:function(e){var r=e.program&&this.compileProgram(e.program),n=this.setupFullMustacheParams(e,r,void 0),s=e.path;this.useDecorators=!0,this.opcode("registerDecorator",n.length,s.original)},PartialStatement:function(e){this.usePartial=!0;var r=e.program;r&&(r=this.compileProgram(e.program));var n=e.params;if(n.length>1)throw new Es.default("Unsupported number of partial arguments: "+n.length,e);n.length||(this.options.explicitPartialContext?this.opcode("pushLiteral","undefined"):n.push({type:"PathExpression",parts:[],depth:0}));var s=e.name.original,o=e.name.type==="SubExpression";o&&this.accept(e.name),this.setupFullMustacheParams(e,r,void 0,!0);var i=e.indent||"";this.options.preventIndent&&i&&(this.opcode("appendContent",i),i=""),this.opcode("invokePartial",o,s,i),this.opcode("append")},PartialBlockStatement:function(e){this.PartialStatement(e)},MustacheStatement:function(e){this.SubExpression(e),e.escaped&&!this.options.noEscape?this.opcode("appendEscaped"):this.opcode("append")},Decorator:function(e){this.DecoratorBlock(e)},ContentStatement:function(e){e.value&&this.opcode("appendContent",e.value)},CommentStatement:function(){},SubExpression:function(e){gh(e);var r=this.classifySexpr(e);r==="simple"?this.simpleSexpr(e):r==="helper"?this.helperSexpr(e):this.ambiguousSexpr(e)},ambiguousSexpr:function(e,r,n){var s=e.path,o=s.parts[0],i=r!=null||n!=null;this.opcode("getContext",s.depth),this.opcode("pushProgram",r),this.opcode("pushProgram",n),s.strict=!0,this.accept(s),this.opcode("invokeAmbiguous",o,i)},simpleSexpr:function(e){var r=e.path;r.strict=!0,this.accept(r),this.opcode("resolvePossibleLambda")},helperSexpr:function(e,r,n){var s=this.setupFullMustacheParams(e,r,n),o=e.path,i=o.parts[0];if(this.options.knownHelpers[i])this.opcode("invokeKnownHelper",s.length,i);else{if(this.options.knownHelpersOnly)throw new Es.default("You specified knownHelpersOnly, but used the unknown helper "+i,e);o.strict=!0,o.falsy=!0,this.accept(o),this.opcode("invokeHelper",s.length,o.original,Ss.default.helpers.simpleId(o))}},PathExpression:function(e){this.addDepth(e.depth),this.opcode("getContext",e.depth);var r=e.parts[0],n=Ss.default.helpers.scopedId(e),s=!e.depth&&!n&&this.blockParamIndex(r);s?this.opcode("lookupBlockParam",s,e.parts):r?e.data?(this.options.data=!0,this.opcode("lookupData",e.depth,e.parts,e.strict)):this.opcode("lookupOnContext",e.parts,e.falsy,e.strict,n):this.opcode("pushContext")},StringLiteral:function(e){this.opcode("pushString",e.value)},NumberLiteral:function(e){this.opcode("pushLiteral",e.value)},BooleanLiteral:function(e){this.opcode("pushLiteral",e.value)},UndefinedLiteral:function(){this.opcode("pushLiteral","undefined")},NullLiteral:function(){this.opcode("pushLiteral","null")},Hash:function(e){var r=e.pairs,n=0,s=r.length;for(this.opcode("pushHash");n<s;n++)this.pushParam(r[n].value);for(;n--;)this.opcode("assignToHash",r[n].key);this.opcode("popHash")},opcode:function(e){this.opcodes.push({opcode:e,args:Kb.call(arguments,1),loc:this.sourceNode[0].loc})},addDepth:function(e){e&&(this.useDepths=!0)},classifySexpr:function(e){var r=Ss.default.helpers.simpleId(e.path),n=r&&!!this.blockParamIndex(e.path.parts[0]),s=!n&&Ss.default.helpers.helperExpression(e),o=!n&&(s||r);if(o&&!s){var i=e.path.parts[0],a=this.options;a.knownHelpers[i]?s=!0:a.knownHelpersOnly&&(o=!1)}return s?"helper":o?"ambiguous":"simple"},pushParams:function(e){for(var r=0,n=e.length;r<n;r++)this.pushParam(e[r])},pushParam:function(e){var r=e.value!=null?e.value:e.original||"";if(this.stringParams)r.replace&&(r=r.replace(/^(\.?\.\/)*/g,"").replace(/\//g,".")),e.depth&&this.addDepth(e.depth),this.opcode("getContext",e.depth||0),this.opcode("pushStringParam",r,e.type),e.type==="SubExpression"&&this.accept(e);else{if(this.trackIds){var n=void 0;if(e.parts&&!Ss.default.helpers.scopedId(e)&&!e.depth&&(n=this.blockParamIndex(e.parts[0])),n){var s=e.parts.slice(1).join(".");this.opcode("pushId","BlockParam",n,s)}else r=e.original||r,r.replace&&(r=r.replace(/^this(?:\.|$)/,"").replace(/^\.\//,"").replace(/^\.$/,"")),this.opcode("pushId",e.type,r)}this.accept(e)}},setupFullMustacheParams:function(e,r,n,s){var o=e.params;return this.pushParams(o),this.opcode("pushProgram",r),this.opcode("pushProgram",n),e.hash?this.accept(e.hash):this.opcode("emptyHash",s),o},blockParamIndex:function(e){for(var r=0,n=this.options.blockParams.length;r<n;r++){var s=this.options.blockParams[r],o=s&&vs.indexOf(s,e);if(s&&o>=0)return[r,o]}}};function Vb(t,e,r){if(t==null||typeof t!="string"&&t.type!=="Program")throw new Es.default("You must pass a string or Handlebars AST to Handlebars.precompile. You passed "+t);e=e||{},"data"in e||(e.data=!0),e.compat&&(e.useDepths=!0);var n=r.parse(t,e),s=new r.Compiler().compile(n,e);return new r.JavaScriptCompiler().compile(s,e)}function Wb(t,e,r){if(e===void 0&&(e={}),t==null||typeof t!="string"&&t.type!=="Program")throw new Es.default("You must pass a string or Handlebars AST to Handlebars.compile. You passed "+t);e=vs.extend({},e),"data"in e||(e.data=!0),e.compat&&(e.useDepths=!0);var n=void 0;function s(){var i=r.parse(t,e),a=new r.Compiler().compile(i,e),l=new r.JavaScriptCompiler().compile(a,e,void 0,!0);return r.template(l)}function o(i,a){return n||(n=s()),n.call(this,i,a)}return o._setup=function(i){return n||(n=s()),n._setup(i)},o._child=function(i,a,l,c){return n||(n=s()),n._child(i,a,l,c)},o}function wh(t,e){if(t===e)return!0;if(vs.isArray(t)&&vs.isArray(e)&&t.length===e.length){for(var r=0;r<t.length;r++)if(!wh(t[r],e[r]))return!1;return!0}}function gh(t){if(!t.path.parts){var e=t.path;t.path={type:"PathExpression",data:!1,depth:0,parts:[e.original+""],original:e.original+"",loc:e.loc}}}});var Sh=I(rc=>{var bh="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split("");rc.encode=function(t){if(0<=t&&t<bh.length)return bh[t];throw new TypeError("Must be between 0 and 63: "+t)};rc.decode=function(t){var e=65,r=90,n=97,s=122,o=48,i=57,a=43,l=47,c=26,f=52;return e<=t&&t<=r?t-e:n<=t&&t<=s?t-n+c:o<=t&&t<=i?t-o+f:t==a?62:t==l?63:-1}});var oc=I(sc=>{var Eh=Sh(),nc=5,vh=1<<nc,Ch=vh-1,xh=vh;function Jb(t){return t<0?(-t<<1)+1:(t<<1)+0}function $b(t){var e=(t&1)===1,r=t>>1;return e?-r:r}sc.encode=function(e){var r="",n,s=Jb(e);do n=s&Ch,s>>>=nc,s>0&&(n|=xh),r+=Eh.encode(n);while(s>0);return r};sc.decode=function(e,r,n){var s=e.length,o=0,i=0,a,l;do{if(r>=s)throw new Error("Expected more digits in base 64 VLQ value.");if(l=Eh.decode(e.charCodeAt(r++)),l===-1)throw new Error("Invalid base64 digit: "+e.charAt(r-1));a=!!(l&xh),l&=Ch,o=o+(l<<i),i+=nc}while(a);n.value=$b(o),n.rest=r}});var yn=I(ae=>{function Gb(t,e,r){if(e in t)return t[e];if(arguments.length===3)return r;throw new Error('"'+e+'" is a required argument.')}ae.getArg=Gb;var Ah=/^(?:([\w+\-.]+):)?\/\/(?:(\w+:\w+)@)?([\w.-]*)(?::(\d+))?(.*)$/,zb=/^data:.+\,.+$/;function xs(t){var e=t.match(Ah);return e?{scheme:e[1],auth:e[2],host:e[3],port:e[4],path:e[5]}:null}ae.urlParse=xs;function mn(t){var e="";return t.scheme&&(e+=t.scheme+":"),e+="//",t.auth&&(e+=t.auth+"@"),t.host&&(e+=t.host),t.port&&(e+=":"+t.port),t.path&&(e+=t.path),e}ae.urlGenerate=mn;function ic(t){var e=t,r=xs(t);if(r){if(!r.path)return t;e=r.path}for(var n=ae.isAbsolute(e),s=e.split(/\/+/),o,i=0,a=s.length-1;a>=0;a--)o=s[a],o==="."?s.splice(a,1):o===".."?i++:i>0&&(o===""?(s.splice(a+1,i),i=0):(s.splice(a,2),i--));return e=s.join("/"),e===""&&(e=n?"/":"."),r?(r.path=e,mn(r)):e}ae.normalize=ic;function Rh(t,e){t===""&&(t="."),e===""&&(e=".");var r=xs(e),n=xs(t);if(n&&(t=n.path||"/"),r&&!r.scheme)return n&&(r.scheme=n.scheme),mn(r);if(r||e.match(zb))return e;if(n&&!n.host&&!n.path)return n.host=e,mn(n);var s=e.charAt(0)==="/"?e:ic(t.replace(/\/+$/,"")+"/"+e);return n?(n.path=s,mn(n)):s}ae.join=Rh;ae.isAbsolute=function(t){return t.charAt(0)==="/"||Ah.test(t)};function Xb(t,e){t===""&&(t="."),t=t.replace(/\/$/,"");for(var r=0;e.indexOf(t+"/")!==0;){var n=t.lastIndexOf("/");if(n<0||(t=t.slice(0,n),t.match(/^([^\/]+:\/)?\/*$/)))return e;++r}return Array(r+1).join("../")+e.substr(t.length+1)}ae.relative=Xb;var Ph=function(){var t=Object.create(null);return!("__proto__"in t)}();function Oh(t){return t}function Yb(t){return Th(t)?"$"+t:t}ae.toSetString=Ph?Oh:Yb;function Qb(t){return Th(t)?t.slice(1):t}ae.fromSetString=Ph?Oh:Qb;function Th(t){if(!t)return!1;var e=t.length;if(e<9||t.charCodeAt(e-1)!==95||t.charCodeAt(e-2)!==95||t.charCodeAt(e-3)!==111||t.charCodeAt(e-4)!==116||t.charCodeAt(e-5)!==111||t.charCodeAt(e-6)!==114||t.charCodeAt(e-7)!==112||t.charCodeAt(e-8)!==95||t.charCodeAt(e-9)!==95)return!1;for(var r=e-10;r>=0;r--)if(t.charCodeAt(r)!==36)return!1;return!0}function Zb(t,e,r){var n=gn(t.source,e.source);return n!==0||(n=t.originalLine-e.originalLine,n!==0)||(n=t.originalColumn-e.originalColumn,n!==0||r)||(n=t.generatedColumn-e.generatedColumn,n!==0)||(n=t.generatedLine-e.generatedLine,n!==0)?n:gn(t.name,e.name)}ae.compareByOriginalPositions=Zb;function e2(t,e,r){var n=t.generatedLine-e.generatedLine;return n!==0||(n=t.generatedColumn-e.generatedColumn,n!==0||r)||(n=gn(t.source,e.source),n!==0)||(n=t.originalLine-e.originalLine,n!==0)||(n=t.originalColumn-e.originalColumn,n!==0)?n:gn(t.name,e.name)}ae.compareByGeneratedPositionsDeflated=e2;function gn(t,e){return t===e?0:t===null?1:e===null?-1:t>e?1:-1}function t2(t,e){var r=t.generatedLine-e.generatedLine;return r!==0||(r=t.generatedColumn-e.generatedColumn,r!==0)||(r=gn(t.source,e.source),r!==0)||(r=t.originalLine-e.originalLine,r!==0)||(r=t.originalColumn-e.originalColumn,r!==0)?r:gn(t.name,e.name)}ae.compareByGeneratedPositionsInflated=t2;function r2(t){return JSON.parse(t.replace(/^\)]}'[^\n]*\n/,""))}ae.parseSourceMapInput=r2;function n2(t,e,r){if(e=e||"",t&&(t[t.length-1]!=="/"&&e[0]!=="/"&&(t+="/"),e=t+e),r){var n=xs(r);if(!n)throw new Error("sourceMapURL could not be parsed");if(n.path){var s=n.path.lastIndexOf("/");s>=0&&(n.path=n.path.substring(0,s+1))}e=Rh(mn(n),e)}return ic(e)}ae.computeSourceURL=n2});var cc=I(Ih=>{var ac=yn(),lc=Object.prototype.hasOwnProperty,mr=typeof Map!="undefined";function ht(){this._array=[],this._set=mr?new Map:Object.create(null)}ht.fromArray=function(e,r){for(var n=new ht,s=0,o=e.length;s<o;s++)n.add(e[s],r);return n};ht.prototype.size=function(){return mr?this._set.size:Object.getOwnPropertyNames(this._set).length};ht.prototype.add=function(e,r){var n=mr?e:ac.toSetString(e),s=mr?this.has(e):lc.call(this._set,n),o=this._array.length;(!s||r)&&this._array.push(e),s||(mr?this._set.set(e,o):this._set[n]=o)};ht.prototype.has=function(e){if(mr)return this._set.has(e);var r=ac.toSetString(e);return lc.call(this._set,r)};ht.prototype.indexOf=function(e){if(mr){var r=this._set.get(e);if(r>=0)return r}else{var n=ac.toSetString(e);if(lc.call(this._set,n))return this._set[n]}throw new Error('"'+e+'" is not in the set.')};ht.prototype.at=function(e){if(e>=0&&e<this._array.length)return this._array[e];throw new Error("No element indexed by "+e)};ht.prototype.toArray=function(){return this._array.slice()};Ih.ArraySet=ht});var Lh=I(Nh=>{var kh=yn();function s2(t,e){var r=t.generatedLine,n=e.generatedLine,s=t.generatedColumn,o=e.generatedColumn;return n>r||n==r&&o>=s||kh.compareByGeneratedPositionsInflated(t,e)<=0}function wi(){this._array=[],this._sorted=!0,this._last={generatedLine:-1,generatedColumn:0}}wi.prototype.unsortedForEach=function(e,r){this._array.forEach(e,r)};wi.prototype.add=function(e){s2(this._last,e)?(this._last=e,this._array.push(e)):(this._sorted=!1,this._array.push(e))};wi.prototype.toArray=function(){return this._sorted||(this._array.sort(kh.compareByGeneratedPositionsInflated),this._sorted=!0),this._array};Nh.MappingList=wi});var uc=I(Mh=>{var As=oc(),$=yn(),_i=cc().ArraySet,o2=Lh().MappingList;function Pe(t){t||(t={}),this._file=$.getArg(t,"file",null),this._sourceRoot=$.getArg(t,"sourceRoot",null),this._skipValidation=$.getArg(t,"skipValidation",!1),this._sources=new _i,this._names=new _i,this._mappings=new o2,this._sourcesContents=null}Pe.prototype._version=3;Pe.fromSourceMap=function(e){var r=e.sourceRoot,n=new Pe({file:e.file,sourceRoot:r});return e.eachMapping(function(s){var o={generated:{line:s.generatedLine,column:s.generatedColumn}};s.source!=null&&(o.source=s.source,r!=null&&(o.source=$.relative(r,o.source)),o.original={line:s.originalLine,column:s.originalColumn},s.name!=null&&(o.name=s.name)),n.addMapping(o)}),e.sources.forEach(function(s){var o=s;r!==null&&(o=$.relative(r,s)),n._sources.has(o)||n._sources.add(o);var i=e.sourceContentFor(s);i!=null&&n.setSourceContent(s,i)}),n};Pe.prototype.addMapping=function(e){var r=$.getArg(e,"generated"),n=$.getArg(e,"original",null),s=$.getArg(e,"source",null),o=$.getArg(e,"name",null);this._skipValidation||this._validateMapping(r,n,s,o),s!=null&&(s=String(s),this._sources.has(s)||this._sources.add(s)),o!=null&&(o=String(o),this._names.has(o)||this._names.add(o)),this._mappings.add({generatedLine:r.line,generatedColumn:r.column,originalLine:n!=null&&n.line,originalColumn:n!=null&&n.column,source:s,name:o})};Pe.prototype.setSourceContent=function(e,r){var n=e;this._sourceRoot!=null&&(n=$.relative(this._sourceRoot,n)),r!=null?(this._sourcesContents||(this._sourcesContents=Object.create(null)),this._sourcesContents[$.toSetString(n)]=r):this._sourcesContents&&(delete this._sourcesContents[$.toSetString(n)],Object.keys(this._sourcesContents).length===0&&(this._sourcesContents=null))};Pe.prototype.applySourceMap=function(e,r,n){var s=r;if(r==null){if(e.file==null)throw new Error(`SourceMapGenerator.prototype.applySourceMap requires either an explicit source file, or the source map's "file" property. Both were omitted.`);s=e.file}var o=this._sourceRoot;o!=null&&(s=$.relative(o,s));var i=new _i,a=new _i;this._mappings.unsortedForEach(function(l){if(l.source===s&&l.originalLine!=null){var c=e.originalPositionFor({line:l.originalLine,column:l.originalColumn});c.source!=null&&(l.source=c.source,n!=null&&(l.source=$.join(n,l.source)),o!=null&&(l.source=$.relative(o,l.source)),l.originalLine=c.line,l.originalColumn=c.column,c.name!=null&&(l.name=c.name))}var f=l.source;f!=null&&!i.has(f)&&i.add(f);var u=l.name;u!=null&&!a.has(u)&&a.add(u)},this),this._sources=i,this._names=a,e.sources.forEach(function(l){var c=e.sourceContentFor(l);c!=null&&(n!=null&&(l=$.join(n,l)),o!=null&&(l=$.relative(o,l)),this.setSourceContent(l,c))},this)};Pe.prototype._validateMapping=function(e,r,n,s){if(r&&typeof r.line!="number"&&typeof r.column!="number")throw new Error("original.line and original.column are not numbers -- you probably meant to omit the original mapping entirely and only map the generated position. If so, pass null for the original mapping instead of an object with empty or null values.");if(!(e&&"line"in e&&"column"in e&&e.line>0&&e.column>=0&&!r&&!n&&!s)){if(e&&"line"in e&&"column"in e&&r&&"line"in r&&"column"in r&&e.line>0&&e.column>=0&&r.line>0&&r.column>=0&&n)return;throw new Error("Invalid mapping: "+JSON.stringify({generated:e,source:n,original:r,name:s}))}};Pe.prototype._serializeMappings=function(){for(var e=0,r=1,n=0,s=0,o=0,i=0,a="",l,c,f,u,d=this._mappings.toArray(),h=0,p=d.length;h<p;h++){if(c=d[h],l="",c.generatedLine!==r)for(e=0;c.generatedLine!==r;)l+=";",r++;else if(h>0){if(!$.compareByGeneratedPositionsInflated(c,d[h-1]))continue;l+=","}l+=As.encode(c.generatedColumn-e),e=c.generatedColumn,c.source!=null&&(u=this._sources.indexOf(c.source),l+=As.encode(u-i),i=u,l+=As.encode(c.originalLine-1-s),s=c.originalLine-1,l+=As.encode(c.originalColumn-n),n=c.originalColumn,c.name!=null&&(f=this._names.indexOf(c.name),l+=As.encode(f-o),o=f)),a+=l}return a};Pe.prototype._generateSourcesContent=function(e,r){return e.map(function(n){if(!this._sourcesContents)return null;r!=null&&(n=$.relative(r,n));var s=$.toSetString(n);return Object.prototype.hasOwnProperty.call(this._sourcesContents,s)?this._sourcesContents[s]:null},this)};Pe.prototype.toJSON=function(){var e={version:this._version,sources:this._sources.toArray(),names:this._names.toArray(),mappings:this._serializeMappings()};return this._file!=null&&(e.file=this._file),this._sourceRoot!=null&&(e.sourceRoot=this._sourceRoot),this._sourcesContents&&(e.sourcesContent=this._generateSourcesContent(e.sources,e.sourceRoot)),e};Pe.prototype.toString=function(){return JSON.stringify(this.toJSON())};Mh.SourceMapGenerator=Pe});var Dh=I(gr=>{gr.GREATEST_LOWER_BOUND=1;gr.LEAST_UPPER_BOUND=2;function fc(t,e,r,n,s,o){var i=Math.floor((e-t)/2)+t,a=s(r,n[i],!0);return a===0?i:a>0?e-i>1?fc(i,e,r,n,s,o):o==gr.LEAST_UPPER_BOUND?e<n.length?e:-1:i:i-t>1?fc(t,i,r,n,s,o):o==gr.LEAST_UPPER_BOUND?i:t<0?-1:t}gr.search=function(e,r,n,s){if(r.length===0)return-1;var o=fc(-1,r.length,e,r,n,s||gr.GREATEST_LOWER_BOUND);if(o<0)return-1;for(;o-1>=0&&n(r[o],r[o-1],!0)===0;)--o;return o}});var Fh=I(Bh=>{function dc(t,e,r){var n=t[e];t[e]=t[r],t[r]=n}function i2(t,e){return Math.round(t+Math.random()*(e-t))}function hc(t,e,r,n){if(r<n){var s=i2(r,n),o=r-1;dc(t,s,n);for(var i=t[n],a=r;a<n;a++)e(t[a],i)<=0&&(o+=1,dc(t,o,a));dc(t,o+1,a);var l=o+1;hc(t,e,r,l-1),hc(t,e,l+1,n)}}Bh.quickSort=function(t,e){hc(t,e,0,t.length-1)}});var Uh=I(bi=>{var v=yn(),pc=Dh(),wn=cc().ArraySet,a2=oc(),Rs=Fh().quickSort;function j(t,e){var r=t;return typeof t=="string"&&(r=v.parseSourceMapInput(t)),r.sections!=null?new Me(r,e):new se(r,e)}j.fromSourceMap=function(t,e){return se.fromSourceMap(t,e)};j.prototype._version=3;j.prototype.__generatedMappings=null;Object.defineProperty(j.prototype,"_generatedMappings",{configurable:!0,enumerable:!0,get:function(){return this.__generatedMappings||this._parseMappings(this._mappings,this.sourceRoot),this.__generatedMappings}});j.prototype.__originalMappings=null;Object.defineProperty(j.prototype,"_originalMappings",{configurable:!0,enumerable:!0,get:function(){return this.__originalMappings||this._parseMappings(this._mappings,this.sourceRoot),this.__originalMappings}});j.prototype._charIsMappingSeparator=function(e,r){var n=e.charAt(r);return n===";"||n===","};j.prototype._parseMappings=function(e,r){throw new Error("Subclasses must implement _parseMappings")};j.GENERATED_ORDER=1;j.ORIGINAL_ORDER=2;j.GREATEST_LOWER_BOUND=1;j.LEAST_UPPER_BOUND=2;j.prototype.eachMapping=function(e,r,n){var s=r||null,o=n||j.GENERATED_ORDER,i;switch(o){case j.GENERATED_ORDER:i=this._generatedMappings;break;case j.ORIGINAL_ORDER:i=this._originalMappings;break;default:throw new Error("Unknown order of iteration.")}var a=this.sourceRoot;i.map(function(l){var c=l.source===null?null:this._sources.at(l.source);return c=v.computeSourceURL(a,c,this._sourceMapURL),{source:c,generatedLine:l.generatedLine,generatedColumn:l.generatedColumn,originalLine:l.originalLine,originalColumn:l.originalColumn,name:l.name===null?null:this._names.at(l.name)}},this).forEach(e,s)};j.prototype.allGeneratedPositionsFor=function(e){var r=v.getArg(e,"line"),n={source:v.getArg(e,"source"),originalLine:r,originalColumn:v.getArg(e,"column",0)};if(n.source=this._findSourceIndex(n.source),n.source<0)return[];var s=[],o=this._findMapping(n,this._originalMappings,"originalLine","originalColumn",v.compareByOriginalPositions,pc.LEAST_UPPER_BOUND);if(o>=0){var i=this._originalMappings[o];if(e.column===void 0)for(var a=i.originalLine;i&&i.originalLine===a;)s.push({line:v.getArg(i,"generatedLine",null),column:v.getArg(i,"generatedColumn",null),lastColumn:v.getArg(i,"lastGeneratedColumn",null)}),i=this._originalMappings[++o];else for(var l=i.originalColumn;i&&i.originalLine===r&&i.originalColumn==l;)s.push({line:v.getArg(i,"generatedLine",null),column:v.getArg(i,"generatedColumn",null),lastColumn:v.getArg(i,"lastGeneratedColumn",null)}),i=this._originalMappings[++o]}return s};bi.SourceMapConsumer=j;function se(t,e){var r=t;typeof t=="string"&&(r=v.parseSourceMapInput(t));var n=v.getArg(r,"version"),s=v.getArg(r,"sources"),o=v.getArg(r,"names",[]),i=v.getArg(r,"sourceRoot",null),a=v.getArg(r,"sourcesContent",null),l=v.getArg(r,"mappings"),c=v.getArg(r,"file",null);if(n!=this._version)throw new Error("Unsupported version: "+n);i&&(i=v.normalize(i)),s=s.map(String).map(v.normalize).map(function(f){return i&&v.isAbsolute(i)&&v.isAbsolute(f)?v.relative(i,f):f}),this._names=wn.fromArray(o.map(String),!0),this._sources=wn.fromArray(s,!0),this._absoluteSources=this._sources.toArray().map(function(f){return v.computeSourceURL(i,f,e)}),this.sourceRoot=i,this.sourcesContent=a,this._mappings=l,this._sourceMapURL=e,this.file=c}se.prototype=Object.create(j.prototype);se.prototype.consumer=j;se.prototype._findSourceIndex=function(t){var e=t;if(this.sourceRoot!=null&&(e=v.relative(this.sourceRoot,e)),this._sources.has(e))return this._sources.indexOf(e);var r;for(r=0;r<this._absoluteSources.length;++r)if(this._absoluteSources[r]==t)return r;return-1};se.fromSourceMap=function(e,r){var n=Object.create(se.prototype),s=n._names=wn.fromArray(e._names.toArray(),!0),o=n._sources=wn.fromArray(e._sources.toArray(),!0);n.sourceRoot=e._sourceRoot,n.sourcesContent=e._generateSourcesContent(n._sources.toArray(),n.sourceRoot),n.file=e._file,n._sourceMapURL=r,n._absoluteSources=n._sources.toArray().map(function(h){return v.computeSourceURL(n.sourceRoot,h,r)});for(var i=e._mappings.toArray().slice(),a=n.__generatedMappings=[],l=n.__originalMappings=[],c=0,f=i.length;c<f;c++){var u=i[c],d=new qh;d.generatedLine=u.generatedLine,d.generatedColumn=u.generatedColumn,u.source&&(d.source=o.indexOf(u.source),d.originalLine=u.originalLine,d.originalColumn=u.originalColumn,u.name&&(d.name=s.indexOf(u.name)),l.push(d)),a.push(d)}return Rs(n.__originalMappings,v.compareByOriginalPositions),n};se.prototype._version=3;Object.defineProperty(se.prototype,"sources",{get:function(){return this._absoluteSources.slice()}});function qh(){this.generatedLine=0,this.generatedColumn=0,this.source=null,this.originalLine=null,this.originalColumn=null,this.name=null}se.prototype._parseMappings=function(e,r){for(var n=1,s=0,o=0,i=0,a=0,l=0,c=e.length,f=0,u={},d={},h=[],p=[],g,w,b,_,C;f<c;)if(e.charAt(f)===";")n++,f++,s=0;else if(e.charAt(f)===",")f++;else{for(g=new qh,g.generatedLine=n,_=f;_<c&&!this._charIsMappingSeparator(e,_);_++);if(w=e.slice(f,_),b=u[w],b)f+=w.length;else{for(b=[];f<_;)a2.decode(e,f,d),C=d.value,f=d.rest,b.push(C);if(b.length===2)throw new Error("Found a source, but no line and column");if(b.length===3)throw new Error("Found a source and line, but no column");u[w]=b}g.generatedColumn=s+b[0],s=g.generatedColumn,b.length>1&&(g.source=a+b[1],a+=b[1],g.originalLine=o+b[2],o=g.originalLine,g.originalLine+=1,g.originalColumn=i+b[3],i=g.originalColumn,b.length>4&&(g.name=l+b[4],l+=b[4])),p.push(g),typeof g.originalLine=="number"&&h.push(g)}Rs(p,v.compareByGeneratedPositionsDeflated),this.__generatedMappings=p,Rs(h,v.compareByOriginalPositions),this.__originalMappings=h};se.prototype._findMapping=function(e,r,n,s,o,i){if(e[n]<=0)throw new TypeError("Line must be greater than or equal to 1, got "+e[n]);if(e[s]<0)throw new TypeError("Column must be greater than or equal to 0, got "+e[s]);return pc.search(e,r,o,i)};se.prototype.computeColumnSpans=function(){for(var e=0;e<this._generatedMappings.length;++e){var r=this._generatedMappings[e];if(e+1<this._generatedMappings.length){var n=this._generatedMappings[e+1];if(r.generatedLine===n.generatedLine){r.lastGeneratedColumn=n.generatedColumn-1;continue}}r.lastGeneratedColumn=1/0}};se.prototype.originalPositionFor=function(e){var r={generatedLine:v.getArg(e,"line"),generatedColumn:v.getArg(e,"column")},n=this._findMapping(r,this._generatedMappings,"generatedLine","generatedColumn",v.compareByGeneratedPositionsDeflated,v.getArg(e,"bias",j.GREATEST_LOWER_BOUND));if(n>=0){var s=this._generatedMappings[n];if(s.generatedLine===r.generatedLine){var o=v.getArg(s,"source",null);o!==null&&(o=this._sources.at(o),o=v.computeSourceURL(this.sourceRoot,o,this._sourceMapURL));var i=v.getArg(s,"name",null);return i!==null&&(i=this._names.at(i)),{source:o,line:v.getArg(s,"originalLine",null),column:v.getArg(s,"originalColumn",null),name:i}}}return{source:null,line:null,column:null,name:null}};se.prototype.hasContentsOfAllSources=function(){return this.sourcesContent?this.sourcesContent.length>=this._sources.size()&&!this.sourcesContent.some(function(e){return e==null}):!1};se.prototype.sourceContentFor=function(e,r){if(!this.sourcesContent)return null;var n=this._findSourceIndex(e);if(n>=0)return this.sourcesContent[n];var s=e;this.sourceRoot!=null&&(s=v.relative(this.sourceRoot,s));var o;if(this.sourceRoot!=null&&(o=v.urlParse(this.sourceRoot))){var i=s.replace(/^file:\/\//,"");if(o.scheme=="file"&&this._sources.has(i))return this.sourcesContent[this._sources.indexOf(i)];if((!o.path||o.path=="/")&&this._sources.has("/"+s))return this.sourcesContent[this._sources.indexOf("/"+s)]}if(r)return null;throw new Error('"'+s+'" is not in the SourceMap.')};se.prototype.generatedPositionFor=function(e){var r=v.getArg(e,"source");if(r=this._findSourceIndex(r),r<0)return{line:null,column:null,lastColumn:null};var n={source:r,originalLine:v.getArg(e,"line"),originalColumn:v.getArg(e,"column")},s=this._findMapping(n,this._originalMappings,"originalLine","originalColumn",v.compareByOriginalPositions,v.getArg(e,"bias",j.GREATEST_LOWER_BOUND));if(s>=0){var o=this._originalMappings[s];if(o.source===n.source)return{line:v.getArg(o,"generatedLine",null),column:v.getArg(o,"generatedColumn",null),lastColumn:v.getArg(o,"lastGeneratedColumn",null)}}return{line:null,column:null,lastColumn:null}};bi.BasicSourceMapConsumer=se;function Me(t,e){var r=t;typeof t=="string"&&(r=v.parseSourceMapInput(t));var n=v.getArg(r,"version"),s=v.getArg(r,"sections");if(n!=this._version)throw new Error("Unsupported version: "+n);this._sources=new wn,this._names=new wn;var o={line:-1,column:0};this._sections=s.map(function(i){if(i.url)throw new Error("Support for url field in sections not implemented.");var a=v.getArg(i,"offset"),l=v.getArg(a,"line"),c=v.getArg(a,"column");if(l<o.line||l===o.line&&c<o.column)throw new Error("Section offsets must be ordered and non-overlapping.");return o=a,{generatedOffset:{generatedLine:l+1,generatedColumn:c+1},consumer:new j(v.getArg(i,"map"),e)}})}Me.prototype=Object.create(j.prototype);Me.prototype.constructor=j;Me.prototype._version=3;Object.defineProperty(Me.prototype,"sources",{get:function(){for(var t=[],e=0;e<this._sections.length;e++)for(var r=0;r<this._sections[e].consumer.sources.length;r++)t.push(this._sections[e].consumer.sources[r]);return t}});Me.prototype.originalPositionFor=function(e){var r={generatedLine:v.getArg(e,"line"),generatedColumn:v.getArg(e,"column")},n=pc.search(r,this._sections,function(o,i){var a=o.generatedLine-i.generatedOffset.generatedLine;return a||o.generatedColumn-i.generatedOffset.generatedColumn}),s=this._sections[n];return s?s.consumer.originalPositionFor({line:r.generatedLine-(s.generatedOffset.generatedLine-1),column:r.generatedColumn-(s.generatedOffset.generatedLine===r.generatedLine?s.generatedOffset.generatedColumn-1:0),bias:e.bias}):{source:null,line:null,column:null,name:null}};Me.prototype.hasContentsOfAllSources=function(){return this._sections.every(function(e){return e.consumer.hasContentsOfAllSources()})};Me.prototype.sourceContentFor=function(e,r){for(var n=0;n<this._sections.length;n++){var s=this._sections[n],o=s.consumer.sourceContentFor(e,!0);if(o)return o}if(r)return null;throw new Error('"'+e+'" is not in the SourceMap.')};Me.prototype.generatedPositionFor=function(e){for(var r=0;r<this._sections.length;r++){var n=this._sections[r];if(n.consumer._findSourceIndex(v.getArg(e,"source"))!==-1){var s=n.consumer.generatedPositionFor(e);if(s){var o={line:s.line+(n.generatedOffset.generatedLine-1),column:s.column+(n.generatedOffset.generatedLine===s.line?n.generatedOffset.generatedColumn-1:0)};return o}}}return{line:null,column:null}};Me.prototype._parseMappings=function(e,r){this.__generatedMappings=[],this.__originalMappings=[];for(var n=0;n<this._sections.length;n++)for(var s=this._sections[n],o=s.consumer._generatedMappings,i=0;i<o.length;i++){var a=o[i],l=s.consumer._sources.at(a.source);l=v.computeSourceURL(s.consumer.sourceRoot,l,this._sourceMapURL),this._sources.add(l),l=this._sources.indexOf(l);var c=null;a.name&&(c=s.consumer._names.at(a.name),this._names.add(c),c=this._names.indexOf(c));var f={source:l,generatedLine:a.generatedLine+(s.generatedOffset.generatedLine-1),generatedColumn:a.generatedColumn+(s.generatedOffset.generatedLine===a.generatedLine?s.generatedOffset.generatedColumn-1:0),originalLine:a.originalLine,originalColumn:a.originalColumn,name:c};this.__generatedMappings.push(f),typeof f.originalLine=="number"&&this.__originalMappings.push(f)}Rs(this.__generatedMappings,v.compareByGeneratedPositionsDeflated),Rs(this.__originalMappings,v.compareByOriginalPositions)};bi.IndexedSourceMapConsumer=Me});var jh=I(Hh=>{var l2=uc().SourceMapGenerator,Si=yn(),c2=/(\r?\n)/,u2=10,_n="$$$isSourceNode$$$";function Se(t,e,r,n,s){this.children=[],this.sourceContents={},this.line=t==null?null:t,this.column=e==null?null:e,this.source=r==null?null:r,this.name=s==null?null:s,this[_n]=!0,n!=null&&this.add(n)}Se.fromStringWithSourceMap=function(e,r,n){var s=new Se,o=e.split(c2),i=0,a=function(){var d=p(),h=p()||"";return d+h;function p(){return i<o.length?o[i++]:void 0}},l=1,c=0,f=null;return r.eachMapping(function(d){if(f!==null)if(l<d.generatedLine)u(f,a()),l++,c=0;else{var h=o[i]||"",p=h.substr(0,d.generatedColumn-c);o[i]=h.substr(d.generatedColumn-c),c=d.generatedColumn,u(f,p),f=d;return}for(;l<d.generatedLine;)s.add(a()),l++;if(c<d.generatedColumn){var h=o[i]||"";s.add(h.substr(0,d.generatedColumn)),o[i]=h.substr(d.generatedColumn),c=d.generatedColumn}f=d},this),i<o.length&&(f&&u(f,a()),s.add(o.splice(i).join(""))),r.sources.forEach(function(d){var h=r.sourceContentFor(d);h!=null&&(n!=null&&(d=Si.join(n,d)),s.setSourceContent(d,h))}),s;function u(d,h){if(d===null||d.source===void 0)s.add(h);else{var p=n?Si.join(n,d.source):d.source;s.add(new Se(d.originalLine,d.originalColumn,p,h,d.name))}}};Se.prototype.add=function(e){if(Array.isArray(e))e.forEach(function(r){this.add(r)},this);else if(e[_n]||typeof e=="string")e&&this.children.push(e);else throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+e);return this};Se.prototype.prepend=function(e){if(Array.isArray(e))for(var r=e.length-1;r>=0;r--)this.prepend(e[r]);else if(e[_n]||typeof e=="string")this.children.unshift(e);else throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+e);return this};Se.prototype.walk=function(e){for(var r,n=0,s=this.children.length;n<s;n++)r=this.children[n],r[_n]?r.walk(e):r!==""&&e(r,{source:this.source,line:this.line,column:this.column,name:this.name})};Se.prototype.join=function(e){var r,n,s=this.children.length;if(s>0){for(r=[],n=0;n<s-1;n++)r.push(this.children[n]),r.push(e);r.push(this.children[n]),this.children=r}return this};Se.prototype.replaceRight=function(e,r){var n=this.children[this.children.length-1];return n[_n]?n.replaceRight(e,r):typeof n=="string"?this.children[this.children.length-1]=n.replace(e,r):this.children.push("".replace(e,r)),this};Se.prototype.setSourceContent=function(e,r){this.sourceContents[Si.toSetString(e)]=r};Se.prototype.walkSourceContents=function(e){for(var r=0,n=this.children.length;r<n;r++)this.children[r][_n]&&this.children[r].walkSourceContents(e);for(var s=Object.keys(this.sourceContents),r=0,n=s.length;r<n;r++)e(Si.fromSetString(s[r]),this.sourceContents[s[r]])};Se.prototype.toString=function(){var e="";return this.walk(function(r){e+=r}),e};Se.prototype.toStringWithSourceMap=function(e){var r={code:"",line:1,column:0},n=new l2(e),s=!1,o=null,i=null,a=null,l=null;return this.walk(function(c,f){r.code+=c,f.source!==null&&f.line!==null&&f.column!==null?((o!==f.source||i!==f.line||a!==f.column||l!==f.name)&&n.addMapping({source:f.source,original:{line:f.line,column:f.column},generated:{line:r.line,column:r.column},name:f.name}),o=f.source,i=f.line,a=f.column,l=f.name,s=!0):s&&(n.addMapping({generated:{line:r.line,column:r.column}}),o=null,s=!1);for(var u=0,d=c.length;u<d;u++)c.charCodeAt(u)===u2?(r.line++,r.column=0,u+1===d?(o=null,s=!1):s&&n.addMapping({source:f.source,original:{line:f.line,column:f.column},generated:{line:r.line,column:r.column},name:f.name})):r.column++}),this.walkSourceContents(function(c,f){n.setSourceContent(c,f)}),{code:r.code,map:n}};Hh.SourceNode=Se});var Kh=I(Ei=>{Ei.SourceMapGenerator=uc().SourceMapGenerator;Ei.SourceMapConsumer=Uh().SourceMapConsumer;Ei.SourceNode=jh().SourceNode});var $h=I((vi,Jh)=>{"use strict";vi.__esModule=!0;var gc=de(),yr=void 0;try{(typeof define!="function"||!define.amd)&&(Vh=Kh(),yr=Vh.SourceNode)}catch(t){}var Vh;yr||(yr=function(t,e,r,n){this.src="",n&&this.add(n)},yr.prototype={add:function(e){gc.isArray(e)&&(e=e.join("")),this.src+=e},prepend:function(e){gc.isArray(e)&&(e=e.join("")),this.src=e+this.src},toStringWithSourceMap:function(){return{code:this.toString()}},toString:function(){return this.src}});function mc(t,e,r){if(gc.isArray(t)){for(var n=[],s=0,o=t.length;s<o;s++)n.push(e.wrap(t[s],r));return n}else if(typeof t=="boolean"||typeof t=="number")return t+"";return t}function Wh(t){this.srcFile=t,this.source=[]}Wh.prototype={isEmpty:function(){return!this.source.length},prepend:function(e,r){this.source.unshift(this.wrap(e,r))},push:function(e,r){this.source.push(this.wrap(e,r))},merge:function(){var e=this.empty();return this.each(function(r){e.add(["  ",r,`
`])}),e},each:function(e){for(var r=0,n=this.source.length;r<n;r++)e(this.source[r])},empty:function(){var e=this.currentLocation||{start:{}};return new yr(e.start.line,e.start.column,this.srcFile)},wrap:function(e){var r=arguments.length<=1||arguments[1]===void 0?this.currentLocation||{start:{}}:arguments[1];return e instanceof yr?e:(e=mc(e,this,r),new yr(r.start.line,r.start.column,this.srcFile,e))},functionCall:function(e,r,n){return n=this.generateList(n),this.wrap([e,r?"."+r+"(":"(",n,")"])},quotedString:function(e){return'"'+(e+"").replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")+'"'},objectLiteral:function(e){var r=this,n=[];Object.keys(e).forEach(function(o){var i=mc(e[o],r);i!=="undefined"&&n.push([r.quotedString(o),":",i])});var s=this.generateList(n);return s.prepend("{"),s.add("}"),s},generateList:function(e){for(var r=this.empty(),n=0,s=e.length;n<s;n++)n&&r.add(","),r.add(mc(e[n],this));return r},generateArray:function(e){var r=this.generateList(e);return r.prepend("["),r.add("]"),r}};vi.default=Wh;Jh.exports=vi.default});var Qh=I((Ci,Yh)=>{"use strict";Ci.__esModule=!0;function Xh(t){return t&&t.__esModule?t:{default:t}}var Gh=ii(),f2=Ae(),yc=Xh(f2),d2=de(),h2=$h(),zh=Xh(h2);function bn(t){this.value=t}function Sn(){}Sn.prototype={nameLookup:function(e,r){return this.internalNameLookup(e,r)},depthedLookup:function(e){return[this.aliasable("container.lookup"),"(depths, ",JSON.stringify(e),")"]},compilerInfo:function(){var e=Gh.COMPILER_REVISION,r=Gh.REVISION_CHANGES[e];return[e,r]},appendToBuffer:function(e,r,n){return d2.isArray(e)||(e=[e]),e=this.source.wrap(e,r),this.environment.isSimple?["return ",e,";"]:n?["buffer += ",e,";"]:(e.appendToBuffer=!0,e)},initializeBuffer:function(){return this.quotedString("")},internalNameLookup:function(e,r){return this.lookupPropertyFunctionIsUsed=!0,["lookupProperty(",e,",",JSON.stringify(r),")"]},lookupPropertyFunctionIsUsed:!1,compile:function(e,r,n,s){this.environment=e,this.options=r,this.stringParams=this.options.stringParams,this.trackIds=this.options.trackIds,this.precompile=!s,this.name=this.environment.name,this.isChild=!!n,this.context=n||{decorators:[],programs:[],environments:[]},this.preamble(),this.stackSlot=0,this.stackVars=[],this.aliases={},this.registers={list:[]},this.hashes=[],this.compileStack=[],this.inlineStack=[],this.blockParams=[],this.compileChildren(e,r),this.useDepths=this.useDepths||e.useDepths||e.useDecorators||this.options.compat,this.useBlockParams=this.useBlockParams||e.useBlockParams;var o=e.opcodes,i=void 0,a=void 0,l=void 0,c=void 0;for(l=0,c=o.length;l<c;l++)i=o[l],this.source.currentLocation=i.loc,a=a||i.loc,this[i.opcode].apply(this,i.args);if(this.source.currentLocation=a,this.pushSource(""),this.stackSlot||this.inlineStack.length||this.compileStack.length)throw new yc.default("Compile completed with content left on stack");this.decorators.isEmpty()?this.decorators=void 0:(this.useDecorators=!0,this.decorators.prepend(["var decorators = container.decorators, ",this.lookupPropertyFunctionVarDeclaration(),`;
`]),this.decorators.push("return fn;"),s?this.decorators=Function.apply(this,["fn","props","container","depth0","data","blockParams","depths",this.decorators.merge()]):(this.decorators.prepend(`function(fn, props, container, depth0, data, blockParams, depths) {
`),this.decorators.push(`}
`),this.decorators=this.decorators.merge()));var f=this.createFunctionContext(s);if(this.isChild)return f;var u={compiler:this.compilerInfo(),main:f};this.decorators&&(u.main_d=this.decorators,u.useDecorators=!0);var d=this.context,h=d.programs,p=d.decorators;for(l=0,c=h.length;l<c;l++)h[l]&&(u[l]=h[l],p[l]&&(u[l+"_d"]=p[l],u.useDecorators=!0));return this.environment.usePartial&&(u.usePartial=!0),this.options.data&&(u.useData=!0),this.useDepths&&(u.useDepths=!0),this.useBlockParams&&(u.useBlockParams=!0),this.options.compat&&(u.compat=!0),s?u.compilerOptions=this.options:(u.compiler=JSON.stringify(u.compiler),this.source.currentLocation={start:{line:1,column:0}},u=this.objectLiteral(u),r.srcName?(u=u.toStringWithSourceMap({file:r.destName}),u.map=u.map&&u.map.toString()):u=u.toString()),u},preamble:function(){this.lastContext=0,this.source=new zh.default(this.options.srcName),this.decorators=new zh.default(this.options.srcName)},createFunctionContext:function(e){var r=this,n="",s=this.stackVars.concat(this.registers.list);s.length>0&&(n+=", "+s.join(", "));var o=0;Object.keys(this.aliases).forEach(function(l){var c=r.aliases[l];c.children&&c.referenceCount>1&&(n+=", alias"+ ++o+"="+l,c.children[0]="alias"+o)}),this.lookupPropertyFunctionIsUsed&&(n+=", "+this.lookupPropertyFunctionVarDeclaration());var i=["container","depth0","helpers","partials","data"];(this.useBlockParams||this.useDepths)&&i.push("blockParams"),this.useDepths&&i.push("depths");var a=this.mergeSource(n);return e?(i.push(a),Function.apply(this,i)):this.source.wrap(["function(",i.join(","),`) {
  `,a,"}"])},mergeSource:function(e){var r=this.environment.isSimple,n=!this.forceBuffer,s=void 0,o=void 0,i=void 0,a=void 0;return this.source.each(function(l){l.appendToBuffer?(i?l.prepend("  + "):i=l,a=l):(i&&(o?i.prepend("buffer += "):s=!0,a.add(";"),i=a=void 0),o=!0,r||(n=!1))}),n?i?(i.prepend("return "),a.add(";")):o||this.source.push('return "";'):(e+=", buffer = "+(s?"":this.initializeBuffer()),i?(i.prepend("return buffer + "),a.add(";")):this.source.push("return buffer;")),e&&this.source.prepend("var "+e.substring(2)+(s?"":`;
`)),this.source.merge()},lookupPropertyFunctionVarDeclaration:function(){return`
      lookupProperty = container.lookupProperty || function(parent, propertyName) {
        if (Object.prototype.hasOwnProperty.call(parent, propertyName)) {
          return parent[propertyName];
        }
        return undefined
    }
    `.trim()},blockValue:function(e){var r=this.aliasable("container.hooks.blockHelperMissing"),n=[this.contextName(0)];this.setupHelperArgs(e,0,n);var s=this.popStack();n.splice(1,0,s),this.push(this.source.functionCall(r,"call",n))},ambiguousBlockValue:function(){var e=this.aliasable("container.hooks.blockHelperMissing"),r=[this.contextName(0)];this.setupHelperArgs("",0,r,!0),this.flushInline();var n=this.topStack();r.splice(1,0,n),this.pushSource(["if (!",this.lastHelper,") { ",n," = ",this.source.functionCall(e,"call",r),"}"])},appendContent:function(e){this.pendingContent?e=this.pendingContent+e:this.pendingLocation=this.source.currentLocation,this.pendingContent=e},append:function(){if(this.isInline())this.replaceStack(function(r){return[" != null ? ",r,' : ""']}),this.pushSource(this.appendToBuffer(this.popStack()));else{var e=this.popStack();this.pushSource(["if (",e," != null) { ",this.appendToBuffer(e,void 0,!0)," }"]),this.environment.isSimple&&this.pushSource(["else { ",this.appendToBuffer("''",void 0,!0)," }"])}},appendEscaped:function(){this.pushSource(this.appendToBuffer([this.aliasable("container.escapeExpression"),"(",this.popStack(),")"]))},getContext:function(e){this.lastContext=e},pushContext:function(){this.pushStackLiteral(this.contextName(this.lastContext))},lookupOnContext:function(e,r,n,s){var o=0;!s&&this.options.compat&&!this.lastContext?this.push(this.depthedLookup(e[o++])):this.pushContext(),this.resolvePath("context",e,o,r,n)},lookupBlockParam:function(e,r){this.useBlockParams=!0,this.push(["blockParams[",e[0],"][",e[1],"]"]),this.resolvePath("context",r,1)},lookupData:function(e,r,n){e?this.pushStackLiteral("container.data(data, "+e+")"):this.pushStackLiteral("data"),this.resolvePath("data",r,0,!0,n)},resolvePath:function(e,r,n,s,o){var i=this;if(this.options.strict||this.options.assumeObjects){this.push(p2(this.options.strict&&o,this,r,n,e));return}for(var a=r.length;n<a;n++)this.replaceStack(function(l){var c=i.nameLookup(l,r[n],e);return s?[" && ",c]:[" != null ? ",c," : ",l]})},resolvePossibleLambda:function(){this.push([this.aliasable("container.lambda"),"(",this.popStack(),", ",this.contextName(0),")"])},pushStringParam:function(e,r){this.pushContext(),this.pushString(r),r!=="SubExpression"&&(typeof e=="string"?this.pushString(e):this.pushStackLiteral(e))},emptyHash:function(e){this.trackIds&&this.push("{}"),this.stringParams&&(this.push("{}"),this.push("{}")),this.pushStackLiteral(e?"undefined":"{}")},pushHash:function(){this.hash&&this.hashes.push(this.hash),this.hash={values:{},types:[],contexts:[],ids:[]}},popHash:function(){var e=this.hash;this.hash=this.hashes.pop(),this.trackIds&&this.push(this.objectLiteral(e.ids)),this.stringParams&&(this.push(this.objectLiteral(e.contexts)),this.push(this.objectLiteral(e.types))),this.push(this.objectLiteral(e.values))},pushString:function(e){this.pushStackLiteral(this.quotedString(e))},pushLiteral:function(e){this.pushStackLiteral(e)},pushProgram:function(e){e!=null?this.pushStackLiteral(this.programExpression(e)):this.pushStackLiteral(null)},registerDecorator:function(e,r){var n=this.nameLookup("decorators",r,"decorator"),s=this.setupHelperArgs(r,e);this.decorators.push(["fn = ",this.decorators.functionCall(n,"",["fn","props","container",s])," || fn;"])},invokeHelper:function(e,r,n){var s=this.popStack(),o=this.setupHelper(e,r),i=[];n&&i.push(o.name),i.push(s),this.options.strict||i.push(this.aliasable("container.hooks.helperMissing"));var a=["(",this.itemsSeparatedBy(i,"||"),")"],l=this.source.functionCall(a,"call",o.callParams);this.push(l)},itemsSeparatedBy:function(e,r){var n=[];n.push(e[0]);for(var s=1;s<e.length;s++)n.push(r,e[s]);return n},invokeKnownHelper:function(e,r){var n=this.setupHelper(e,r);this.push(this.source.functionCall(n.name,"call",n.callParams))},invokeAmbiguous:function(e,r){this.useRegister("helper");var n=this.popStack();this.emptyHash();var s=this.setupHelper(0,e,r),o=this.lastHelper=this.nameLookup("helpers",e,"helper"),i=["(","(helper = ",o," || ",n,")"];this.options.strict||(i[0]="(helper = ",i.push(" != null ? helper : ",this.aliasable("container.hooks.helperMissing"))),this.push(["(",i,s.paramsInit?["),(",s.paramsInit]:[],"),","(typeof helper === ",this.aliasable('"function"')," ? ",this.source.functionCall("helper","call",s.callParams)," : helper))"])},invokePartial:function(e,r,n){var s=[],o=this.setupParams(r,1,s);e&&(r=this.popStack(),delete o.name),n&&(o.indent=JSON.stringify(n)),o.helpers="helpers",o.partials="partials",o.decorators="container.decorators",e?s.unshift(r):s.unshift(this.nameLookup("partials",r,"partial")),this.options.compat&&(o.depths="depths"),o=this.objectLiteral(o),s.push(o),this.push(this.source.functionCall("container.invokePartial","",s))},assignToHash:function(e){var r=this.popStack(),n=void 0,s=void 0,o=void 0;this.trackIds&&(o=this.popStack()),this.stringParams&&(s=this.popStack(),n=this.popStack());var i=this.hash;n&&(i.contexts[e]=n),s&&(i.types[e]=s),o&&(i.ids[e]=o),i.values[e]=r},pushId:function(e,r,n){e==="BlockParam"?this.pushStackLiteral("blockParams["+r[0]+"].path["+r[1]+"]"+(n?" + "+JSON.stringify("."+n):"")):e==="PathExpression"?this.pushString(r):e==="SubExpression"?this.pushStackLiteral("true"):this.pushStackLiteral("null")},compiler:Sn,compileChildren:function(e,r){for(var n=e.children,s=void 0,o=void 0,i=0,a=n.length;i<a;i++){s=n[i],o=new this.compiler;var l=this.matchExistingProgram(s);if(l==null){this.context.programs.push("");var c=this.context.programs.length;s.index=c,s.name="program"+c,this.context.programs[c]=o.compile(s,r,this.context,!this.precompile),this.context.decorators[c]=o.decorators,this.context.environments[c]=s,this.useDepths=this.useDepths||o.useDepths,this.useBlockParams=this.useBlockParams||o.useBlockParams,s.useDepths=this.useDepths,s.useBlockParams=this.useBlockParams}else s.index=l.index,s.name="program"+l.index,this.useDepths=this.useDepths||l.useDepths,this.useBlockParams=this.useBlockParams||l.useBlockParams}},matchExistingProgram:function(e){for(var r=0,n=this.context.environments.length;r<n;r++){var s=this.context.environments[r];if(s&&s.equals(e))return s}},programExpression:function(e){var r=this.environment.children[e],n=[r.index,"data",r.blockParams];return(this.useBlockParams||this.useDepths)&&n.push("blockParams"),this.useDepths&&n.push("depths"),"container.program("+n.join(", ")+")"},useRegister:function(e){this.registers[e]||(this.registers[e]=!0,this.registers.list.push(e))},push:function(e){return e instanceof bn||(e=this.source.wrap(e)),this.inlineStack.push(e),e},pushStackLiteral:function(e){this.push(new bn(e))},pushSource:function(e){this.pendingContent&&(this.source.push(this.appendToBuffer(this.source.quotedString(this.pendingContent),this.pendingLocation)),this.pendingContent=void 0),e&&this.source.push(e)},replaceStack:function(e){var r=["("],n=void 0,s=void 0,o=void 0;if(!this.isInline())throw new yc.default("replaceStack on non-inline");var i=this.popStack(!0);if(i instanceof bn)n=[i.value],r=["(",n],o=!0;else{s=!0;var a=this.incrStack();r=["((",this.push(a)," = ",i,")"],n=this.topStack()}var l=e.call(this,n);o||this.popStack(),s&&this.stackSlot--,this.push(r.concat(l,")"))},incrStack:function(){return this.stackSlot++,this.stackSlot>this.stackVars.length&&this.stackVars.push("stack"+this.stackSlot),this.topStackName()},topStackName:function(){return"stack"+this.stackSlot},flushInline:function(){var e=this.inlineStack;this.inlineStack=[];for(var r=0,n=e.length;r<n;r++){var s=e[r];if(s instanceof bn)this.compileStack.push(s);else{var o=this.incrStack();this.pushSource([o," = ",s,";"]),this.compileStack.push(o)}}},isInline:function(){return this.inlineStack.length},popStack:function(e){var r=this.isInline(),n=(r?this.inlineStack:this.compileStack).pop();if(!e&&n instanceof bn)return n.value;if(!r){if(!this.stackSlot)throw new yc.default("Invalid stack pop");this.stackSlot--}return n},topStack:function(){var e=this.isInline()?this.inlineStack:this.compileStack,r=e[e.length-1];return r instanceof bn?r.value:r},contextName:function(e){return this.useDepths&&e?"depths["+e+"]":"depth"+e},quotedString:function(e){return this.source.quotedString(e)},objectLiteral:function(e){return this.source.objectLiteral(e)},aliasable:function(e){var r=this.aliases[e];return r?(r.referenceCount++,r):(r=this.aliases[e]=this.source.wrap(e),r.aliasable=!0,r.referenceCount=1,r)},setupHelper:function(e,r,n){var s=[],o=this.setupHelperArgs(r,e,s,n),i=this.nameLookup("helpers",r,"helper"),a=this.aliasable(this.contextName(0)+" != null ? "+this.contextName(0)+" : (container.nullContext || {})");return{params:s,paramsInit:o,name:i,callParams:[a].concat(s)}},setupParams:function(e,r,n){var s={},o=[],i=[],a=[],l=!n,c=void 0;l&&(n=[]),s.name=this.quotedString(e),s.hash=this.popStack(),this.trackIds&&(s.hashIds=this.popStack()),this.stringParams&&(s.hashTypes=this.popStack(),s.hashContexts=this.popStack());var f=this.popStack(),u=this.popStack();(u||f)&&(s.fn=u||"container.noop",s.inverse=f||"container.noop");for(var d=r;d--;)c=this.popStack(),n[d]=c,this.trackIds&&(a[d]=this.popStack()),this.stringParams&&(i[d]=this.popStack(),o[d]=this.popStack());return l&&(s.args=this.source.generateArray(n)),this.trackIds&&(s.ids=this.source.generateArray(a)),this.stringParams&&(s.types=this.source.generateArray(i),s.contexts=this.source.generateArray(o)),this.options.data&&(s.data="data"),this.useBlockParams&&(s.blockParams="blockParams"),s},setupHelperArgs:function(e,r,n,s){var o=this.setupParams(e,r,n);return o.loc=JSON.stringify(this.source.currentLocation),o=this.objectLiteral(o),s?(this.useRegister("options"),n.push("options"),["options=",o]):n?(n.push(o),""):o}};(function(){for(var t="break else new var case finally return void catch for switch while continue function this with default if throw delete in try do instanceof typeof abstract enum int short boolean export interface static byte extends long super char final native synchronized class float package throws const goto private transient debugger implements protected volatile double import public let yield await null true false".split(" "),e=Sn.RESERVED_WORDS={},r=0,n=t.length;r<n;r++)e[t[r]]=!0})();Sn.isValidJavaScriptVariableName=function(t){return!Sn.RESERVED_WORDS[t]&&/^[a-zA-Z_$][0-9a-zA-Z_$]*$/.test(t)};function p2(t,e,r,n,s){var o=e.popStack(),i=r.length;for(t&&i--;n<i;n++)o=e.nameLookup(o,r[n],s);return t?[e.aliasable("container.strict"),"(",o,", ",e.quotedString(r[n]),", ",JSON.stringify(e.source.currentLocation)," )"]:o}Ci.default=Sn;Yh.exports=Ci.default});var tp=I((xi,ep)=>{"use strict";xi.__esModule=!0;function Ps(t){return t&&t.__esModule?t:{default:t}}var m2=rh(),g2=Ps(m2),y2=$l(),w2=Ps(y2),wc=mh(),_c=_h(),_2=Qh(),b2=Ps(_2),S2=zl(),E2=Ps(S2),v2=Kl(),C2=Ps(v2),x2=g2.default.create;function Zh(){var t=x2();return t.compile=function(e,r){return _c.compile(e,r,t)},t.precompile=function(e,r){return _c.precompile(e,r,t)},t.AST=w2.default,t.Compiler=_c.Compiler,t.JavaScriptCompiler=b2.default,t.Parser=wc.parser,t.parse=wc.parse,t.parseWithoutProcessing=wc.parseWithoutProcessing,t}var En=Zh();En.create=Zh;C2.default(En);En.Visitor=E2.default;En.default=En;xi.default=En;ep.exports=xi.default});var I2={};Cc(I2,{default:()=>Oi});module.exports=gp(I2);var wr=require("obsidian");var ct=require("obsidian");var qo=require("obsidian");var Ti={Error:"Error",user:"user",system:"system",assistant:"assistant",newChat:"newChat","Conversion failed. Selected sections is a":"Conversion failed. Selected sections is a",message:"message","Check the developer console for error details. ":"Check the developer console for error details. ","Regenerate?":"Regenerate?","This will delete the current response content. You can configure this in settings to not require confirmation.":"This will delete the current response content. You can configure this in settings to not require confirmation.","Export conversations to JSONL":"Export conversations to JSONL","No conversation found":"No conversation found","Exported to the same directory, Obsidian does not display the JSONL format. Please open with another software.":"Exported to the same directory, Obsidian does not display the JSONL format. Please open with another software.","Replace speaker with tag":"Replace speaker with tag","No speaker found":"No speaker found","Replace the names of the two most frequently occurring speakers with tag format.":"Replace the names of the two most frequently occurring speakers with tag format.",Replace:"Replace","Select message at cursor":"Select message at cursor","No message found at cursor":"No message found at cursor","API key is required":"API key is required","API secret is required":"API secret is required","Model is required":"Model is required","API URL is required":"API URL is required","Load template file: ":"Load template file: ","Templates have been updated: ":"Templates have been updated: ","Syntax Error Report":"Syntax Error Report","Create prompt template file":"Create prompt template file","Expected at least 2 sections, heading and content":"Expected at least 2 sections, heading and content","Expected heading":"Expected heading","Duplicate title:":"Duplicate title:","Please add a user message before generating AI response":"Please add a user message before generating AI response","Waiting for metadata to be ready. Please try again.":"Waiting for metadata to be ready. Please try again.","No text generated":"No text generated",characters:"characters","Removed commands":"Removed commands","Added commands":"Added commands","Restore default":"Restore default","AI assistants":"AI assistants","New AI assistant":"New AI assistant","Select assistant from dropdown and click 'Add'. For those compatible with the OpenAI protocol, you can select OpenAI.":"Select assistant from dropdown and click 'Add'. For those compatible with the OpenAI protocol, you can select OpenAI.",Add:"Add","Please add at least one AI assistant to start using the plugin.":"Please add at least one AI assistant to start using the plugin.","Message tags":"Message tags","Keywords for tags in the text box are separated by spaces":"Keywords for tags in the text box are separated by spaces","New chat tags":"New chat tags","User message tags":"User message tags","System message tags":"System message tags","At least one tag is required":"At least one tag is required",tag:"tag","Trigger AI generation":"Trigger AI generation","Obtain key from ":"Obtain key from ","Web search":"Web search","Enable web search for AI":"Enable web search for AI","Enter your key":"Enter your key","Default:":"Default:","Refer to the technical documentation":"Refer to the technical documentation","Keyword for tag must not contain #":"Keyword for tag must not contain #","Keyword for tag must not contain space":"Keyword for tag must not contain space","Keyword for tag must be unique":"Keyword for tag must be unique",Model:"Model","Select the model to use":"Select the model to use","Please input API key first":"Please input API key first","Input the model to use":"Input the model to use","Please enter a number":"Please enter a number","Minimum value is 256":"Minimum value is 256","Invalid URL":"Invalid URL","Override input parameters":"Override input parameters",'Developer feature, in JSON format. For example, if the model list doesn\'t have the model you want, enter {"model": "your desired model"}':`Developer feature, in JSON format. For example, if the model list doesn't have the model you want, enter {"model": "your desired model"}`,"Remove AI assistant":"Remove AI assistant",Remove:"Remove",Endpoint:"Endpoint","API version":"API version","Select assistant":"Select assistant","Confirm before regeneration":"Confirm before regeneration","Confirm before replacing existing assistant responses when using assistant commands":"Confirm before replacing existing assistant responses when using assistant commands",Advanced:"Advanced","Delay before answer (Seconds)":"Delay before answer (Seconds)","If you encounter errors with missing user messages, it may be due to the need for more time to parse the messages. Please slightly increase the answer delay time.":"If you encounter errors with missing user messages, it may be due to the need for more time to parse the messages. Please slightly increase the answer delay time.","Replace tag Command":"Replace tag Command","Export to JSONL Command":"Export to JSONL Command","AI generate":"AI generate","Text generated successfully":"Text generated successfully","This is a non-streaming request, please wait...":"This is a non-streaming request, please wait...",promptFileName:"prompt.en",PRESET_PROMPT_TEMPLATES:`# Instructions

- Collect your commonly used prompts here for use with the Tars plugin commands.
- This file follows Obsidian's slide format, using \`---\` to separate each page.
- The first page contains instructions, and each subsequent page is a prompt template.
- Each template starts with a title in Markdown heading format, titles cannot be repeated. This is followed by the template content. Both title and content are required.
- If the content contains \`{{s}}\`, it will be replaced with your selected text.
- If there's no \`{{s}}\`, the selected text will be appended.
- If no text is selected, the template content will be used as is.
- If a page contains syntax errors, it won't appear in the command list.
- If you've edited this file, to load the updated templates into commands, please ==run the 'Load template file' command==, which will also check for syntax errors and display them in a popup.

---

# Prompt example

Tell me a joke

---

# Translation

Translate the following content into English\uFF1A{{s}}

---

# One-sentence summary

{{s}} Summarize the above content in one sentence

`};var Ac={Error:"\u5F02\u5E38",user:"\u7528\u6237",system:"\u7CFB\u7EDF",assistant:"\u52A9\u624B",newChat:"\u65B0\u5BF9\u8BDD","Conversion failed. Selected sections is a":"\u8F6C\u6362\u5931\u8D25\u3002\u9009\u4E2D\u7684\u6BB5\u843D\u662F",message:"\u6D88\u606F","Check the developer console for error details. ":"\u67E5\u770B\u5F00\u53D1\u8005\u63A7\u5236\u53F0\u4E86\u89E3\u9519\u8BEF. ","Regenerate?":"\u91CD\u65B0\u751F\u6210?","This will delete the current response content. You can configure this in settings to not require confirmation.":"\u8FD9\u4F1A\u5220\u6389\u5F53\u524D\u7684\u56DE\u7B54\u5185\u5BB9\u3002\u4F60\u53EF\u4EE5\u5728\u8BBE\u7F6E\u91CC\u914D\u7F6E\u4E0D\u9700\u8981\u5F39\u7A97\u786E\u8BA4\u3002","Export conversations to JSONL":"\u5BFC\u51FA\u5BF9\u8BDD\u5230 JSONL","No conversation found":"\u6CA1\u6709\u627E\u5230\u5BF9\u8BDD","Exported to the same directory, Obsidian does not display the JSONL format. Please open with another software.":"\u5DF2\u7ECF\u5BFC\u51FA\u5230\u540C\u4E00\u76EE\u5F55\uFF0Cobsidian \u4E0D\u663E\u793A jsonl \u683C\u5F0F\uFF0C\u8BF7\u7528\u5176\u4ED6\u8F6F\u4EF6\u6253\u5F00","Replace speaker with tag":"\u628A\u8BF4\u8BDD\u8005\u66FF\u6362\u4E3A\u6807\u7B7E","No speaker found":"\u6CA1\u6709\u627E\u5230\u8BF4\u8BDD\u8005","Replace the names of the two most frequently occurring speakers with tag format.":"\u7528\u6807\u7B7E\u683C\u5F0F\u66FF\u6362\u4E24\u4E2A\u6700\u5E38\u51FA\u73B0\u7684\u8BF4\u8BDD\u8005\u7684\u540D\u5B57",Replace:"\u66FF\u6362","Select message at cursor":"\u9009\u62E9\u5149\u6807\u5904\u7684\u6D88\u606F","No message found at cursor":"\u5149\u6807\u5904\u6CA1\u6709\u627E\u5230\u6D88\u606F","API key is required":"\u8BF7\u914D\u7F6E\u5BF9\u5E94\u7684 API key","API secret is required":"\u8BF7\u914D\u7F6E\u5BF9\u5E94\u7684 API secret","Model is required":"\u8BF7\u914D\u7F6E\u5BF9\u5E94\u7684\u6A21\u578B","API URL is required":"\u8BF7\u914D\u7F6E\u5BF9\u5E94\u7684 API URL","Load template file: ":"\u52A0\u8F7D\u6A21\u677F\u6587\u4EF6: ","Templates have been updated: ":"\u6A21\u677F\u5DF2\u66F4\u65B0: ","Syntax Error Report":"\u8BED\u6CD5\u9519\u8BEF\u62A5\u544A","Create prompt template file":"\u521B\u5EFA\u63D0\u793A\u8BCD\u6A21\u677F\u6587\u4EF6","Expected at least 2 sections, heading and content":"\u81F3\u5C11\u9700\u8981 2 \u4E2A\u90E8\u5206\uFF0C\u6807\u9898\u548C\u5185\u5BB9","Expected heading":"\u9700\u8981\u6807\u9898","Duplicate title:":"\u91CD\u590D\u7684\u6807\u9898:","Please add a user message before generating AI response":"\u8BF7\u5148\u6DFB\u52A0\u7528\u6237\u6D88\u606F\uFF0C\u518D\u7528 AI \u56DE\u7B54","Waiting for metadata to be ready. Please try again.":"\u6B63\u5728\u7B49\u5F85\u5143\u6570\u636E\u51C6\u5907\u5C31\u7EEA\u3002\u8BF7\u91CD\u8BD5\u3002","No text generated":"\u6CA1\u6709\u751F\u6210\u6587\u672C",characters:"\u4E2A\u5B57\u7B26","Removed commands":"\u5DF2\u79FB\u9664\u547D\u4EE4","Added commands":"\u5DF2\u6DFB\u52A0\u547D\u4EE4","Restore default":"\u6062\u590D\u9ED8\u8BA4","AI assistants":"AI \u52A9\u624B","New AI assistant":"\u65B0\u7684AI\u52A9\u624B","Select assistant from dropdown and click 'Add'. For those compatible with the OpenAI protocol, you can select OpenAI.":"\u4ECE\u4E0B\u62C9\u6846\u9009\u62E9\u52A9\u624B\u7C7B\u578B\uFF0C\u70B9\u51FB\u65B0\u589E\u6309\u94AE\u3002\u5BF9\u4E8E\u517C\u5BB9OpenAI\u534F\u8BAE\u7684\uFF0C\u53EF\u4EE5\u9009\u62E9OpenAI.",Add:"\u65B0\u589E","Please add at least one AI assistant to start using the plugin.":"\u8BF7\u81F3\u5C11\u6DFB\u52A0\u4E00\u4E2AAI\u52A9\u624B\uFF0C\u4EE5\u4FBF\u5F00\u59CB\u4F7F\u7528\u63D2\u4EF6","Message tags":"\u6D88\u606F\u6807\u7B7E","Keywords for tags in the text box are separated by spaces":"\u5728\u6587\u672C\u6846\u4E2D\u7684\u6807\u7B7E\u5173\u952E\u5B57\u7528\u7A7A\u683C\u5206\u9694","New chat tags":"\u65B0\u5BF9\u8BDD\u7684\u6807\u7B7E","User message tags":"\u7528\u6237\u6D88\u606F\u7684\u6807\u7B7E","System message tags":"\u7CFB\u7EDF\u6D88\u606F\u7684\u6807\u7B7E","At least one tag is required":"\u81F3\u5C11\u9700\u8981\u4E00\u4E2A\u6807\u7B7E",tag:"\u6807\u7B7E","Trigger AI generation":"\u89E6\u53D1AI\u751F\u6210","Obtain key from ":"\u83B7\u53D6 key \u7F51\u7AD9 ","Web search":"\u7F51\u7EDC\u641C\u7D22","Enable web search for AI":"\u4E3A\u5F53\u524D AI \u542F\u7528\u7F51\u7EDC\u641C\u7D22","Enter your key":"\u8F93\u5165\u4F60\u7684 key","Default:":"\u9ED8\u8BA4:","Refer to the technical documentation":"\u53C2\u8003\u6280\u672F\u6587\u6863","Keyword for tag must not contain #":"\u6807\u7B7E\u5173\u952E\u5B57\u4E0D\u80FD\u5305\u542B#","Keyword for tag must not contain space":"\u6807\u7B7E\u5173\u952E\u5B57\u4E0D\u80FD\u5305\u542B\u7A7A\u683C","Keyword for tag must be unique":"\u6807\u7B7E\u5173\u952E\u5B57\u5FC5\u987B\u552F\u4E00",Model:"\u6A21\u578B","Select the model to use":"\u9009\u62E9\u8981\u4F7F\u7528\u7684\u6A21\u578B","Please input API key first":"\u8BF7\u5148\u8F93\u5165API key","Input the model to use":"\u8F93\u5165\u8981\u4F7F\u7528\u7684\u6A21\u578B","Please enter a number":"\u8BF7\u8F93\u5165\u4E00\u4E2A\u6570\u5B57","Minimum value is 256":"\u6700\u5C0F\u503C\u662F256","Invalid URL":"\u65E0\u6548\u7684 URL","Override input parameters":"\u8986\u76D6\u8F93\u5165\u53C2\u6570",'Developer feature, in JSON format. For example, if the model list doesn\'t have the model you want, enter {"model": "your desired model"}':'\u5F00\u53D1\u8005\u529F\u80FD\uFF0C\u4EE5 JSON \u683C\u5F0F\u3002\u4F8B\u5982: \u6A21\u578B\u5217\u8868\u4E2D\u6CA1\u6709\u4F60\u9700\u8981\u7684\u6A21\u578B\u65F6\uFF0C\u53EF\u4EE5\u586B\u5165 {"model": "\u4F60\u60F3\u8981\u7684model"}',"Remove AI assistant":"\u79FB\u9664 AI \u52A9\u624B",Remove:"\u79FB\u9664",Endpoint:"\u7EC8\u7ED3\u70B9","API version":"API \u7248\u672C","Select assistant":"\u9009\u62E9\u52A9\u624B","Confirm before regeneration":"\u91CD\u65B0\u751F\u6210\u524D\u662F\u5426\u9700\u8981\u786E\u8BA4","Confirm before replacing existing assistant responses when using assistant commands":"\u5728\u4F7F\u7528\u52A9\u624B\u6807\u7B7E\u547D\u4EE4\u65F6\uFF0C\u66FF\u6362\u65E7\u7684\u52A9\u624B\u6D88\u606F\uFF0C\u662F\u5426\u9700\u8981\u5F39\u7A97\u786E\u8BA4",Advanced:"\u9AD8\u7EA7","Delay before answer (Seconds)":"\u56DE\u7B54\u524D\u7684\u5EF6\u8FDF\uFF08\u79D2\uFF09","If you encounter errors with missing user messages, it may be due to the need for more time to parse the messages. Please slightly increase the answer delay time.":"\u5982\u679C\u9047\u5230\u7F3A\u5C11\u7528\u6237\u6D88\u606F\u7684\u9519\u8BEF\uFF0C\u53EF\u80FD\u662F\u56E0\u4E3A\u9700\u8981\u66F4\u591A\u65F6\u95F4\u6765\u89E3\u6790\u6D88\u606F\uFF0C\u8BF7\u7A0D\u5FAE\u589E\u52A0\u5EF6\u8FDF","Replace tag Command":"\u66FF\u6362\u6807\u7B7E\u547D\u4EE4","Export to JSONL Command":"\u5BFC\u51FA\u5230 JSONL \u547D\u4EE4","AI generate":"AI \u751F\u6210","Text generated successfully":"\u6587\u672C\u751F\u6210\u6210\u529F","This is a non-streaming request, please wait...":"\u8FD9\u662F\u4E00\u4E2A\u975E\u6D41\u5F0F\u8BF7\u6C42\uFF0C\u8BF7\u7A0D\u5019...",promptFileName:"prompt.zh",PRESET_PROMPT_TEMPLATES:`# \u4F7F\u7528\u8BF4\u660E

- \u628A\u4F60\u7684\u5E38\u7528\u63D0\u793A\u8BCD\u6536\u96C6\u5230\u8FD9\u91CC\uFF0C\u4EE5\u4FBF\u5728Tars\u63D2\u4EF6\u7684\u547D\u4EE4\u4E2D\u4F7F\u7528\u3002
- \u672C\u6587\u4EF6\u6309\u7167 obsidian \u7684\u5E7B\u706F\u7247\u683C\u5F0F\uFF0C\u7528\`---\`\u6765\u5206\u9694\u6BCF\u4E00\u9875
- \u7B2C\u4E00\u9875\u662F\u8BF4\u660E\uFF0C\u540E\u9762\u7684\u6BCF\u4E00\u9875\u90FD\u662F\u4E00\u4E2A\u63D0\u793A\u8BCD\u6A21\u677F
- \u9996\u5148\u662F\u6A21\u677F\u7684\u6807\u9898, \u4EE5markdown\u7684\u6807\u9898\u683C\u5F0F, \u6807\u9898\u4E0D\u80FD\u91CD\u590D\u3002\u63A5\u4E0B\u6765\u90FD\u662F\u6A21\u677F\u7684\u5185\u5BB9\u3002\u6807\u9898\u548C\u5185\u5BB9\u90FD\u4E0D\u53EF\u7F3A\u5C11\u3002
- \u5982\u679C\u5185\u5BB9\u6709 \`{{s}}\`\uFF0C\u4F1A\u628A \`{{s}}\`\u66FF\u6362\u4E3A\u9009\u4E2D\u7684\u6587\u672C
- \u5982\u679C\u6CA1\u6709 \`{{s}}\`\uFF0C\u5219\u8FFD\u52A0
- \u5982\u679C\u6CA1\u6709\u9009\u4E2D\u7684\u6587\u672C\uFF0C\u5219\u76F4\u63A5\u4F7F\u7528\u6A21\u677F\u7684\u5185\u5BB9
- \u5982\u679C\u67D0\u4E00\u9875\u6709\u8BED\u6CD5\u9519\u8BEF\uFF0C\u5219\u4E0D\u4F1A\u51FA\u73B0\u5728\u547D\u4EE4\u4E2D
- \u5982\u679C\u4F60\u7F16\u8F91\u4E86\u8BE5\u6587\u4EF6\uFF0C\u8981\u628A\u66F4\u65B0\u540E\u7684\u6A21\u677F\u52A0\u8F7D\u5230\u547D\u4EE4\u4E2D\uFF0C==\u6267\u884C\u547D\u4EE4\u201C\u52A0\u8F7D\u6A21\u677F\u6587\u4EF6\u201D==\uFF0C\u8BE5\u547D\u4EE4\u540C\u65F6\u4F1A\u68C0\u67E5\u8BED\u6CD5\u9519\u8BEF\u5E76\u5F39\u7A97\u663E\u793A\u3002

---

# \u63D0\u793A\u8BCD\u4F8B\u5B50

\u7ED9\u6211\u8BB2\u4E2A\u7B11\u8BDD

---

# \u7FFB\u8BD1

\u628A\u4EE5\u4E0B\u5185\u5BB9\u7FFB\u8BD1\u4E3A\u4E2D\u6587\uFF1A{{s}}

---

# \u4E00\u53E5\u8BDD\u603B\u7ED3

{{s}} \u7528\u4E00\u53E5\u8BDD\u603B\u7ED3\u4EE5\u4E0A\u5185\u5BB9

`};var Rc={};var yp={en:Ti,"zh-TW":Rc,zh:Ac},Pc=window.localStorage.getItem("language"),Ii=yp[Pc||"en"];function y(t){return Ii||console.error("Error: locale not found",Pc),Ii&&Ii[t]||Ti[t]}var Is="RFC3986",ks={RFC1738:t=>String(t).replace(/%20/g,"+"),RFC3986:t=>String(t)},Oc="RFC1738";var wp=Array.isArray,Be=(()=>{let t=[];for(let e=0;e<256;++e)t.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return t})();var ki=1024,Tc=(t,e,r,n,s)=>{if(t.length===0)return t;let o=t;if(typeof t=="symbol"?o=Symbol.prototype.toString.call(t):typeof t!="string"&&(o=String(t)),r==="iso-8859-1")return escape(o).replace(/%u[0-9a-f]{4}/gi,function(a){return"%26%23"+parseInt(a.slice(2),16)+"%3B"});let i="";for(let a=0;a<o.length;a+=ki){let l=o.length>=ki?o.slice(a,a+ki):o,c=[];for(let f=0;f<l.length;++f){let u=l.charCodeAt(f);if(u===45||u===46||u===95||u===126||u>=48&&u<=57||u>=65&&u<=90||u>=97&&u<=122||s===Oc&&(u===40||u===41)){c[c.length]=l.charAt(f);continue}if(u<128){c[c.length]=Be[u];continue}if(u<2048){c[c.length]=Be[192|u>>6]+Be[128|u&63];continue}if(u<55296||u>=57344){c[c.length]=Be[224|u>>12]+Be[128|u>>6&63]+Be[128|u&63];continue}f+=1,u=65536+((u&1023)<<10|l.charCodeAt(f)&1023),c[c.length]=Be[240|u>>18]+Be[128|u>>12&63]+Be[128|u>>6&63]+Be[128|u&63]}i+=c.join("")}return i};function Ic(t){return!t||typeof t!="object"?!1:!!(t.constructor&&t.constructor.isBuffer&&t.constructor.isBuffer(t))}function Ni(t,e){if(wp(t)){let r=[];for(let n=0;n<t.length;n+=1)r.push(e(t[n]));return r}return e(t)}var _p=Object.prototype.hasOwnProperty,kc={brackets(t){return String(t)+"[]"},comma:"comma",indices(t,e){return String(t)+"["+e+"]"},repeat(t){return String(t)}},Fe=Array.isArray,bp=Array.prototype.push,Nc=function(t,e){bp.apply(t,Fe(e)?e:[e])},Sp=Date.prototype.toISOString,G={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:Tc,encodeValuesOnly:!1,format:Is,formatter:ks[Is],indices:!1,serializeDate(t){return Sp.call(t)},skipNulls:!1,strictNullHandling:!1};function Ep(t){return typeof t=="string"||typeof t=="number"||typeof t=="boolean"||typeof t=="symbol"||typeof t=="bigint"}var Li={};function Lc(t,e,r,n,s,o,i,a,l,c,f,u,d,h,p,g,w,b){let _=t,C=b,R=0,E=!1;for(;(C=C.get(Li))!==void 0&&!E;){let M=C.get(t);if(R+=1,typeof M!="undefined"){if(M===R)throw new RangeError("Cyclic object value");E=!0}typeof C.get(Li)=="undefined"&&(R=0)}if(typeof c=="function"?_=c(e,_):_ instanceof Date?_=d==null?void 0:d(_):r==="comma"&&Fe(_)&&(_=Ni(_,function(M){return M instanceof Date?d==null?void 0:d(M):M})),_===null){if(o)return l&&!g?l(e,G.encoder,w,"key",h):e;_=""}if(Ep(_)||Ic(_)){if(l){let M=g?e:l(e,G.encoder,w,"key",h);return[(p==null?void 0:p(M))+"="+(p==null?void 0:p(l(_,G.encoder,w,"value",h)))]}return[(p==null?void 0:p(e))+"="+(p==null?void 0:p(String(_)))]}let T=[];if(typeof _=="undefined")return T;let P;if(r==="comma"&&Fe(_))g&&l&&(_=Ni(_,l)),P=[{value:_.length>0?_.join(",")||null:void 0}];else if(Fe(c))P=c;else{let M=Object.keys(_);P=f?M.sort(f):M}let B=a?String(e).replace(/\./g,"%2E"):String(e),k=n&&Fe(_)&&_.length===1?B+"[]":B;if(s&&Fe(_)&&_.length===0)return k+"[]";for(let M=0;M<P.length;++M){let F=P[M],N=typeof F=="object"&&typeof F.value!="undefined"?F.value:_[F];if(i&&N===null)continue;let le=u&&a?F.replace(/\./g,"%2E"):F,he=Fe(_)?typeof r=="function"?r(k,le):k:k+(u?"."+le:"["+le+"]");b.set(t,R);let ee=new WeakMap;ee.set(Li,b),Nc(T,Lc(N,he,r,n,s,o,i,a,r==="comma"&&g&&Fe(_)?null:l,c,f,u,d,h,p,g,w,ee))}return T}function vp(t=G){if(typeof t.allowEmptyArrays!="undefined"&&typeof t.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof t.encodeDotInKeys!="undefined"&&typeof t.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(t.encoder!==null&&typeof t.encoder!="undefined"&&typeof t.encoder!="function")throw new TypeError("Encoder has to be a function.");let e=t.charset||G.charset;if(typeof t.charset!="undefined"&&t.charset!=="utf-8"&&t.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");let r=Is;if(typeof t.format!="undefined"){if(!_p.call(ks,t.format))throw new TypeError("Unknown format option provided.");r=t.format}let n=ks[r],s=G.filter;(typeof t.filter=="function"||Fe(t.filter))&&(s=t.filter);let o;if(t.arrayFormat&&t.arrayFormat in kc?o=t.arrayFormat:"indices"in t?o=t.indices?"indices":"repeat":o=G.arrayFormat,"commaRoundTrip"in t&&typeof t.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");let i=typeof t.allowDots=="undefined"?t.encodeDotInKeys?!0:G.allowDots:!!t.allowDots;return{addQueryPrefix:typeof t.addQueryPrefix=="boolean"?t.addQueryPrefix:G.addQueryPrefix,allowDots:i,allowEmptyArrays:typeof t.allowEmptyArrays=="boolean"?!!t.allowEmptyArrays:G.allowEmptyArrays,arrayFormat:o,charset:e,charsetSentinel:typeof t.charsetSentinel=="boolean"?t.charsetSentinel:G.charsetSentinel,commaRoundTrip:!!t.commaRoundTrip,delimiter:typeof t.delimiter=="undefined"?G.delimiter:t.delimiter,encode:typeof t.encode=="boolean"?t.encode:G.encode,encodeDotInKeys:typeof t.encodeDotInKeys=="boolean"?t.encodeDotInKeys:G.encodeDotInKeys,encoder:typeof t.encoder=="function"?t.encoder:G.encoder,encodeValuesOnly:typeof t.encodeValuesOnly=="boolean"?t.encodeValuesOnly:G.encodeValuesOnly,filter:s,format:r,formatter:n,serializeDate:typeof t.serializeDate=="function"?t.serializeDate:G.serializeDate,skipNulls:typeof t.skipNulls=="boolean"?t.skipNulls:G.skipNulls,sort:typeof t.sort=="function"?t.sort:null,strictNullHandling:typeof t.strictNullHandling=="boolean"?t.strictNullHandling:G.strictNullHandling}}function Mi(t,e={}){let r=t,n=vp(e),s,o;typeof n.filter=="function"?(o=n.filter,r=o("",r)):Fe(n.filter)&&(o=n.filter,s=o);let i=[];if(typeof r!="object"||r===null)return"";let a=kc[n.arrayFormat],l=a==="comma"&&n.commaRoundTrip;s||(s=Object.keys(r)),n.sort&&s.sort(n.sort);let c=new WeakMap;for(let d=0;d<s.length;++d){let h=s[d];n.skipNulls&&r[h]===null||Nc(i,Lc(r[h],h,a,l,n.allowEmptyArrays,n.strictNullHandling,n.skipNulls,n.encodeDotInKeys,n.encode?n.encoder:null,n.filter,n.sort,n.allowDots,n.serializeDate,n.format,n.formatter,n.encodeValuesOnly,n.charset,c))}let f=i.join(n.delimiter),u=n.addQueryPrefix===!0?"?":"";return n.charsetSentinel&&(n.charset==="iso-8859-1"?u+="utf8=%26%2310003%3B&":u+="utf8=%E2%9C%93&"),f.length>0?u+f:""}var Mt="4.85.0";var Mc=!1,Dt,Di,xp,Ap,Rp,Bi,Pp,Ns,Fi,qi,Ui,Ls,Hi;function Dc(t,e={auto:!1}){if(Mc)throw new Error(`you must \`import 'openai/shims/${t.kind}'\` before importing anything else from openai`);if(Dt)throw new Error(`can't \`import 'openai/shims/${t.kind}'\` after \`import 'openai/shims/${Dt}'\``);Mc=e.auto,Dt=t.kind,Di=t.fetch,xp=t.Request,Ap=t.Response,Rp=t.Headers,Bi=t.FormData,Pp=t.Blob,Ns=t.File,Fi=t.ReadableStream,qi=t.getMultipartRequestOptions,Ui=t.getDefaultAgent,Ls=t.fileFromPath,Hi=t.isFsReadStream}var Ms=class{constructor(e){this.body=e}get[Symbol.toStringTag](){return"MultipartBody"}};function Bc({manuallyImported:t}={}){let e=t?"You may need to use polyfills":"Add one of these imports before your first `import \u2026 from 'openai'`:\n- `import 'openai/shims/node'` (if you're running on Node)\n- `import 'openai/shims/web'` (otherwise)\n",r,n,s,o;try{r=fetch,n=Request,s=Response,o=Headers}catch(i){throw new Error(`this environment is missing the following Web Fetch API type: ${i.message}. ${e}`)}return{kind:"web",fetch:r,Request:n,Response:s,Headers:o,FormData:typeof FormData!="undefined"?FormData:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'FormData' is undefined. ${e}`)}},Blob:typeof Blob!="undefined"?Blob:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'Blob' is undefined. ${e}`)}},File:typeof File!="undefined"?File:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'File' is undefined. ${e}`)}},ReadableStream:typeof ReadableStream!="undefined"?ReadableStream:class{constructor(){throw new Error(`streaming isn't supported in this environment yet as 'ReadableStream' is undefined. ${e}`)}},getMultipartRequestOptions:async(i,a)=>({...a,body:new Ms(i)}),getDefaultAgent:i=>{},fileFromPath:()=>{throw new Error("The `fileFromPath` function is only supported in Node. See the README for more details: https://www.github.com/openai/openai-node#file-uploads")},isFsReadStream:i=>!1}}Dt||Dc(Bc(),{auto:!0});var A=class extends Error{},W=class extends A{constructor(e,r,n,s){super(`${W.makeMessage(e,r,n)}`),this.status=e,this.headers=s,this.request_id=s==null?void 0:s["x-request-id"],this.error=r;let o=r;this.code=o==null?void 0:o.code,this.param=o==null?void 0:o.param,this.type=o==null?void 0:o.type}static makeMessage(e,r,n){let s=r!=null&&r.message?typeof r.message=="string"?r.message:JSON.stringify(r.message):r?JSON.stringify(r):n;return e&&s?`${e} ${s}`:e?`${e} status code (no body)`:s||"(no status code or body)"}static generate(e,r,n,s){if(!e||!s)return new pt({message:n,cause:Ds(r)});let o=r==null?void 0:r.error;return e===400?new Cn(e,o,n,s):e===401?new xn(e,o,n,s):e===403?new An(e,o,n,s):e===404?new Rn(e,o,n,s):e===409?new Pn(e,o,n,s):e===422?new On(e,o,n,s):e===429?new Tn(e,o,n,s):e>=500?new In(e,o,n,s):new W(e,o,n,s)}},Q=class extends W{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}},pt=class extends W{constructor({message:e,cause:r}){super(void 0,void 0,e||"Connection error.",void 0),r&&(this.cause=r)}},mt=class extends pt{constructor({message:e}={}){super({message:e!=null?e:"Request timed out."})}},Cn=class extends W{},xn=class extends W{},An=class extends W{},Rn=class extends W{},Pn=class extends W{},On=class extends W{},Tn=class extends W{},In=class extends W{},_r=class extends A{constructor(){super("Could not parse response content as the length limit was reached")}},br=class extends A{constructor(){super("Could not parse response content as the request was rejected by the content filter")}};var Bs=function(t,e,r,n,s){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?s.call(t,r):s?s.value=r:e.set(t,r),r},Bt=function(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)},me,Ft=class{constructor(){me.set(this,void 0),this.buffer=new Uint8Array,Bs(this,me,null,"f")}decode(e){if(e==null)return[];let r=e instanceof ArrayBuffer?new Uint8Array(e):typeof e=="string"?new TextEncoder().encode(e):e,n=new Uint8Array(this.buffer.length+r.length);n.set(this.buffer),n.set(r,this.buffer.length),this.buffer=n;let s=[],o;for(;(o=Ip(this.buffer,Bt(this,me,"f")))!=null;){if(o.carriage&&Bt(this,me,"f")==null){Bs(this,me,o.index,"f");continue}if(Bt(this,me,"f")!=null&&(o.index!==Bt(this,me,"f")+1||o.carriage)){s.push(this.decodeText(this.buffer.slice(0,Bt(this,me,"f")-1))),this.buffer=this.buffer.slice(Bt(this,me,"f")),Bs(this,me,null,"f");continue}let i=Bt(this,me,"f")!==null?o.preceding-1:o.preceding,a=this.decodeText(this.buffer.slice(0,i));s.push(a),this.buffer=this.buffer.slice(o.index),Bs(this,me,null,"f")}return s}decodeText(e){var r;if(e==null)return"";if(typeof e=="string")return e;if(typeof Buffer!="undefined"){if(e instanceof Buffer)return e.toString();if(e instanceof Uint8Array)return Buffer.from(e).toString();throw new A(`Unexpected: received non-Uint8Array (${e.constructor.name}) stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.`)}if(typeof TextDecoder!="undefined"){if(e instanceof Uint8Array||e instanceof ArrayBuffer)return(r=this.textDecoder)!=null||(this.textDecoder=new TextDecoder("utf8")),this.textDecoder.decode(e);throw new A(`Unexpected: received non-Uint8Array/ArrayBuffer (${e.constructor.name}) in a web platform. Please report this error.`)}throw new A("Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.")}flush(){return this.buffer.length?this.decode(`
`):[]}};me=new WeakMap;Ft.NEWLINE_CHARS=new Set([`
`,"\r"]);Ft.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function Ip(t,e){for(let s=e!=null?e:0;s<t.length;s++){if(t[s]===10)return{preceding:s,index:s+1,carriage:!1};if(t[s]===13)return{preceding:s,index:s+1,carriage:!0}}return null}function ji(t){if(t[Symbol.asyncIterator])return t;let e=t.getReader();return{async next(){try{let r=await e.read();return r!=null&&r.done&&e.releaseLock(),r}catch(r){throw e.releaseLock(),r}},async return(){let r=e.cancel();return e.releaseLock(),await r,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}var ce=class{constructor(e,r){this.iterator=e,this.controller=r}static fromSSEResponse(e,r){let n=!1;async function*s(){if(n)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");n=!0;let o=!1;try{for await(let i of kp(e,r))if(!o){if(i.data.startsWith("[DONE]")){o=!0;continue}if(i.event===null){let a;try{a=JSON.parse(i.data)}catch(l){throw console.error("Could not parse message into JSON:",i.data),console.error("From chunk:",i.raw),l}if(a&&a.error)throw new W(void 0,a.error,void 0,void 0);yield a}else{let a;try{a=JSON.parse(i.data)}catch(l){throw console.error("Could not parse message into JSON:",i.data),console.error("From chunk:",i.raw),l}if(i.event=="error")throw new W(void 0,a.error,a.message,void 0);yield{event:i.event,data:a}}}o=!0}catch(i){if(i instanceof Error&&i.name==="AbortError")return;throw i}finally{o||r.abort()}}return new ce(s,r)}static fromReadableStream(e,r){let n=!1;async function*s(){let i=new Ft,a=ji(e);for await(let l of a)for(let c of i.decode(l))yield c;for(let l of i.flush())yield l}async function*o(){if(n)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");n=!0;let i=!1;try{for await(let a of s())i||a&&(yield JSON.parse(a));i=!0}catch(a){if(a instanceof Error&&a.name==="AbortError")return;throw a}finally{i||r.abort()}}return new ce(o,r)}[Symbol.asyncIterator](){return this.iterator()}tee(){let e=[],r=[],n=this.iterator(),s=o=>({next:()=>{if(o.length===0){let i=n.next();e.push(i),r.push(i)}return o.shift()}});return[new ce(()=>s(e),this.controller),new ce(()=>s(r),this.controller)]}toReadableStream(){let e=this,r,n=new TextEncoder;return new Fi({async start(){r=e[Symbol.asyncIterator]()},async pull(s){try{let{value:o,done:i}=await r.next();if(i)return s.close();let a=n.encode(JSON.stringify(o)+`
`);s.enqueue(a)}catch(o){s.error(o)}},async cancel(){var s;await((s=r.return)==null?void 0:s.call(r))}})}};async function*kp(t,e){if(!t.body)throw e.abort(),new A("Attempted to iterate over a response with no body");let r=new Ki,n=new Ft,s=ji(t.body);for await(let o of Np(s))for(let i of n.decode(o)){let a=r.decode(i);a&&(yield a)}for(let o of n.flush()){let i=r.decode(o);i&&(yield i)}}async function*Np(t){let e=new Uint8Array;for await(let r of t){if(r==null)continue;let n=r instanceof ArrayBuffer?new Uint8Array(r):typeof r=="string"?new TextEncoder().encode(r):r,s=new Uint8Array(e.length+n.length);s.set(e),s.set(n,e.length),e=s;let o;for(;(o=Lp(e))!==-1;)yield e.slice(0,o),e=e.slice(o)}e.length>0&&(yield e)}function Lp(t){for(let n=0;n<t.length-2;n++){if(t[n]===10&&t[n+1]===10||t[n]===13&&t[n+1]===13)return n+2;if(t[n]===13&&t[n+1]===10&&n+3<t.length&&t[n+2]===13&&t[n+3]===10)return n+4}return-1}var Ki=class{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;let o={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],o}if(this.chunks.push(e),e.startsWith(":"))return null;let[r,n,s]=Mp(e,":");return s.startsWith(" ")&&(s=s.substring(1)),r==="event"?this.event=s:r==="data"&&this.data.push(s),null}};function Mp(t,e){let r=t.indexOf(e);return r!==-1?[t.substring(0,r),e,t.substring(r+e.length)]:[t,"",""]}var Fc=t=>t!=null&&typeof t=="object"&&typeof t.url=="string"&&typeof t.blob=="function",qc=t=>t!=null&&typeof t=="object"&&typeof t.name=="string"&&typeof t.lastModified=="number"&&kn(t),kn=t=>t!=null&&typeof t=="object"&&typeof t.size=="number"&&typeof t.type=="string"&&typeof t.text=="function"&&typeof t.slice=="function"&&typeof t.arrayBuffer=="function",Dp=t=>qc(t)||Fc(t)||Hi(t);async function Ji(t,e,r){var s,o,i;if(t=await t,qc(t))return t;if(Fc(t)){let a=await t.blob();e||(e=(s=new URL(t.url).pathname.split(/[\\/]/).pop())!=null?s:"unknown_file");let l=kn(a)?[await a.arrayBuffer()]:[a];return new Ns(l,e,r)}let n=await Bp(t);if(e||(e=(o=qp(t))!=null?o:"unknown_file"),!(r!=null&&r.type)){let a=(i=n[0])==null?void 0:i.type;typeof a=="string"&&(r={...r,type:a})}return new Ns(n,e,r)}async function Bp(t){var r;let e=[];if(typeof t=="string"||ArrayBuffer.isView(t)||t instanceof ArrayBuffer)e.push(t);else if(kn(t))e.push(await t.arrayBuffer());else if(Up(t))for await(let n of t)e.push(n);else throw new Error(`Unexpected data type: ${typeof t}; constructor: ${(r=t==null?void 0:t.constructor)==null?void 0:r.name}; props: ${Fp(t)}`);return e}function Fp(t){return`[${Object.getOwnPropertyNames(t).map(r=>`"${r}"`).join(", ")}]`}function qp(t){var e;return Vi(t.name)||Vi(t.filename)||((e=Vi(t.path))==null?void 0:e.split(/[\\/]/).pop())}var Vi=t=>{if(typeof t=="string")return t;if(typeof Buffer!="undefined"&&t instanceof Buffer)return String(t)},Up=t=>t!=null&&typeof t=="object"&&typeof t[Symbol.asyncIterator]=="function",$i=t=>t&&typeof t=="object"&&t.body&&t[Symbol.toStringTag]==="MultipartBody";var ve=async t=>{let e=await Uc(t.body);return qi(e,t)},Uc=async t=>{let e=new Bi;return await Promise.all(Object.entries(t||{}).map(([r,n])=>Wi(e,r,n))),e};var Wi=async(t,e,r)=>{if(r!==void 0){if(r==null)throw new TypeError(`Received null for "${e}"; to pass null in FormData, you must use the string 'null'`);if(typeof r=="string"||typeof r=="number"||typeof r=="boolean")t.append(e,String(r));else if(Dp(r)){let n=await Ji(r);t.append(e,n)}else if(Array.isArray(r))await Promise.all(r.map(n=>Wi(t,e+"[]",n)));else if(typeof r=="object")await Promise.all(Object.entries(r).map(([n,s])=>Wi(t,`${e}[${n}]`,s)));else throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${r} instead`)}};var jp=function(t,e,r,n,s){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?s.call(t,r):s?s.value=r:e.set(t,r),r},Kp=function(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)},Fs;async function Wc(t){let{response:e}=t;if(t.options.stream)return Sr("response",e.status,e.url,e.headers,e.body),t.options.__streamClass?t.options.__streamClass.fromSSEResponse(e,t.controller):ce.fromSSEResponse(e,t.controller);if(e.status===204)return null;if(t.options.__binaryResponse)return e;let r=e.headers.get("content-type");if((r==null?void 0:r.includes("application/json"))||(r==null?void 0:r.includes("application/vnd.api+json"))){let o=await e.json();return Sr("response",e.status,e.url,e.headers,o),Jc(o,e)}let s=await e.text();return Sr("response",e.status,e.url,e.headers,s),s}function Jc(t,e){return!t||typeof t!="object"||Array.isArray(t)?t:Object.defineProperty(t,"_request_id",{value:e.headers.get("x-request-id"),enumerable:!1})}var Er=class extends Promise{constructor(e,r=Wc){super(n=>{n(null)}),this.responsePromise=e,this.parseResponse=r}_thenUnwrap(e){return new Er(this.responsePromise,async r=>Jc(e(await this.parseResponse(r),r),r.response))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){let[e,r]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:r,request_id:r.headers.get("x-request-id")}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(this.parseResponse)),this.parsedPromise}then(e,r){return this.parse().then(e,r)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}},Hs=class{constructor({baseURL:e,maxRetries:r=2,timeout:n=6e5,httpAgent:s,fetch:o}){this.baseURL=e,this.maxRetries=Gi("maxRetries",r),this.timeout=Gi("timeout",n),this.httpAgent=s,this.fetch=o!=null?o:Di}authHeaders(e){return{}}defaultHeaders(e){return{Accept:"application/json","Content-Type":"application/json","User-Agent":this.getUserAgent(),...Gp(),...this.authHeaders(e)}}validateHeaders(e,r){}defaultIdempotencyKey(){return`stainless-node-retry-${Qp()}`}get(e,r){return this.methodRequest("get",e,r)}post(e,r){return this.methodRequest("post",e,r)}patch(e,r){return this.methodRequest("patch",e,r)}put(e,r){return this.methodRequest("put",e,r)}delete(e,r){return this.methodRequest("delete",e,r)}methodRequest(e,r,n){return this.request(Promise.resolve(n).then(async s=>{let o=s&&kn(s==null?void 0:s.body)?new DataView(await s.body.arrayBuffer()):(s==null?void 0:s.body)instanceof DataView?s.body:(s==null?void 0:s.body)instanceof ArrayBuffer?new DataView(s.body):s&&ArrayBuffer.isView(s==null?void 0:s.body)?new DataView(s.body.buffer):s==null?void 0:s.body;return{method:e,path:r,...s,body:o}}))}getAPIList(e,r,n){return this.requestAPIList(r,{method:"get",path:e,...n})}calculateContentLength(e){if(typeof e=="string"){if(typeof Buffer!="undefined")return Buffer.byteLength(e,"utf8").toString();if(typeof TextEncoder!="undefined")return new TextEncoder().encode(e).length.toString()}else if(ArrayBuffer.isView(e))return e.byteLength.toString();return null}buildRequest(e,{retryCount:r=0}={}){var p,g,w,b,_,C;e={...e};let{method:n,path:s,query:o,headers:i={}}=e,a=ArrayBuffer.isView(e.body)||e.__binaryRequest&&typeof e.body=="string"?e.body:$i(e.body)?e.body.body:e.body?JSON.stringify(e.body,null,2):null,l=this.calculateContentLength(a),c=this.buildURL(s,o);"timeout"in e&&Gi("timeout",e.timeout),e.timeout=(p=e.timeout)!=null?p:this.timeout;let f=(w=(g=e.httpAgent)!=null?g:this.httpAgent)!=null?w:Ui(c),u=e.timeout+1e3;typeof((b=f==null?void 0:f.options)==null?void 0:b.timeout)=="number"&&u>((_=f.options.timeout)!=null?_:0)&&(f.options.timeout=u),this.idempotencyHeader&&n!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),i[this.idempotencyHeader]=e.idempotencyKey);let d=this.buildHeaders({options:e,headers:i,contentLength:l,retryCount:r});return{req:{method:n,...a&&{body:a},headers:d,...f&&{agent:f},signal:(C=e.signal)!=null?C:null},url:c,timeout:e.timeout}}buildHeaders({options:e,headers:r,contentLength:n,retryCount:s}){let o={};n&&(o["content-length"]=n);let i=this.defaultHeaders(e);return Kc(o,i),Kc(o,r),$i(e.body)&&Dt!=="node"&&delete o["content-type"],Us(i,"x-stainless-retry-count")===void 0&&Us(r,"x-stainless-retry-count")===void 0&&(o["x-stainless-retry-count"]=String(s)),Us(i,"x-stainless-timeout")===void 0&&Us(r,"x-stainless-timeout")===void 0&&e.timeout&&(o["x-stainless-timeout"]=String(e.timeout)),this.validateHeaders(o,r),o}async prepareOptions(e){}async prepareRequest(e,{url:r,options:n}){}parseHeaders(e){return e?Symbol.iterator in e?Object.fromEntries(Array.from(e).map(r=>[...r])):{...e}:{}}makeStatusError(e,r,n,s){return W.generate(e,r,n,s)}request(e,r=null){return new Er(this.makeRequest(e,r))}async makeRequest(e,r){var u,d,h;let n=await e,s=(u=n.maxRetries)!=null?u:this.maxRetries;r==null&&(r=s),await this.prepareOptions(n);let{req:o,url:i,timeout:a}=this.buildRequest(n,{retryCount:s-r});if(await this.prepareRequest(o,{url:i,options:n}),Sr("request",i,n,o.headers),(d=n.signal)!=null&&d.aborted)throw new Q;let l=new AbortController,c=await this.fetchWithTimeout(i,o,a,l).catch(Ds);if(c instanceof Error){if((h=n.signal)!=null&&h.aborted)throw new Q;if(r)return this.retryRequest(n,r);throw c.name==="AbortError"?new mt:new pt({cause:c})}let f=Vp(c.headers);if(!c.ok){if(r&&this.shouldRetry(c)){let C=`retrying, ${r} attempts remaining`;return Sr(`response (error; ${C})`,c.status,i,f),this.retryRequest(n,r,f)}let p=await c.text().catch(C=>Ds(C).message),g=zp(p),w=g?void 0:p;throw Sr(`response (error; ${r?"(error; no more retries left)":"(error; not retryable)"})`,c.status,i,f,w),this.makeStatusError(c.status,g,w,f)}return{response:c,options:n,controller:l}}requestAPIList(e,r){let n=this.makeRequest(r,null);return new zi(this,n,e)}buildURL(e,r){let n=Yp(e)?new URL(e):new URL(this.baseURL+(this.baseURL.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),s=this.defaultQuery();return $c(s)||(r={...s,...r}),typeof r=="object"&&r&&!Array.isArray(r)&&(n.search=this.stringifyQuery(r)),n.toString()}stringifyQuery(e){return Object.entries(e).filter(([r,n])=>typeof n!="undefined").map(([r,n])=>{if(typeof n=="string"||typeof n=="number"||typeof n=="boolean")return`${encodeURIComponent(r)}=${encodeURIComponent(n)}`;if(n===null)return`${encodeURIComponent(r)}=`;throw new A(`Cannot stringify type ${typeof n}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}async fetchWithTimeout(e,r,n,s){let{signal:o,...i}=r||{};o&&o.addEventListener("abort",()=>s.abort());let a=setTimeout(()=>s.abort(),n),l={signal:s.signal,...i};return l.method&&(l.method=l.method.toUpperCase()),this.fetch.call(void 0,e,l).finally(()=>{clearTimeout(a)})}shouldRetry(e){let r=e.headers.get("x-should-retry");return r==="true"?!0:r==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,r,n){var a;let s,o=n==null?void 0:n["retry-after-ms"];if(o){let l=parseFloat(o);Number.isNaN(l)||(s=l)}let i=n==null?void 0:n["retry-after"];if(i&&!s){let l=parseFloat(i);Number.isNaN(l)?s=Date.parse(i)-Date.now():s=l*1e3}if(!(s&&0<=s&&s<60*1e3)){let l=(a=e.maxRetries)!=null?a:this.maxRetries;s=this.calculateDefaultRetryTimeoutMillis(r,l)}return await Ze(s),this.makeRequest(e,r-1)}calculateDefaultRetryTimeoutMillis(e,r){let o=r-e,i=Math.min(.5*Math.pow(2,o),8),a=1-Math.random()*.25;return i*a*1e3}getUserAgent(){return`${this.constructor.name}/JS ${Mt}`}},Nn=class{constructor(e,r,n,s){Fs.set(this,void 0),jp(this,Fs,e,"f"),this.options=s,this.response=r,this.body=n}hasNextPage(){return this.getPaginatedItems().length?this.nextPageInfo()!=null:!1}async getNextPage(){let e=this.nextPageInfo();if(!e)throw new A("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");let r={...this.options};if("params"in e&&typeof r.query=="object")r.query={...r.query,...e.params};else if("url"in e){let n=[...Object.entries(r.query||{}),...e.url.searchParams.entries()];for(let[s,o]of n)e.url.searchParams.set(s,o);r.query=void 0,r.path=e.url.toString()}return await Kp(this,Fs,"f").requestAPIList(this.constructor,r)}async*iterPages(){let e=this;for(yield e;e.hasNextPage();)e=await e.getNextPage(),yield e}async*[(Fs=new WeakMap,Symbol.asyncIterator)](){for await(let e of this.iterPages())for(let r of e.getPaginatedItems())yield r}},zi=class extends Er{constructor(e,r,n){super(r,async s=>new n(e,s.response,await Wc(s),s.options))}async*[Symbol.asyncIterator](){let e=await this;for await(let r of e)yield r}},Vp=t=>new Proxy(Object.fromEntries(t.entries()),{get(e,r){let n=r.toString();return e[n.toLowerCase()]||e[n]}}),Wp={method:!0,path:!0,query:!0,body:!0,headers:!0,maxRetries:!0,stream:!0,timeout:!0,httpAgent:!0,signal:!0,idempotencyKey:!0,__metadata:!0,__binaryRequest:!0,__binaryResponse:!0,__streamClass:!0},q=t=>typeof t=="object"&&t!==null&&!$c(t)&&Object.keys(t).every(e=>Gc(Wp,e)),Jp=()=>{var e,r;if(typeof Deno!="undefined"&&Deno.build!=null)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Mt,"X-Stainless-OS":jc(Deno.build.os),"X-Stainless-Arch":Hc(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:(r=(e=Deno.version)==null?void 0:e.deno)!=null?r:"unknown"};if(typeof EdgeRuntime!="undefined")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Mt,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":process.version};if(Object.prototype.toString.call(typeof process!="undefined"?process:0)==="[object process]")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Mt,"X-Stainless-OS":jc(process.platform),"X-Stainless-Arch":Hc(process.arch),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":process.version};let t=$p();return t?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Mt,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${t.browser}`,"X-Stainless-Runtime-Version":t.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Mt,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function $p(){if(typeof navigator=="undefined"||!navigator)return null;let t=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(let{key:e,pattern:r}of t){let n=r.exec(navigator.userAgent);if(n){let s=n[1]||0,o=n[2]||0,i=n[3]||0;return{browser:e,version:`${s}.${o}.${i}`}}}return null}var Hc=t=>t==="x32"?"x32":t==="x86_64"||t==="x64"?"x64":t==="arm"?"arm":t==="aarch64"||t==="arm64"?"arm64":t?`other:${t}`:"unknown",jc=t=>(t=t.toLowerCase(),t.includes("ios")?"iOS":t==="android"?"Android":t==="darwin"?"MacOS":t==="win32"?"Windows":t==="freebsd"?"FreeBSD":t==="openbsd"?"OpenBSD":t==="linux"?"Linux":t?`Other:${t}`:"Unknown"),qs,Gp=()=>qs!=null?qs:qs=Jp(),zp=t=>{try{return JSON.parse(t)}catch(e){return}},Xp=/^[a-z][a-z0-9+.-]*:/i,Yp=t=>Xp.test(t),Ze=t=>new Promise(e=>setTimeout(e,t)),Gi=(t,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new A(`${t} must be an integer`);if(e<0)throw new A(`${t} must be a positive integer`);return e},Ds=t=>{if(t instanceof Error)return t;if(typeof t=="object"&&t!==null)try{return new Error(JSON.stringify(t))}catch(e){}return new Error(t)};var gt=t=>{var e,r,n,s,o,i;if(typeof process!="undefined")return(n=(r=(e=process.env)==null?void 0:e[t])==null?void 0:r.trim())!=null?n:void 0;if(typeof Deno!="undefined")return(i=(o=(s=Deno.env)==null?void 0:s.get)==null?void 0:o.call(s,t))==null?void 0:i.trim()};function $c(t){if(!t)return!0;for(let e in t)return!1;return!0}function Gc(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Kc(t,e){for(let r in e){if(!Gc(e,r))continue;let n=r.toLowerCase();if(!n)continue;let s=e[r];s===null?delete t[n]:s!==void 0&&(t[n]=s)}}var Vc=new Set(["authorization","api-key"]);function Sr(t,...e){var r;if(typeof process!="undefined"&&((r=process==null?void 0:process.env)==null?void 0:r.DEBUG)==="true"){let n=e.map(s=>{if(!s)return s;if(s.headers){let i={...s,headers:{...s.headers}};for(let a in s.headers)Vc.has(a.toLowerCase())&&(i.headers[a]="REDACTED");return i}let o=null;for(let i in s)Vc.has(i.toLowerCase())&&(o!=null||(o={...s}),o[i]="REDACTED");return o!=null?o:s});console.log(`OpenAI:DEBUG:${t}`,...n)}}var Qp=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,t=>{let e=Math.random()*16|0;return(t==="x"?e:e&3|8).toString(16)}),zc=()=>typeof window!="undefined"&&typeof window.document!="undefined"&&typeof navigator!="undefined",Zp=t=>typeof(t==null?void 0:t.get)=="function";var Us=(t,e)=>{var n;let r=e.toLowerCase();if(Zp(t)){let s=((n=e[0])==null?void 0:n.toUpperCase())+e.substring(1).replace(/([^\w])(\w)/g,(o,i,a)=>i+a.toUpperCase());for(let o of[e,r,e.toUpperCase(),s]){let i=t.get(o);if(i)return i}}for(let[s,o]of Object.entries(t))if(s.toLowerCase()===r)return Array.isArray(o)?(o.length<=1||console.warn(`Received ${o.length} entries for the ${e} header, using the first entry.`),o[0]):o};function vr(t){return t!=null&&typeof t=="object"&&!Array.isArray(t)}var js=class extends Nn{constructor(e,r,n,s){super(e,r,n,s),this.data=n.data||[],this.object=n.object}getPaginatedItems(){var e;return(e=this.data)!=null?e:[]}nextPageParams(){return null}nextPageInfo(){return null}},H=class extends Nn{constructor(e,r,n,s){super(e,r,n,s),this.data=n.data||[],this.has_more=n.has_more||!1}getPaginatedItems(){var e;return(e=this.data)!=null?e:[]}hasNextPage(){return this.has_more===!1?!1:super.hasNextPage()}nextPageParams(){let e=this.nextPageInfo();if(!e)return null;if("params"in e)return e.params;let r=Object.fromEntries(e.url.searchParams);return Object.keys(r).length?r:null}nextPageInfo(){var n;let e=this.getPaginatedItems();if(!e.length)return null;let r=(n=e[e.length-1])==null?void 0:n.id;return r?{params:{after:r}}:null}};var S=class{constructor(e){this._client=e}};var Cr=class extends S{list(e,r={},n){return q(r)?this.list(e,{},r):this._client.getAPIList(`/chat/completions/${e}/messages`,Ks,{query:r,...n})}};var yt=class extends S{constructor(){super(...arguments),this.messages=new Cr(this._client)}create(e,r){var n;return this._client.post("/chat/completions",{body:e,...r,stream:(n=e.stream)!=null?n:!1})}retrieve(e,r){return this._client.get(`/chat/completions/${e}`,r)}update(e,r,n){return this._client.post(`/chat/completions/${e}`,{body:r,...n})}list(e={},r){return q(e)?this.list({},e):this._client.getAPIList("/chat/completions",wt,{query:e,...r})}del(e,r){return this._client.delete(`/chat/completions/${e}`,r)}},wt=class extends H{},Ks=class extends H{};yt.ChatCompletionsPage=wt;yt.Messages=Cr;var et=class extends S{constructor(){super(...arguments),this.completions=new yt(this._client)}};et.Completions=yt;et.ChatCompletionsPage=wt;var xr=class extends S{create(e,r){return this._client.post("/audio/speech",{body:e,...r,headers:{Accept:"application/octet-stream",...r==null?void 0:r.headers},__binaryResponse:!0})}};var Ar=class extends S{create(e,r){return this._client.post("/audio/transcriptions",ve({body:e,...r,__metadata:{model:e.model}}))}};var Rr=class extends S{create(e,r){return this._client.post("/audio/translations",ve({body:e,...r,__metadata:{model:e.model}}))}};var qe=class extends S{constructor(){super(...arguments),this.transcriptions=new Ar(this._client),this.translations=new Rr(this._client),this.speech=new xr(this._client)}};qe.Transcriptions=Ar;qe.Translations=Rr;qe.Speech=xr;var _t=class extends S{create(e,r){return this._client.post("/batches",{body:e,...r})}retrieve(e,r){return this._client.get(`/batches/${e}`,r)}list(e={},r){return q(e)?this.list({},e):this._client.getAPIList("/batches",Ut,{query:e,...r})}cancel(e,r){return this._client.post(`/batches/${e}/cancel`,r)}},Ut=class extends H{};_t.BatchesPage=Ut;var Ht=class extends S{create(e,r){return this._client.post("/assistants",{body:e,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}retrieve(e,r){return this._client.get(`/assistants/${e}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}update(e,r,n){return this._client.post(`/assistants/${e}`,{body:r,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}list(e={},r){return q(e)?this.list({},e):this._client.getAPIList("/assistants",Pr,{query:e,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}del(e,r){return this._client.delete(`/assistants/${e}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}},Pr=class extends H{};Ht.AssistantsPage=Pr;function Xi(t){return typeof t.parse=="function"}var bt=t=>(t==null?void 0:t.role)==="assistant",Yi=t=>(t==null?void 0:t.role)==="function",Qi=t=>(t==null?void 0:t.role)==="tool";var Te=function(t,e,r,n,s){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?s.call(t,r):s?s.value=r:e.set(t,r),r},K=function(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)},Zi,Vs,Ws,Ln,Mn,Js,Dn,tt,Bn,$s,Gs,Or,Xc,Tr=class{constructor(){Zi.add(this),this.controller=new AbortController,Vs.set(this,void 0),Ws.set(this,()=>{}),Ln.set(this,()=>{}),Mn.set(this,void 0),Js.set(this,()=>{}),Dn.set(this,()=>{}),tt.set(this,{}),Bn.set(this,!1),$s.set(this,!1),Gs.set(this,!1),Or.set(this,!1),Te(this,Vs,new Promise((e,r)=>{Te(this,Ws,e,"f"),Te(this,Ln,r,"f")}),"f"),Te(this,Mn,new Promise((e,r)=>{Te(this,Js,e,"f"),Te(this,Dn,r,"f")}),"f"),K(this,Vs,"f").catch(()=>{}),K(this,Mn,"f").catch(()=>{})}_run(e){setTimeout(()=>{e().then(()=>{this._emitFinal(),this._emit("end")},K(this,Zi,"m",Xc).bind(this))},0)}_connected(){this.ended||(K(this,Ws,"f").call(this),this._emit("connect"))}get ended(){return K(this,Bn,"f")}get errored(){return K(this,$s,"f")}get aborted(){return K(this,Gs,"f")}abort(){this.controller.abort()}on(e,r){return(K(this,tt,"f")[e]||(K(this,tt,"f")[e]=[])).push({listener:r}),this}off(e,r){let n=K(this,tt,"f")[e];if(!n)return this;let s=n.findIndex(o=>o.listener===r);return s>=0&&n.splice(s,1),this}once(e,r){return(K(this,tt,"f")[e]||(K(this,tt,"f")[e]=[])).push({listener:r,once:!0}),this}emitted(e){return new Promise((r,n)=>{Te(this,Or,!0,"f"),e!=="error"&&this.once("error",n),this.once(e,r)})}async done(){Te(this,Or,!0,"f"),await K(this,Mn,"f")}_emit(e,...r){if(K(this,Bn,"f"))return;e==="end"&&(Te(this,Bn,!0,"f"),K(this,Js,"f").call(this));let n=K(this,tt,"f")[e];if(n&&(K(this,tt,"f")[e]=n.filter(s=>!s.once),n.forEach(({listener:s})=>s(...r))),e==="abort"){let s=r[0];!K(this,Or,"f")&&!(n!=null&&n.length)&&Promise.reject(s),K(this,Ln,"f").call(this,s),K(this,Dn,"f").call(this,s),this._emit("end");return}if(e==="error"){let s=r[0];!K(this,Or,"f")&&!(n!=null&&n.length)&&Promise.reject(s),K(this,Ln,"f").call(this,s),K(this,Dn,"f").call(this,s),this._emit("end")}}_emitFinal(){}};Vs=new WeakMap,Ws=new WeakMap,Ln=new WeakMap,Mn=new WeakMap,Js=new WeakMap,Dn=new WeakMap,tt=new WeakMap,Bn=new WeakMap,$s=new WeakMap,Gs=new WeakMap,Or=new WeakMap,Zi=new WeakSet,Xc=function(e){if(Te(this,$s,!0,"f"),e instanceof Error&&e.name==="AbortError"&&(e=new Q),e instanceof Q)return Te(this,Gs,!0,"f"),this._emit("abort",e);if(e instanceof A)return this._emit("error",e);if(e instanceof Error){let r=new A(e.message);return r.cause=e,this._emit("error",r)}return this._emit("error",new A(String(e)))};function ea(t){return(t==null?void 0:t.$brand)==="auto-parseable-response-format"}function jt(t){return(t==null?void 0:t.$brand)==="auto-parseable-tool"}function Yc(t,e){return!e||!ta(e)?{...t,choices:t.choices.map(r=>{var n;return{...r,message:{...r.message,parsed:null,tool_calls:(n=r.message.tool_calls)!=null?n:[]}}})}:Fn(t,e)}function Fn(t,e){let r=t.choices.map(n=>{var s,o;if(n.finish_reason==="length")throw new _r;if(n.finish_reason==="content_filter")throw new br;return{...n,message:{...n.message,tool_calls:(o=(s=n.message.tool_calls)==null?void 0:s.map(i=>am(e,i)))!=null?o:[],parsed:n.message.content&&!n.message.refusal?im(e,n.message.content):null}}});return{...t,choices:r}}function im(t,e){var r,n;return((r=t.response_format)==null?void 0:r.type)!=="json_schema"?null:((n=t.response_format)==null?void 0:n.type)==="json_schema"?"$parseRaw"in t.response_format?t.response_format.$parseRaw(e):JSON.parse(e):null}function am(t,e){var n;let r=(n=t.tools)==null?void 0:n.find(s=>{var o;return((o=s.function)==null?void 0:o.name)===e.function.name});return{...e,function:{...e.function,parsed_arguments:jt(r)?r.$parseRaw(e.function.arguments):r!=null&&r.function.strict?JSON.parse(e.function.arguments):null}}}function Qc(t,e){var n;if(!t)return!1;let r=(n=t.tools)==null?void 0:n.find(s=>{var o;return((o=s.function)==null?void 0:o.name)===e.function.name});return jt(r)||(r==null?void 0:r.function.strict)||!1}function ta(t){var e,r;return ea(t.response_format)?!0:(r=(e=t.tools)==null?void 0:e.some(n=>jt(n)||n.type==="function"&&n.function.strict===!0))!=null?r:!1}function Zc(t){for(let e of t!=null?t:[]){if(e.type!=="function")throw new A(`Currently only \`function\` tool types support auto-parsing; Received \`${e.type}\``);if(e.function.strict!==!0)throw new A(`The \`${e.function.name}\` tool is not marked with \`strict: true\`. Only strict function tools can be auto-parsed`)}}var pe=function(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)},oe,ra,zs,na,sa,oa,tu,ia,eu=10,Ir=class extends Tr{constructor(){super(...arguments),oe.add(this),this._chatCompletions=[],this.messages=[]}_addChatCompletion(e){var n;this._chatCompletions.push(e),this._emit("chatCompletion",e);let r=(n=e.choices[0])==null?void 0:n.message;return r&&this._addMessage(r),e}_addMessage(e,r=!0){if("content"in e||(e.content=null),this.messages.push(e),r){if(this._emit("message",e),(Yi(e)||Qi(e))&&e.content)this._emit("functionCallResult",e.content);else if(bt(e)&&e.function_call)this._emit("functionCall",e.function_call);else if(bt(e)&&e.tool_calls)for(let n of e.tool_calls)n.type==="function"&&this._emit("functionCall",n.function)}}async finalChatCompletion(){await this.done();let e=this._chatCompletions[this._chatCompletions.length-1];if(!e)throw new A("stream ended without producing a ChatCompletion");return e}async finalContent(){return await this.done(),pe(this,oe,"m",ra).call(this)}async finalMessage(){return await this.done(),pe(this,oe,"m",zs).call(this)}async finalFunctionCall(){return await this.done(),pe(this,oe,"m",na).call(this)}async finalFunctionCallResult(){return await this.done(),pe(this,oe,"m",sa).call(this)}async totalUsage(){return await this.done(),pe(this,oe,"m",oa).call(this)}allChatCompletions(){return[...this._chatCompletions]}_emitFinal(){let e=this._chatCompletions[this._chatCompletions.length-1];e&&this._emit("finalChatCompletion",e);let r=pe(this,oe,"m",zs).call(this);r&&this._emit("finalMessage",r);let n=pe(this,oe,"m",ra).call(this);n&&this._emit("finalContent",n);let s=pe(this,oe,"m",na).call(this);s&&this._emit("finalFunctionCall",s);let o=pe(this,oe,"m",sa).call(this);o!=null&&this._emit("finalFunctionCallResult",o),this._chatCompletions.some(i=>i.usage)&&this._emit("totalUsage",pe(this,oe,"m",oa).call(this))}async _createChatCompletion(e,r,n){let s=n==null?void 0:n.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),pe(this,oe,"m",tu).call(this,r);let o=await e.chat.completions.create({...r,stream:!1},{...n,signal:this.controller.signal});return this._connected(),this._addChatCompletion(Fn(o,r))}async _runChatCompletion(e,r,n){for(let s of r.messages)this._addMessage(s,!1);return await this._createChatCompletion(e,r,n)}async _runFunctions(e,r,n){var d;let s="function",{function_call:o="auto",stream:i,...a}=r,l=typeof o!="string"&&(o==null?void 0:o.name),{maxChatCompletions:c=eu}=n||{},f={};for(let h of r.functions)f[h.name||h.function.name]=h;let u=r.functions.map(h=>({name:h.name||h.function.name,parameters:h.parameters,description:h.description}));for(let h of r.messages)this._addMessage(h,!1);for(let h=0;h<c;++h){let g=(d=(await this._createChatCompletion(e,{...a,function_call:o,functions:u,messages:[...this.messages]},n)).choices[0])==null?void 0:d.message;if(!g)throw new A("missing message in ChatCompletion response");if(!g.function_call)return;let{name:w,arguments:b}=g.function_call,_=f[w];if(_){if(l&&l!==w){let T=`Invalid function_call: ${JSON.stringify(w)}. ${JSON.stringify(l)} requested. Please try again`;this._addMessage({role:s,name:w,content:T});continue}}else{let T=`Invalid function_call: ${JSON.stringify(w)}. Available options are: ${u.map(P=>JSON.stringify(P.name)).join(", ")}. Please try again`;this._addMessage({role:s,name:w,content:T});continue}let C;try{C=Xi(_)?await _.parse(b):b}catch(T){this._addMessage({role:s,name:w,content:T instanceof Error?T.message:String(T)});continue}let R=await _.function(C,this),E=pe(this,oe,"m",ia).call(this,R);if(this._addMessage({role:s,name:w,content:E}),l)return}}async _runTools(e,r,n){var h,p,g;let s="tool",{tool_choice:o="auto",stream:i,...a}=r,l=typeof o!="string"&&((h=o==null?void 0:o.function)==null?void 0:h.name),{maxChatCompletions:c=eu}=n||{},f=r.tools.map(w=>{if(jt(w)){if(!w.$callback)throw new A("Tool given to `.runTools()` that does not have an associated function");return{type:"function",function:{function:w.$callback,name:w.function.name,description:w.function.description||"",parameters:w.function.parameters,parse:w.$parseRaw,strict:!0}}}return w}),u={};for(let w of f)w.type==="function"&&(u[w.function.name||w.function.function.name]=w.function);let d="tools"in r?f.map(w=>w.type==="function"?{type:"function",function:{name:w.function.name||w.function.function.name,parameters:w.function.parameters,description:w.function.description,strict:w.function.strict}}:w):void 0;for(let w of r.messages)this._addMessage(w,!1);for(let w=0;w<c;++w){let _=(p=(await this._createChatCompletion(e,{...a,tool_choice:o,tools:d,messages:[...this.messages]},n)).choices[0])==null?void 0:p.message;if(!_)throw new A("missing message in ChatCompletion response");if(!((g=_.tool_calls)!=null&&g.length))return;for(let C of _.tool_calls){if(C.type!=="function")continue;let R=C.id,{name:E,arguments:T}=C.function,P=u[E];if(P){if(l&&l!==E){let F=`Invalid tool_call: ${JSON.stringify(E)}. ${JSON.stringify(l)} requested. Please try again`;this._addMessage({role:s,tool_call_id:R,content:F});continue}}else{let F=`Invalid tool_call: ${JSON.stringify(E)}. Available options are: ${Object.keys(u).map(N=>JSON.stringify(N)).join(", ")}. Please try again`;this._addMessage({role:s,tool_call_id:R,content:F});continue}let B;try{B=Xi(P)?await P.parse(T):T}catch(F){let N=F instanceof Error?F.message:String(F);this._addMessage({role:s,tool_call_id:R,content:N});continue}let k=await P.function(B,this),M=pe(this,oe,"m",ia).call(this,k);if(this._addMessage({role:s,tool_call_id:R,content:M}),l)return}}}};oe=new WeakSet,ra=function(){var e;return(e=pe(this,oe,"m",zs).call(this).content)!=null?e:null},zs=function(){var r,n;let e=this.messages.length;for(;e-- >0;){let s=this.messages[e];if(bt(s)){let{function_call:o,...i}=s,a={...i,content:(r=s.content)!=null?r:null,refusal:(n=s.refusal)!=null?n:null};return o&&(a.function_call=o),a}}throw new A("stream ended without producing a ChatCompletionMessage with role=assistant")},na=function(){var e,r;for(let n=this.messages.length-1;n>=0;n--){let s=this.messages[n];if(bt(s)&&(s!=null&&s.function_call))return s.function_call;if(bt(s)&&((e=s==null?void 0:s.tool_calls)!=null&&e.length))return(r=s.tool_calls.at(-1))==null?void 0:r.function}},sa=function(){for(let e=this.messages.length-1;e>=0;e--){let r=this.messages[e];if(Yi(r)&&r.content!=null||Qi(r)&&r.content!=null&&typeof r.content=="string"&&this.messages.some(n=>{var s;return n.role==="assistant"&&((s=n.tool_calls)==null?void 0:s.some(o=>o.type==="function"&&o.id===r.tool_call_id))}))return r.content}},oa=function(){let e={completion_tokens:0,prompt_tokens:0,total_tokens:0};for(let{usage:r}of this._chatCompletions)r&&(e.completion_tokens+=r.completion_tokens,e.prompt_tokens+=r.prompt_tokens,e.total_tokens+=r.total_tokens);return e},tu=function(e){if(e.n!=null&&e.n>1)throw new A("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.")},ia=function(e){return typeof e=="string"?e:e===void 0?"undefined":JSON.stringify(e)};var St=class extends Ir{static runFunctions(e,r,n){let s=new St,o={...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"runFunctions"}};return s._run(()=>s._runFunctions(e,r,o)),s}static runTools(e,r,n){let s=new St,o={...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"runTools"}};return s._run(()=>s._runTools(e,r,o)),s}_addMessage(e,r=!0){super._addMessage(e,r),bt(e)&&e.content&&this._emit("content",e.content)}};var Z={STR:1,NUM:2,ARR:4,OBJ:8,NULL:16,BOOL:32,NAN:64,INFINITY:128,MINUS_INFINITY:256,INF:384,SPECIAL:496,ATOM:499,COLLECTION:12,ALL:511},aa=class extends Error{},la=class extends Error{};function lm(t,e=Z.ALL){if(typeof t!="string")throw new TypeError(`expecting str, got ${typeof t}`);if(!t.trim())throw new Error(`${t} is empty`);return cm(t.trim(),e)}var cm=(t,e)=>{let r=t.length,n=0,s=d=>{throw new aa(`${d} at position ${n}`)},o=d=>{throw new la(`${d} at position ${n}`)},i=()=>(u(),n>=r&&s("Unexpected end of input"),t[n]==='"'?a():t[n]==="{"?l():t[n]==="["?c():t.substring(n,n+4)==="null"||Z.NULL&e&&r-n<4&&"null".startsWith(t.substring(n))?(n+=4,null):t.substring(n,n+4)==="true"||Z.BOOL&e&&r-n<4&&"true".startsWith(t.substring(n))?(n+=4,!0):t.substring(n,n+5)==="false"||Z.BOOL&e&&r-n<5&&"false".startsWith(t.substring(n))?(n+=5,!1):t.substring(n,n+8)==="Infinity"||Z.INFINITY&e&&r-n<8&&"Infinity".startsWith(t.substring(n))?(n+=8,1/0):t.substring(n,n+9)==="-Infinity"||Z.MINUS_INFINITY&e&&1<r-n&&r-n<9&&"-Infinity".startsWith(t.substring(n))?(n+=9,-1/0):t.substring(n,n+3)==="NaN"||Z.NAN&e&&r-n<3&&"NaN".startsWith(t.substring(n))?(n+=3,NaN):f()),a=()=>{let d=n,h=!1;for(n++;n<r&&(t[n]!=='"'||h&&t[n-1]==="\\");)h=t[n]==="\\"?!h:!1,n++;if(t.charAt(n)=='"')try{return JSON.parse(t.substring(d,++n-Number(h)))}catch(p){o(String(p))}else if(Z.STR&e)try{return JSON.parse(t.substring(d,n-Number(h))+'"')}catch(p){return JSON.parse(t.substring(d,t.lastIndexOf("\\"))+'"')}s("Unterminated string literal")},l=()=>{n++,u();let d={};try{for(;t[n]!=="}";){if(u(),n>=r&&Z.OBJ&e)return d;let h=a();u(),n++;try{let p=i();Object.defineProperty(d,h,{value:p,writable:!0,enumerable:!0,configurable:!0})}catch(p){if(Z.OBJ&e)return d;throw p}u(),t[n]===","&&n++}}catch(h){if(Z.OBJ&e)return d;s("Expected '}' at end of object")}return n++,d},c=()=>{n++;let d=[];try{for(;t[n]!=="]";)d.push(i()),u(),t[n]===","&&n++}catch(h){if(Z.ARR&e)return d;s("Expected ']' at end of array")}return n++,d},f=()=>{if(n===0){t==="-"&&Z.NUM&e&&s("Not sure what '-' is");try{return JSON.parse(t)}catch(h){if(Z.NUM&e)try{return t[t.length-1]==="."?JSON.parse(t.substring(0,t.lastIndexOf("."))):JSON.parse(t.substring(0,t.lastIndexOf("e")))}catch(p){}o(String(h))}}let d=n;for(t[n]==="-"&&n++;t[n]&&!",]}".includes(t[n]);)n++;n==r&&!(Z.NUM&e)&&s("Unterminated number literal");try{return JSON.parse(t.substring(d,n))}catch(h){t.substring(d,n)==="-"&&Z.NUM&e&&s("Not sure what '-' is");try{return JSON.parse(t.substring(d,t.lastIndexOf("e")))}catch(p){o(String(p))}}},u=()=>{for(;n<r&&` 
\r	`.includes(t[n]);)n++};return i()},ca=t=>lm(t,Z.ALL^Z.NUM);var kr=function(t,e,r,n,s){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?s.call(t,r):s?s.value=r:e.set(t,r),r},U=function(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)},z,rt,Nr,Et,ua,Xs,fa,da,ha,Ys,pa,ru,nt=class extends Ir{constructor(e){super(),z.add(this),rt.set(this,void 0),Nr.set(this,void 0),Et.set(this,void 0),kr(this,rt,e,"f"),kr(this,Nr,[],"f")}get currentChatCompletionSnapshot(){return U(this,Et,"f")}static fromReadableStream(e){let r=new nt(null);return r._run(()=>r._fromReadableStream(e)),r}static createChatCompletion(e,r,n){let s=new nt(r);return s._run(()=>s._runChatCompletion(e,{...r,stream:!0},{...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"stream"}})),s}async _createChatCompletion(e,r,n){var i;super._createChatCompletion;let s=n==null?void 0:n.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),U(this,z,"m",ua).call(this);let o=await e.chat.completions.create({...r,stream:!0},{...n,signal:this.controller.signal});this._connected();for await(let a of o)U(this,z,"m",fa).call(this,a);if((i=o.controller.signal)!=null&&i.aborted)throw new Q;return this._addChatCompletion(U(this,z,"m",Ys).call(this))}async _fromReadableStream(e,r){var i;let n=r==null?void 0:r.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",()=>this.controller.abort())),U(this,z,"m",ua).call(this),this._connected();let s=ce.fromReadableStream(e,this.controller),o;for await(let a of s)o&&o!==a.id&&this._addChatCompletion(U(this,z,"m",Ys).call(this)),U(this,z,"m",fa).call(this,a),o=a.id;if((i=s.controller.signal)!=null&&i.aborted)throw new Q;return this._addChatCompletion(U(this,z,"m",Ys).call(this))}[(rt=new WeakMap,Nr=new WeakMap,Et=new WeakMap,z=new WeakSet,ua=function(){this.ended||kr(this,Et,void 0,"f")},Xs=function(r){let n=U(this,Nr,"f")[r.index];return n||(n={content_done:!1,refusal_done:!1,logprobs_content_done:!1,logprobs_refusal_done:!1,done_tool_calls:new Set,current_tool_call_index:null},U(this,Nr,"f")[r.index]=n,n)},fa=function(r){var s,o,i,a,l,c,f,u,d,h,p,g,w,b,_,C,R,E,T,P;if(this.ended)return;let n=U(this,z,"m",ru).call(this,r);this._emit("chunk",r,n);for(let B of r.choices){let k=n.choices[B.index];B.delta.content!=null&&((s=k.message)==null?void 0:s.role)==="assistant"&&((o=k.message)!=null&&o.content)&&(this._emit("content",B.delta.content,k.message.content),this._emit("content.delta",{delta:B.delta.content,snapshot:k.message.content,parsed:k.message.parsed})),B.delta.refusal!=null&&((i=k.message)==null?void 0:i.role)==="assistant"&&((a=k.message)!=null&&a.refusal)&&this._emit("refusal.delta",{delta:B.delta.refusal,snapshot:k.message.refusal}),((l=B.logprobs)==null?void 0:l.content)!=null&&((c=k.message)==null?void 0:c.role)==="assistant"&&this._emit("logprobs.content.delta",{content:(f=B.logprobs)==null?void 0:f.content,snapshot:(d=(u=k.logprobs)==null?void 0:u.content)!=null?d:[]}),((h=B.logprobs)==null?void 0:h.refusal)!=null&&((p=k.message)==null?void 0:p.role)==="assistant"&&this._emit("logprobs.refusal.delta",{refusal:(g=B.logprobs)==null?void 0:g.refusal,snapshot:(b=(w=k.logprobs)==null?void 0:w.refusal)!=null?b:[]});let M=U(this,z,"m",Xs).call(this,k);k.finish_reason&&(U(this,z,"m",ha).call(this,k),M.current_tool_call_index!=null&&U(this,z,"m",da).call(this,k,M.current_tool_call_index));for(let F of(_=B.delta.tool_calls)!=null?_:[])M.current_tool_call_index!==F.index&&(U(this,z,"m",ha).call(this,k),M.current_tool_call_index!=null&&U(this,z,"m",da).call(this,k,M.current_tool_call_index)),M.current_tool_call_index=F.index;for(let F of(C=B.delta.tool_calls)!=null?C:[]){let N=(R=k.message.tool_calls)==null?void 0:R[F.index];N!=null&&N.type&&((N==null?void 0:N.type)==="function"?this._emit("tool_calls.function.arguments.delta",{name:(E=N.function)==null?void 0:E.name,index:F.index,arguments:N.function.arguments,parsed_arguments:N.function.parsed_arguments,arguments_delta:(P=(T=F.function)==null?void 0:T.arguments)!=null?P:""}):(N==null||N.type,void 0))}}},da=function(r,n){var i,a,l;if(U(this,z,"m",Xs).call(this,r).done_tool_calls.has(n))return;let o=(i=r.message.tool_calls)==null?void 0:i[n];if(!o)throw new Error("no tool call snapshot");if(!o.type)throw new Error("tool call snapshot missing `type`");if(o.type==="function"){let c=(l=(a=U(this,rt,"f"))==null?void 0:a.tools)==null?void 0:l.find(f=>f.type==="function"&&f.function.name===o.function.name);this._emit("tool_calls.function.arguments.done",{name:o.function.name,index:n,arguments:o.function.arguments,parsed_arguments:jt(c)?c.$parseRaw(o.function.arguments):c!=null&&c.function.strict?JSON.parse(o.function.arguments):null})}else o.type},ha=function(r){var s,o;let n=U(this,z,"m",Xs).call(this,r);if(r.message.content&&!n.content_done){n.content_done=!0;let i=U(this,z,"m",pa).call(this);this._emit("content.done",{content:r.message.content,parsed:i?i.$parseRaw(r.message.content):null})}r.message.refusal&&!n.refusal_done&&(n.refusal_done=!0,this._emit("refusal.done",{refusal:r.message.refusal})),(s=r.logprobs)!=null&&s.content&&!n.logprobs_content_done&&(n.logprobs_content_done=!0,this._emit("logprobs.content.done",{content:r.logprobs.content})),(o=r.logprobs)!=null&&o.refusal&&!n.logprobs_refusal_done&&(n.logprobs_refusal_done=!0,this._emit("logprobs.refusal.done",{refusal:r.logprobs.refusal}))},Ys=function(){if(this.ended)throw new A("stream has ended, this shouldn't happen");let r=U(this,Et,"f");if(!r)throw new A("request ended without sending any chunks");return kr(this,Et,void 0,"f"),kr(this,Nr,[],"f"),um(r,U(this,rt,"f"))},pa=function(){var n;let r=(n=U(this,rt,"f"))==null?void 0:n.response_format;return ea(r)?r:null},ru=function(r){var f,u,d,h,p,g;var n,s,o,i;let a=U(this,Et,"f"),{choices:l,...c}=r;a?Object.assign(a,c):a=kr(this,Et,{...c,choices:[]},"f");for(let{delta:w,finish_reason:b,index:_,logprobs:C=null,...R}of r.choices){let E=a.choices[_];if(E||(E=a.choices[_]={finish_reason:b,index:_,message:{},logprobs:C,...R}),C)if(!E.logprobs)E.logprobs=Object.assign({},C);else{let{content:N,refusal:le,...he}=C;Object.assign(E.logprobs,he),N&&((f=(n=E.logprobs).content)!=null||(n.content=[]),E.logprobs.content.push(...N)),le&&((u=(s=E.logprobs).refusal)!=null||(s.refusal=[]),E.logprobs.refusal.push(...le))}if(b&&(E.finish_reason=b,U(this,rt,"f")&&ta(U(this,rt,"f")))){if(b==="length")throw new _r;if(b==="content_filter")throw new br}if(Object.assign(E,R),!w)continue;let{content:T,refusal:P,function_call:B,role:k,tool_calls:M,...F}=w;if(Object.assign(E.message,F),P&&(E.message.refusal=(E.message.refusal||"")+P),k&&(E.message.role=k),B&&(E.message.function_call?(B.name&&(E.message.function_call.name=B.name),B.arguments&&((d=(o=E.message.function_call).arguments)!=null||(o.arguments=""),E.message.function_call.arguments+=B.arguments)):E.message.function_call=B),T&&(E.message.content=(E.message.content||"")+T,!E.message.refusal&&U(this,z,"m",pa).call(this)&&(E.message.parsed=ca(E.message.content))),M){E.message.tool_calls||(E.message.tool_calls=[]);for(let{index:N,id:le,type:he,function:ee,...Ee}of M){let De=(h=(i=E.message.tool_calls)[N])!=null?h:i[N]={};Object.assign(De,Ee),le&&(De.id=le),he&&(De.type=he),ee&&((g=De.function)!=null||(De.function={name:(p=ee.name)!=null?p:"",arguments:""})),ee!=null&&ee.name&&(De.function.name=ee.name),ee!=null&&ee.arguments&&(De.function.arguments+=ee.arguments,Qc(U(this,rt,"f"),De)&&(De.function.parsed_arguments=ca(De.function.arguments)))}}}return a},Symbol.asyncIterator)](){let e=[],r=[],n=!1;return this.on("chunk",s=>{let o=r.shift();o?o.resolve(s):e.push(s)}),this.on("end",()=>{n=!0;for(let s of r)s.resolve(void 0);r.length=0}),this.on("abort",s=>{n=!0;for(let o of r)o.reject(s);r.length=0}),this.on("error",s=>{n=!0;for(let o of r)o.reject(s);r.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:n?{value:void 0,done:!0}:new Promise((o,i)=>r.push({resolve:o,reject:i})).then(o=>o?{value:o,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new ce(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}};function um(t,e){let{id:r,choices:n,created:s,model:o,system_fingerprint:i,...a}=t,l={...a,id:r,choices:n.map(({message:c,finish_reason:f,index:u,logprobs:d,...h})=>{var C,R,E;if(!f)throw new A(`missing finish_reason for choice ${u}`);let{content:p=null,function_call:g,tool_calls:w,...b}=c,_=c.role;if(!_)throw new A(`missing role for choice ${u}`);if(g){let{arguments:T,name:P}=g;if(T==null)throw new A(`missing function_call.arguments for choice ${u}`);if(!P)throw new A(`missing function_call.name for choice ${u}`);return{...h,message:{content:p,function_call:{arguments:T,name:P},role:_,refusal:(C=c.refusal)!=null?C:null},finish_reason:f,index:u,logprobs:d}}return w?{...h,index:u,finish_reason:f,logprobs:d,message:{...b,role:_,content:p,refusal:(R=c.refusal)!=null?R:null,tool_calls:w.map((T,P)=>{let{function:B,type:k,id:M,...F}=T,{arguments:N,name:le,...he}=B||{};if(M==null)throw new A(`missing choices[${u}].tool_calls[${P}].id
${Qs(t)}`);if(k==null)throw new A(`missing choices[${u}].tool_calls[${P}].type
${Qs(t)}`);if(le==null)throw new A(`missing choices[${u}].tool_calls[${P}].function.name
${Qs(t)}`);if(N==null)throw new A(`missing choices[${u}].tool_calls[${P}].function.arguments
${Qs(t)}`);return{...F,id:M,type:k,function:{...he,name:le,arguments:N}}})}}:{...h,message:{...b,content:p,role:_,refusal:(E=c.refusal)!=null?E:null},finish_reason:f,index:u,logprobs:d}}),created:s,model:o,object:"chat.completion",...i?{system_fingerprint:i}:{}};return Yc(l,e)}function Qs(t){return JSON.stringify(t)}var st=class extends nt{static fromReadableStream(e){let r=new st(null);return r._run(()=>r._fromReadableStream(e)),r}static runFunctions(e,r,n){let s=new st(null),o={...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"runFunctions"}};return s._run(()=>s._runFunctions(e,r,o)),s}static runTools(e,r,n){let s=new st(r),o={...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"runTools"}};return s._run(()=>s._runTools(e,r,o)),s}};var qn=class extends S{parse(e,r){return Zc(e.tools),this._client.chat.completions.create(e,{...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"beta.chat.completions.parse"}})._thenUnwrap(n=>Fn(n,e))}runFunctions(e,r){return e.stream?st.runFunctions(this._client,e,r):St.runFunctions(this._client,e,r)}runTools(e,r){return e.stream?st.runTools(this._client,e,r):St.runTools(this._client,e,r)}stream(e,r){return nt.createChatCompletion(this._client,e,r)}};var Lr=class extends S{constructor(){super(...arguments),this.completions=new qn(this._client)}};(function(t){t.Completions=qn})(Lr||(Lr={}));var Mr=class extends S{create(e,r){return this._client.post("/realtime/sessions",{body:e,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}};var Kt=class extends S{constructor(){super(...arguments),this.sessions=new Mr(this._client)}};Kt.Sessions=Mr;var x=function(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)},ge=function(t,e,r,n,s){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?s.call(t,r):s?s.value=r:e.set(t,r),r},te,ma,Ue,Zs,Ie,Wt,Dr,Vt,ro,ye,eo,to,jn,Un,Hn,nu,su,ou,iu,au,lu,cu,ue=class extends Tr{constructor(){super(...arguments),te.add(this),ma.set(this,[]),Ue.set(this,{}),Zs.set(this,{}),Ie.set(this,void 0),Wt.set(this,void 0),Dr.set(this,void 0),Vt.set(this,void 0),ro.set(this,void 0),ye.set(this,void 0),eo.set(this,void 0),to.set(this,void 0),jn.set(this,void 0)}[(ma=new WeakMap,Ue=new WeakMap,Zs=new WeakMap,Ie=new WeakMap,Wt=new WeakMap,Dr=new WeakMap,Vt=new WeakMap,ro=new WeakMap,ye=new WeakMap,eo=new WeakMap,to=new WeakMap,jn=new WeakMap,te=new WeakSet,Symbol.asyncIterator)](){let e=[],r=[],n=!1;return this.on("event",s=>{let o=r.shift();o?o.resolve(s):e.push(s)}),this.on("end",()=>{n=!0;for(let s of r)s.resolve(void 0);r.length=0}),this.on("abort",s=>{n=!0;for(let o of r)o.reject(s);r.length=0}),this.on("error",s=>{n=!0;for(let o of r)o.reject(s);r.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:n?{value:void 0,done:!0}:new Promise((o,i)=>r.push({resolve:o,reject:i})).then(o=>o?{value:o,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}static fromReadableStream(e){let r=new ue;return r._run(()=>r._fromReadableStream(e)),r}async _fromReadableStream(e,r){var o;let n=r==null?void 0:r.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",()=>this.controller.abort())),this._connected();let s=ce.fromReadableStream(e,this.controller);for await(let i of s)x(this,te,"m",Un).call(this,i);if((o=s.controller.signal)!=null&&o.aborted)throw new Q;return this._addRun(x(this,te,"m",Hn).call(this))}toReadableStream(){return new ce(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}static createToolAssistantStream(e,r,n,s,o){let i=new ue;return i._run(()=>i._runToolAssistantStream(e,r,n,s,{...o,headers:{...o==null?void 0:o.headers,"X-Stainless-Helper-Method":"stream"}})),i}async _createToolAssistantStream(e,r,n,s,o){var c;let i=o==null?void 0:o.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort()));let a={...s,stream:!0},l=await e.submitToolOutputs(r,n,a,{...o,signal:this.controller.signal});this._connected();for await(let f of l)x(this,te,"m",Un).call(this,f);if((c=l.controller.signal)!=null&&c.aborted)throw new Q;return this._addRun(x(this,te,"m",Hn).call(this))}static createThreadAssistantStream(e,r,n){let s=new ue;return s._run(()=>s._threadAssistantStream(e,r,{...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"stream"}})),s}static createAssistantStream(e,r,n,s){let o=new ue;return o._run(()=>o._runAssistantStream(e,r,n,{...s,headers:{...s==null?void 0:s.headers,"X-Stainless-Helper-Method":"stream"}})),o}currentEvent(){return x(this,eo,"f")}currentRun(){return x(this,to,"f")}currentMessageSnapshot(){return x(this,Ie,"f")}currentRunStepSnapshot(){return x(this,jn,"f")}async finalRunSteps(){return await this.done(),Object.values(x(this,Ue,"f"))}async finalMessages(){return await this.done(),Object.values(x(this,Zs,"f"))}async finalRun(){if(await this.done(),!x(this,Wt,"f"))throw Error("Final run was not received.");return x(this,Wt,"f")}async _createThreadAssistantStream(e,r,n){var a;let s=n==null?void 0:n.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort()));let o={...r,stream:!0},i=await e.createAndRun(o,{...n,signal:this.controller.signal});this._connected();for await(let l of i)x(this,te,"m",Un).call(this,l);if((a=i.controller.signal)!=null&&a.aborted)throw new Q;return this._addRun(x(this,te,"m",Hn).call(this))}async _createAssistantStream(e,r,n,s){var l;let o=s==null?void 0:s.signal;o&&(o.aborted&&this.controller.abort(),o.addEventListener("abort",()=>this.controller.abort()));let i={...n,stream:!0},a=await e.create(r,i,{...s,signal:this.controller.signal});this._connected();for await(let c of a)x(this,te,"m",Un).call(this,c);if((l=a.controller.signal)!=null&&l.aborted)throw new Q;return this._addRun(x(this,te,"m",Hn).call(this))}static accumulateDelta(e,r){for(let[n,s]of Object.entries(r)){if(!e.hasOwnProperty(n)){e[n]=s;continue}let o=e[n];if(o==null){e[n]=s;continue}if(n==="index"||n==="type"){e[n]=s;continue}if(typeof o=="string"&&typeof s=="string")o+=s;else if(typeof o=="number"&&typeof s=="number")o+=s;else if(vr(o)&&vr(s))o=this.accumulateDelta(o,s);else if(Array.isArray(o)&&Array.isArray(s)){if(o.every(i=>typeof i=="string"||typeof i=="number")){o.push(...s);continue}for(let i of s){if(!vr(i))throw new Error(`Expected array delta entry to be an object but got: ${i}`);let a=i.index;if(a==null)throw console.error(i),new Error("Expected array delta entry to have an `index` property");if(typeof a!="number")throw new Error(`Expected array delta entry \`index\` property to be a number but got ${a}`);let l=o[a];l==null?o.push(i):o[a]=this.accumulateDelta(l,i)}continue}else throw Error(`Unhandled record type: ${n}, deltaValue: ${s}, accValue: ${o}`);e[n]=o}return e}_addRun(e){return e}async _threadAssistantStream(e,r,n){return await this._createThreadAssistantStream(r,e,n)}async _runAssistantStream(e,r,n,s){return await this._createAssistantStream(r,e,n,s)}async _runToolAssistantStream(e,r,n,s,o){return await this._createToolAssistantStream(n,e,r,s,o)}};Un=function(e){if(!this.ended)switch(ge(this,eo,e,"f"),x(this,te,"m",ou).call(this,e),e.event){case"thread.created":break;case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.requires_action":case"thread.run.completed":case"thread.run.incomplete":case"thread.run.failed":case"thread.run.cancelling":case"thread.run.cancelled":case"thread.run.expired":x(this,te,"m",cu).call(this,e);break;case"thread.run.step.created":case"thread.run.step.in_progress":case"thread.run.step.delta":case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":x(this,te,"m",su).call(this,e);break;case"thread.message.created":case"thread.message.in_progress":case"thread.message.delta":case"thread.message.completed":case"thread.message.incomplete":x(this,te,"m",nu).call(this,e);break;case"error":throw new Error("Encountered an error event in event processing - errors should be processed earlier");default:}},Hn=function(){if(this.ended)throw new A("stream has ended, this shouldn't happen");if(!x(this,Wt,"f"))throw Error("Final run has not been received");return x(this,Wt,"f")},nu=function(e){let[r,n]=x(this,te,"m",au).call(this,e,x(this,Ie,"f"));ge(this,Ie,r,"f"),x(this,Zs,"f")[r.id]=r;for(let s of n){let o=r.content[s.index];(o==null?void 0:o.type)=="text"&&this._emit("textCreated",o.text)}switch(e.event){case"thread.message.created":this._emit("messageCreated",e.data);break;case"thread.message.in_progress":break;case"thread.message.delta":if(this._emit("messageDelta",e.data.delta,r),e.data.delta.content)for(let s of e.data.delta.content){if(s.type=="text"&&s.text){let o=s.text,i=r.content[s.index];if(i&&i.type=="text")this._emit("textDelta",o,i.text);else throw Error("The snapshot associated with this text delta is not text or missing")}if(s.index!=x(this,Dr,"f")){if(x(this,Vt,"f"))switch(x(this,Vt,"f").type){case"text":this._emit("textDone",x(this,Vt,"f").text,x(this,Ie,"f"));break;case"image_file":this._emit("imageFileDone",x(this,Vt,"f").image_file,x(this,Ie,"f"));break}ge(this,Dr,s.index,"f")}ge(this,Vt,r.content[s.index],"f")}break;case"thread.message.completed":case"thread.message.incomplete":if(x(this,Dr,"f")!==void 0){let s=e.data.content[x(this,Dr,"f")];if(s)switch(s.type){case"image_file":this._emit("imageFileDone",s.image_file,x(this,Ie,"f"));break;case"text":this._emit("textDone",s.text,x(this,Ie,"f"));break}}x(this,Ie,"f")&&this._emit("messageDone",e.data),ge(this,Ie,void 0,"f")}},su=function(e){let r=x(this,te,"m",iu).call(this,e);switch(ge(this,jn,r,"f"),e.event){case"thread.run.step.created":this._emit("runStepCreated",e.data);break;case"thread.run.step.delta":let n=e.data.delta;if(n.step_details&&n.step_details.type=="tool_calls"&&n.step_details.tool_calls&&r.step_details.type=="tool_calls")for(let o of n.step_details.tool_calls)o.index==x(this,ro,"f")?this._emit("toolCallDelta",o,r.step_details.tool_calls[o.index]):(x(this,ye,"f")&&this._emit("toolCallDone",x(this,ye,"f")),ge(this,ro,o.index,"f"),ge(this,ye,r.step_details.tool_calls[o.index],"f"),x(this,ye,"f")&&this._emit("toolCallCreated",x(this,ye,"f")));this._emit("runStepDelta",e.data.delta,r);break;case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":ge(this,jn,void 0,"f"),e.data.step_details.type=="tool_calls"&&x(this,ye,"f")&&(this._emit("toolCallDone",x(this,ye,"f")),ge(this,ye,void 0,"f")),this._emit("runStepDone",e.data,r);break;case"thread.run.step.in_progress":break}},ou=function(e){x(this,ma,"f").push(e),this._emit("event",e)},iu=function(e){switch(e.event){case"thread.run.step.created":return x(this,Ue,"f")[e.data.id]=e.data,e.data;case"thread.run.step.delta":let r=x(this,Ue,"f")[e.data.id];if(!r)throw Error("Received a RunStepDelta before creation of a snapshot");let n=e.data;if(n.delta){let s=ue.accumulateDelta(r,n.delta);x(this,Ue,"f")[e.data.id]=s}return x(this,Ue,"f")[e.data.id];case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":case"thread.run.step.in_progress":x(this,Ue,"f")[e.data.id]=e.data;break}if(x(this,Ue,"f")[e.data.id])return x(this,Ue,"f")[e.data.id];throw new Error("No snapshot available")},au=function(e,r){let n=[];switch(e.event){case"thread.message.created":return[e.data,n];case"thread.message.delta":if(!r)throw Error("Received a delta with no existing snapshot (there should be one from message creation)");let s=e.data;if(s.delta.content)for(let o of s.delta.content)if(o.index in r.content){let i=r.content[o.index];r.content[o.index]=x(this,te,"m",lu).call(this,o,i)}else r.content[o.index]=o,n.push(o);return[r,n];case"thread.message.in_progress":case"thread.message.completed":case"thread.message.incomplete":if(r)return[r,n];throw Error("Received thread message event with no existing snapshot")}throw Error("Tried to accumulate a non-message event")},lu=function(e,r){return ue.accumulateDelta(r,e)},cu=function(e){switch(ge(this,to,e.data,"f"),e.event){case"thread.run.created":break;case"thread.run.queued":break;case"thread.run.in_progress":break;case"thread.run.requires_action":case"thread.run.cancelled":case"thread.run.failed":case"thread.run.completed":case"thread.run.expired":ge(this,Wt,e.data,"f"),x(this,ye,"f")&&(this._emit("toolCallDone",x(this,ye,"f")),ge(this,ye,void 0,"f"));break;case"thread.run.cancelling":break}};var Jt=class extends S{create(e,r,n){return this._client.post(`/threads/${e}/messages`,{body:r,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(e,r,n){return this._client.get(`/threads/${e}/messages/${r}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}update(e,r,n,s){return this._client.post(`/threads/${e}/messages/${r}`,{body:n,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}list(e,r={},n){return q(r)?this.list(e,{},r):this._client.getAPIList(`/threads/${e}/messages`,Br,{query:r,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}del(e,r,n){return this._client.delete(`/threads/${e}/messages/${r}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}},Br=class extends H{};Jt.MessagesPage=Br;var $t=class extends S{retrieve(e,r,n,s={},o){return q(s)?this.retrieve(e,r,n,{},s):this._client.get(`/threads/${e}/runs/${r}/steps/${n}`,{query:s,...o,headers:{"OpenAI-Beta":"assistants=v2",...o==null?void 0:o.headers}})}list(e,r,n={},s){return q(n)?this.list(e,r,{},n):this._client.getAPIList(`/threads/${e}/runs/${r}/steps`,Fr,{query:n,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}},Fr=class extends H{};$t.RunStepsPage=Fr;var ot=class extends S{constructor(){super(...arguments),this.steps=new $t(this._client)}create(e,r,n){var i;let{include:s,...o}=r;return this._client.post(`/threads/${e}/runs`,{query:{include:s},body:o,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers},stream:(i=r.stream)!=null?i:!1})}retrieve(e,r,n){return this._client.get(`/threads/${e}/runs/${r}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}update(e,r,n,s){return this._client.post(`/threads/${e}/runs/${r}`,{body:n,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}list(e,r={},n){return q(r)?this.list(e,{},r):this._client.getAPIList(`/threads/${e}/runs`,qr,{query:r,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}cancel(e,r,n){return this._client.post(`/threads/${e}/runs/${r}/cancel`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}async createAndPoll(e,r,n){let s=await this.create(e,r,n);return await this.poll(e,s.id,n)}createAndStream(e,r,n){return ue.createAssistantStream(e,this._client.beta.threads.runs,r,n)}async poll(e,r,n){let s={...n==null?void 0:n.headers,"X-Stainless-Poll-Helper":"true"};for(n!=null&&n.pollIntervalMs&&(s["X-Stainless-Custom-Poll-Interval"]=n.pollIntervalMs.toString());;){let{data:o,response:i}=await this.retrieve(e,r,{...n,headers:{...n==null?void 0:n.headers,...s}}).withResponse();switch(o.status){case"queued":case"in_progress":case"cancelling":let a=5e3;if(n!=null&&n.pollIntervalMs)a=n.pollIntervalMs;else{let l=i.headers.get("openai-poll-after-ms");if(l){let c=parseInt(l);isNaN(c)||(a=c)}}await Ze(a);break;case"requires_action":case"incomplete":case"cancelled":case"completed":case"failed":case"expired":return o}}}stream(e,r,n){return ue.createAssistantStream(e,this._client.beta.threads.runs,r,n)}submitToolOutputs(e,r,n,s){var o;return this._client.post(`/threads/${e}/runs/${r}/submit_tool_outputs`,{body:n,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers},stream:(o=n.stream)!=null?o:!1})}async submitToolOutputsAndPoll(e,r,n,s){let o=await this.submitToolOutputs(e,r,n,s);return await this.poll(e,o.id,s)}submitToolOutputsStream(e,r,n,s){return ue.createToolAssistantStream(e,r,this._client.beta.threads.runs,n,s)}},qr=class extends H{};ot.RunsPage=qr;ot.Steps=$t;ot.RunStepsPage=Fr;var He=class extends S{constructor(){super(...arguments),this.runs=new ot(this._client),this.messages=new Jt(this._client)}create(e={},r){return q(e)?this.create({},e):this._client.post("/threads",{body:e,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}retrieve(e,r){return this._client.get(`/threads/${e}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}update(e,r,n){return this._client.post(`/threads/${e}`,{body:r,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}del(e,r){return this._client.delete(`/threads/${e}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}createAndRun(e,r){var n;return this._client.post("/threads/runs",{body:e,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers},stream:(n=e.stream)!=null?n:!1})}async createAndRunPoll(e,r){let n=await this.createAndRun(e,r);return await this.runs.poll(n.thread_id,n.id,r)}createAndRunStream(e,r){return ue.createThreadAssistantStream(e,this._client.beta.threads,r)}};He.Runs=ot;He.RunsPage=qr;He.Messages=Jt;He.MessagesPage=Br;var uu=async t=>{let e=await Promise.allSettled(t),r=e.filter(s=>s.status==="rejected");if(r.length){for(let s of r)console.error(s.reason);throw new Error(`${r.length} promise(s) failed - see the above errors`)}let n=[];for(let s of e)s.status==="fulfilled"&&n.push(s.value);return n};var Gt=class extends S{create(e,r,n){return this._client.post(`/vector_stores/${e}/files`,{body:r,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(e,r,n){return this._client.get(`/vector_stores/${e}/files/${r}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}list(e,r={},n){return q(r)?this.list(e,{},r):this._client.getAPIList(`/vector_stores/${e}/files`,vt,{query:r,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}del(e,r,n){return this._client.delete(`/vector_stores/${e}/files/${r}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}async createAndPoll(e,r,n){let s=await this.create(e,r,n);return await this.poll(e,s.id,n)}async poll(e,r,n){let s={...n==null?void 0:n.headers,"X-Stainless-Poll-Helper":"true"};for(n!=null&&n.pollIntervalMs&&(s["X-Stainless-Custom-Poll-Interval"]=n.pollIntervalMs.toString());;){let o=await this.retrieve(e,r,{...n,headers:s}).withResponse(),i=o.data;switch(i.status){case"in_progress":let a=5e3;if(n!=null&&n.pollIntervalMs)a=n.pollIntervalMs;else{let l=o.response.headers.get("openai-poll-after-ms");if(l){let c=parseInt(l);isNaN(c)||(a=c)}}await Ze(a);break;case"failed":case"completed":return i}}}async upload(e,r,n){let s=await this._client.files.create({file:r,purpose:"assistants"},n);return this.create(e,{file_id:s.id},n)}async uploadAndPoll(e,r,n){let s=await this.upload(e,r,n);return await this.poll(e,s.id,n)}},vt=class extends H{};Gt.VectorStoreFilesPage=vt;var Ur=class extends S{create(e,r,n){return this._client.post(`/vector_stores/${e}/file_batches`,{body:r,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(e,r,n){return this._client.get(`/vector_stores/${e}/file_batches/${r}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}cancel(e,r,n){return this._client.post(`/vector_stores/${e}/file_batches/${r}/cancel`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}async createAndPoll(e,r,n){let s=await this.create(e,r);return await this.poll(e,s.id,n)}listFiles(e,r,n={},s){return q(n)?this.listFiles(e,r,{},n):this._client.getAPIList(`/vector_stores/${e}/file_batches/${r}/files`,vt,{query:n,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}async poll(e,r,n){let s={...n==null?void 0:n.headers,"X-Stainless-Poll-Helper":"true"};for(n!=null&&n.pollIntervalMs&&(s["X-Stainless-Custom-Poll-Interval"]=n.pollIntervalMs.toString());;){let{data:o,response:i}=await this.retrieve(e,r,{...n,headers:s}).withResponse();switch(o.status){case"in_progress":let a=5e3;if(n!=null&&n.pollIntervalMs)a=n.pollIntervalMs;else{let l=i.headers.get("openai-poll-after-ms");if(l){let c=parseInt(l);isNaN(c)||(a=c)}}await Ze(a);break;case"failed":case"cancelled":case"completed":return o}}}async uploadAndPoll(e,{files:r,fileIds:n=[]},s){var d;if(r==null||r.length==0)throw new Error("No `files` provided to process. If you've already uploaded files you should use `.createAndPoll()` instead");let o=(d=s==null?void 0:s.maxConcurrency)!=null?d:5,i=Math.min(o,r.length),a=this._client,l=r.values(),c=[...n];async function f(h){for(let p of h){let g=await a.files.create({file:p,purpose:"assistants"},s);c.push(g.id)}}let u=Array(i).fill(l).map(f);return await uu(u),await this.createAndPoll(e,{file_ids:c})}};var je=class extends S{constructor(){super(...arguments),this.files=new Gt(this._client),this.fileBatches=new Ur(this._client)}create(e,r){return this._client.post("/vector_stores",{body:e,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}retrieve(e,r){return this._client.get(`/vector_stores/${e}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}update(e,r,n){return this._client.post(`/vector_stores/${e}`,{body:r,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}list(e={},r){return q(e)?this.list({},e):this._client.getAPIList("/vector_stores",Hr,{query:e,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}del(e,r){return this._client.delete(`/vector_stores/${e}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}},Hr=class extends H{};je.VectorStoresPage=Hr;je.Files=Gt;je.VectorStoreFilesPage=vt;je.FileBatches=Ur;var we=class extends S{constructor(){super(...arguments),this.realtime=new Kt(this._client),this.vectorStores=new je(this._client),this.chat=new Lr(this._client),this.assistants=new Ht(this._client),this.threads=new He(this._client)}};we.Realtime=Kt;we.VectorStores=je;we.VectorStoresPage=Hr;we.Assistants=Ht;we.AssistantsPage=Pr;we.Threads=He;var zt=class extends S{create(e,r){var n;return this._client.post("/completions",{body:e,...r,stream:(n=e.stream)!=null?n:!1})}};var Xt=class extends S{create(e,r){return this._client.post("/embeddings",{body:e,...r})}};var Ct=class extends S{create(e,r){return this._client.post("/files",ve({body:e,...r}))}retrieve(e,r){return this._client.get(`/files/${e}`,r)}list(e={},r){return q(e)?this.list({},e):this._client.getAPIList("/files",Yt,{query:e,...r})}del(e,r){return this._client.delete(`/files/${e}`,r)}content(e,r){return this._client.get(`/files/${e}/content`,{...r,headers:{Accept:"application/binary",...r==null?void 0:r.headers},__binaryResponse:!0})}retrieveContent(e,r){return this._client.get(`/files/${e}/content`,r)}async waitForProcessing(e,{pollInterval:r=5e3,maxWait:n=30*60*1e3}={}){let s=new Set(["processed","error","deleted"]),o=Date.now(),i=await this.retrieve(e);for(;!i.status||!s.has(i.status);)if(await Ze(r),i=await this.retrieve(e),Date.now()-o>n)throw new mt({message:`Giving up on waiting for file ${e} to finish processing after ${n} milliseconds.`});return i}},Yt=class extends H{};Ct.FileObjectsPage=Yt;var Qt=class extends S{list(e,r={},n){return q(r)?this.list(e,{},r):this._client.getAPIList(`/fine_tuning/jobs/${e}/checkpoints`,jr,{query:r,...n})}},jr=class extends H{};Qt.FineTuningJobCheckpointsPage=jr;var Ke=class extends S{constructor(){super(...arguments),this.checkpoints=new Qt(this._client)}create(e,r){return this._client.post("/fine_tuning/jobs",{body:e,...r})}retrieve(e,r){return this._client.get(`/fine_tuning/jobs/${e}`,r)}list(e={},r){return q(e)?this.list({},e):this._client.getAPIList("/fine_tuning/jobs",Kr,{query:e,...r})}cancel(e,r){return this._client.post(`/fine_tuning/jobs/${e}/cancel`,r)}listEvents(e,r={},n){return q(r)?this.listEvents(e,{},r):this._client.getAPIList(`/fine_tuning/jobs/${e}/events`,Vr,{query:r,...n})}},Kr=class extends H{},Vr=class extends H{};Ke.FineTuningJobsPage=Kr;Ke.FineTuningJobEventsPage=Vr;Ke.Checkpoints=Qt;Ke.FineTuningJobCheckpointsPage=jr;var Ve=class extends S{constructor(){super(...arguments),this.jobs=new Ke(this._client)}};Ve.Jobs=Ke;Ve.FineTuningJobsPage=Kr;Ve.FineTuningJobEventsPage=Vr;var Zt=class extends S{createVariation(e,r){return this._client.post("/images/variations",ve({body:e,...r}))}edit(e,r){return this._client.post("/images/edits",ve({body:e,...r}))}generate(e,r){return this._client.post("/images/generations",{body:e,...r})}};var xt=class extends S{retrieve(e,r){return this._client.get(`/models/${e}`,r)}list(e){return this._client.getAPIList("/models",er,e)}del(e,r){return this._client.delete(`/models/${e}`,r)}},er=class extends js{};xt.ModelsPage=er;var tr=class extends S{create(e,r){return this._client.post("/moderations",{body:e,...r})}};var Wr=class extends S{create(e,r,n){return this._client.post(`/uploads/${e}/parts`,ve({body:r,...n}))}};var At=class extends S{constructor(){super(...arguments),this.parts=new Wr(this._client)}create(e,r){return this._client.post("/uploads",{body:e,...r})}cancel(e,r){return this._client.post(`/uploads/${e}/cancel`,r)}complete(e,r,n){return this._client.post(`/uploads/${e}/complete`,{body:r,...n})}};At.Parts=Wr;var du,L=class extends Hs{constructor({baseURL:e=gt("OPENAI_BASE_URL"),apiKey:r=gt("OPENAI_API_KEY"),organization:n=(i=>(i=gt("OPENAI_ORG_ID"))!=null?i:null)(),project:s=(a=>(a=gt("OPENAI_PROJECT_ID"))!=null?a:null)(),...o}={}){var c;if(r===void 0)throw new A("The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).");let l={apiKey:r,organization:n,project:s,...o,baseURL:e||"https://api.openai.com/v1"};if(!l.dangerouslyAllowBrowser&&zc())throw new A(`It looks like you're running in a browser-like environment.

This is disabled by default, as it risks exposing your secret API credentials to attackers.
If you understand the risks and have appropriate mitigations in place,
you can set the \`dangerouslyAllowBrowser\` option to \`true\`, e.g.,

new OpenAI({ apiKey, dangerouslyAllowBrowser: true });

https://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety
`);super({baseURL:l.baseURL,timeout:(c=l.timeout)!=null?c:6e5,httpAgent:l.httpAgent,maxRetries:l.maxRetries,fetch:l.fetch}),this.completions=new zt(this),this.chat=new et(this),this.embeddings=new Xt(this),this.files=new Ct(this),this.images=new Zt(this),this.audio=new qe(this),this.moderations=new tr(this),this.models=new xt(this),this.fineTuning=new Ve(this),this.beta=new we(this),this.batches=new _t(this),this.uploads=new At(this),this._options=l,this.apiKey=r,this.organization=n,this.project=s}defaultQuery(){return this._options.defaultQuery}defaultHeaders(e){return{...super.defaultHeaders(e),"OpenAI-Organization":this.organization,"OpenAI-Project":this.project,...this._options.defaultHeaders}}authHeaders(e){return{Authorization:`Bearer ${this.apiKey}`}}stringifyQuery(e){return Mi(e,{arrayFormat:"brackets"})}};du=L;L.OpenAI=du;L.DEFAULT_TIMEOUT=6e5;L.OpenAIError=A;L.APIError=W;L.APIConnectionError=pt;L.APIConnectionTimeoutError=mt;L.APIUserAbortError=Q;L.NotFoundError=Rn;L.ConflictError=Pn;L.RateLimitError=Tn;L.BadRequestError=Cn;L.AuthenticationError=xn;L.InternalServerError=In;L.PermissionDeniedError=An;L.UnprocessableEntityError=On;L.toFile=Ji;L.fileFromPath=Ls;L.Completions=zt;L.Chat=et;L.ChatCompletionsPage=wt;L.Embeddings=Xt;L.Files=Ct;L.FileObjectsPage=Yt;L.Images=Zt;L.Audio=qe;L.Moderations=tr;L.Models=xt;L.ModelsPage=er;L.FineTuning=Ve;L.Beta=we;L.Batches=_t;L.BatchesPage=Ut;L.Uploads=At;var no=class extends L{constructor({baseURL:e=gt("OPENAI_BASE_URL"),apiKey:r=gt("AZURE_OPENAI_API_KEY"),apiVersion:n=gt("OPENAI_API_VERSION"),endpoint:s,deployment:o,azureADTokenProvider:i,dangerouslyAllowBrowser:a,...l}={}){if(!n)throw new A("The OPENAI_API_VERSION environment variable is missing or empty; either provide it, or instantiate the AzureOpenAI client with an apiVersion option, like new AzureOpenAI({ apiVersion: 'My API Version' }).");if(typeof i=="function"&&(a=!0),!i&&!r)throw new A("Missing credentials. Please pass one of `apiKey` and `azureADTokenProvider`, or set the `AZURE_OPENAI_API_KEY` environment variable.");if(i&&r)throw new A("The `apiKey` and `azureADTokenProvider` arguments are mutually exclusive; only one can be passed at a time.");if(r!=null||(r=fu),l.defaultQuery={...l.defaultQuery,"api-version":n},e){if(s)throw new A("baseURL and endpoint are mutually exclusive")}else{if(s||(s=process.env.AZURE_OPENAI_ENDPOINT),!s)throw new A("Must provide one of the `baseURL` or `endpoint` arguments, or the `AZURE_OPENAI_ENDPOINT` environment variable");e=`${s}/openai`}super({apiKey:r,baseURL:e,...l,...a!==void 0?{dangerouslyAllowBrowser:a}:{}}),this.apiVersion="",this._azureADTokenProvider=i,this.apiVersion=n,this.deploymentName=o}buildRequest(e,r={}){var n;if(Am.has(e.path)&&e.method==="post"&&e.body!==void 0){if(!vr(e.body))throw new Error("Expected request body to be an object");let s=this.deploymentName||e.body.model||((n=e.__metadata)==null?void 0:n.model);s!==void 0&&!this.baseURL.includes("/deployments")&&(e.path=`/deployments/${s}${e.path}`)}return super.buildRequest(e,r)}async _getAzureADToken(){if(typeof this._azureADTokenProvider=="function"){let e=await this._azureADTokenProvider();if(!e||typeof e!="string")throw new A(`Expected 'azureADTokenProvider' argument to return a string but it returned ${e}`);return e}}authHeaders(e){return{}}async prepareOptions(e){var n,s;if((n=e.headers)!=null&&n["api-key"])return super.prepareOptions(e);let r=await this._getAzureADToken();if((s=e.headers)!=null||(e.headers={}),r)e.headers.Authorization=`Bearer ${r}`;else if(this.apiKey!==fu)e.headers["api-key"]=this.apiKey;else throw new A("Unable to handle auth");return super.prepareOptions(e)}},Am=new Set(["/completions","/chat/completions","/embeddings","/audio/transcriptions","/audio/translations","/audio/speech","/images/generations"]),fu="<Missing Key>",We=L;var Rm=`

> [!quote]-  
> `,Pm="",Om=t=>async function*(e){var g,w;let{parameters:r,...n}=t,s={...n,...r},{apiKey:o,model:i,endpoint:a,apiVersion:l,...c}=s;if(!o)throw new Error(y("API key is required"));let f=new no({endpoint:a,apiKey:o,apiVersion:l,deployment:i,dangerouslyAllowBrowser:!0});e=[{role:"system",content:`Initiate your response with "<think>
\u55EF" at the beginning of every output.`},...e];let u=await f.chat.completions.create({model:i,messages:e,stream:!0,...c}),d=!1,h=!1,p=!1;for await(let b of u){b.usage&&b.usage.prompt_tokens&&b.usage.completion_tokens&&console.debug(`Prompt tokens: ${b.usage.prompt_tokens}, completion tokens: ${b.usage.completion_tokens}`);let _=(w=(g=b.choices[0])==null?void 0:g.delta)==null?void 0:w.content;if(_){if(_==="<think>"){if(h)continue;d=!0,h=!0,yield Rm;continue}if(_==="</think>"){if(p)continue;d=!1,p=!0,yield Pm;continue}yield d?_.replace(/\n/g,`
> `):_}}},hu=["o3-mini","deepseek-r1","phi-4","o1","o1-mini","gpt-4o","gpt-4o-mini"],pu={name:"Azure",defaultOptions:{apiKey:"",baseURL:"",model:hu[0],endpoint:"",apiVersion:"",parameters:{}},sendRequestFunc:Om,models:hu,websiteToObtainKey:"https://portal.azure.com"};function Kn(t,e){return function(){return t.apply(e,arguments)}}var{toString:Tm}=Object.prototype,{getPrototypeOf:wa}=Object,oo=(t=>e=>{let r=Tm.call(e);return t[r]||(t[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),ke=t=>(t=t.toLowerCase(),e=>oo(e)===t),io=t=>e=>typeof e===t,{isArray:Jr}=Array,Vn=io("undefined");function Im(t){return t!==null&&!Vn(t)&&t.constructor!==null&&!Vn(t.constructor)&&_e(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}var yu=ke("ArrayBuffer");function km(t){let e;return typeof ArrayBuffer!="undefined"&&ArrayBuffer.isView?e=ArrayBuffer.isView(t):e=t&&t.buffer&&yu(t.buffer),e}var Nm=io("string"),_e=io("function"),wu=io("number"),ao=t=>t!==null&&typeof t=="object",Lm=t=>t===!0||t===!1,so=t=>{if(oo(t)!=="object")return!1;let e=wa(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},Mm=ke("Date"),Dm=ke("File"),Bm=ke("Blob"),Fm=ke("FileList"),qm=t=>ao(t)&&_e(t.pipe),Um=t=>{let e;return t&&(typeof FormData=="function"&&t instanceof FormData||_e(t.append)&&((e=oo(t))==="formdata"||e==="object"&&_e(t.toString)&&t.toString()==="[object FormData]"))},Hm=ke("URLSearchParams"),[jm,Km,Vm,Wm]=["ReadableStream","Request","Response","Headers"].map(ke),Jm=t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Wn(t,e,{allOwnKeys:r=!1}={}){if(t===null||typeof t=="undefined")return;let n,s;if(typeof t!="object"&&(t=[t]),Jr(t))for(n=0,s=t.length;n<s;n++)e.call(null,t[n],n,t);else{let o=r?Object.getOwnPropertyNames(t):Object.keys(t),i=o.length,a;for(n=0;n<i;n++)a=o[n],e.call(null,t[a],a,t)}}function _u(t,e){e=e.toLowerCase();let r=Object.keys(t),n=r.length,s;for(;n-- >0;)if(s=r[n],e===s.toLowerCase())return s;return null}var rr=(()=>typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:typeof window!="undefined"?window:global)(),bu=t=>!Vn(t)&&t!==rr;function ya(){let{caseless:t}=bu(this)&&this||{},e={},r=(n,s)=>{let o=t&&_u(e,s)||s;so(e[o])&&so(n)?e[o]=ya(e[o],n):so(n)?e[o]=ya({},n):Jr(n)?e[o]=n.slice():e[o]=n};for(let n=0,s=arguments.length;n<s;n++)arguments[n]&&Wn(arguments[n],r);return e}var $m=(t,e,r,{allOwnKeys:n}={})=>(Wn(e,(s,o)=>{r&&_e(s)?t[o]=Kn(s,r):t[o]=s},{allOwnKeys:n}),t),Gm=t=>(t.charCodeAt(0)===65279&&(t=t.slice(1)),t),zm=(t,e,r,n)=>{t.prototype=Object.create(e.prototype,n),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:e.prototype}),r&&Object.assign(t.prototype,r)},Xm=(t,e,r,n)=>{let s,o,i,a={};if(e=e||{},t==null)return e;do{for(s=Object.getOwnPropertyNames(t),o=s.length;o-- >0;)i=s[o],(!n||n(i,t,e))&&!a[i]&&(e[i]=t[i],a[i]=!0);t=r!==!1&&wa(t)}while(t&&(!r||r(t,e))&&t!==Object.prototype);return e},Ym=(t,e,r)=>{t=String(t),(r===void 0||r>t.length)&&(r=t.length),r-=e.length;let n=t.indexOf(e,r);return n!==-1&&n===r},Qm=t=>{if(!t)return null;if(Jr(t))return t;let e=t.length;if(!wu(e))return null;let r=new Array(e);for(;e-- >0;)r[e]=t[e];return r},Zm=(t=>e=>t&&e instanceof t)(typeof Uint8Array!="undefined"&&wa(Uint8Array)),eg=(t,e)=>{let n=(t&&t[Symbol.iterator]).call(t),s;for(;(s=n.next())&&!s.done;){let o=s.value;e.call(t,o[0],o[1])}},tg=(t,e)=>{let r,n=[];for(;(r=t.exec(e))!==null;)n.push(r);return n},rg=ke("HTMLFormElement"),ng=t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,n,s){return n.toUpperCase()+s}),mu=(({hasOwnProperty:t})=>(e,r)=>t.call(e,r))(Object.prototype),sg=ke("RegExp"),Su=(t,e)=>{let r=Object.getOwnPropertyDescriptors(t),n={};Wn(r,(s,o)=>{let i;(i=e(s,o,t))!==!1&&(n[o]=i||s)}),Object.defineProperties(t,n)},og=t=>{Su(t,(e,r)=>{if(_e(t)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;let n=t[r];if(_e(n)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},ig=(t,e)=>{let r={},n=s=>{s.forEach(o=>{r[o]=!0})};return Jr(t)?n(t):n(String(t).split(e)),r},ag=()=>{},lg=(t,e)=>t!=null&&Number.isFinite(t=+t)?t:e,ga="abcdefghijklmnopqrstuvwxyz",gu="0123456789",Eu={DIGIT:gu,ALPHA:ga,ALPHA_DIGIT:ga+ga.toUpperCase()+gu},cg=(t=16,e=Eu.ALPHA_DIGIT)=>{let r="",{length:n}=e;for(;t--;)r+=e[Math.random()*n|0];return r};function ug(t){return!!(t&&_e(t.append)&&t[Symbol.toStringTag]==="FormData"&&t[Symbol.iterator])}var fg=t=>{let e=new Array(10),r=(n,s)=>{if(ao(n)){if(e.indexOf(n)>=0)return;if(!("toJSON"in n)){e[s]=n;let o=Jr(n)?[]:{};return Wn(n,(i,a)=>{let l=r(i,s+1);!Vn(l)&&(o[a]=l)}),e[s]=void 0,o}}return n};return r(t,0)},dg=ke("AsyncFunction"),hg=t=>t&&(ao(t)||_e(t))&&_e(t.then)&&_e(t.catch),vu=((t,e)=>t?setImmediate:e?((r,n)=>(rr.addEventListener("message",({source:s,data:o})=>{s===rr&&o===r&&n.length&&n.shift()()},!1),s=>{n.push(s),rr.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",_e(rr.postMessage)),pg=typeof queueMicrotask!="undefined"?queueMicrotask.bind(rr):typeof process!="undefined"&&process.nextTick||vu,m={isArray:Jr,isArrayBuffer:yu,isBuffer:Im,isFormData:Um,isArrayBufferView:km,isString:Nm,isNumber:wu,isBoolean:Lm,isObject:ao,isPlainObject:so,isReadableStream:jm,isRequest:Km,isResponse:Vm,isHeaders:Wm,isUndefined:Vn,isDate:Mm,isFile:Dm,isBlob:Bm,isRegExp:sg,isFunction:_e,isStream:qm,isURLSearchParams:Hm,isTypedArray:Zm,isFileList:Fm,forEach:Wn,merge:ya,extend:$m,trim:Jm,stripBOM:Gm,inherits:zm,toFlatObject:Xm,kindOf:oo,kindOfTest:ke,endsWith:Ym,toArray:Qm,forEachEntry:eg,matchAll:tg,isHTMLForm:rg,hasOwnProperty:mu,hasOwnProp:mu,reduceDescriptors:Su,freezeMethods:og,toObjectSet:ig,toCamelCase:ng,noop:ag,toFiniteNumber:lg,findKey:_u,global:rr,isContextDefined:bu,ALPHABET:Eu,generateString:cg,isSpecCompliantForm:ug,toJSONObject:fg,isAsyncFn:dg,isThenable:hg,setImmediate:vu,asap:pg};function $r(t,e,r,n,s){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=t,this.name="AxiosError",e&&(this.code=e),r&&(this.config=r),n&&(this.request=n),s&&(this.response=s,this.status=s.status?s.status:null)}m.inherits($r,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:m.toJSONObject(this.config),code:this.code,status:this.status}}});var Cu=$r.prototype,xu={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(t=>{xu[t]={value:t}});Object.defineProperties($r,xu);Object.defineProperty(Cu,"isAxiosError",{value:!0});$r.from=(t,e,r,n,s,o)=>{let i=Object.create(Cu);return m.toFlatObject(t,i,function(l){return l!==Error.prototype},a=>a!=="isAxiosError"),$r.call(i,t.message,e,r,n,s),i.cause=t,i.name=t.name,o&&Object.assign(i,o),i};var O=$r;var lo=null;function _a(t){return m.isPlainObject(t)||m.isArray(t)}function Ru(t){return m.endsWith(t,"[]")?t.slice(0,-2):t}function Au(t,e,r){return t?t.concat(e).map(function(s,o){return s=Ru(s),!r&&o?"["+s+"]":s}).join(r?".":""):e}function mg(t){return m.isArray(t)&&!t.some(_a)}var gg=m.toFlatObject(m,{},null,function(e){return/^is[A-Z]/.test(e)});function yg(t,e,r){if(!m.isObject(t))throw new TypeError("target must be an object");e=e||new(lo||FormData),r=m.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(g,w){return!m.isUndefined(w[g])});let n=r.metaTokens,s=r.visitor||f,o=r.dots,i=r.indexes,l=(r.Blob||typeof Blob!="undefined"&&Blob)&&m.isSpecCompliantForm(e);if(!m.isFunction(s))throw new TypeError("visitor must be a function");function c(p){if(p===null)return"";if(m.isDate(p))return p.toISOString();if(!l&&m.isBlob(p))throw new O("Blob is not supported. Use a Buffer instead.");return m.isArrayBuffer(p)||m.isTypedArray(p)?l&&typeof Blob=="function"?new Blob([p]):Buffer.from(p):p}function f(p,g,w){let b=p;if(p&&!w&&typeof p=="object"){if(m.endsWith(g,"{}"))g=n?g:g.slice(0,-2),p=JSON.stringify(p);else if(m.isArray(p)&&mg(p)||(m.isFileList(p)||m.endsWith(g,"[]"))&&(b=m.toArray(p)))return g=Ru(g),b.forEach(function(C,R){!(m.isUndefined(C)||C===null)&&e.append(i===!0?Au([g],R,o):i===null?g:g+"[]",c(C))}),!1}return _a(p)?!0:(e.append(Au(w,g,o),c(p)),!1)}let u=[],d=Object.assign(gg,{defaultVisitor:f,convertValue:c,isVisitable:_a});function h(p,g){if(!m.isUndefined(p)){if(u.indexOf(p)!==-1)throw Error("Circular reference detected in "+g.join("."));u.push(p),m.forEach(p,function(b,_){(!(m.isUndefined(b)||b===null)&&s.call(e,b,m.isString(_)?_.trim():_,g,d))===!0&&h(b,g?g.concat(_):[_])}),u.pop()}}if(!m.isObject(t))throw new TypeError("data must be an object");return h(t),e}var Rt=yg;function Pu(t){let e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(n){return e[n]})}function Ou(t,e){this._pairs=[],t&&Rt(t,this,e)}var Tu=Ou.prototype;Tu.append=function(e,r){this._pairs.push([e,r])};Tu.toString=function(e){let r=e?function(n){return e.call(this,n,Pu)}:Pu;return this._pairs.map(function(s){return r(s[0])+"="+r(s[1])},"").join("&")};var co=Ou;function wg(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function Jn(t,e,r){if(!e)return t;let n=r&&r.encode||wg;m.isFunction(r)&&(r={serialize:r});let s=r&&r.serialize,o;if(s?o=s(e,r):o=m.isURLSearchParams(e)?e.toString():new co(e,r).toString(n),o){let i=t.indexOf("#");i!==-1&&(t=t.slice(0,i)),t+=(t.indexOf("?")===-1?"?":"&")+o}return t}var ba=class{constructor(){this.handlers=[]}use(e,r,n){return this.handlers.push({fulfilled:e,rejected:r,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){m.forEach(this.handlers,function(n){n!==null&&e(n)})}},Sa=ba;var uo={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1};var Iu=typeof URLSearchParams!="undefined"?URLSearchParams:co;var ku=typeof FormData!="undefined"?FormData:null;var Nu=typeof Blob!="undefined"?Blob:null;var Lu={isBrowser:!0,classes:{URLSearchParams:Iu,FormData:ku,Blob:Nu},protocols:["http","https","file","blob","url","data"]};var Ca={};Cc(Ca,{hasBrowserEnv:()=>va,hasStandardBrowserEnv:()=>_g,hasStandardBrowserWebWorkerEnv:()=>bg,navigator:()=>Ea,origin:()=>Sg});var va=typeof window!="undefined"&&typeof document!="undefined",Ea=typeof navigator=="object"&&navigator||void 0,_g=va&&(!Ea||["ReactNative","NativeScript","NS"].indexOf(Ea.product)<0),bg=(()=>typeof WorkerGlobalScope!="undefined"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function")(),Sg=va&&window.location.href||"http://localhost";var V={...Ca,...Lu};function xa(t,e){return Rt(t,new V.classes.URLSearchParams,Object.assign({visitor:function(r,n,s,o){return V.isNode&&m.isBuffer(r)?(this.append(n,r.toString("base64")),!1):o.defaultVisitor.apply(this,arguments)}},e))}function Eg(t){return m.matchAll(/\w+|\[(\w*)]/g,t).map(e=>e[0]==="[]"?"":e[1]||e[0])}function vg(t){let e={},r=Object.keys(t),n,s=r.length,o;for(n=0;n<s;n++)o=r[n],e[o]=t[o];return e}function Cg(t){function e(r,n,s,o){let i=r[o++];if(i==="__proto__")return!0;let a=Number.isFinite(+i),l=o>=r.length;return i=!i&&m.isArray(s)?s.length:i,l?(m.hasOwnProp(s,i)?s[i]=[s[i],n]:s[i]=n,!a):((!s[i]||!m.isObject(s[i]))&&(s[i]=[]),e(r,n,s[i],o)&&m.isArray(s[i])&&(s[i]=vg(s[i])),!a)}if(m.isFormData(t)&&m.isFunction(t.entries)){let r={};return m.forEachEntry(t,(n,s)=>{e(Eg(n),s,r,0)}),r}return null}var fo=Cg;function xg(t,e,r){if(m.isString(t))try{return(e||JSON.parse)(t),m.trim(t)}catch(n){if(n.name!=="SyntaxError")throw n}return(r||JSON.stringify)(t)}var Aa={transitional:uo,adapter:["xhr","http","fetch"],transformRequest:[function(e,r){let n=r.getContentType()||"",s=n.indexOf("application/json")>-1,o=m.isObject(e);if(o&&m.isHTMLForm(e)&&(e=new FormData(e)),m.isFormData(e))return s?JSON.stringify(fo(e)):e;if(m.isArrayBuffer(e)||m.isBuffer(e)||m.isStream(e)||m.isFile(e)||m.isBlob(e)||m.isReadableStream(e))return e;if(m.isArrayBufferView(e))return e.buffer;if(m.isURLSearchParams(e))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let a;if(o){if(n.indexOf("application/x-www-form-urlencoded")>-1)return xa(e,this.formSerializer).toString();if((a=m.isFileList(e))||n.indexOf("multipart/form-data")>-1){let l=this.env&&this.env.FormData;return Rt(a?{"files[]":e}:e,l&&new l,this.formSerializer)}}return o||s?(r.setContentType("application/json",!1),xg(e)):e}],transformResponse:[function(e){let r=this.transitional||Aa.transitional,n=r&&r.forcedJSONParsing,s=this.responseType==="json";if(m.isResponse(e)||m.isReadableStream(e))return e;if(e&&m.isString(e)&&(n&&!this.responseType||s)){let i=!(r&&r.silentJSONParsing)&&s;try{return JSON.parse(e)}catch(a){if(i)throw a.name==="SyntaxError"?O.from(a,O.ERR_BAD_RESPONSE,this,null,this.response):a}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:V.classes.FormData,Blob:V.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};m.forEach(["delete","get","head","post","put","patch"],t=>{Aa.headers[t]={}});var Gr=Aa;var Ag=m.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Mu=t=>{let e={},r,n,s;return t&&t.split(`
`).forEach(function(i){s=i.indexOf(":"),r=i.substring(0,s).trim().toLowerCase(),n=i.substring(s+1).trim(),!(!r||e[r]&&Ag[r])&&(r==="set-cookie"?e[r]?e[r].push(n):e[r]=[n]:e[r]=e[r]?e[r]+", "+n:n)}),e};var Du=Symbol("internals");function $n(t){return t&&String(t).trim().toLowerCase()}function ho(t){return t===!1||t==null?t:m.isArray(t)?t.map(ho):String(t)}function Rg(t){let e=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g,n;for(;n=r.exec(t);)e[n[1]]=n[2];return e}var Pg=t=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim());function Ra(t,e,r,n,s){if(m.isFunction(n))return n.call(this,e,r);if(s&&(e=r),!!m.isString(e)){if(m.isString(n))return e.indexOf(n)!==-1;if(m.isRegExp(n))return n.test(e)}}function Og(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,r,n)=>r.toUpperCase()+n)}function Tg(t,e){let r=m.toCamelCase(" "+e);["get","set","has"].forEach(n=>{Object.defineProperty(t,n+r,{value:function(s,o,i){return this[n].call(this,e,s,o,i)},configurable:!0})})}var zr=class{constructor(e){e&&this.set(e)}set(e,r,n){let s=this;function o(a,l,c){let f=$n(l);if(!f)throw new Error("header name must be a non-empty string");let u=m.findKey(s,f);(!u||s[u]===void 0||c===!0||c===void 0&&s[u]!==!1)&&(s[u||l]=ho(a))}let i=(a,l)=>m.forEach(a,(c,f)=>o(c,f,l));if(m.isPlainObject(e)||e instanceof this.constructor)i(e,r);else if(m.isString(e)&&(e=e.trim())&&!Pg(e))i(Mu(e),r);else if(m.isHeaders(e))for(let[a,l]of e.entries())o(l,a,n);else e!=null&&o(r,e,n);return this}get(e,r){if(e=$n(e),e){let n=m.findKey(this,e);if(n){let s=this[n];if(!r)return s;if(r===!0)return Rg(s);if(m.isFunction(r))return r.call(this,s,n);if(m.isRegExp(r))return r.exec(s);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,r){if(e=$n(e),e){let n=m.findKey(this,e);return!!(n&&this[n]!==void 0&&(!r||Ra(this,this[n],n,r)))}return!1}delete(e,r){let n=this,s=!1;function o(i){if(i=$n(i),i){let a=m.findKey(n,i);a&&(!r||Ra(n,n[a],a,r))&&(delete n[a],s=!0)}}return m.isArray(e)?e.forEach(o):o(e),s}clear(e){let r=Object.keys(this),n=r.length,s=!1;for(;n--;){let o=r[n];(!e||Ra(this,this[o],o,e,!0))&&(delete this[o],s=!0)}return s}normalize(e){let r=this,n={};return m.forEach(this,(s,o)=>{let i=m.findKey(n,o);if(i){r[i]=ho(s),delete r[o];return}let a=e?Og(o):String(o).trim();a!==o&&delete r[o],r[a]=ho(s),n[a]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){let r=Object.create(null);return m.forEach(this,(n,s)=>{n!=null&&n!==!1&&(r[s]=e&&m.isArray(n)?n.join(", "):n)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,r])=>e+": "+r).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...r){let n=new this(e);return r.forEach(s=>n.set(s)),n}static accessor(e){let n=(this[Du]=this[Du]={accessors:{}}).accessors,s=this.prototype;function o(i){let a=$n(i);n[a]||(Tg(s,i),n[a]=!0)}return m.isArray(e)?e.forEach(o):o(e),this}};zr.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);m.reduceDescriptors(zr.prototype,({value:t},e)=>{let r=e[0].toUpperCase()+e.slice(1);return{get:()=>t,set(n){this[r]=n}}});m.freezeMethods(zr);var X=zr;function Gn(t,e){let r=this||Gr,n=e||r,s=X.from(n.headers),o=n.data;return m.forEach(t,function(a){o=a.call(r,o,s.normalize(),e?e.status:void 0)}),s.normalize(),o}function zn(t){return!!(t&&t.__CANCEL__)}function Bu(t,e,r){O.call(this,t==null?"canceled":t,O.ERR_CANCELED,e,r),this.name="CanceledError"}m.inherits(Bu,O,{__CANCEL__:!0});var Je=Bu;function Xn(t,e,r){let n=r.config.validateStatus;!r.status||!n||n(r.status)?t(r):e(new O("Request failed with status code "+r.status,[O.ERR_BAD_REQUEST,O.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function Pa(t){let e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return e&&e[1]||""}function Ig(t,e){t=t||10;let r=new Array(t),n=new Array(t),s=0,o=0,i;return e=e!==void 0?e:1e3,function(l){let c=Date.now(),f=n[o];i||(i=c),r[s]=l,n[s]=c;let u=o,d=0;for(;u!==s;)d+=r[u++],u=u%t;if(s=(s+1)%t,s===o&&(o=(o+1)%t),c-i<e)return;let h=f&&c-f;return h?Math.round(d*1e3/h):void 0}}var Fu=Ig;function kg(t,e){let r=0,n=1e3/e,s,o,i=(c,f=Date.now())=>{r=f,s=null,o&&(clearTimeout(o),o=null),t.apply(null,c)};return[(...c)=>{let f=Date.now(),u=f-r;u>=n?i(c,f):(s=c,o||(o=setTimeout(()=>{o=null,i(s)},n-u)))},()=>s&&i(s)]}var qu=kg;var Xr=(t,e,r=3)=>{let n=0,s=Fu(50,250);return qu(o=>{let i=o.loaded,a=o.lengthComputable?o.total:void 0,l=i-n,c=s(l),f=i<=a;n=i;let u={loaded:i,total:a,progress:a?i/a:void 0,bytes:l,rate:c||void 0,estimated:c&&a&&f?(a-i)/c:void 0,event:o,lengthComputable:a!=null,[e?"download":"upload"]:!0};t(u)},r)},Oa=(t,e)=>{let r=t!=null;return[n=>e[0]({lengthComputable:r,total:t,loaded:n}),e[1]]},Ta=t=>(...e)=>m.asap(()=>t(...e));var Uu=V.hasStandardBrowserEnv?((t,e)=>r=>(r=new URL(r,V.origin),t.protocol===r.protocol&&t.host===r.host&&(e||t.port===r.port)))(new URL(V.origin),V.navigator&&/(msie|trident)/i.test(V.navigator.userAgent)):()=>!0;var Hu=V.hasStandardBrowserEnv?{write(t,e,r,n,s,o){let i=[t+"="+encodeURIComponent(e)];m.isNumber(r)&&i.push("expires="+new Date(r).toGMTString()),m.isString(n)&&i.push("path="+n),m.isString(s)&&i.push("domain="+s),o===!0&&i.push("secure"),document.cookie=i.join("; ")},read(t){let e=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(t){this.write(t,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function Ia(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}function ka(t,e){return e?t.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):t}function Yn(t,e){return t&&!Ia(e)?ka(t,e):e}var ju=t=>t instanceof X?{...t}:t;function Ne(t,e){e=e||{};let r={};function n(c,f,u,d){return m.isPlainObject(c)&&m.isPlainObject(f)?m.merge.call({caseless:d},c,f):m.isPlainObject(f)?m.merge({},f):m.isArray(f)?f.slice():f}function s(c,f,u,d){if(m.isUndefined(f)){if(!m.isUndefined(c))return n(void 0,c,u,d)}else return n(c,f,u,d)}function o(c,f){if(!m.isUndefined(f))return n(void 0,f)}function i(c,f){if(m.isUndefined(f)){if(!m.isUndefined(c))return n(void 0,c)}else return n(void 0,f)}function a(c,f,u){if(u in e)return n(c,f);if(u in t)return n(void 0,c)}let l={url:o,method:o,data:o,baseURL:i,transformRequest:i,transformResponse:i,paramsSerializer:i,timeout:i,timeoutMessage:i,withCredentials:i,withXSRFToken:i,adapter:i,responseType:i,xsrfCookieName:i,xsrfHeaderName:i,onUploadProgress:i,onDownloadProgress:i,decompress:i,maxContentLength:i,maxBodyLength:i,beforeRedirect:i,transport:i,httpAgent:i,httpsAgent:i,cancelToken:i,socketPath:i,responseEncoding:i,validateStatus:a,headers:(c,f,u)=>s(ju(c),ju(f),u,!0)};return m.forEach(Object.keys(Object.assign({},t,e)),function(f){let u=l[f]||s,d=u(t[f],e[f],f);m.isUndefined(d)&&u!==a||(r[f]=d)}),r}var po=t=>{let e=Ne({},t),{data:r,withXSRFToken:n,xsrfHeaderName:s,xsrfCookieName:o,headers:i,auth:a}=e;e.headers=i=X.from(i),e.url=Jn(Yn(e.baseURL,e.url),t.params,t.paramsSerializer),a&&i.set("Authorization","Basic "+btoa((a.username||"")+":"+(a.password?unescape(encodeURIComponent(a.password)):"")));let l;if(m.isFormData(r)){if(V.hasStandardBrowserEnv||V.hasStandardBrowserWebWorkerEnv)i.setContentType(void 0);else if((l=i.getContentType())!==!1){let[c,...f]=l?l.split(";").map(u=>u.trim()).filter(Boolean):[];i.setContentType([c||"multipart/form-data",...f].join("; "))}}if(V.hasStandardBrowserEnv&&(n&&m.isFunction(n)&&(n=n(e)),n||n!==!1&&Uu(e.url))){let c=s&&o&&Hu.read(o);c&&i.set(s,c)}return e};var Ng=typeof XMLHttpRequest!="undefined",Ku=Ng&&function(t){return new Promise(function(r,n){let s=po(t),o=s.data,i=X.from(s.headers).normalize(),{responseType:a,onUploadProgress:l,onDownloadProgress:c}=s,f,u,d,h,p;function g(){h&&h(),p&&p(),s.cancelToken&&s.cancelToken.unsubscribe(f),s.signal&&s.signal.removeEventListener("abort",f)}let w=new XMLHttpRequest;w.open(s.method.toUpperCase(),s.url,!0),w.timeout=s.timeout;function b(){if(!w)return;let C=X.from("getAllResponseHeaders"in w&&w.getAllResponseHeaders()),E={data:!a||a==="text"||a==="json"?w.responseText:w.response,status:w.status,statusText:w.statusText,headers:C,config:t,request:w};Xn(function(P){r(P),g()},function(P){n(P),g()},E),w=null}"onloadend"in w?w.onloadend=b:w.onreadystatechange=function(){!w||w.readyState!==4||w.status===0&&!(w.responseURL&&w.responseURL.indexOf("file:")===0)||setTimeout(b)},w.onabort=function(){w&&(n(new O("Request aborted",O.ECONNABORTED,t,w)),w=null)},w.onerror=function(){n(new O("Network Error",O.ERR_NETWORK,t,w)),w=null},w.ontimeout=function(){let R=s.timeout?"timeout of "+s.timeout+"ms exceeded":"timeout exceeded",E=s.transitional||uo;s.timeoutErrorMessage&&(R=s.timeoutErrorMessage),n(new O(R,E.clarifyTimeoutError?O.ETIMEDOUT:O.ECONNABORTED,t,w)),w=null},o===void 0&&i.setContentType(null),"setRequestHeader"in w&&m.forEach(i.toJSON(),function(R,E){w.setRequestHeader(E,R)}),m.isUndefined(s.withCredentials)||(w.withCredentials=!!s.withCredentials),a&&a!=="json"&&(w.responseType=s.responseType),c&&([d,p]=Xr(c,!0),w.addEventListener("progress",d)),l&&w.upload&&([u,h]=Xr(l),w.upload.addEventListener("progress",u),w.upload.addEventListener("loadend",h)),(s.cancelToken||s.signal)&&(f=C=>{w&&(n(!C||C.type?new Je(null,t,w):C),w.abort(),w=null)},s.cancelToken&&s.cancelToken.subscribe(f),s.signal&&(s.signal.aborted?f():s.signal.addEventListener("abort",f)));let _=Pa(s.url);if(_&&V.protocols.indexOf(_)===-1){n(new O("Unsupported protocol "+_+":",O.ERR_BAD_REQUEST,t));return}w.send(o||null)})};var Lg=(t,e)=>{let{length:r}=t=t?t.filter(Boolean):[];if(e||r){let n=new AbortController,s,o=function(c){if(!s){s=!0,a();let f=c instanceof Error?c:this.reason;n.abort(f instanceof O?f:new Je(f instanceof Error?f.message:f))}},i=e&&setTimeout(()=>{i=null,o(new O(`timeout ${e} of ms exceeded`,O.ETIMEDOUT))},e),a=()=>{t&&(i&&clearTimeout(i),i=null,t.forEach(c=>{c.unsubscribe?c.unsubscribe(o):c.removeEventListener("abort",o)}),t=null)};t.forEach(c=>c.addEventListener("abort",o));let{signal:l}=n;return l.unsubscribe=()=>m.asap(a),l}},Vu=Lg;var Mg=function*(t,e){let r=t.byteLength;if(!e||r<e){yield t;return}let n=0,s;for(;n<r;)s=n+e,yield t.slice(n,s),n=s},Dg=async function*(t,e){for await(let r of Bg(t))yield*Mg(r,e)},Bg=async function*(t){if(t[Symbol.asyncIterator]){yield*t;return}let e=t.getReader();try{for(;;){let{done:r,value:n}=await e.read();if(r)break;yield n}}finally{await e.cancel()}},Na=(t,e,r,n)=>{let s=Dg(t,e),o=0,i,a=l=>{i||(i=!0,n&&n(l))};return new ReadableStream({async pull(l){try{let{done:c,value:f}=await s.next();if(c){a(),l.close();return}let u=f.byteLength;if(r){let d=o+=u;r(d)}l.enqueue(new Uint8Array(f))}catch(c){throw a(c),c}},cancel(l){return a(l),s.return()}},{highWaterMark:2})};var go=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",Ju=go&&typeof ReadableStream=="function",Fg=go&&(typeof TextEncoder=="function"?(t=>e=>t.encode(e))(new TextEncoder):async t=>new Uint8Array(await new Response(t).arrayBuffer())),$u=(t,...e)=>{try{return!!t(...e)}catch(r){return!1}},qg=Ju&&$u(()=>{let t=!1,e=new Request(V.origin,{body:new ReadableStream,method:"POST",get duplex(){return t=!0,"half"}}).headers.has("Content-Type");return t&&!e}),Wu=64*1024,La=Ju&&$u(()=>m.isReadableStream(new Response("").body)),mo={stream:La&&(t=>t.body)};go&&(t=>{["text","arrayBuffer","blob","formData","stream"].forEach(e=>{!mo[e]&&(mo[e]=m.isFunction(t[e])?r=>r[e]():(r,n)=>{throw new O(`Response type '${e}' is not supported`,O.ERR_NOT_SUPPORT,n)})})})(new Response);var Ug=async t=>{if(t==null)return 0;if(m.isBlob(t))return t.size;if(m.isSpecCompliantForm(t))return(await new Request(V.origin,{method:"POST",body:t}).arrayBuffer()).byteLength;if(m.isArrayBufferView(t)||m.isArrayBuffer(t))return t.byteLength;if(m.isURLSearchParams(t)&&(t=t+""),m.isString(t))return(await Fg(t)).byteLength},Hg=async(t,e)=>{let r=m.toFiniteNumber(t.getContentLength());return r==null?Ug(e):r},Gu=go&&(async t=>{let{url:e,method:r,data:n,signal:s,cancelToken:o,timeout:i,onDownloadProgress:a,onUploadProgress:l,responseType:c,headers:f,withCredentials:u="same-origin",fetchOptions:d}=po(t);c=c?(c+"").toLowerCase():"text";let h=Vu([s,o&&o.toAbortSignal()],i),p,g=h&&h.unsubscribe&&(()=>{h.unsubscribe()}),w;try{if(l&&qg&&r!=="get"&&r!=="head"&&(w=await Hg(f,n))!==0){let E=new Request(e,{method:"POST",body:n,duplex:"half"}),T;if(m.isFormData(n)&&(T=E.headers.get("content-type"))&&f.setContentType(T),E.body){let[P,B]=Oa(w,Xr(Ta(l)));n=Na(E.body,Wu,P,B)}}m.isString(u)||(u=u?"include":"omit");let b="credentials"in Request.prototype;p=new Request(e,{...d,signal:h,method:r.toUpperCase(),headers:f.normalize().toJSON(),body:n,duplex:"half",credentials:b?u:void 0});let _=await fetch(p),C=La&&(c==="stream"||c==="response");if(La&&(a||C&&g)){let E={};["status","statusText","headers"].forEach(k=>{E[k]=_[k]});let T=m.toFiniteNumber(_.headers.get("content-length")),[P,B]=a&&Oa(T,Xr(Ta(a),!0))||[];_=new Response(Na(_.body,Wu,P,()=>{B&&B(),g&&g()}),E)}c=c||"text";let R=await mo[m.findKey(mo,c)||"text"](_,t);return!C&&g&&g(),await new Promise((E,T)=>{Xn(E,T,{data:R,headers:X.from(_.headers),status:_.status,statusText:_.statusText,config:t,request:p})})}catch(b){throw g&&g(),b&&b.name==="TypeError"&&/fetch/i.test(b.message)?Object.assign(new O("Network Error",O.ERR_NETWORK,t,p),{cause:b.cause||b}):O.from(b,b&&b.code,t,p)}});var Ma={http:lo,xhr:Ku,fetch:Gu};m.forEach(Ma,(t,e)=>{if(t){try{Object.defineProperty(t,"name",{value:e})}catch(r){}Object.defineProperty(t,"adapterName",{value:e})}});var zu=t=>`- ${t}`,jg=t=>m.isFunction(t)||t===null||t===!1,yo={getAdapter:t=>{t=m.isArray(t)?t:[t];let{length:e}=t,r,n,s={};for(let o=0;o<e;o++){r=t[o];let i;if(n=r,!jg(r)&&(n=Ma[(i=String(r)).toLowerCase()],n===void 0))throw new O(`Unknown adapter '${i}'`);if(n)break;s[i||"#"+o]=n}if(!n){let o=Object.entries(s).map(([a,l])=>`adapter ${a} `+(l===!1?"is not supported by the environment":"is not available in the build")),i=e?o.length>1?`since :
`+o.map(zu).join(`
`):" "+zu(o[0]):"as no adapter specified";throw new O("There is no suitable adapter to dispatch the request "+i,"ERR_NOT_SUPPORT")}return n},adapters:Ma};function Da(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new Je(null,t)}function wo(t){return Da(t),t.headers=X.from(t.headers),t.data=Gn.call(t,t.transformRequest),["post","put","patch"].indexOf(t.method)!==-1&&t.headers.setContentType("application/x-www-form-urlencoded",!1),yo.getAdapter(t.adapter||Gr.adapter)(t).then(function(n){return Da(t),n.data=Gn.call(t,t.transformResponse,n),n.headers=X.from(n.headers),n},function(n){return zn(n)||(Da(t),n&&n.response&&(n.response.data=Gn.call(t,t.transformResponse,n.response),n.response.headers=X.from(n.response.headers))),Promise.reject(n)})}var _o="1.7.9";var bo={};["object","boolean","number","function","string","symbol"].forEach((t,e)=>{bo[t]=function(n){return typeof n===t||"a"+(e<1?"n ":" ")+t}});var Xu={};bo.transitional=function(e,r,n){function s(o,i){return"[Axios v"+_o+"] Transitional option '"+o+"'"+i+(n?". "+n:"")}return(o,i,a)=>{if(e===!1)throw new O(s(i," has been removed"+(r?" in "+r:"")),O.ERR_DEPRECATED);return r&&!Xu[i]&&(Xu[i]=!0,console.warn(s(i," has been deprecated since v"+r+" and will be removed in the near future"))),e?e(o,i,a):!0}};bo.spelling=function(e){return(r,n)=>(console.warn(`${n} is likely a misspelling of ${e}`),!0)};function Kg(t,e,r){if(typeof t!="object")throw new O("options must be an object",O.ERR_BAD_OPTION_VALUE);let n=Object.keys(t),s=n.length;for(;s-- >0;){let o=n[s],i=e[o];if(i){let a=t[o],l=a===void 0||i(a,o,t);if(l!==!0)throw new O("option "+o+" must be "+l,O.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new O("Unknown option "+o,O.ERR_BAD_OPTION)}}var Qn={assertOptions:Kg,validators:bo};var $e=Qn.validators,Yr=class{constructor(e){this.defaults=e,this.interceptors={request:new Sa,response:new Sa}}async request(e,r){try{return await this._request(e,r)}catch(n){if(n instanceof Error){let s={};Error.captureStackTrace?Error.captureStackTrace(s):s=new Error;let o=s.stack?s.stack.replace(/^.+\n/,""):"";try{n.stack?o&&!String(n.stack).endsWith(o.replace(/^.+\n.+\n/,""))&&(n.stack+=`
`+o):n.stack=o}catch(i){}}throw n}}_request(e,r){typeof e=="string"?(r=r||{},r.url=e):r=e||{},r=Ne(this.defaults,r);let{transitional:n,paramsSerializer:s,headers:o}=r;n!==void 0&&Qn.assertOptions(n,{silentJSONParsing:$e.transitional($e.boolean),forcedJSONParsing:$e.transitional($e.boolean),clarifyTimeoutError:$e.transitional($e.boolean)},!1),s!=null&&(m.isFunction(s)?r.paramsSerializer={serialize:s}:Qn.assertOptions(s,{encode:$e.function,serialize:$e.function},!0)),Qn.assertOptions(r,{baseUrl:$e.spelling("baseURL"),withXsrfToken:$e.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let i=o&&m.merge(o.common,o[r.method]);o&&m.forEach(["delete","get","head","post","put","patch","common"],p=>{delete o[p]}),r.headers=X.concat(i,o);let a=[],l=!0;this.interceptors.request.forEach(function(g){typeof g.runWhen=="function"&&g.runWhen(r)===!1||(l=l&&g.synchronous,a.unshift(g.fulfilled,g.rejected))});let c=[];this.interceptors.response.forEach(function(g){c.push(g.fulfilled,g.rejected)});let f,u=0,d;if(!l){let p=[wo.bind(this),void 0];for(p.unshift.apply(p,a),p.push.apply(p,c),d=p.length,f=Promise.resolve(r);u<d;)f=f.then(p[u++],p[u++]);return f}d=a.length;let h=r;for(u=0;u<d;){let p=a[u++],g=a[u++];try{h=p(h)}catch(w){g.call(this,w);break}}try{f=wo.call(this,h)}catch(p){return Promise.reject(p)}for(u=0,d=c.length;u<d;)f=f.then(c[u++],c[u++]);return f}getUri(e){e=Ne(this.defaults,e);let r=Yn(e.baseURL,e.url);return Jn(r,e.params,e.paramsSerializer)}};m.forEach(["delete","get","head","options"],function(e){Yr.prototype[e]=function(r,n){return this.request(Ne(n||{},{method:e,url:r,data:(n||{}).data}))}});m.forEach(["post","put","patch"],function(e){function r(n){return function(o,i,a){return this.request(Ne(a||{},{method:e,headers:n?{"Content-Type":"multipart/form-data"}:{},url:o,data:i}))}}Yr.prototype[e]=r(),Yr.prototype[e+"Form"]=r(!0)});var Zn=Yr;var es=class{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(o){r=o});let n=this;this.promise.then(s=>{if(!n._listeners)return;let o=n._listeners.length;for(;o-- >0;)n._listeners[o](s);n._listeners=null}),this.promise.then=s=>{let o,i=new Promise(a=>{n.subscribe(a),o=a}).then(s);return i.cancel=function(){n.unsubscribe(o)},i},e(function(o,i,a){n.reason||(n.reason=new Je(o,i,a),r(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;let r=this._listeners.indexOf(e);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){let e=new AbortController,r=n=>{e.abort(n)};return this.subscribe(r),e.signal.unsubscribe=()=>this.unsubscribe(r),e.signal}static source(){let e;return{token:new es(function(s){e=s}),cancel:e}}},Yu=es;function Ba(t){return function(r){return t.apply(null,r)}}function Fa(t){return m.isObject(t)&&t.isAxiosError===!0}var qa={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(qa).forEach(([t,e])=>{qa[e]=t});var Qu=qa;function Zu(t){let e=new Zn(t),r=Kn(Zn.prototype.request,e);return m.extend(r,Zn.prototype,e,{allOwnKeys:!0}),m.extend(r,e,null,{allOwnKeys:!0}),r.create=function(s){return Zu(Ne(t,s))},r}var J=Zu(Gr);J.Axios=Zn;J.CanceledError=Je;J.CancelToken=Yu;J.isCancel=zn;J.VERSION=_o;J.toFormData=Rt;J.AxiosError=O;J.Cancel=J.CanceledError;J.all=function(e){return Promise.all(e)};J.spread=Ba;J.isAxiosError=Fa;J.mergeConfig=Ne;J.AxiosHeaders=X;J.formToJSON=t=>fo(m.isHTMLForm(t)?new FormData(t):t);J.getAdapter=yo.getAdapter;J.HttpStatusCode=Qu;J.default=J;var Pt=J;var{Axios:R1,AxiosError:P1,CanceledError:O1,isCancel:T1,CancelToken:I1,VERSION:k1,all:N1,Cancel:L1,isAxiosError:M1,spread:D1,toFormData:B1,AxiosHeaders:F1,HttpStatusCode:q1,formToJSON:U1,getAdapter:H1,mergeConfig:j1}=Pt;var Vg=t=>async function*(e){let{parameters:r,...n}=t,s={...n,...r},{apiKey:o,baseURL:i,model:a,max_tokens:l}=s;if(!o)throw new Error(y("API key is required"));let[c,f]=e[0].role==="system"?[e[0],e.slice(1)]:[null,e],u={"Content-Type":"application/json","anthropic-version":"2023-06-01","X-Api-Key":o,"anthropic-dangerous-direct-browser-access":"true"},d={model:a,system:c==null?void 0:c.content,max_tokens:l,messages:f,stream:!0},h=await Pt.post(i,d,{headers:u,adapter:"fetch",responseType:"stream",withCredentials:!1}),p=Ot.fromSSEResponse(h,new AbortController);for await(let g of p)if(g.type==="content_block_delta"&&g.delta.type==="text_delta")yield g.delta.text;else if(g.type==="message_delta"&&g.delta.stop_reason!=="end_turn")throw new Error(`Unexpected stop reason: ${g.delta.stop_reason}`)},ef=["claude-3-5-sonnet-latest","claude-3-opus-latest","claude-3-5-haiku-latest"],tf={name:"Claude",defaultOptions:{apiKey:"",baseURL:"https://api.anthropic.com/v1/messages",model:ef[0],max_tokens:8192,parameters:{}},sendRequestFunc:Vg,models:ef,websiteToObtainKey:"https://console.anthropic.com"},Ot=class{constructor(e,r){this.iterator=e;this.controller=r}static fromSSEResponse(e,r){let n=!1;async function*s(){if(n)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");n=!0;let o=!1;try{for await(let i of Wg(e,r)){if(i.event==="completion")try{yield JSON.parse(i.data)}catch(a){throw console.error("Could not parse message into JSON:",i.data),console.error("From chunk:",i.raw),a}if(i.event==="message_start"||i.event==="message_delta"||i.event==="message_stop"||i.event==="content_block_start"||i.event==="content_block_delta"||i.event==="content_block_stop")try{yield JSON.parse(i.data)}catch(a){throw console.error("Could not parse message into JSON:",i.data),console.error("From chunk:",i.raw),a}if(i.event!=="ping"&&i.event==="error"){console.error("Error event from server:",i.data);let a=i.data,c=JSON.parse(a)?void 0:a;throw new Error(c)}}o=!0}catch(i){if(i instanceof Error&&i.name==="AbortError")return;throw i}finally{o||r.abort()}}return new Ot(s,r)}static fromReadableStream(e,r){let n=!1;async function*s(){let i=new Qr,a=rf(e);for await(let l of a)for(let c of i.decode(l))yield c;for(let l of i.flush())yield l}async function*o(){if(n)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");n=!0;let i=!1;try{for await(let a of s())i||a&&(yield JSON.parse(a));i=!0}catch(a){if(a instanceof Error&&a.name==="AbortError")return;throw a}finally{i||r.abort()}}return new Ot(o,r)}[Symbol.asyncIterator](){return this.iterator()}tee(){let e=[],r=[],n=this.iterator(),s=o=>({next:()=>{if(o.length===0){let i=n.next();e.push(i),r.push(i)}return o.shift()}});return[new Ot(()=>s(e),this.controller),new Ot(()=>s(r),this.controller)]}toReadableStream(){let e=this,r,n=new TextEncoder;return new ReadableStream({async start(){r=e[Symbol.asyncIterator]()},async pull(s){try{let{value:o,done:i}=await r.next();if(i)return s.close();let a=n.encode(JSON.stringify(o)+`
`);s.enqueue(a)}catch(o){s.error(o)}},async cancel(){var s;await((s=r.return)==null?void 0:s.call(r))}})}};async function*Wg(t,e){if(!t.data)throw e.abort(),new Error("Attempted to iterate over a response with no data");let r=new Ua,n=new Qr,s=rf(t.data);for await(let o of Jg(s))for(let i of n.decode(o)){let a=r.decode(i);a&&(yield a)}for(let o of n.flush()){if(o.startsWith('{"type":"error"'))throw new Error(o);let i=r.decode(o);i&&(yield i)}}async function*Jg(t){let e=new Uint8Array;for await(let r of t){if(r==null)continue;let n=r instanceof ArrayBuffer?new Uint8Array(r):typeof r=="string"?new TextEncoder().encode(r):r,s=new Uint8Array(e.length+n.length);s.set(e),s.set(n,e.length),e=s;let o;for(;(o=$g(e))!==-1;)yield e.slice(0,o),e=e.slice(o)}e.length>0&&(yield e)}function $g(t){for(let n=0;n<t.length-2;n++){if(t[n]===10&&t[n+1]===10||t[n]===13&&t[n+1]===13)return n+2;if(t[n]===13&&t[n+1]===10&&n+3<t.length&&t[n+2]===13&&t[n+3]===10)return n+4}return-1}var Ua=class{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;let i={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],i}if(this.chunks.push(e),e.startsWith(":"))return null;let[r,n,s]=Gg(e,":"),o=s.startsWith(" ")?s.substring(1):s;return r==="event"?this.event=o:r==="data"&&this.data.push(o),null}},So=class{constructor(){this.buffer=[],this.trailingCR=!1}decode(e){let r=this.decodeText(e);if(this.trailingCR&&(r="\r"+r,this.trailingCR=!1),r.endsWith("\r")&&(this.trailingCR=!0,r=r.slice(0,-1)),!r)return[];let n=So.NEWLINE_CHARS.has(r[r.length-1]||""),s=r.split(So.NEWLINE_REGEXP);return n&&s.pop(),s.length===1&&!n?(this.buffer.push(s[0]),[]):(this.buffer.length>0&&(s=[this.buffer.join("")+s[0],...s.slice(1)],this.buffer=[]),n||(this.buffer=[s.pop()||""]),s)}decodeText(e){var r;if(e==null)return"";if(typeof e=="string")return e;if(typeof Buffer!="undefined"){if(e instanceof Buffer)return e.toString();if(e instanceof Uint8Array)return Buffer.from(e).toString();throw new Error(`Unexpected: received non-Uint8Array (${e.constructor.name}) stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.`)}if(typeof TextDecoder!="undefined"){if(e instanceof Uint8Array||e instanceof ArrayBuffer)return(r=this.textDecoder)!=null||(this.textDecoder=new TextDecoder("utf8")),this.textDecoder.decode(e);throw new Error(`Unexpected: received non-Uint8Array/ArrayBuffer (${e.constructor.name}) in a web platform. Please report this error.`)}throw new Error("Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.")}flush(){if(!this.buffer.length&&!this.trailingCR)return[];let e=[this.buffer.join("")];return this.buffer=[],this.trailingCR=!1,e}},Qr=So;Qr.NEWLINE_CHARS=new Set([`
`,"\r"]),Qr.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function Gg(t,e){let r=t.indexOf(e);return r!==-1?[t.substring(0,r),e,t.substring(r+e.length)]:[t,"",""]}function rf(t){if(t[Symbol.asyncIterator])return t;let e=t.getReader();return{async next(){try{let r=await e.read();return r!=null&&r.done&&e.releaseLock(),r}catch(r){throw e.releaseLock(),r}},async return(){let r=e.cancel();return e.releaseLock(),await r,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}var zg=`

> [!quote]-  
> `,Xg=`

`,Yg=t=>async function*(e){var d;let{parameters:r,...n}=t,s={...n,...r},{apiKey:o,baseURL:i,model:a,...l}=s;if(!o)throw new Error(y("API key is required"));let f=await new We({apiKey:o,baseURL:i,dangerouslyAllowBrowser:!0}).chat.completions.create({model:a,messages:e,stream:!0,...l}),u=!1;for await(let h of f){h.usage&&h.usage.prompt_tokens&&h.usage.completion_tokens&&console.debug(`Prompt tokens: ${h.usage.prompt_tokens}, completion tokens: ${h.usage.completion_tokens}`);let p=(d=h.choices[0])==null?void 0:d.delta,g=p==null?void 0:p.reasoning_content;if(g)yield(u?"":(u=!0,zg))+g.replace(/\n/g,`
> `);else{let w=u?(u=!1,Xg):"";p!=null&&p.content&&(yield w+(p==null?void 0:p.content))}}},nf=["deepseek-chat","deepseek-coder","deepseek-reasoner"],sf={name:"DeepSeek",defaultOptions:{apiKey:"",baseURL:"https://api.deepseek.com",model:nf[0],parameters:{}},sendRequestFunc:Yg,models:nf,websiteToObtainKey:"https://platform.deepseek.com"};var Eo=require("obsidian");var Qg=t=>async function*(e){let{parameters:r,...n}=t,s={...n,...r},{apiKey:o,baseURL:i,model:a,...l}=s;if(!o)throw new Error(y("API key is required"));if(!a)throw new Error(y("Model is required"));let c={model:a,messages:e,stream:!1,...l};new Eo.Notice(y("This is a non-streaming request, please wait..."),5*1e3),yield(await(0,Eo.requestUrl)({url:i,method:"POST",body:JSON.stringify(c),headers:{Authorization:`Bearer ${o}`,"Content-Type":"application/json"}})).json.choices[0].message.content},of={name:"Doubao",defaultOptions:{apiKey:"",baseURL:"https://ark.cn-beijing.volces.com/api/v3/chat/completions",model:"",parameters:{}},sendRequestFunc:Qg,models:[],websiteToObtainKey:"https://www.volcengine.com"};var af;(function(t){t.STRING="string",t.NUMBER="number",t.INTEGER="integer",t.BOOLEAN="boolean",t.ARRAY="array",t.OBJECT="object"})(af||(af={}));var lf;(function(t){t.LANGUAGE_UNSPECIFIED="language_unspecified",t.PYTHON="python"})(lf||(lf={}));var cf;(function(t){t.OUTCOME_UNSPECIFIED="outcome_unspecified",t.OUTCOME_OK="outcome_ok",t.OUTCOME_FAILED="outcome_failed",t.OUTCOME_DEADLINE_EXCEEDED="outcome_deadline_exceeded"})(cf||(cf={}));var uf=["user","model","function","system"],ff;(function(t){t.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",t.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",t.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",t.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",t.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT"})(ff||(ff={}));var df;(function(t){t.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",t.BLOCK_NONE="BLOCK_NONE"})(df||(df={}));var hf;(function(t){t.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",t.NEGLIGIBLE="NEGLIGIBLE",t.LOW="LOW",t.MEDIUM="MEDIUM",t.HIGH="HIGH"})(hf||(hf={}));var pf;(function(t){t.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",t.SAFETY="SAFETY",t.OTHER="OTHER"})(pf||(pf={}));var ts;(function(t){t.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",t.STOP="STOP",t.MAX_TOKENS="MAX_TOKENS",t.SAFETY="SAFETY",t.RECITATION="RECITATION",t.LANGUAGE="LANGUAGE",t.OTHER="OTHER"})(ts||(ts={}));var mf;(function(t){t.TASK_TYPE_UNSPECIFIED="TASK_TYPE_UNSPECIFIED",t.RETRIEVAL_QUERY="RETRIEVAL_QUERY",t.RETRIEVAL_DOCUMENT="RETRIEVAL_DOCUMENT",t.SEMANTIC_SIMILARITY="SEMANTIC_SIMILARITY",t.CLASSIFICATION="CLASSIFICATION",t.CLUSTERING="CLUSTERING"})(mf||(mf={}));var gf;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.AUTO="AUTO",t.ANY="ANY",t.NONE="NONE"})(gf||(gf={}));var yf;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.MODE_DYNAMIC="MODE_DYNAMIC"})(yf||(yf={}));var ie=class extends Error{constructor(e){super(`[GoogleGenerativeAI Error]: ${e}`)}},Tt=class extends ie{constructor(e,r){super(e),this.response=r}},Co=class extends ie{constructor(e,r,n,s){super(e),this.status=r,this.statusText=n,this.errorDetails=s}},Ge=class extends ie{};var Zg="https://generativelanguage.googleapis.com",ey="v1beta",ty="0.21.0",ry="genai-js",nr;(function(t){t.GENERATE_CONTENT="generateContent",t.STREAM_GENERATE_CONTENT="streamGenerateContent",t.COUNT_TOKENS="countTokens",t.EMBED_CONTENT="embedContent",t.BATCH_EMBED_CONTENTS="batchEmbedContents"})(nr||(nr={}));var Ha=class{constructor(e,r,n,s,o){this.model=e,this.task=r,this.apiKey=n,this.stream=s,this.requestOptions=o}toString(){var e,r;let n=((e=this.requestOptions)===null||e===void 0?void 0:e.apiVersion)||ey,o=`${((r=this.requestOptions)===null||r===void 0?void 0:r.baseUrl)||Zg}/${n}/${this.model}:${this.task}`;return this.stream&&(o+="?alt=sse"),o}};function ny(t){let e=[];return t!=null&&t.apiClient&&e.push(t.apiClient),e.push(`${ry}/${ty}`),e.join(" ")}async function sy(t){var e;let r=new Headers;r.append("Content-Type","application/json"),r.append("x-goog-api-client",ny(t.requestOptions)),r.append("x-goog-api-key",t.apiKey);let n=(e=t.requestOptions)===null||e===void 0?void 0:e.customHeaders;if(n){if(!(n instanceof Headers))try{n=new Headers(n)}catch(s){throw new Ge(`unable to convert customHeaders value ${JSON.stringify(n)} to Headers: ${s.message}`)}for(let[s,o]of n.entries()){if(s==="x-goog-api-key")throw new Ge(`Cannot set reserved header name ${s}`);if(s==="x-goog-api-client")throw new Ge(`Header name ${s} can only be set using the apiClient field`);r.append(s,o)}}return r}async function oy(t,e,r,n,s,o){let i=new Ha(t,e,r,n,o);return{url:i.toString(),fetchOptions:Object.assign(Object.assign({},cy(o)),{method:"POST",headers:await sy(i),body:s})}}async function ss(t,e,r,n,s,o={},i=fetch){let{url:a,fetchOptions:l}=await oy(t,e,r,n,s,o);return iy(a,l,i)}async function iy(t,e,r=fetch){let n;try{n=await r(t,e)}catch(s){ay(s,t)}return n.ok||await ly(n,t),n}function ay(t,e){let r=t;throw t instanceof Co||t instanceof Ge||(r=new ie(`Error fetching from ${e.toString()}: ${t.message}`),r.stack=t.stack),r}async function ly(t,e){let r="",n;try{let s=await t.json();r=s.error.message,s.error.details&&(r+=` ${JSON.stringify(s.error.details)}`,n=s.error.details)}catch(s){}throw new Co(`Error fetching from ${e.toString()}: [${t.status} ${t.statusText}] ${r}`,t.status,t.statusText,n)}function cy(t){let e={};if((t==null?void 0:t.signal)!==void 0||(t==null?void 0:t.timeout)>=0){let r=new AbortController;(t==null?void 0:t.timeout)>=0&&setTimeout(()=>r.abort(),t.timeout),t!=null&&t.signal&&t.signal.addEventListener("abort",()=>{r.abort()}),e.signal=r.signal}return e}function Ka(t){return t.text=()=>{if(t.candidates&&t.candidates.length>0){if(t.candidates.length>1&&console.warn(`This response had ${t.candidates.length} candidates. Returning text from the first candidate only. Access response.candidates directly to use the other candidates.`),vo(t.candidates[0]))throw new Tt(`${It(t)}`,t);return uy(t)}else if(t.promptFeedback)throw new Tt(`Text not available. ${It(t)}`,t);return""},t.functionCall=()=>{if(t.candidates&&t.candidates.length>0){if(t.candidates.length>1&&console.warn(`This response had ${t.candidates.length} candidates. Returning function calls from the first candidate only. Access response.candidates directly to use the other candidates.`),vo(t.candidates[0]))throw new Tt(`${It(t)}`,t);return console.warn("response.functionCall() is deprecated. Use response.functionCalls() instead."),wf(t)[0]}else if(t.promptFeedback)throw new Tt(`Function call not available. ${It(t)}`,t)},t.functionCalls=()=>{if(t.candidates&&t.candidates.length>0){if(t.candidates.length>1&&console.warn(`This response had ${t.candidates.length} candidates. Returning function calls from the first candidate only. Access response.candidates directly to use the other candidates.`),vo(t.candidates[0]))throw new Tt(`${It(t)}`,t);return wf(t)}else if(t.promptFeedback)throw new Tt(`Function call not available. ${It(t)}`,t)},t}function uy(t){var e,r,n,s;let o=[];if(!((r=(e=t.candidates)===null||e===void 0?void 0:e[0].content)===null||r===void 0)&&r.parts)for(let i of(s=(n=t.candidates)===null||n===void 0?void 0:n[0].content)===null||s===void 0?void 0:s.parts)i.text&&o.push(i.text),i.executableCode&&o.push("\n```"+i.executableCode.language+`
`+i.executableCode.code+"\n```\n"),i.codeExecutionResult&&o.push("\n```\n"+i.codeExecutionResult.output+"\n```\n");return o.length>0?o.join(""):""}function wf(t){var e,r,n,s;let o=[];if(!((r=(e=t.candidates)===null||e===void 0?void 0:e[0].content)===null||r===void 0)&&r.parts)for(let i of(s=(n=t.candidates)===null||n===void 0?void 0:n[0].content)===null||s===void 0?void 0:s.parts)i.functionCall&&o.push(i.functionCall);if(o.length>0)return o}var fy=[ts.RECITATION,ts.SAFETY,ts.LANGUAGE];function vo(t){return!!t.finishReason&&fy.includes(t.finishReason)}function It(t){var e,r,n;let s="";if((!t.candidates||t.candidates.length===0)&&t.promptFeedback)s+="Response was blocked",!((e=t.promptFeedback)===null||e===void 0)&&e.blockReason&&(s+=` due to ${t.promptFeedback.blockReason}`),!((r=t.promptFeedback)===null||r===void 0)&&r.blockReasonMessage&&(s+=`: ${t.promptFeedback.blockReasonMessage}`);else if(!((n=t.candidates)===null||n===void 0)&&n[0]){let o=t.candidates[0];vo(o)&&(s+=`Candidate was blocked due to ${o.finishReason}`,o.finishMessage&&(s+=`: ${o.finishMessage}`))}return s}function rs(t){return this instanceof rs?(this.v=t,this):new rs(t)}function dy(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(t,e||[]),s,o=[];return s={},i("next"),i("throw"),i("return"),s[Symbol.asyncIterator]=function(){return this},s;function i(d){n[d]&&(s[d]=function(h){return new Promise(function(p,g){o.push([d,h,p,g])>1||a(d,h)})})}function a(d,h){try{l(n[d](h))}catch(p){u(o[0][3],p)}}function l(d){d.value instanceof rs?Promise.resolve(d.value.v).then(c,f):u(o[0][2],d)}function c(d){a("next",d)}function f(d){a("throw",d)}function u(d,h){d(h),o.shift(),o.length&&a(o[0][0],o[0][1])}}var _f=/^data\: (.*)(?:\n\n|\r\r|\r\n\r\n)/;function hy(t){let e=t.body.pipeThrough(new TextDecoderStream("utf8",{fatal:!0})),r=gy(e),[n,s]=r.tee();return{stream:my(n),response:py(s)}}async function py(t){let e=[],r=t.getReader();for(;;){let{done:n,value:s}=await r.read();if(n)return Ka(yy(e));e.push(s)}}function my(t){return dy(this,arguments,function*(){let r=t.getReader();for(;;){let{value:n,done:s}=yield rs(r.read());if(s)break;yield yield rs(Ka(n))}})}function gy(t){let e=t.getReader();return new ReadableStream({start(n){let s="";return o();function o(){return e.read().then(({value:i,done:a})=>{if(a){if(s.trim()){n.error(new ie("Failed to parse stream"));return}n.close();return}s+=i;let l=s.match(_f),c;for(;l;){try{c=JSON.parse(l[1])}catch(f){n.error(new ie(`Error parsing JSON response: "${l[1]}"`));return}n.enqueue(c),s=s.substring(l[0].length),l=s.match(_f)}return o()})}}})}function yy(t){let e=t[t.length-1],r={promptFeedback:e==null?void 0:e.promptFeedback};for(let n of t){if(n.candidates)for(let s of n.candidates){let o=s.index;if(r.candidates||(r.candidates=[]),r.candidates[o]||(r.candidates[o]={index:s.index}),r.candidates[o].citationMetadata=s.citationMetadata,r.candidates[o].groundingMetadata=s.groundingMetadata,r.candidates[o].finishReason=s.finishReason,r.candidates[o].finishMessage=s.finishMessage,r.candidates[o].safetyRatings=s.safetyRatings,s.content&&s.content.parts){r.candidates[o].content||(r.candidates[o].content={role:s.content.role||"user",parts:[]});let i={};for(let a of s.content.parts)a.text&&(i.text=a.text),a.functionCall&&(i.functionCall=a.functionCall),a.executableCode&&(i.executableCode=a.executableCode),a.codeExecutionResult&&(i.codeExecutionResult=a.codeExecutionResult),Object.keys(i).length===0&&(i.text=""),r.candidates[o].content.parts.push(i)}}n.usageMetadata&&(r.usageMetadata=n.usageMetadata)}return r}async function vf(t,e,r,n){let s=await ss(e,nr.STREAM_GENERATE_CONTENT,t,!0,JSON.stringify(r),n);return hy(s)}async function Cf(t,e,r,n){let o=await(await ss(e,nr.GENERATE_CONTENT,t,!1,JSON.stringify(r),n)).json();return{response:Ka(o)}}function xf(t){if(t!=null){if(typeof t=="string")return{role:"system",parts:[{text:t}]};if(t.text)return{role:"system",parts:[t]};if(t.parts)return t.role?t:{role:"system",parts:t.parts}}}function ns(t){let e=[];if(typeof t=="string")e=[{text:t}];else for(let r of t)typeof r=="string"?e.push({text:r}):e.push(r);return wy(e)}function wy(t){let e={role:"user",parts:[]},r={role:"function",parts:[]},n=!1,s=!1;for(let o of t)"functionResponse"in o?(r.parts.push(o),s=!0):(e.parts.push(o),n=!0);if(n&&s)throw new ie("Within a single message, FunctionResponse cannot be mixed with other type of part in the request for sending chat message.");if(!n&&!s)throw new ie("No content is provided for sending chat message.");return n?e:r}function _y(t,e){var r;let n={model:e==null?void 0:e.model,generationConfig:e==null?void 0:e.generationConfig,safetySettings:e==null?void 0:e.safetySettings,tools:e==null?void 0:e.tools,toolConfig:e==null?void 0:e.toolConfig,systemInstruction:e==null?void 0:e.systemInstruction,cachedContent:(r=e==null?void 0:e.cachedContent)===null||r===void 0?void 0:r.name,contents:[]},s=t.generateContentRequest!=null;if(t.contents){if(s)throw new Ge("CountTokensRequest must have one of contents or generateContentRequest, not both.");n.contents=t.contents}else if(s)n=Object.assign(Object.assign({},n),t.generateContentRequest);else{let o=ns(t);n.contents=[o]}return{generateContentRequest:n}}function bf(t){let e;return t.contents?e=t:e={contents:[ns(t)]},t.systemInstruction&&(e.systemInstruction=xf(t.systemInstruction)),e}function by(t){return typeof t=="string"||Array.isArray(t)?{content:ns(t)}:t}var Sf=["text","inlineData","functionCall","functionResponse","executableCode","codeExecutionResult"],Sy={user:["text","inlineData"],function:["functionResponse"],model:["text","functionCall","executableCode","codeExecutionResult"],system:["text"]};function Ey(t){let e=!1;for(let r of t){let{role:n,parts:s}=r;if(!e&&n!=="user")throw new ie(`First content should be with role 'user', got ${n}`);if(!uf.includes(n))throw new ie(`Each item should include role field. Got ${n} but valid roles are: ${JSON.stringify(uf)}`);if(!Array.isArray(s))throw new ie("Content should have 'parts' property with an array of Parts");if(s.length===0)throw new ie("Each Content should have at least one part");let o={text:0,inlineData:0,functionCall:0,functionResponse:0,fileData:0,executableCode:0,codeExecutionResult:0};for(let a of s)for(let l of Sf)l in a&&(o[l]+=1);let i=Sy[n];for(let a of Sf)if(!i.includes(a)&&o[a]>0)throw new ie(`Content with role '${n}' can't contain '${a}' part`);e=!0}}var Ef="SILENT_ERROR",ja=class{constructor(e,r,n,s={}){this.model=r,this.params=n,this._requestOptions=s,this._history=[],this._sendPromise=Promise.resolve(),this._apiKey=e,n!=null&&n.history&&(Ey(n.history),this._history=n.history)}async getHistory(){return await this._sendPromise,this._history}async sendMessage(e,r={}){var n,s,o,i,a,l;await this._sendPromise;let c=ns(e),f={safetySettings:(n=this.params)===null||n===void 0?void 0:n.safetySettings,generationConfig:(s=this.params)===null||s===void 0?void 0:s.generationConfig,tools:(o=this.params)===null||o===void 0?void 0:o.tools,toolConfig:(i=this.params)===null||i===void 0?void 0:i.toolConfig,systemInstruction:(a=this.params)===null||a===void 0?void 0:a.systemInstruction,cachedContent:(l=this.params)===null||l===void 0?void 0:l.cachedContent,contents:[...this._history,c]},u=Object.assign(Object.assign({},this._requestOptions),r),d;return this._sendPromise=this._sendPromise.then(()=>Cf(this._apiKey,this.model,f,u)).then(h=>{var p;if(h.response.candidates&&h.response.candidates.length>0){this._history.push(c);let g=Object.assign({parts:[],role:"model"},(p=h.response.candidates)===null||p===void 0?void 0:p[0].content);this._history.push(g)}else{let g=It(h.response);g&&console.warn(`sendMessage() was unsuccessful. ${g}. Inspect response object for details.`)}d=h}),await this._sendPromise,d}async sendMessageStream(e,r={}){var n,s,o,i,a,l;await this._sendPromise;let c=ns(e),f={safetySettings:(n=this.params)===null||n===void 0?void 0:n.safetySettings,generationConfig:(s=this.params)===null||s===void 0?void 0:s.generationConfig,tools:(o=this.params)===null||o===void 0?void 0:o.tools,toolConfig:(i=this.params)===null||i===void 0?void 0:i.toolConfig,systemInstruction:(a=this.params)===null||a===void 0?void 0:a.systemInstruction,cachedContent:(l=this.params)===null||l===void 0?void 0:l.cachedContent,contents:[...this._history,c]},u=Object.assign(Object.assign({},this._requestOptions),r),d=vf(this._apiKey,this.model,f,u);return this._sendPromise=this._sendPromise.then(()=>d).catch(h=>{throw new Error(Ef)}).then(h=>h.response).then(h=>{if(h.candidates&&h.candidates.length>0){this._history.push(c);let p=Object.assign({},h.candidates[0].content);p.role||(p.role="model"),this._history.push(p)}else{let p=It(h);p&&console.warn(`sendMessageStream() was unsuccessful. ${p}. Inspect response object for details.`)}}).catch(h=>{h.message!==Ef&&console.error(h)}),d}};async function vy(t,e,r,n){return(await ss(e,nr.COUNT_TOKENS,t,!1,JSON.stringify(r),n)).json()}async function Cy(t,e,r,n){return(await ss(e,nr.EMBED_CONTENT,t,!1,JSON.stringify(r),n)).json()}async function xy(t,e,r,n){let s=r.requests.map(i=>Object.assign(Object.assign({},i),{model:e}));return(await ss(e,nr.BATCH_EMBED_CONTENTS,t,!1,JSON.stringify({requests:s}),n)).json()}var xo=class{constructor(e,r,n={}){this.apiKey=e,this._requestOptions=n,r.model.includes("/")?this.model=r.model:this.model=`models/${r.model}`,this.generationConfig=r.generationConfig||{},this.safetySettings=r.safetySettings||[],this.tools=r.tools,this.toolConfig=r.toolConfig,this.systemInstruction=xf(r.systemInstruction),this.cachedContent=r.cachedContent}async generateContent(e,r={}){var n;let s=bf(e),o=Object.assign(Object.assign({},this._requestOptions),r);return Cf(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:(n=this.cachedContent)===null||n===void 0?void 0:n.name},s),o)}async generateContentStream(e,r={}){var n;let s=bf(e),o=Object.assign(Object.assign({},this._requestOptions),r);return vf(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:(n=this.cachedContent)===null||n===void 0?void 0:n.name},s),o)}startChat(e){var r;return new ja(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:(r=this.cachedContent)===null||r===void 0?void 0:r.name},e),this._requestOptions)}async countTokens(e,r={}){let n=_y(e,{model:this.model,generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:this.cachedContent}),s=Object.assign(Object.assign({},this._requestOptions),r);return vy(this.apiKey,this.model,n,s)}async embedContent(e,r={}){let n=by(e),s=Object.assign(Object.assign({},this._requestOptions),r);return Cy(this.apiKey,this.model,n,s)}async batchEmbedContents(e,r={}){let n=Object.assign(Object.assign({},this._requestOptions),r);return xy(this.apiKey,this.model,e,n)}};var Ao=class{constructor(e){this.apiKey=e}getGenerativeModel(e,r){if(!e.model)throw new ie("Must provide a model name. Example: genai.getGenerativeModel({ model: 'my-model-name' })");return new xo(this.apiKey,e,r)}getGenerativeModelFromCachedContent(e,r,n){if(!e.name)throw new Ge("Cached content must contain a `name` field.");if(!e.model)throw new Ge("Cached content must contain a `model` field.");let s=["model","systemInstruction"];for(let i of s)if(r!=null&&r[i]&&e[i]&&(r==null?void 0:r[i])!==e[i]){if(i==="model"){let a=r.model.startsWith("models/")?r.model.replace("models/",""):r.model,l=e.model.startsWith("models/")?e.model.replace("models/",""):e.model;if(a===l)continue}throw new Ge(`Different value for "${i}" specified in modelParams (${r[i]}) and cachedContent (${e[i]})`)}let o=Object.assign(Object.assign({},r),{model:e.model,tools:e.tools,toolConfig:e.toolConfig,systemInstruction:e.systemInstruction,cachedContent:e});return new xo(this.apiKey,o,n)}};var Ay=t=>async function*(e){let{parameters:r,...n}=t,s={...n,...r},{apiKey:o,baseURL:i,model:a}=s;if(!o)throw new Error(y("API key is required"));let[l,c,f]=e[0].role==="system"?[e[0],e.slice(1,-1),e[e.length-1]]:[null,e.slice(0,-1),e[e.length-1]],u=l==null?void 0:l.content,d=c.map(b=>({role:b.role==="assistant"?"model":b.role,parts:[{text:b.content}]})),w=await new Ao(o).getGenerativeModel({model:a,systemInstruction:u},{baseUrl:i}).startChat({history:d}).sendMessageStream(f.content);for await(let b of w.stream)yield b.text()},Af={name:"Gemini",defaultOptions:{apiKey:"",baseURL:"https://generativelanguage.googleapis.com",model:"gemini-1.5-flash",parameters:{}},sendRequestFunc:Ay,models:[],websiteToObtainKey:"https://makersuite.google.com/app/apikey"};var Ry=t=>async function*(e){let{parameters:r,...n}=t,s={...n,...r},{apiKey:o,baseURL:i,model:a,...l}=s;if(!o)throw new Error(y("API key is required"));if(!a)throw new Error(y("Model is required"));let c={model:a,messages:e,stream:!0,...l},u=(await Pt.post(i,c,{headers:{Authorization:`Bearer ${o}`,"Content-Type":"application/json"},adapter:"fetch",responseType:"stream",withCredentials:!1})).data.pipeThrough(new TextDecoderStream).getReader(),d=!0;for(;d;){let{done:h,value:p}=await u.read();if(h){d=!1;break}let g=p.split(`
`);for(let w of g){if(w.includes("data: [DONE]")){d=!1;break}let b=w.replace(/^data: /,"").trim();if(b){let _=JSON.parse(b);_.choices&&_.choices[0].delta&&_.choices[0].delta.content&&(yield _.choices[0].delta.content)}}}},Rf=["moonshot-v1-128k","moonshot-v1-32k","moonshot-v1-8k"],Pf={name:"Kimi",defaultOptions:{apiKey:"",baseURL:"https://api.moonshot.cn/v1/chat/completions",model:Rf[0],parameters:{}},sendRequestFunc:Ry,models:Rf,websiteToObtainKey:"https://www.moonshot.cn"};var re=typeof globalThis!="undefined"&&globalThis||typeof self!="undefined"&&self||typeof global!="undefined"&&global||{},fe={searchParams:"URLSearchParams"in re,iterable:"Symbol"in re&&"iterator"in Symbol,blob:"FileReader"in re&&"Blob"in re&&function(){try{return new Blob,!0}catch(t){return!1}}(),formData:"FormData"in re,arrayBuffer:"ArrayBuffer"in re};function Py(t){return t&&DataView.prototype.isPrototypeOf(t)}fe.arrayBuffer&&(Of=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],If=ArrayBuffer.isView||function(t){return t&&Of.indexOf(Object.prototype.toString.call(t))>-1});var Of,If;function Zr(t){if(typeof t!="string"&&(t=String(t)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(t)||t==="")throw new TypeError('Invalid character in header field name: "'+t+'"');return t.toLowerCase()}function Wa(t){return typeof t!="string"&&(t=String(t)),t}function Ja(t){var e={next:function(){var r=t.shift();return{done:r===void 0,value:r}}};return fe.iterable&&(e[Symbol.iterator]=function(){return e}),e}function Y(t){this.map={},t instanceof Y?t.forEach(function(e,r){this.append(r,e)},this):Array.isArray(t)?t.forEach(function(e){if(e.length!=2)throw new TypeError("Headers constructor: expected name/value pair to be length 2, found"+e.length);this.append(e[0],e[1])},this):t&&Object.getOwnPropertyNames(t).forEach(function(e){this.append(e,t[e])},this)}Y.prototype.append=function(t,e){t=Zr(t),e=Wa(e);var r=this.map[t];this.map[t]=r?r+", "+e:e};Y.prototype.delete=function(t){delete this.map[Zr(t)]};Y.prototype.get=function(t){return t=Zr(t),this.has(t)?this.map[t]:null};Y.prototype.has=function(t){return this.map.hasOwnProperty(Zr(t))};Y.prototype.set=function(t,e){this.map[Zr(t)]=Wa(e)};Y.prototype.forEach=function(t,e){for(var r in this.map)this.map.hasOwnProperty(r)&&t.call(e,this.map[r],r,this)};Y.prototype.keys=function(){var t=[];return this.forEach(function(e,r){t.push(r)}),Ja(t)};Y.prototype.values=function(){var t=[];return this.forEach(function(e){t.push(e)}),Ja(t)};Y.prototype.entries=function(){var t=[];return this.forEach(function(e,r){t.push([r,e])}),Ja(t)};fe.iterable&&(Y.prototype[Symbol.iterator]=Y.prototype.entries);function Va(t){if(!t._noBody){if(t.bodyUsed)return Promise.reject(new TypeError("Already read"));t.bodyUsed=!0}}function kf(t){return new Promise(function(e,r){t.onload=function(){e(t.result)},t.onerror=function(){r(t.error)}})}function Oy(t){var e=new FileReader,r=kf(e);return e.readAsArrayBuffer(t),r}function Ty(t){var e=new FileReader,r=kf(e),n=/charset=([A-Za-z0-9_-]+)/.exec(t.type),s=n?n[1]:"utf-8";return e.readAsText(t,s),r}function Iy(t){for(var e=new Uint8Array(t),r=new Array(e.length),n=0;n<e.length;n++)r[n]=String.fromCharCode(e[n]);return r.join("")}function Tf(t){if(t.slice)return t.slice(0);var e=new Uint8Array(t.byteLength);return e.set(new Uint8Array(t)),e.buffer}function Nf(){return this.bodyUsed=!1,this._initBody=function(t){this.bodyUsed=this.bodyUsed,this._bodyInit=t,t?typeof t=="string"?this._bodyText=t:fe.blob&&Blob.prototype.isPrototypeOf(t)?this._bodyBlob=t:fe.formData&&FormData.prototype.isPrototypeOf(t)?this._bodyFormData=t:fe.searchParams&&URLSearchParams.prototype.isPrototypeOf(t)?this._bodyText=t.toString():fe.arrayBuffer&&fe.blob&&Py(t)?(this._bodyArrayBuffer=Tf(t.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):fe.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(t)||If(t))?this._bodyArrayBuffer=Tf(t):this._bodyText=t=Object.prototype.toString.call(t):(this._noBody=!0,this._bodyText=""),this.headers.get("content-type")||(typeof t=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):fe.searchParams&&URLSearchParams.prototype.isPrototypeOf(t)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},fe.blob&&(this.blob=function(){var t=Va(this);if(t)return t;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))}),this.arrayBuffer=function(){if(this._bodyArrayBuffer){var t=Va(this);return t||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer))}else{if(fe.blob)return this.blob().then(Oy);throw new Error("could not read as ArrayBuffer")}},this.text=function(){var t=Va(this);if(t)return t;if(this._bodyBlob)return Ty(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(Iy(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},fe.formData&&(this.formData=function(){return this.text().then(Ly)}),this.json=function(){return this.text().then(JSON.parse)},this}var ky=["CONNECT","DELETE","GET","HEAD","OPTIONS","PATCH","POST","PUT","TRACE"];function Ny(t){var e=t.toUpperCase();return ky.indexOf(e)>-1?e:t}function or(t,e){if(!(this instanceof or))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');e=e||{};var r=e.body;if(t instanceof or){if(t.bodyUsed)throw new TypeError("Already read");this.url=t.url,this.credentials=t.credentials,e.headers||(this.headers=new Y(t.headers)),this.method=t.method,this.mode=t.mode,this.signal=t.signal,!r&&t._bodyInit!=null&&(r=t._bodyInit,t.bodyUsed=!0)}else this.url=String(t);if(this.credentials=e.credentials||this.credentials||"same-origin",(e.headers||!this.headers)&&(this.headers=new Y(e.headers)),this.method=Ny(e.method||this.method||"GET"),this.mode=e.mode||this.mode||null,this.signal=e.signal||this.signal||function(){if("AbortController"in re){var o=new AbortController;return o.signal}}(),this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&r)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(r),(this.method==="GET"||this.method==="HEAD")&&(e.cache==="no-store"||e.cache==="no-cache")){var n=/([?&])_=[^&]*/;if(n.test(this.url))this.url=this.url.replace(n,"$1_="+new Date().getTime());else{var s=/\?/;this.url+=(s.test(this.url)?"&":"?")+"_="+new Date().getTime()}}}or.prototype.clone=function(){return new or(this,{body:this._bodyInit})};function Ly(t){var e=new FormData;return t.trim().split("&").forEach(function(r){if(r){var n=r.split("="),s=n.shift().replace(/\+/g," "),o=n.join("=").replace(/\+/g," ");e.append(decodeURIComponent(s),decodeURIComponent(o))}}),e}function My(t){var e=new Y,r=t.replace(/\r?\n[\t ]+/g," ");return r.split("\r").map(function(n){return n.indexOf(`
`)===0?n.substr(1,n.length):n}).forEach(function(n){var s=n.split(":"),o=s.shift().trim();if(o){var i=s.join(":").trim();try{e.append(o,i)}catch(a){console.warn("Response "+a.message)}}}),e}Nf.call(or.prototype);function ze(t,e){if(!(this instanceof ze))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');if(e||(e={}),this.type="default",this.status=e.status===void 0?200:e.status,this.status<200||this.status>599)throw new RangeError("Failed to construct 'Response': The status provided (0) is outside the range [200, 599].");this.ok=this.status>=200&&this.status<300,this.statusText=e.statusText===void 0?"":""+e.statusText,this.headers=new Y(e.headers),this.url=e.url||"",this._initBody(t)}Nf.call(ze.prototype);ze.prototype.clone=function(){return new ze(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new Y(this.headers),url:this.url})};ze.error=function(){var t=new ze(null,{status:200,statusText:""});return t.ok=!1,t.status=0,t.type="error",t};var Dy=[301,302,303,307,308];ze.redirect=function(t,e){if(Dy.indexOf(e)===-1)throw new RangeError("Invalid status code");return new ze(null,{status:e,headers:{location:t}})};var sr=re.DOMException;try{new sr}catch(t){sr=function(e,r){this.message=e,this.name=r;var n=Error(e);this.stack=n.stack},sr.prototype=Object.create(Error.prototype),sr.prototype.constructor=sr}function Lf(t,e){return new Promise(function(r,n){var s=new or(t,e);if(s.signal&&s.signal.aborted)return n(new sr("Aborted","AbortError"));var o=new XMLHttpRequest;function i(){o.abort()}o.onload=function(){var c={statusText:o.statusText,headers:My(o.getAllResponseHeaders()||"")};s.url.indexOf("file://")===0&&(o.status<200||o.status>599)?c.status=200:c.status=o.status,c.url="responseURL"in o?o.responseURL:c.headers.get("X-Request-URL");var f="response"in o?o.response:o.responseText;setTimeout(function(){r(new ze(f,c))},0)},o.onerror=function(){setTimeout(function(){n(new TypeError("Network request failed"))},0)},o.ontimeout=function(){setTimeout(function(){n(new TypeError("Network request timed out"))},0)},o.onabort=function(){setTimeout(function(){n(new sr("Aborted","AbortError"))},0)};function a(c){try{return c===""&&re.location.href?re.location.href:c}catch(f){return c}}if(o.open(s.method,a(s.url),!0),s.credentials==="include"?o.withCredentials=!0:s.credentials==="omit"&&(o.withCredentials=!1),"responseType"in o&&(fe.blob?o.responseType="blob":fe.arrayBuffer&&(o.responseType="arraybuffer")),e&&typeof e.headers=="object"&&!(e.headers instanceof Y||re.Headers&&e.headers instanceof re.Headers)){var l=[];Object.getOwnPropertyNames(e.headers).forEach(function(c){l.push(Zr(c)),o.setRequestHeader(c,Wa(e.headers[c]))}),s.headers.forEach(function(c,f){l.indexOf(f)===-1&&o.setRequestHeader(f,c)})}else s.headers.forEach(function(c,f){o.setRequestHeader(f,c)});s.signal&&(s.signal.addEventListener("abort",i),o.onreadystatechange=function(){o.readyState===4&&s.signal.removeEventListener("abort",i)}),o.send(typeof s._bodyInit=="undefined"?null:s._bodyInit)})}Lf.polyfill=!0;re.fetch||(re.fetch=Lf,re.Headers=Y,re.Request=or,re.Response=ze);var By="0.5.13",Df="11434",Bf=`http://127.0.0.1:${Df}`,Fy=Object.defineProperty,qy=(t,e,r)=>e in t?Fy(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,$a=(t,e,r)=>(qy(t,typeof e!="symbol"?e+"":e,r),r),os=class extends Error{constructor(e,r){super(e),this.error=e,this.status_code=r,this.name="ResponseError",Error.captureStackTrace&&Error.captureStackTrace(this,os)}},za=class{constructor(e,r,n){$a(this,"abortController"),$a(this,"itr"),$a(this,"doneCallback"),this.abortController=e,this.itr=r,this.doneCallback=n}abort(){this.abortController.abort()}async*[Symbol.asyncIterator](){for await(let e of this.itr){if("error"in e)throw new Error(e.error);if(yield e,e.done||e.status==="success"){this.doneCallback();return}}throw new Error("Did not receive done or success response in stream.")}},Xa=async t=>{var n;if(t.ok)return;let e=`Error ${t.status}: ${t.statusText}`,r=null;if((n=t.headers.get("content-type"))!=null&&n.includes("application/json"))try{r=await t.json(),e=r.error||e}catch(s){console.log("Failed to parse error response as JSON")}else try{console.log("Getting text from response"),e=await t.text()||e}catch(s){console.log("Failed to get text from error response")}throw new os(e,t.status)};function Uy(){return typeof window!="undefined"&&window.navigator?`${window.navigator.platform.toLowerCase()} Browser/${navigator.userAgent};`:typeof process!="undefined"?`${process.arch} ${process.platform} Node.js/${process.version}`:""}var Ya=async(t,e,r={})=>{let n={"Content-Type":"application/json",Accept:"application/json","User-Agent":`ollama-js/${By} (${Uy()})`};r.headers||(r.headers={});let s=Object.fromEntries(Object.entries(r.headers).filter(([o])=>!Object.keys(n).some(i=>i.toLowerCase()===o.toLowerCase())));return r.headers={...n,...s},t(e,r)},Mf=async(t,e,r)=>{let n=await Ya(t,e,{headers:r==null?void 0:r.headers});return await Xa(n),n},en=async(t,e,r,n)=>{let o=(a=>a!==null&&typeof a=="object"&&!Array.isArray(a))(r)?JSON.stringify(r):r,i=await Ya(t,e,{method:"POST",body:o,signal:n==null?void 0:n.signal,headers:n==null?void 0:n.headers});return await Xa(i),i},Hy=async(t,e,r,n)=>{let s=await Ya(t,e,{method:"DELETE",body:JSON.stringify(r),headers:n==null?void 0:n.headers});return await Xa(s),s},jy=async function*(t){var s;let e=new TextDecoder("utf-8"),r="",n=t.getReader();for(;;){let{done:o,value:i}=await n.read();if(o)break;r+=e.decode(i);let a=r.split(`
`);r=(s=a.pop())!=null?s:"";for(let l of a)try{yield JSON.parse(l)}catch(c){console.warn("invalid json: ",l)}}for(let o of r.split(`
`).filter(i=>i!==""))try{yield JSON.parse(o)}catch(i){console.warn("invalid json: ",o)}},Ky=t=>{if(!t)return Bf;let e=t.includes("://");t.startsWith(":")&&(t=`http://127.0.0.1${t}`,e=!0),e||(t=`http://${t}`);let r=new URL(t),n=r.port;n||(e?n=r.protocol==="https:"?"443":"80":n=Df);let s=`${r.protocol}//${r.hostname}:${n}${r.pathname}`;return s.endsWith("/")&&(s=s.slice(0,-1)),s},Vy=Object.defineProperty,Wy=(t,e,r)=>e in t?Vy(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Ga=(t,e,r)=>(Wy(t,typeof e!="symbol"?e+"":e,r),r),Qa=class{constructor(e){var r,n;Ga(this,"config"),Ga(this,"fetch"),Ga(this,"ongoingStreamedRequests",[]),this.config={host:"",headers:e==null?void 0:e.headers},e!=null&&e.proxy||(this.config.host=Ky((r=e==null?void 0:e.host)!=null?r:Bf)),this.fetch=(n=e==null?void 0:e.fetch)!=null?n:fetch}abort(){for(let e of this.ongoingStreamedRequests)e.abort();this.ongoingStreamedRequests.length=0}async processStreamableRequest(e,r){var o;r.stream=(o=r.stream)!=null?o:!1;let n=`${this.config.host}/api/${e}`;if(r.stream){let i=new AbortController,a=await en(this.fetch,n,r,{signal:i.signal,headers:this.config.headers});if(!a.body)throw new Error("Missing body");let l=jy(a.body),c=new za(i,l,()=>{let f=this.ongoingStreamedRequests.indexOf(c);f>-1&&this.ongoingStreamedRequests.splice(f,1)});return this.ongoingStreamedRequests.push(c),c}return await(await en(this.fetch,n,r,{headers:this.config.headers})).json()}async encodeImage(e){if(typeof e!="string"){let r=new Uint8Array(e),n="",s=r.byteLength;for(let o=0;o<s;o++)n+=String.fromCharCode(r[o]);return btoa(n)}return e}async generate(e){return e.images&&(e.images=await Promise.all(e.images.map(this.encodeImage.bind(this)))),this.processStreamableRequest("generate",e)}async chat(e){if(e.messages)for(let r of e.messages)r.images&&(r.images=await Promise.all(r.images.map(this.encodeImage.bind(this))));return this.processStreamableRequest("chat",e)}async create(e){return this.processStreamableRequest("create",{...e})}async pull(e){return this.processStreamableRequest("pull",{name:e.model,stream:e.stream,insecure:e.insecure})}async push(e){return this.processStreamableRequest("push",{name:e.model,stream:e.stream,insecure:e.insecure})}async delete(e){return await Hy(this.fetch,`${this.config.host}/api/delete`,{name:e.model},{headers:this.config.headers}),{status:"success"}}async copy(e){return await en(this.fetch,`${this.config.host}/api/copy`,{...e},{headers:this.config.headers}),{status:"success"}}async list(){return await(await Mf(this.fetch,`${this.config.host}/api/tags`,{headers:this.config.headers})).json()}async show(e){return await(await en(this.fetch,`${this.config.host}/api/show`,{...e},{headers:this.config.headers})).json()}async embed(e){return await(await en(this.fetch,`${this.config.host}/api/embed`,{...e},{headers:this.config.headers})).json()}async embeddings(e){return await(await en(this.fetch,`${this.config.host}/api/embeddings`,{...e},{headers:this.config.headers})).json()}async ps(){return await(await Mf(this.fetch,`${this.config.host}/api/ps`,{headers:this.config.headers})).json()}},uA=new Qa;var Jy=t=>async function*(e){let{parameters:r,...n}=t,s={...n,...r},{baseURL:o,model:i,...a}=s,c=await new Qa({host:o}).chat({model:i,messages:e,stream:!0,...a});for await(let f of c)yield f.message.content},Ro={name:"Ollama",defaultOptions:{apiKey:"",baseURL:"http://127.0.0.1:11434",model:"llama3.1",parameters:{}},sendRequestFunc:Jy,models:[],websiteToObtainKey:"https://ollama.com"};var $y=t=>async function*(e){var u,d;let{parameters:r,...n}=t,s={...n,...r},{apiKey:o,baseURL:i,model:a,...l}=s;if(!o)throw new Error(y("API key is required"));let f=await new We({apiKey:o,baseURL:i,dangerouslyAllowBrowser:!0}).chat.completions.create({model:a,messages:e,stream:!0,...l});for await(let h of f){let p=(d=(u=h.choices[0])==null?void 0:u.delta)==null?void 0:d.content;p&&(yield p)}},Ff={name:"OpenAI",defaultOptions:{apiKey:"",baseURL:"https://api.openai.com/v1",model:"gpt-4",parameters:{}},sendRequestFunc:$y,models:[],websiteToObtainKey:"https://platform.openai.com/api-keys"};var ir=require("obsidian");var Gy=async(t,e)=>{if(!t||!e)throw new Error("Invalid API key secret");let r={grant_type:"client_credentials",client_id:t,client_secret:e},n=new URLSearchParams(r).toString(),o=(await(0,ir.requestUrl)(`https://aip.baidubce.com/oauth/2.0/token?${n}`)).json;return{accessToken:o.access_token,exp:Date.now()+o.expires_in,apiKey:t,apiSecret:e}},zy=async(t,e,r)=>{let n=Date.now();if(t&&t.apiKey===e&&t.apiSecret===r&&t.exp>n+3*60*1e3)return{isValid:!0,token:t};let s=await Gy(e,r);return console.debug("create new token",s),{isValid:!1,token:s}},Xy=(t,e)=>{let r=e.endsWith(`
`)||e.endsWith("\r"),n=e.split(/\r\n|[\n\r]/g);return n.length===1&&!r?(t.push(n[0]),[]):(t.length>0&&(n=[t.join("")+n[0],...n.slice(1)],t=[]),r||(t=[n.pop()||""]),n)},Yy=t=>async function*(e){let{parameters:r,...n}=t,s={...n,...r},{apiKey:o,apiSecret:i,baseURL:a,model:l,token:c,...f}=s;if(!o)throw new Error(y("API key is required"));if(!i)throw new Error(y("API secret is required"));if(!l)throw new Error(y("Model is required"));let{token:u}=await zy(c,o,i);if(t.token=u,ir.Platform.isDesktopApp){let d={messages:e,stream:!0,...f},h=await Pt.post(a+`/${l}?access_token=${u.accessToken}`,d,{headers:{"Content-Type":"application/json"},adapter:"fetch",responseType:"stream",withCredentials:!1}),p=[],g=new TextDecoder("utf-8");for await(let w of h.data){let b=g.decode(Buffer.from(w)),_=Xy(p,b);for(let C of _)if(C.startsWith("data: ")){let R=C.slice(6),T=JSON.parse(R).result;T&&(yield T)}}}else{let d={messages:e,stream:!1,...f};new ir.Notice(y("This is a non-streaming request, please wait..."),5*1e3);let h=await(0,ir.requestUrl)({url:a+`/${l}?access_token=${u.accessToken}`,method:"POST",body:JSON.stringify(d),headers:{"Content-Type":"application/json"}});console.debug("response",h.json),yield h.json.result}},qf=["ernie-4.0-8k-latest","ernie-4.0-turbo-8k","ernie-3.5-128k","ernie_speed","ernie-speed-128k","gemma_7b_it","yi_34b_chat","mixtral_8x7b_instruct","llama_2_70b"],Uf={name:"QianFan",defaultOptions:{apiKey:"",apiSecret:"",baseURL:"https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat",model:qf[0],parameters:{}},sendRequestFunc:Yy,models:qf,websiteToObtainKey:"https://qianfan.cloud.baidu.com"};var Qy=t=>async function*(e){var u,d;let{parameters:r,...n}=t,s={...n,...r},{apiKey:o,baseURL:i,model:a,...l}=s;if(!o)throw new Error(y("API key is required"));let f=await new We({apiKey:o,baseURL:i,dangerouslyAllowBrowser:!0}).chat.completions.create({model:a,messages:e,stream:!0,...l});for await(let h of f){let p=(d=(u=h.choices[0])==null?void 0:u.delta)==null?void 0:d.content;p&&(yield p)}},Hf=["qwen-turbo","qwen-plus","qwen-max","qwen-max-longcontext"],jf={name:"Qwen",defaultOptions:{apiKey:"",baseURL:"https://dashscope.aliyuncs.com/compatible-mode/v1",model:Hf[0],parameters:{}},sendRequestFunc:Qy,models:Hf,websiteToObtainKey:"https://dashscope.console.aliyun.com"};var Kf=require("obsidian");var Zy=`

> [!quote]-  
> `,ew=`

`,tw=t=>async function*(e){var d;let{parameters:r,...n}=t,s={...n,...r},{apiKey:o,baseURL:i,model:a,...l}=s;if(!o)throw new Error(y("API key is required"));let f=await new We({apiKey:o,baseURL:i,dangerouslyAllowBrowser:!0}).chat.completions.create({model:a,messages:e,stream:!0,...l}),u=!1;for await(let h of f){let p=(d=h.choices[0])==null?void 0:d.delta,g=p==null?void 0:p.reasoning_content;if(g)yield(u?"":(u=!0,Zy))+g.replace(/\n/g,`
> `);else{let w=u?(u=!1,ew):"";p!=null&&p.content&&(yield w+(p==null?void 0:p.content))}}},Po={name:"SiliconFlow",defaultOptions:{apiKey:"",baseURL:"https://api.siliconflow.cn/v1",model:"",parameters:{}},sendRequestFunc:tw,models:[],websiteToObtainKey:"https://siliconflow.cn"},Vf=async t=>(await(0,Kf.requestUrl)({url:"https://api.siliconflow.cn/v1/models?type=text&sub_type=chat",headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"}})).json.data.map(n=>n.id);var tn=crypto,Oo=t=>t instanceof CryptoKey;var it=new TextEncoder,is=new TextDecoder,RA=2**32;function Wf(...t){let e=t.reduce((s,{length:o})=>s+o,0),r=new Uint8Array(e),n=0;for(let s of t)r.set(s,n),n+=s.length;return r}var rw=t=>{let e=t;typeof e=="string"&&(e=it.encode(e));let r=32768,n=[];for(let s=0;s<e.length;s+=r)n.push(String.fromCharCode.apply(null,e.subarray(s,s+r)));return btoa(n.join(""))},To=t=>rw(t).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_"),nw=t=>{let e=atob(t),r=new Uint8Array(e.length);for(let n=0;n<e.length;n++)r[n]=e.charCodeAt(n);return r},Io=t=>{let e=t;e instanceof Uint8Array&&(e=is.decode(e)),e=e.replace(/-/g,"+").replace(/_/g,"/").replace(/\s/g,"");try{return nw(e)}catch(r){throw new TypeError("The input to be decoded is not correctly encoded.")}};var ne=class extends Error{constructor(e,r){var n;super(e,r),this.code="ERR_JOSE_GENERIC",this.name=this.constructor.name,(n=Error.captureStackTrace)==null||n.call(Error,this,this.constructor)}};ne.code="ERR_JOSE_GENERIC";var Za=class extends ne{constructor(e,r,n="unspecified",s="unspecified"){super(e,{cause:{claim:n,reason:s,payload:r}}),this.code="ERR_JWT_CLAIM_VALIDATION_FAILED",this.claim=n,this.reason=s,this.payload=r}};Za.code="ERR_JWT_CLAIM_VALIDATION_FAILED";var el=class extends ne{constructor(e,r,n="unspecified",s="unspecified"){super(e,{cause:{claim:n,reason:s,payload:r}}),this.code="ERR_JWT_EXPIRED",this.claim=n,this.reason=s,this.payload=r}};el.code="ERR_JWT_EXPIRED";var tl=class extends ne{constructor(){super(...arguments),this.code="ERR_JOSE_ALG_NOT_ALLOWED"}};tl.code="ERR_JOSE_ALG_NOT_ALLOWED";var Ce=class extends ne{constructor(){super(...arguments),this.code="ERR_JOSE_NOT_SUPPORTED"}};Ce.code="ERR_JOSE_NOT_SUPPORTED";var rl=class extends ne{constructor(e="decryption operation failed",r){super(e,r),this.code="ERR_JWE_DECRYPTION_FAILED"}};rl.code="ERR_JWE_DECRYPTION_FAILED";var nl=class extends ne{constructor(){super(...arguments),this.code="ERR_JWE_INVALID"}};nl.code="ERR_JWE_INVALID";var at=class extends ne{constructor(){super(...arguments),this.code="ERR_JWS_INVALID"}};at.code="ERR_JWS_INVALID";var as=class extends ne{constructor(){super(...arguments),this.code="ERR_JWT_INVALID"}};as.code="ERR_JWT_INVALID";var sl=class extends ne{constructor(){super(...arguments),this.code="ERR_JWK_INVALID"}};sl.code="ERR_JWK_INVALID";var ol=class extends ne{constructor(){super(...arguments),this.code="ERR_JWKS_INVALID"}};ol.code="ERR_JWKS_INVALID";var il=class extends ne{constructor(e="no applicable key found in the JSON Web Key Set",r){super(e,r),this.code="ERR_JWKS_NO_MATCHING_KEY"}};il.code="ERR_JWKS_NO_MATCHING_KEY";var al=class extends ne{constructor(e="multiple matching keys found in the JSON Web Key Set",r){super(e,r),this.code="ERR_JWKS_MULTIPLE_MATCHING_KEYS"}};al.code="ERR_JWKS_MULTIPLE_MATCHING_KEYS";var ll=class extends ne{constructor(e="request timed out",r){super(e,r),this.code="ERR_JWKS_TIMEOUT"}};ll.code="ERR_JWKS_TIMEOUT";var cl=class extends ne{constructor(e="signature verification failed",r){super(e,r),this.code="ERR_JWS_SIGNATURE_VERIFICATION_FAILED"}};cl.code="ERR_JWS_SIGNATURE_VERIFICATION_FAILED";function lt(t,e="algorithm.name"){return new TypeError(`CryptoKey does not support this operation, its ${e} must be ${t}`)}function ko(t,e){return t.name===e}function ul(t){return parseInt(t.name.slice(4),10)}function sw(t){switch(t){case"ES256":return"P-256";case"ES384":return"P-384";case"ES512":return"P-521";default:throw new Error("unreachable")}}function ow(t,e){if(e.length&&!e.some(r=>t.usages.includes(r))){let r="CryptoKey does not support this operation, its usages must include ";if(e.length>2){let n=e.pop();r+=`one of ${e.join(", ")}, or ${n}.`}else e.length===2?r+=`one of ${e[0]} or ${e[1]}.`:r+=`${e[0]}.`;throw new TypeError(r)}}function Jf(t,e,...r){switch(e){case"HS256":case"HS384":case"HS512":{if(!ko(t.algorithm,"HMAC"))throw lt("HMAC");let n=parseInt(e.slice(2),10);if(ul(t.algorithm.hash)!==n)throw lt(`SHA-${n}`,"algorithm.hash");break}case"RS256":case"RS384":case"RS512":{if(!ko(t.algorithm,"RSASSA-PKCS1-v1_5"))throw lt("RSASSA-PKCS1-v1_5");let n=parseInt(e.slice(2),10);if(ul(t.algorithm.hash)!==n)throw lt(`SHA-${n}`,"algorithm.hash");break}case"PS256":case"PS384":case"PS512":{if(!ko(t.algorithm,"RSA-PSS"))throw lt("RSA-PSS");let n=parseInt(e.slice(2),10);if(ul(t.algorithm.hash)!==n)throw lt(`SHA-${n}`,"algorithm.hash");break}case"EdDSA":{if(t.algorithm.name!=="Ed25519"&&t.algorithm.name!=="Ed448")throw lt("Ed25519 or Ed448");break}case"ES256":case"ES384":case"ES512":{if(!ko(t.algorithm,"ECDSA"))throw lt("ECDSA");let n=sw(e);if(t.algorithm.namedCurve!==n)throw lt(n,"algorithm.namedCurve");break}default:throw new TypeError("CryptoKey does not support this operation")}ow(t,r)}function $f(t,e,...r){var n;if(r=r.filter(Boolean),r.length>2){let s=r.pop();t+=`one of type ${r.join(", ")}, or ${s}.`}else r.length===2?t+=`one of type ${r[0]} or ${r[1]}.`:t+=`of type ${r[0]}.`;return e==null?t+=` Received ${e}`:typeof e=="function"&&e.name?t+=` Received function ${e.name}`:typeof e=="object"&&e!=null&&(n=e.constructor)!=null&&n.name&&(t+=` Received an instance of ${e.constructor.name}`),t}var fl=(t,...e)=>$f("Key must be ",t,...e);function dl(t,e,...r){return $f(`Key for the ${t} algorithm must be `,e,...r)}var hl=t=>Oo(t)?!0:(t==null?void 0:t[Symbol.toStringTag])==="KeyObject",rn=["CryptoKey"];var iw=(...t)=>{let e=t.filter(Boolean);if(e.length===0||e.length===1)return!0;let r;for(let n of e){let s=Object.keys(n);if(!r||r.size===0){r=new Set(s);continue}for(let o of s){if(r.has(o))return!1;r.add(o)}}return!0},Gf=iw;function aw(t){return typeof t=="object"&&t!==null}function ls(t){if(!aw(t)||Object.prototype.toString.call(t)!=="[object Object]")return!1;if(Object.getPrototypeOf(t)===null)return!0;let e=t;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e}var zf=(t,e)=>{if(t.startsWith("RS")||t.startsWith("PS")){let{modulusLength:r}=e.algorithm;if(typeof r!="number"||r<2048)throw new TypeError(`${t} requires key modulusLength to be 2048 bits or larger`)}};function ar(t){return ls(t)&&typeof t.kty=="string"}function Xf(t){return t.kty!=="oct"&&typeof t.d=="string"}function Yf(t){return t.kty!=="oct"&&typeof t.d=="undefined"}function Qf(t){return ar(t)&&t.kty==="oct"&&typeof t.k=="string"}function cw(t){let e,r;switch(t.kty){case"RSA":{switch(t.alg){case"PS256":case"PS384":case"PS512":e={name:"RSA-PSS",hash:`SHA-${t.alg.slice(-3)}`},r=t.d?["sign"]:["verify"];break;case"RS256":case"RS384":case"RS512":e={name:"RSASSA-PKCS1-v1_5",hash:`SHA-${t.alg.slice(-3)}`},r=t.d?["sign"]:["verify"];break;case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":e={name:"RSA-OAEP",hash:`SHA-${parseInt(t.alg.slice(-3),10)||1}`},r=t.d?["decrypt","unwrapKey"]:["encrypt","wrapKey"];break;default:throw new Ce('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}break}case"EC":{switch(t.alg){case"ES256":e={name:"ECDSA",namedCurve:"P-256"},r=t.d?["sign"]:["verify"];break;case"ES384":e={name:"ECDSA",namedCurve:"P-384"},r=t.d?["sign"]:["verify"];break;case"ES512":e={name:"ECDSA",namedCurve:"P-521"},r=t.d?["sign"]:["verify"];break;case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":e={name:"ECDH",namedCurve:t.crv},r=t.d?["deriveBits"]:[];break;default:throw new Ce('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}break}case"OKP":{switch(t.alg){case"EdDSA":e={name:t.crv},r=t.d?["sign"]:["verify"];break;case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":e={name:t.crv},r=t.d?["deriveBits"]:[];break;default:throw new Ce('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}break}default:throw new Ce('Invalid or unsupported JWK "kty" (Key Type) Parameter value')}return{algorithm:e,keyUsages:r}}var uw=async t=>{var o,i;if(!t.alg)throw new TypeError('"alg" argument is required when "jwk.alg" is not present');let{algorithm:e,keyUsages:r}=cw(t),n=[e,(o=t.ext)!=null?o:!1,(i=t.key_ops)!=null?i:r],s={...t};return delete s.alg,delete s.use,tn.subtle.importKey("jwk",s,...n)},Zf=uw;var ed=t=>Io(t),nn,sn,td=t=>(t==null?void 0:t[Symbol.toStringTag])==="KeyObject",No=async(t,e,r,n,s=!1)=>{let o=t.get(e);if(o!=null&&o[n])return o[n];let i=await Zf({...r,alg:n});return s&&Object.freeze(e),o?o[n]=i:t.set(e,{[n]:i}),i},fw=(t,e)=>{if(td(t)){let r=t.export({format:"jwk"});return delete r.d,delete r.dp,delete r.dq,delete r.p,delete r.q,delete r.qi,r.k?ed(r.k):(sn||(sn=new WeakMap),No(sn,t,r,e))}return ar(t)?t.k?Io(t.k):(sn||(sn=new WeakMap),No(sn,t,t,e,!0)):t},dw=(t,e)=>{if(td(t)){let r=t.export({format:"jwk"});return r.k?ed(r.k):(nn||(nn=new WeakMap),No(nn,t,r,e))}return ar(t)?t.k?Io(t.k):(nn||(nn=new WeakMap),No(nn,t,t,e,!0)):t},pl={normalizePublicKey:fw,normalizePrivateKey:dw};var on=t=>t==null?void 0:t[Symbol.toStringTag],ml=(t,e,r)=>{var n,s;if(e.use!==void 0&&e.use!=="sig")throw new TypeError("Invalid key for this operation, when present its use must be sig");if(e.key_ops!==void 0&&((s=(n=e.key_ops).includes)==null?void 0:s.call(n,r))!==!0)throw new TypeError(`Invalid key for this operation, when present its key_ops must include ${r}`);if(e.alg!==void 0&&e.alg!==t)throw new TypeError(`Invalid key for this operation, when present its alg must be ${t}`);return!0},hw=(t,e,r,n)=>{if(!(e instanceof Uint8Array)){if(n&&ar(e)){if(Qf(e)&&ml(t,e,r))return;throw new TypeError('JSON Web Key for symmetric algorithms must have JWK "kty" (Key Type) equal to "oct" and the JWK "k" (Key Value) present')}if(!hl(e))throw new TypeError(dl(t,e,...rn,"Uint8Array",n?"JSON Web Key":null));if(e.type!=="secret")throw new TypeError(`${on(e)} instances for symmetric algorithms must be of type "secret"`)}},pw=(t,e,r,n)=>{if(n&&ar(e))switch(r){case"sign":if(Xf(e)&&ml(t,e,r))return;throw new TypeError("JSON Web Key for this operation be a private JWK");case"verify":if(Yf(e)&&ml(t,e,r))return;throw new TypeError("JSON Web Key for this operation be a public JWK")}if(!hl(e))throw new TypeError(dl(t,e,...rn,n?"JSON Web Key":null));if(e.type==="secret")throw new TypeError(`${on(e)} instances for asymmetric algorithms must not be of type "secret"`);if(r==="sign"&&e.type==="public")throw new TypeError(`${on(e)} instances for asymmetric algorithm signing must be of type "private"`);if(r==="decrypt"&&e.type==="public")throw new TypeError(`${on(e)} instances for asymmetric algorithm decryption must be of type "private"`);if(e.algorithm&&r==="verify"&&e.type==="private")throw new TypeError(`${on(e)} instances for asymmetric algorithm verifying must be of type "public"`);if(e.algorithm&&r==="encrypt"&&e.type==="private")throw new TypeError(`${on(e)} instances for asymmetric algorithm encryption must be of type "public"`)};function rd(t,e,r,n){e.startsWith("HS")||e==="dir"||e.startsWith("PBES2")||/^A\d{3}(?:GCM)?KW$/.test(e)?hw(e,r,n,t):pw(e,r,n,t)}var zA=rd.bind(void 0,!1),nd=rd.bind(void 0,!0);function mw(t,e,r,n,s){if(s.crit!==void 0&&(n==null?void 0:n.crit)===void 0)throw new t('"crit" (Critical) Header Parameter MUST be integrity protected');if(!n||n.crit===void 0)return new Set;if(!Array.isArray(n.crit)||n.crit.length===0||n.crit.some(i=>typeof i!="string"||i.length===0))throw new t('"crit" (Critical) Header Parameter MUST be an array of non-empty strings when present');let o;r!==void 0?o=new Map([...Object.entries(r),...e.entries()]):o=e;for(let i of n.crit){if(!o.has(i))throw new Ce(`Extension Header Parameter "${i}" is not recognized`);if(s[i]===void 0)throw new t(`Extension Header Parameter "${i}" is missing`);if(o.get(i)&&n[i]===void 0)throw new t(`Extension Header Parameter "${i}" MUST be integrity protected`)}return new Set(n.crit)}var sd=mw;function gl(t,e){let r=`SHA-${t.slice(-3)}`;switch(t){case"HS256":case"HS384":case"HS512":return{hash:r,name:"HMAC"};case"PS256":case"PS384":case"PS512":return{hash:r,name:"RSA-PSS",saltLength:t.slice(-3)>>3};case"RS256":case"RS384":case"RS512":return{hash:r,name:"RSASSA-PKCS1-v1_5"};case"ES256":case"ES384":case"ES512":return{hash:r,name:"ECDSA",namedCurve:e.namedCurve};case"EdDSA":return{name:e.name};default:throw new Ce(`alg ${t} is not supported either by JOSE or your javascript runtime`)}}async function yl(t,e,r){if(r==="sign"&&(e=await pl.normalizePrivateKey(e,t)),r==="verify"&&(e=await pl.normalizePublicKey(e,t)),Oo(e))return Jf(e,t,r),e;if(e instanceof Uint8Array){if(!t.startsWith("HS"))throw new TypeError(fl(e,...rn));return tn.subtle.importKey("raw",e,{hash:`SHA-${t.slice(-3)}`,name:"HMAC"},!1,[r])}throw new TypeError(fl(e,...rn,"Uint8Array","JSON Web Key"))}var kt=t=>Math.floor(t.getTime()/1e3);var gw=/^(\+|\-)? ?(\d+|\d+\.\d+) ?(seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)(?: (ago|from now))?$/i,Lo=t=>{let e=gw.exec(t);if(!e||e[4]&&e[1])throw new TypeError("Invalid time period format");let r=parseFloat(e[2]),n=e[3].toLowerCase(),s;switch(n){case"sec":case"secs":case"second":case"seconds":case"s":s=Math.round(r);break;case"minute":case"minutes":case"min":case"mins":case"m":s=Math.round(r*60);break;case"hour":case"hours":case"hr":case"hrs":case"h":s=Math.round(r*3600);break;case"day":case"days":case"d":s=Math.round(r*86400);break;case"week":case"weeks":case"w":s=Math.round(r*604800);break;default:s=Math.round(r*31557600);break}return e[1]==="-"||e[4]==="ago"?-s:s};var yw=async(t,e,r)=>{let n=await yl(t,e,"sign");zf(t,n);let s=await tn.subtle.sign(gl(t,n.algorithm),n,r);return new Uint8Array(s)},od=yw;var Mo=class{constructor(e){if(!(e instanceof Uint8Array))throw new TypeError("payload must be an instance of Uint8Array");this._payload=e}setProtectedHeader(e){if(this._protectedHeader)throw new TypeError("setProtectedHeader can only be called once");return this._protectedHeader=e,this}setUnprotectedHeader(e){if(this._unprotectedHeader)throw new TypeError("setUnprotectedHeader can only be called once");return this._unprotectedHeader=e,this}async sign(e,r){if(!this._protectedHeader&&!this._unprotectedHeader)throw new at("either setProtectedHeader or setUnprotectedHeader must be called before #sign()");if(!Gf(this._protectedHeader,this._unprotectedHeader))throw new at("JWS Protected and JWS Unprotected Header Parameter names must be disjoint");let n={...this._protectedHeader,...this._unprotectedHeader},s=sd(at,new Map([["b64",!0]]),r==null?void 0:r.crit,this._protectedHeader,n),o=!0;if(s.has("b64")&&(o=this._protectedHeader.b64,typeof o!="boolean"))throw new at('The "b64" (base64url-encode payload) Header Parameter must be a boolean');let{alg:i}=n;if(typeof i!="string"||!i)throw new at('JWS "alg" (Algorithm) Header Parameter missing or invalid');nd(i,e,"sign");let a=this._payload;o&&(a=it.encode(To(a)));let l;this._protectedHeader?l=it.encode(To(JSON.stringify(this._protectedHeader))):l=it.encode("");let c=Wf(l,it.encode("."),a),f=await od(i,e,c),u={signature:To(f),payload:""};return o&&(u.payload=is.decode(a)),this._unprotectedHeader&&(u.header=this._unprotectedHeader),this._protectedHeader&&(u.protected=is.decode(l)),u}};var Do=class{constructor(e){this._flattened=new Mo(e)}setProtectedHeader(e){return this._flattened.setProtectedHeader(e),this}async sign(e,r){let n=await this._flattened.sign(e,r);if(n.payload===void 0)throw new TypeError("use the flattened module for creating JWS with b64: false");return`${n.protected}.${n.payload}.${n.signature}`}};function lr(t,e){if(!Number.isFinite(e))throw new TypeError(`Invalid ${t} input`);return e}var Bo=class{constructor(e={}){if(!ls(e))throw new TypeError("JWT Claims Set MUST be an object");this._payload=e}setIssuer(e){return this._payload={...this._payload,iss:e},this}setSubject(e){return this._payload={...this._payload,sub:e},this}setAudience(e){return this._payload={...this._payload,aud:e},this}setJti(e){return this._payload={...this._payload,jti:e},this}setNotBefore(e){return typeof e=="number"?this._payload={...this._payload,nbf:lr("setNotBefore",e)}:e instanceof Date?this._payload={...this._payload,nbf:lr("setNotBefore",kt(e))}:this._payload={...this._payload,nbf:kt(new Date)+Lo(e)},this}setExpirationTime(e){return typeof e=="number"?this._payload={...this._payload,exp:lr("setExpirationTime",e)}:e instanceof Date?this._payload={...this._payload,exp:lr("setExpirationTime",kt(e))}:this._payload={...this._payload,exp:kt(new Date)+Lo(e)},this}setIssuedAt(e){return typeof e=="undefined"?this._payload={...this._payload,iat:kt(new Date)}:e instanceof Date?this._payload={...this._payload,iat:lr("setIssuedAt",kt(e))}:typeof e=="string"?this._payload={...this._payload,iat:lr("setIssuedAt",kt(new Date)+Lo(e))}:this._payload={...this._payload,iat:lr("setIssuedAt",e)},this}};var cs=class extends Bo{setProtectedHeader(e){return this._protectedHeader=e,this}async sign(e,r){var s;let n=new Do(it.encode(JSON.stringify(this._payload)));if(n.setProtectedHeader(this._protectedHeader),Array.isArray((s=this._protectedHeader)==null?void 0:s.crit)&&this._protectedHeader.crit.includes("b64")&&this._protectedHeader.b64===!1)throw new as("JWTs MUST NOT use unencoded payload");return n.sign(e,r)}};var _w=t=>async function*(e){var w,b;let{parameters:r,...n}=t,s={...n,...r},{apiKey:o,baseURL:i,model:a,token:l,tokenExpireInMinutes:c,enableWebSearch:f,...u}=s;if(!o)throw new Error(y("API key is required"));console.debug("zhipu options",{baseURL:i,apiKey:o,model:a,currentToken:l,tokenExpireInMinutes:c,enableWebSearch:f});let{token:d}=await Sw(l,o,c);t.token=d;let h=new We({apiKey:d.id,baseURL:i,dangerouslyAllowBrowser:!0}),p=f?[{type:"web_search",web_search:{enable:!0}}]:[],g=await h.chat.completions.create({model:a,messages:e,stream:!0,tools:p,...u});for await(let _ of g){let C=(b=(w=_.choices[0])==null?void 0:w.delta)==null?void 0:b.content;C&&(yield C)}},bw=async(t,e)=>{let[r,n]=t.split(".");if(!r||!n)throw new Error('Invalid API key secret, must be in the format "apiKey.apiSecret"');let s=Date.now(),o={api_key:r,exp:s+e*60*1e3,timestamp:s};return{id:await new cs({...o}).setProtectedHeader({alg:"HS256",sign_type:"SIGN"}).sign(new TextEncoder().encode(n)),exp:o.exp,apiKeySecret:t}},Sw=async(t,e,r)=>{let n=Date.now();if(t&&t.apiKeySecret===e&&t.exp>n+3*60*1e3)return{isValid:!0,token:t};let s=await bw(e,r);return console.debug("create new token",s),{isValid:!1,token:s}},id=["glm-4-plus","glm-4-air","glm-4-airx","glm-4-long","glm-4-flash","glm-4-flashx"],Fo={name:"Zhipu",defaultOptions:{apiKey:"",baseURL:"https://open.bigmodel.cn/api/paas/v4/",model:id[0],tokenExpireInMinutes:60*24,enableWebSearch:!1,parameters:{}},sendRequestFunc:_w,models:id,websiteToObtainKey:"https://open.bigmodel.cn/"};var Xe={providers:[],systemTags:["System","\u7CFB\u7EDF"],newChatTags:["NewChat","\u65B0\u5BF9\u8BDD"],userTags:["User","\u6211"],promptTemplates:[],answerDelayInMilliseconds:2e3,confirmRegenerate:!0,advancedCmd:{enableExportToJSONL:!1,enableReplaceTag:!1}},an=[Ff,pu,tf,sf,of,Af,Pf,Ro,Uf,jf,Po,Fo];var ad=["callout"],Le=async(t,e)=>{var d;let r=t.workspace.getActiveFile();if(!r)throw new Error("No active file");let n=t.metadataCache,s=t.vault,o=await s.cachedRead(r),i=r.path,a=n.getFileCache(r);if(!a)throw new Error(y("Waiting for metadata to be ready. Please try again."));let l=((d=a.sections)==null?void 0:d.filter(h=>ad.includes(h.type)))||[],c=(a.tags||[]).filter(h=>!l.some(p=>p.position.start.offset<=h.position.start.offset&&h.position.end.offset<=p.position.end.offset));console.debug("tagsInMeta",c);let f=Aw(a),u={newChatTags:e.newChatTags,userTags:e.userTags,assistantTags:e.providers.map(h=>h.tag),systemTags:e.systemTags};return{appMeta:n,vault:s,fileText:o,filePath:i,tagsInMeta:c,sectionsWithRefer:f,options:u}},Ew=async(t,e)=>{let{appMeta:r,vault:n,filePath:s}=t,{path:o,subpath:i}=(0,qo.parseLinktext)(e);console.debug("path",o,"subpath",i);let a=r.getFirstLinkpathDest(o,s);if(a===null)throw new Error("LinkText broken: "+e.substring(0,20));let l=r.getFileCache(a);if(l===null)throw new Error(`No metadata found: ${o} ${i}`);let c=await n.cachedRead(a);if(i){let f=(0,qo.resolveSubpath)(l,i);if(f===null)throw new Error(`no subpath data found: ${i}`);return c.substring(f.start.offset,f.end?f.end.offset:void 0)}else return c},ld=(t,e,r)=>{let{tagsInMeta:n,sectionsWithRefer:s,options:{userTags:o,assistantTags:i,systemTags:a}}=t,l=n.filter(u=>e<=u.position.start.offset&&u.position.end.offset<=r).map(u=>{let d=u.tag.slice(1).split("/")[0].toLowerCase(),h=o.some(p=>p.toLowerCase()===d)?"user":i.some(p=>p.toLowerCase()===d)?"assistant":a.some(p=>p.toLowerCase()===d)?"system":null;return h!=null?{tag:u.tag,role:h,lowerCaseTag:d,tagRange:[u.position.start.offset,u.position.end.offset],tagLine:u.position.start.line}:null}).filter(u=>u!==null);console.debug("tags",l);let f=l.map((u,d)=>[u.tagRange[0],l[d+1]?l[d+1].tagRange[0]-1:r]).map((u,d)=>({...l[d],contentRange:[l[d].tagRange[1]+2,l[d+1]?l[d+1].tagRange[0]-1:r],sections:s.filter(h=>h.position.end.offset<=u[1]&&(h.position.start.offset<u[0]?h.position.end.offset>u[0]:!0)),line:[l[d].tagLine,l[d+1]?l[d+1].tagLine-1:1/0]}));return console.debug("tagsWithSections",f),f},vw=async(t,e,r)=>{let{fileText:n}=t,s=e.position.start.offset<=r[0]?r[0]:e.position.start.offset,o=e.position.end.offset,a=(await Promise.all(e.refers.map(async l=>({ref:l,text:await Ew(t,l.link)})))).reduce((l,{ref:c,text:f})=>({endOffset:c.position.end.offset,text:l.text+n.slice(l.endOffset,c.position.start.offset)+f}),{endOffset:s,text:""});return{text:a.text+n.slice(a.endOffset,o),range:[s,o]}},cd=async(t,e)=>(await Promise.all(e.sections.map(s=>vw(t,s,e.contentRange)))).map(s=>s.text).join(`

`).trim(),Cw=async(t,e,r)=>{let{tagsInMeta:n,options:{newChatTags:s}}=t,o=n.findLast(c=>s.some(f=>c.tag.slice(1).split("/")[0].toLowerCase()===f.toLowerCase())&&e<=c.position.start.offset&&c.position.end.offset<=r),i=o?o.position.end.offset:e,a=ld(t,i,r);return await Promise.all(a.map(async c=>({...c,content:await cd(t,c)})))},xw=(t,e)=>{let r=t.getCursor("to"),n=e.split(`
`),s={line:r.line+n.length-1,ch:n.length===1?r.ch+e.length:n[n.length-1].length};t.replaceRange(e,r),t.setCursor(s),t.scrollIntoView({from:s,to:s})},Aw=t=>{if(!t.sections)return[];let e=[...t.links||[],...t.embeds||[]].sort((n,s)=>n.position.start.offset-s.position.start.offset),r=t.sections.filter(n=>!ad.includes(n.type)).map(n=>{let s=e.filter(o=>n.position.start.offset<=o.position.start.offset&&o.position.end.offset<=n.position.end.offset);return{...n,refers:s}});return console.debug("sectionsWithRefer",r),r},ud=async t=>{let{tagsInMeta:e,options:{newChatTags:r}}=t,o=[0,...e.filter(l=>r.some(c=>l.tag.slice(1).split("/")[0].toLowerCase()===c.toLowerCase())).flatMap(l=>[l.position.start.offset-1,l.position.end.offset+1]),1/0],i=o.filter((l,c)=>c%2===0).map((l,c)=>({startOffset:l,endOffset:o[c*2+1]}));return console.debug("ranges",i),(await Promise.all(i.map(async l=>{let c=ld(t,l.startOffset,l.endOffset);return Promise.all(c.map(async u=>({...u,content:await cd(t,u)})))}))).filter(l=>l.length>0)},fd=(t,e)=>{let{tagsInMeta:r,sectionsWithRefer:n,options:{systemTags:s,userTags:o,assistantTags:i}}=t,a=[...s,...o,...i],l=r.filter(g=>a.some(w=>g.tag.slice(1).split("/")[0].toLowerCase()===w.toLowerCase()));console.debug("msgTagsInMeta",l);let c=l.findLastIndex(g=>g.position.start.line<=e);if(c<0)return[-1,-1];console.debug("msgTag",l[c]);let f=l[c].position.end.offset+2,u=c+1,d=u<l.length?l[u].position.start.offset:1/0;console.debug("nextTag",l[u]);let h=n.findLast(g=>g.position.end.offset<=d&&g.position.start.line>=e);if(!h)return[-1,-1];let p=h.position.end.offset;return console.debug("startOff",f,"endOffset",p),[f,p]},Rw=t=>`${(t/1e3).toFixed(2)}s`,cr=async(t,e,r,n,s)=>{let o=an.find(g=>g.name===r.vendor);if(!o)throw new Error("No vendor found "+r.vendor);let a=(await Cw(t,0,n)).map(g=>({role:g.role,content:g.content}));console.debug("messages",a);let l=a.last();if(!l||l.role!=="user")throw new Error(y("Please add a user message before generating AI response"));let c=a.filter(g=>g.role==="assistant").length+1,f=o.sendRequestFunc(r.options),u=new Date;s.setText(`Round ${c}:...`);let d="";for await(let g of f(a))xw(e,g),d+=g,s.setText(`Round ${c}: ${d.length}${y("characters")}`);let h=new Date,p=Rw(h.getTime()-u.getTime());if(s.setText(`Round ${c}: ${d.length}${y("characters")} ${p}`),d.length===0)throw new Error(y("No text generated"));console.debug("\u2728 "+y("AI generate")+" \u2728 ",d)};var ur=require("obsidian");var xe=t=>`#${t} : `,ln=t=>`#${t} `,Uo=t=>[t.toLowerCase(),`#${t.toLowerCase()} `,`#${t.toLowerCase()} :`,`#${t.toLowerCase()} \uFF1A`],Ho=class extends ur.EditorSuggest{constructor(r,n,s){super(r);this.app=r,this.settings=n,this.statusBarItem=s}onTrigger(r,n,s){if(r.line>=1&&n.getLine(r.line-1).trim())return null;let o=0,i=n.getLine(r.line),a=this.settings.newChatTags.map(ln);for(let h of a)if(i.startsWith(h)){o=h.length;break}let l=i.slice(o,r.ch),c=l.search(/\S/);if(c===-1)return null;o+=c,l=i.slice(o,r.ch);let f=l.toLowerCase(),u={start:{line:r.line,ch:o},end:{line:r.line,ch:r.ch}};for(let h of this.settings.newChatTags)if(Uo(h).includes(f))return{...u,query:JSON.stringify({type:"newChat",tag:h,replacement:ln(h)})};for(let h of this.settings.userTags)if(Uo(h).includes(f))return{...u,query:JSON.stringify({type:"user",tag:h,replacement:xe(h)})};let d=this.settings.providers.map(h=>h.tag);for(let h of d)if(Uo(h).includes(f))return{...u,query:JSON.stringify({type:"assistant",tag:h,replacement:xe(h)})};for(let h of this.settings.systemTags)if(Uo(h).includes(f))return{...u,query:JSON.stringify({type:"system",tag:h,replacement:xe(h)})};return null}async getSuggestions(r){return[JSON.parse(r.query)]}renderSuggestion(r,n){switch(r.type){case"assistant":{n.createSpan({text:r.replacement+"  \u2728 "+y("AI generate")+" \u2728  "});break}default:n.createSpan({text:r.replacement})}}async selectSuggestion(r,n){if(!this.context)return;let s=this.context.editor;if(s.replaceRange(r.replacement,this.context.start,this.context.end),r.type==="assistant"){console.debug("element",r);try{let o=this.settings.providers.find(l=>l.tag===r.tag);if(!o)throw new Error("No provider found "+r.tag);let i=await Le(this.app,this.settings),a=s.posToOffset(this.context.start);console.debug("endOffset",a),await cr(i,s,o,a,this.statusBarItem),new ur.Notice(y("Text generated successfully"))}catch(o){console.error("error",o),new ur.Notice(`\u{1F534} ${ur.Platform.isDesktopApp?y("Check the developer console for error details. "):""}${o}`,10*1e3)}this.close()}}};var wl=`  
`,Pw=t=>{let e=t.listSelections();if(e.length===0)throw new Error("No selection");if(e.length>1)throw new Error("Multiple selections");return e[0]},cn=(t,e,r)=>{let n=_l(t,e);return Ow(t,e,n,r)},_l=(t,e)=>{let r=Pw(e);console.debug("anchor",r.anchor),console.debug("head",r.head);let n=e.getCursor(),{sections:s}=hd(t);if(!s)return console.debug("No sections"),{from:{line:n.line,ch:0},to:{line:n.line,ch:e.getLine(n.line).length}};let o=e.posToOffset(r.anchor),i=e.posToOffset(r.head),[a,l]=o<i?[o,i]:[i,o],c=s.filter(f=>a<=f.position.end.offset&&f.position.start.offset<=l);return c.length===0?(console.debug("No overlapping sections"),{from:{line:n.line,ch:0},to:{line:n.line,ch:e.getLine(n.line).length}}):{from:{line:c[0].position.start.line,ch:c[0].position.start.col},to:{line:c[c.length-1].position.end.line,ch:c[c.length-1].position.end.col}}},un=(t,e)=>{let{from:r,to:n}=e;return t.getRange(r,n).trim().length===0},fn=(t,e,r)=>{let n=e.line,s="";return e.line>0&&t.getLine(e.line-1).trim().length>0?(s=`
`+r,n+=1):s=r,t.replaceRange(s,e,e),t.setCursor({line:n,ch:t.getLine(n).length}),n},dn=(t,e,r)=>{let{from:n,to:s}=e,o="",i=s.line;n.line>0&&t.getLine(n.line-1).trim().length>0&&n.ch===0?(o=`
`+r,i+=1):o=r,t.replaceRange(o,n,n),t.setCursor({line:i,ch:t.getLine(i).length})},jo=(t,e,r,n)=>{let{to:s}=e;r&&(t.replaceRange("#"+n,r.from,r.to),t.setCursor({line:s.line,ch:t.getLine(s.line).length}))},Ow=(t,e,r,n)=>{let{tags:s}=hd(t);if(!s)return{tagContent:null,role:null,range:r,tagRange:null};let{from:o,to:i}=r,a=s.find(l=>e.posToOffset(o)<=l.position.start.offset&&l.position.end.offset<=e.posToOffset(i));if(a){let l=n.userTags,c=n.providers.map(p=>p.tag),f=n.systemTags,u=n.newChatTags,d=a.tag.slice(1).split("/")[0].toLowerCase();if(u.some(p=>p.toLowerCase()===d)){let p=s.find(g=>a.position.end.offset<=g.position.start.offset&&g.position.end.offset<=e.posToOffset(i));return p?{tagContent:p.tag.slice(1),role:dd(p,{userTags:l,assistantTags:c,systemTags:f,newChatTags:u}),range:{from:e.offsetToPos(a.position.end.offset+1),to:r.to},tagRange:{from:e.offsetToPos(p.position.start.offset),to:e.offsetToPos(p.position.end.offset)}}:{tagContent:a.tag.slice(1),role:null,range:{from:e.offsetToPos(a.position.end.offset+1),to:r.to},tagRange:{from:e.offsetToPos(a.position.start.offset),to:e.offsetToPos(a.position.end.offset)}}}return{tagContent:a.tag.slice(1),role:dd(a,{userTags:l,assistantTags:c,systemTags:f,newChatTags:u}),range:r,tagRange:{from:e.offsetToPos(a.position.start.offset),to:e.offsetToPos(a.position.end.offset)}}}else return{tagContent:null,role:null,range:r,tagRange:null}},dd=(t,e)=>{let{userTags:r,assistantTags:n,systemTags:s,newChatTags:o}=e,i=t.tag.slice(1).split("/")[0].toLowerCase();return r.some(l=>l.toLowerCase()===i)?"user":n.some(l=>l.toLowerCase()===i)?"assistant":s.some(l=>l.toLowerCase()===i)?"system":o.some(l=>l.toLowerCase()===i)?"newChat":null},hd=t=>{let e=t.workspace.getActiveFile();if(!e)throw new Error("No active file");let r=t.metadataCache.getFileCache(e);if(!r)throw new Error(y("Waiting for metadata to be ready. Please try again."));let n=r.tags;return{sections:r.sections,tags:n}},us=(t,e)=>{let r=t.getCursor("to"),n=e.split(`
`),s={line:r.line+n.length-1,ch:n.length===1?r.ch+e.length:n[n.length-1].length};return t.replaceRange(e,r),t.setCursor(s),s.line};var Sl=({id:t,name:e,tag:r},n,s,o)=>({id:t,name:e,editorCallback:async(i,a)=>{try{let l=s.providers.find(g=>g.tag===r);if(!l){new ct.Notice(`Assistant ${r} not found`);return}let c=xe(s.userTags[0]),f=xe(r),{range:u,role:d,tagContent:h,tagRange:p}=cn(n,i,s);if(console.debug("asstTagCmd",{range:u,role:d,tagContent:h,tagRange:p}),un(i,u)){let g=fn(i,u.from,f),w=i.posToOffset({line:g,ch:0}),b=await Le(n,s);await cr(b,i,l,w,o);return}if(d===null){dn(i,u,c),i.setCursor({line:u.to.line,ch:i.getLine(u.to.line).length}),us(i,wl+`
`);let g=await Tw(i,f,s.answerDelayInMilliseconds),w=i.posToOffset({line:g,ch:0}),b=await Le(n,s);await cr(b,i,l,w,o)}else if(d==="assistant")if(s.confirmRegenerate){let g=async()=>{await pd(n,s,o,i,l,u,f)};new bl(n,g).open()}else await pd(n,s,o,i,l,u,f);else{i.setCursor({line:u.to.line,ch:i.getLine(u.to.line).length});let g=us(i,wl+`
`+f),w=i.posToOffset({line:g,ch:0}),b=await Le(n,s);await cr(b,i,l,w,o)}}catch(l){console.error(l),new ct.Notice(`\u{1F534} ${ct.Platform.isDesktopApp?y("Check the developer console for error details. "):""}${l}`,10*1e3)}}}),pd=async(t,e,r,n,s,o,i)=>{n.replaceRange(i,o.from,o.to),n.setCursor({line:o.from.line,ch:n.getLine(o.from.line).length});let a=n.posToOffset({line:o.from.line,ch:0}),l=await Le(t,e);await cr(l,n,s,a,r)},bl=class extends ct.Modal{constructor(r,n){super(r);this.onConfirm=n}onOpen(){let{contentEl:r}=this;r.createEl("h2",{text:y("Regenerate?")}),r.createEl("p",{text:y("This will delete the current response content. You can configure this in settings to not require confirmation.")}),new ct.Setting(r).addButton(n=>n.setButtonText("\u786E\u8BA4").setCta().onClick(async()=>{this.close(),await this.onConfirm()}))}},Tw=async(t,e,r)=>{let n=e.length-2;if(n<=0)throw new Error("mark length must be greater than 2");let s=Math.round(r/n),o=us(t,e[0]+e[1]);for(let i=2;i<e.length;i++)await new Promise(a=>setTimeout(a,s)),o=us(t,e[i]);return o};var hn=require("obsidian");var Ko="export-to-jsonl",fs=(t,e)=>({id:Ko,name:y("Export conversations to JSONL"),callback:async()=>{await Iw(t,e)}}),Iw=async(t,e)=>{var f,u,d;let r=await Le(t,e),n=await ud(r);console.debug("conversations",n);let s=[];try{s=n.map(kw)}catch(h){console.error("error",h),new hn.Notice(`\u{1F534}${y("Error")}: ${h}`,10*1e3);return}if(s.length===0){new hn.Notice(y("No conversation found"));return}let o=s.map(h=>JSON.stringify(h)).join(`
`),i=(u=(f=t.workspace.getActiveFile())==null?void 0:f.parent)==null?void 0:u.path,a=(d=t.workspace.getActiveFile())==null?void 0:d.basename,l=(0,hn.normalizePath)(`${i}/${a}.jsonl`),c=t.vault.getFileByPath(l);c?await t.vault.process(c,h=>o):await t.vault.create(l,o),new hn.Notice(y("Exported to the same directory, Obsidian does not display the JSONL format. Please open with another software."),5*1e3)},kw=t=>{var l,c;let e=t.slice();if(e.length<2)throw new Error("No conversation");let r=null;((l=e.first())==null?void 0:l.role)==="system"&&(r=(c=e.shift())==null?void 0:c.content);let n=[];for(;e.length>0;){let f=e.shift(),u=e.shift();if((f==null?void 0:f.role)!=="user"||(u==null?void 0:u.role)!=="assistant")throw new Error("Invalid message role");if((f==null?void 0:f.content.trim().length)===0||(u==null?void 0:u.content.trim().length)===0)throw new Error("Empty message content");n.push([f.content,u.content])}let s=n.pop();if(!s)throw new Error("No conversation");let[o,i]=s,a={system:r,query:o,response:i,history:n.length>0?n:null};return Object.fromEntries(Object.entries(a).filter(([f,u])=>u!=null))};var Vo=require("obsidian");var El=({id:t,name:e,tag:r})=>({id:t,name:e,editorCallback:async(n,s)=>{try{let o=n.getCursor(),i=ln(r);n.replaceRange(i,o),n.setCursor(o.line,o.ch+i.length)}catch(o){console.error(o),new Vo.Notice(`\u{1F534} ${Vo.Platform.isDesktopApp?y("Check the developer console for error details. "):""}${o}`,10*1e3)}}});var fr=require("obsidian");var Wo="replace-tag",ds=t=>({id:Wo,name:y("Replace speaker with tag"),callback:async()=>{let e=t.workspace.getActiveFile();if(!e)return;let r=await t.vault.cachedRead(e),n=Mw(r);if(n.length<1){new fr.Notice(y("No speaker found"));return}console.debug("twoMostFrequentSpeakers",n);let s=n.map(o=>({original:o.name,count:o.count,newTag:Nw(o.name)}));new vl(t,s,async o=>{await t.vault.process(e,i=>Dw(i,o))}).open()}}),Nw=t=>t.trim().startsWith("#")?t:"#"+t.trim().replace(/\s(?!:)/g,"-"),vl=class extends fr.Modal{constructor(r,n,s){super(r);this.recommendTags=n,this.onSubmit=s}onOpen(){let{contentEl:r}=this;r.createEl("h2",{text:y("Replace speaker with tag")}),r.createEl("p",{text:y("Replace the names of the two most frequently occurring speakers with tag format.")});for(let n of this.recommendTags)new fr.Setting(r).setName(n.original+` (${n.count})`).addText(s=>s.setPlaceholder(n.newTag).setValue(n.newTag).onChange(async o=>{n.newTag=o}));new fr.Setting(r).addButton(n=>n.setButtonText(y("Replace")).setCta().onClick(async()=>{this.close(),await this.onSubmit(this.recommendTags)}))}},Lw=t=>t.reduce((e,r)=>(e[r]=(e[r]||0)+1,e),{}),Mw=t=>{let r=t.split(`
`).map(a=>a.match(/^([\u4e00-\u9fa5a-zA-Z0-9# ]+)([:|]) /g)).flatMap(a=>a||[]);console.debug("allMatches",r);let n=Lw(r),s=Object.entries(n).sort((a,l)=>l[1]-a[1]);console.debug("sortedMatchFrequencies",s);let[o,i]=s.slice(0,2);return!o||!i?[]:[{name:o[0],count:o[1]},{name:i[0],count:i[1]}]},Dw=(t,e)=>(e.forEach(({original:r,newTag:n})=>{t=t.replace(new RegExp(`^${r}`,"g"),`${n}`).replace(new RegExp(`
${r}`,"g"),`
${n}`)}),t);var md=require("obsidian");var Cl=(t,e)=>({id:"select-message-at-cursor",name:y("Select message at cursor"),editorCallback:async(r,n)=>{let s=await Le(t,e),o=r.getCursor("to").line,[i,a]=fd(s,o);if(i===-1||a===-1){new md.Notice(y("No message found at cursor"));return}r.setSelection(r.offsetToPos(i),r.offsetToPos(a))}});var hs=require("obsidian");var xl=({id:t,name:e,tag:r},n,s)=>({id:t,name:e,editorCallback:async(o,i)=>{try{let a=xe(r),{range:l,role:c,tagContent:f,tagRange:u}=cn(n,o,s);if(console.debug("systemTagCmd",{range:l,role:c,tagContent:f,tagRange:u}),un(o,l))return fn(o,l.from,a);if(c===null)return dn(o,l,a);if(c==="system"){if(r!==f&&u)return jo(o,l,u,r)}else o.setSelection(l.from,l.to),new hs.Notice(`${y("Conversion failed. Selected sections is a")} ${y(c)} ${y("message")}`)}catch(a){console.error(a),new hs.Notice(`\u{1F534} ${hs.Platform.isDesktopApp?y("Check the developer console for error details. "):""}${a}`,10*1e3)}}});var Jo=(t,e)=>`${t}#${e}`,Bw=t=>{let[e,r]=t.split("#");return{type:e,tag:r}},Al=t=>{let e=t.newChatTags.map(o=>Jo("newChat",o)),r=t.systemTags.map(o=>Jo("system",o)),n=t.userTags.map(o=>Jo("user",o)),s=t.providers.map(o=>Jo("assistant",o.tag));return[...e,...r,...n,...s]},ps=t=>{let{type:e,tag:r}=Bw(t);return{id:t,name:Fw(e,r),tag:r,role:e}},Fw=(t,e)=>t==="newChat"?ln(e):xe(e);var ms=require("obsidian");var Rl=({id:t,name:e,tag:r},n,s)=>({id:t,name:e,editorCallback:async(o,i)=>{try{let a=xe(r),{range:l,role:c,tagContent:f,tagRange:u}=cn(n,o,s);if(console.debug("userTagCmd",{range:l,role:c,tagContent:f,tagRange:u}),un(o,l))return fn(o,l.from,a);if(c===null)return dn(o,l,a);if(c==="user"){if(r!==f&&u)return jo(o,l,u,r)}else o.setSelection(l.from,l.to),new ms.Notice(`${y("Conversion failed. Selected sections is a")} ${y(c)} ${y("message")}`)}catch(a){console.error(a),new ms.Notice(`\u{1F534} ${ms.Platform.isDesktopApp?y("Check the developer console for error details. "):""}${a}`,10*1e3)}}});var ip=mp(tp()),Oe=require("obsidian");var rp=require("obsidian");var Ai=class extends rp.Modal{constructor(r,n){super(r);this.reporter=n}onOpen(){let{contentEl:r}=this;r.createEl("h1",{text:y("Syntax Error Report")});let n=this.reporter.join(`
`);r.createEl("textarea",{text:n,attr:{style:"width: 100%;",readonly:!0,rows:5}})}onClose(){let{contentEl:r}=this;r.empty()}};var np=async(t,e)=>{let r=t.vault.getFileByPath(e);if(!r)throw new Error("No prompt file found. "+e);let s=t.metadataCache.getFileCache(r);if(!s)throw new Error(y("Waiting for metadata to be ready. Please try again."));console.debug("sections",s.sections);let o=s.sections;if(!o)throw new Error("No sections found. "+e);let i=s.headings;if(!i)throw new Error("No headings found. "+e);let a=await t.vault.cachedRead(r),l=o.reduce((d,h)=>{if(h.type==="thematicBreak")return[...d,[]];let p=d.length-1;return d[p]=[...d[p],h],d},[[]]).filter(d=>d.length>0);console.debug("sectionGroups",l);let c=l.slice(1);console.debug("slides",c);let f=[],u=[];for(let d of c)try{let h=A2(d,i,a);if(f.some(p=>p.title===h.title))throw new Error(`${y("Duplicate title:")} ${h.title}`);f.push(h)}catch(h){u.push(h.message)}return console.debug("promptTemplates",f),console.debug("reporter",u),{promptTemplates:f,reporter:u}},A2=(t,e,r)=>{if(t.length<2)throw new Error(`Line ${t[0].position.start.line+1}, ${y("Expected at least 2 sections, heading and content")}`);if(t[0].type!=="heading")throw new Error(`Line ${t[0].position.start.line+1} - ${t[0].position.end.line+1}, ${y("Expected heading")}`);let n=e.find(c=>c.position.start.line===t[0].position.start.line);if(!n)throw new Error(`Line ${t[0].position.start.line+1}, ${y("Expected heading")}`);let s=n.heading.trim();if(!s)throw new Error(`Line ${n.position.start.line+1}, ${y("Expected heading")}`);let o=t[1].position.start.offset,i=t[t.length-1].position.end.offset,l=r.slice(o,i).trim();return{title:s,template:l}},sp=(t,e)=>{let r=[],n=new Map;return t.forEach(s=>{n.set(s.title,s.template)}),e.forEach(s=>{let o=n.get(s.title);o!==void 0&&o!==s.template&&r.push(s)}),r};var vn="Tars",Os=t=>`Prompt#${t.title}`,bc=t=>t.slice(t.indexOf("#")+1),Sc=(t,e,r,n)=>({id:"LoadTemplateFile",name:y("Load template file: ")+`${vn}/${y("promptFileName")}.md`,callback:async()=>{try{let s=(0,Oe.normalizePath)(`${vn}/${y("promptFileName")}.md`);await R2(t)&&(await op(t,s),await new Promise(c=>setTimeout(c,2e3)));let{promptTemplates:i,reporter:a}=await np(t,s),l=sp(e.promptTemplates,i);l.length>0&&(console.debug("changed",l),new Oe.Notice(y("Templates have been updated: ")+l.map(c=>c.title).join(", "))),e.promptTemplates=i,await r(),n(),a&&a.length>0&&(await op(t,s),new Ai(t,a).open())}catch(s){console.error(s),new Oe.Notice(`\u{1F534} ${Oe.Platform.isDesktopApp?y("Check the developer console for error details. "):""}${s}`,10*1e3)}}}),R2=async t=>{let e=!1;await t.vault.adapter.exists((0,Oe.normalizePath)(vn))||await t.vault.createFolder(vn);let r=(0,Oe.normalizePath)(`${vn}/${y("promptFileName")}.md`);return await t.vault.adapter.exists(r)||(await t.vault.create(r,y("PRESET_PROMPT_TEMPLATES")),new Oe.Notice(y("Create prompt template file")+` ${vn}/${y("promptFileName")}.md`),e=!0),e},op=async(t,e)=>{var r;((r=t.workspace.getActiveFile())==null?void 0:r.path)!=e&&await t.workspace.openLinkText("",e,!0)},Ec=(t,e,r,n)=>({id:t,name:e,editorCallback:async(s,o)=>{try{let i=n.promptTemplates.find(f=>f.title===e);if(!i)throw new Error(`No template found. ${i}`);let a=_l(r,s),{from:l,to:c}=a;s.setSelection(l,c),await new Promise(f=>setTimeout(f,500)),O2(s,i.template)}catch(i){console.error(i),new Oe.Notice(`\u{1F534} ${Oe.Platform.isDesktopApp?y("Check the developer console for error details. "):""}${i}`,10*1e3)}}}),P2=t=>{let e=t.listSelections();if(e.length===0)throw new Error("No selection");if(e.length>1)throw new Error("Multiple selections");return e[0]},O2=(t,e)=>{let r=t.getSelection(),s=ip.default.compile(e,{strict:!1,noEscape:!0})({s:r}),o=s.includes(r)?s:r+s,{anchor:i,head:a}=P2(t);t.replaceRange(o,i,a)};var D=require("obsidian");var ap=require("obsidian"),Ri=class extends ap.FuzzySuggestModal{constructor(r,n,s){super(r);this.models=n,this.onChoose=s}getItems(){return this.models}getItemText(r){return r}renderSuggestion(r,n){let s=r.item,o=0,i=n.createEl("div");for(let a of r.match.matches){let l=s.slice(o,a[0]),c=s.slice(a[0],a[0]+a[1]);i.createEl("span",{text:l}),i.createEl("span",{text:c,attr:{style:"font-weight: bold;"}}),o=a[0]+a[1]}i.createEl("span",{text:s.slice(o)})}onChooseItem(r,n){this.onChoose(r)}};var Pi=class extends D.PluginSettingTab{constructor(r,n){super(r,n);this.createProviderSetting=(r,n,s=!1)=>{let o=an.find(l=>l.name===n.vendor);if(!o)throw new Error("No vendor found "+n.vendor);let{containerEl:i}=this,a=i.createEl("details");a.createEl("summary",{text:lp(n.tag,o.name),cls:"tars-setting-h4"}),a.open=s,this.addTagSection(a,n,r,o.name),o.name!==Ro.name&&this.addAPIkeySection(a,n.options,o.websiteToObtainKey?y("Obtain key from ")+o.websiteToObtainKey:""),"apiSecret"in n.options&&this.addAPISecretOptional(a,n.options),o.name===Po.name?new D.Setting(a).setName(y("Model")).setDesc(y("Select the model to use")).addButton(l=>{l.setButtonText(n.options.model?n.options.model:y("Select the model to use")).onClick(async()=>{if(!n.options.apiKey){new D.Notice(y("Please input API key first"));return}try{let c=await Vf(n.options.apiKey),f=async u=>{n.options.model=u,await this.plugin.saveSettings(),l.setButtonText(u)};new Ri(this.app,c,f).open()}catch(c){new D.Notice("\u{1F534}"+c)}})}):o.models.length>0?this.addModelDropDownSection(a,n.options,o.models):this.addModelTextSection(a,n.options),o.name===Fo.name&&new D.Setting(a).setName(y("Web search")).setDesc(y("Enable web search for AI")).addToggle(l=>l.setValue(n.options.enableWebSearch).onChange(async c=>{n.options.enableWebSearch=c,await this.plugin.saveSettings()})),this.addBaseURLSection(a,n.options,o.defaultOptions.baseURL),"max_tokens"in n.options&&this.addMaxTokensOptional(a,n.options),"endpoint"in n.options&&this.addEndpointOptional(a,n.options),"apiVersion"in n.options&&this.addApiVersionOptional(a,n.options),this.addParametersSection(a,n.options),new D.Setting(a).setName(y("Remove")+" "+o.name).addButton(l=>{l.setWarning().setButtonText(y("Remove")).onClick(async()=>{this.plugin.settings.providers.splice(r,1),await this.plugin.saveSettings(),this.display()})})};this.addTagSection=(r,n,s,o)=>new D.Setting(r).setName(y("tag")).setDesc(y("Trigger AI generation")).addText(i=>i.setPlaceholder(o).setValue(n.tag).onChange(async a=>{let l=a.trim();if(l.length===0||!cp(l))return;if(this.plugin.settings.providers.filter((u,d)=>d!==s).map(u=>u.tag.toLowerCase()).includes(l.toLowerCase())){new D.Notice(y("Keyword for tag must be unique"));return}n.tag=l;let f=r.querySelector("summary");f!=null&&(f.textContent=lp(n.tag,o)),await this.plugin.saveSettings()}));this.addBaseURLSection=(r,n,s)=>new D.Setting(r).setName("baseURL").setDesc(y("Default:")+" "+s).addExtraButton(o=>{o.setIcon("reset").setTooltip(y("Restore default")).onClick(async()=>{n.baseURL=s,await this.plugin.saveSettings(),this.display()})}).addText(o=>o.setValue(n.baseURL).onChange(async i=>{n.baseURL=i,await this.plugin.saveSettings()}));this.addAPIkeySection=(r,n,s="")=>new D.Setting(r).setName("API key").setDesc(s).addText(o=>o.setPlaceholder(y("Enter your key")).setValue(n.apiKey).onChange(async i=>{n.apiKey=i,await this.plugin.saveSettings()}));this.addAPISecretOptional=(r,n,s="")=>new D.Setting(r).setName("API Secret").setDesc(s).addText(o=>o.setPlaceholder("").setValue(n.apiSecret).onChange(async i=>{n.apiSecret=i,await this.plugin.saveSettings()}));this.addModelDropDownSection=(r,n,s)=>new D.Setting(r).setName(y("Model")).setDesc(y("Select the model to use")).addDropdown(o=>o.addOptions(s.reduce((i,a)=>(i[a]=a,i),{})).setValue(n.model).onChange(async i=>{n.model=i,await this.plugin.saveSettings()}));this.addModelTextSection=(r,n)=>new D.Setting(r).setName(y("Model")).setDesc(y("Input the model to use")).addText(s=>s.setPlaceholder("").setValue(n.model).onChange(async o=>{n.model=o,await this.plugin.saveSettings()}));this.addMaxTokensOptional=(r,n)=>new D.Setting(r).setName("Max tokens").setDesc(y("Refer to the technical documentation")).addText(s=>s.setPlaceholder("").setValue(n.max_tokens.toString()).onChange(async o=>{let i=parseInt(o);if(isNaN(i)){new D.Notice(y("Please enter a number"));return}if(i<256){new D.Notice(y("Minimum value is 256"));return}n.max_tokens=i,await this.plugin.saveSettings()}));this.addEndpointOptional=(r,n)=>new D.Setting(r).setName(y("Endpoint")).setDesc("e.g. https://docs-test-001.openai.azure.com/").addText(s=>s.setPlaceholder("").setValue(n.endpoint).onChange(async o=>{let i=o.trim();if(i.length===0)n.endpoint="",await this.plugin.saveSettings();else if(T2(i))n.endpoint=i,await this.plugin.saveSettings();else{new D.Notice(y("Invalid URL"));return}}));this.addApiVersionOptional=(r,n)=>new D.Setting(r).setName(y("API version")).setDesc("e.g. 2024-xx-xx-preview").addText(s=>s.setPlaceholder("").setValue(n.apiVersion).onChange(async o=>{n.apiVersion=o,await this.plugin.saveSettings()}));this.addParametersSection=(r,n)=>new D.Setting(r).setName(y("Override input parameters")).setDesc(y(`Developer feature, in JSON format. For example, if the model list doesn't have the model you want, enter {"model": "your desired model"}`)).addTextArea(s=>s.setPlaceholder("{}").setValue(JSON.stringify(n.parameters)).onChange(async o=>{try{n.parameters=JSON.parse(o),await this.plugin.saveSettings()}catch(i){return}}));this.plugin=n}hide(){this.plugin.buildTagCommands()}display(r=!1){let{containerEl:n}=this;n.empty();let s=an.map(a=>a.name),o=s[0];new D.Setting(n).setName(y("AI assistants")).setHeading(),new D.Setting(n).setName(y("New AI assistant")).setDesc(y("Select assistant from dropdown and click 'Add'. For those compatible with the OpenAI protocol, you can select OpenAI.")).addDropdown(a=>a.addOptions(s.reduce((l,c)=>(l[c]=c,l),{})).setValue(s[0]).onChange(async l=>{o=l})).addButton(a=>{a.setButtonText(y("Add")).onClick(async()=>{var d;let l=(d=an.find(h=>h.name===o))==null?void 0:d.defaultOptions;if(!l)throw new Error("No default options found for "+o);let f=this.plugin.settings.providers.map(h=>h.tag).includes(o)?"":o,u=JSON.parse(JSON.stringify(l));this.plugin.settings.providers.push({tag:f,vendor:o,options:u}),await this.plugin.saveSettings(),this.display(!0)})}),this.plugin.settings.providers.length||new D.Setting(n).setDesc(y("Please add at least one AI assistant to start using the plugin."));for(let[a,l]of this.plugin.settings.providers.entries()){let c=a===this.plugin.settings.providers.length-1;this.createProviderSetting(a,l,c&&r)}n.createEl("br"),new D.Setting(n).setName(y("Message tags")).setDesc(y("Keywords for tags in the text box are separated by spaces")).setHeading(),new D.Setting(n).setName(y("New chat tags")).addExtraButton(a=>{a.setIcon("reset").setTooltip(y("Restore default")).onClick(async()=>{this.plugin.settings.newChatTags=Xe.newChatTags,await this.plugin.saveSettings(),this.display()})}).addText(a=>a.setPlaceholder(Xe.newChatTags.join(" ")).setValue(this.plugin.settings.newChatTags.join(" ")).onChange(async l=>{let c=l.split(" ").filter(f=>f.length>0);vc(c)&&(this.plugin.settings.newChatTags=c,await this.plugin.saveSettings())})),new D.Setting(n).setName(y("User message tags")).addExtraButton(a=>{a.setIcon("reset").setTooltip(y("Restore default")).onClick(async()=>{this.plugin.settings.userTags=Xe.userTags,await this.plugin.saveSettings(),this.display()})}).addText(a=>a.setPlaceholder(Xe.userTags.join(" ")).setValue(this.plugin.settings.userTags.join(" ")).onChange(async l=>{let c=l.split(" ").filter(f=>f.length>0);vc(c)&&(this.plugin.settings.userTags=c,await this.plugin.saveSettings())})),new D.Setting(n).setName(y("System message tags")).addExtraButton(a=>{a.setIcon("reset").setTooltip(y("Restore default")).onClick(async()=>{this.plugin.settings.systemTags=Xe.systemTags,await this.plugin.saveSettings(),this.display()})}).addText(a=>a.setPlaceholder(Xe.systemTags.join(" ")).setValue(this.plugin.settings.systemTags.join(" ")).onChange(async l=>{let c=l.split(" ").filter(f=>f.length>0);vc(c)&&(this.plugin.settings.systemTags=c,await this.plugin.saveSettings())})),new D.Setting(n).setName(y("Confirm before regeneration")).setDesc(y("Confirm before replacing existing assistant responses when using assistant commands")).addToggle(a=>a.setValue(this.plugin.settings.confirmRegenerate).onChange(async l=>{this.plugin.settings.confirmRegenerate=l,await this.plugin.saveSettings()})),n.createEl("br");let i=n.createEl("details");i.createEl("summary",{text:y("Advanced"),cls:"tars-setting-h4"}),new D.Setting(i).setName(y("Delay before answer (Seconds)")).setDesc(y("If you encounter errors with missing user messages, it may be due to the need for more time to parse the messages. Please slightly increase the answer delay time.")).addExtraButton(a=>{a.setIcon("reset").setTooltip(y("Restore default")).onClick(async()=>{this.plugin.settings.answerDelayInMilliseconds=Xe.answerDelayInMilliseconds,await this.plugin.saveSettings(),this.display()})}).addSlider(a=>a.setLimits(1.5,4,.5).setValue(this.plugin.settings.answerDelayInMilliseconds/1e3).setDynamicTooltip().onChange(async l=>{this.plugin.settings.answerDelayInMilliseconds=Math.round(l*1e3),await this.plugin.saveSettings()})),new D.Setting(i).setName(y("Replace tag Command")).setDesc(y("Replace the names of the two most frequently occurring speakers with tag format.")).addToggle(a=>a.setValue(this.plugin.settings.advancedCmd.enableReplaceTag).onChange(async l=>{this.plugin.settings.advancedCmd.enableReplaceTag=l,await this.plugin.saveSettings(),l?this.plugin.addCommand(ds(this.app)):this.plugin.removeCommand(Wo)})),new D.Setting(i).setName(y("Export to JSONL Command")).setDesc(y("Export conversations to JSONL")).addToggle(a=>a.setValue(this.plugin.settings.advancedCmd.enableExportToJSONL).onChange(async l=>{this.plugin.settings.advancedCmd.enableExportToJSONL=l,await this.plugin.saveSettings(),l?this.plugin.addCommand(fs(this.app,this.plugin.settings)):this.plugin.removeCommand(Ko)}))}},lp=(t,e)=>t===e?e:t+" ("+e+")",cp=t=>t.includes("#")?(new D.Notice(y("Keyword for tag must not contain #")),!1):t.includes(" ")?(new D.Notice(y("Keyword for tag must not contain space")),!1):!0,vc=t=>{if(t.length===0)return new D.Notice(y("At least one tag is required")),!1;for(let e of t)if(!cp(e))return!1;return!0},T2=t=>{try{return new URL(t),!0}catch(e){return!1}};var Oi=class extends wr.Plugin{constructor(){super(...arguments);this.tagCmdIds=[];this.promptCmdIds=[]}async onload(){await this.loadSettings(),console.debug("loading Tars plugin..."),this.statusBarItem=this.addStatusBarItem(),this.statusBarItem.setText("Tars"),this.registerEditorSuggest(new Ho(this.app,this.settings,this.statusBarItem)),this.buildTagCommands(!0),this.buildPromptCommands(!0),this.addCommand(Cl(this.app,this.settings)),this.addCommand(Sc(this.app,this.settings,()=>this.saveSettings(),()=>this.buildPromptCommands())),this.settings.advancedCmd.enableReplaceTag&&this.addCommand(ds(this.app)),this.settings.advancedCmd.enableExportToJSONL&&this.addCommand(fs(this.app,this.settings)),this.addSettingTab(new Pi(this.app,this))}onunload(){}addTagCommand(r){let n=ps(r);switch(n.role){case"newChat":this.addCommand(El(n));break;case"system":this.addCommand(xl(n,this.app,this.settings));break;case"user":this.addCommand(Rl(n,this.app,this.settings));break;case"assistant":this.addCommand(Sl(n,this.app,this.settings,this.statusBarItem));break;default:throw new Error("Unknown tag role")}}buildTagCommands(r=!1){let n=Al(this.settings),s=this.tagCmdIds.filter(l=>!n.includes(l));s.forEach(l=>this.removeCommand(l));let o=n.filter(l=>!this.tagCmdIds.includes(l));if(o.forEach(l=>this.addTagCommand(l)),this.tagCmdIds=n,r)return;let i=s.map(l=>ps(l).tag);i.length>0&&(console.debug("Removed commands",i),new wr.Notice(`${y("Removed commands")}: ${i.join(", ")}`));let a=o.map(l=>ps(l).tag);a.length>0&&(console.debug("Added commands",a),new wr.Notice(`${y("Added commands")}: ${a.join(", ")}`))}buildPromptCommands(r=!1){let n=this.settings.promptTemplates.map(Os),s=this.promptCmdIds.filter(l=>!n.includes(l));s.forEach(l=>this.removeCommand(l));let o=this.settings.promptTemplates.filter(l=>!this.promptCmdIds.includes(Os(l)));if(o.forEach(l=>{this.addCommand(Ec(Os(l),l.title,this.app,this.settings))}),this.promptCmdIds=n,r)return;let i=s.map(l=>bc(l));i.length>0&&(console.debug("Removed commands",i),new wr.Notice(`${y("Removed commands")}: ${i.join(", ")}`));let a=o.map(l=>l.title);a.length>0&&(console.debug("Added commands",a),new wr.Notice(`${y("Added commands")}: ${a.join(", ")}`))}async loadSettings(){this.settings=Object.assign({},Xe,await this.loadData())}async saveSettings(){await this.saveData(this.settings)}};
/*! Bundled license information:

@google/generative-ai/dist/index.mjs:
  (**
   * @license
   * Copyright 2024 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@google/generative-ai/dist/index.mjs:
  (**
   * @license
   * Copyright 2024 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
*/

/* nosourcemap */
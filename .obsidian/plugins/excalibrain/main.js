"use strict";var e,t,i,n=require("obsidian");!function(e){e[e.DEFINED=1]="DEFINED",e[e.INFERRED=2]="INFERRED"}(e||(e={})),function(e){e[e.PARENT=0]="PARENT",e[e.CHILD=1]="CHILD",e[e.FRIEND=2]="FRIEND"}(t||(t={})),function(e){e[e.TO=1]="TO",e[e.FROM=2]="FROM",e[e.BOTH=3]="BOTH"}(i||(i={}));const s=(e,t,i)=>{const n=e.metadataCache.getFirstLinkpathDest(t,i);return n?n.path:t},u=(e,t)=>{var i,n,u,r;const a=new Set,o=e.matchAll(/[^[]*\[\[(?<wikiLink>[^#\]\|]*)[^\]]*]]|\[[^\]]*]\((?<mdLink>[^)]*)\)/g);let D;for(;!(D=o.next()).done;){if(null===(n=null===(i=null==D?void 0:D.value)||void 0===i?void 0:i.groups)||void 0===n?void 0:n.wikiLink){const e=s(app,D.value.groups.wikiLink,t.path);e&&a.add(e)}if(null===(r=null===(u=null==D?void 0:D.value)||void 0===u?void 0:u.groups)||void 0===r?void 0:r.mdLink){const e=s(app,decodeURIComponent(D.value.groups.mdLink),t.path);e&&a.add(e)}}return Array.from(a)},r=(e,t,i)=>{const n=[],r=new Set;return i.forEach((i=>{const a=t[i];a&&!r.has(i)&&(r.add(i),((e,t,i)=>{const n=new Set;if(t.values){const r=Array.from(t.values());r.filter((e=>(null==e?void 0:e.type)&&("file"===e.type||"header"===e.type||"block"==e.type))).forEach((t=>{const u=s(e,t.path,i.path);u&&n.add(u)}));const a=u(r.filter((e=>"string"==typeof e)).join(" "),i),o=r.filter((e=>(null==e?void 0:e.values)&&"object"==typeof e&&"string"==typeof e.values[0])).map((t=>s(e,t.values[0],i.path)));
//! currently there is an issue with case sensitivity. DataView retains case sensitivity of links for the front matter, but not the others
return Array.from(n).concat(a).concat(o)}if(t.path){const n=s(e,t.path,i.path);return n?[n]:[]}return"string"==typeof t?u(t,i):[]})(e.app,a,t.file).forEach((e=>n.push({link:e,field:i}))))})),n},a=(e,t)=>{var i,n,s;return e?(null!==(s=null===(n=null===(i=e.file)||void 0===i?void 0:i.tags)||void 0===n?void 0:n.values)&&void 0!==s?s:[]).filter((e=>t.tagStyleList.some((t=>e.startsWith(t)))))[0]:null},o=(e,t)=>e?t.tagNodeStyles[t.tagStyleList.filter((t=>e.startsWith(t)))[0]]:{},D=e=>{console.error(Object.assign({plugin:"ExcaliBrain"},e))};console.log.bind(window.console),console.log.bind(window.console);const l=e=>`data:image/svg+xml;base64,${btoa(unescape(encodeURIComponent(e.replaceAll("&nbsp;"," "))))}`;function c(e){const t=e.lastIndexOf("/"),i=-1==t?e:e.substring(t+1);return{folderpath:n.normalizePath(e.substring(0,t)),filename:i,basename:i.replace(/\.[^/.]+$/,"")}}const d={target:null,isParent:!1,isChild:!1,isFriend:!1,direction:null},h=(e,t)=>e&&t?e+", "+t:e||t,p=(e,t)=>e?e===i.BOTH||e===t?e:i.BOTH:t,g=(t,i)=>t===e.DEFINED?e.DEFINED:t===e.INFERRED?i===e.DEFINED?e.DEFINED:e.INFERRED:i;class F{constructor(t,i,n,s,u=!1,r=!1,a){this.pages=t,this.path=i,this.file=n,this.plugin=s,this.isFolder=u,this.isTag=r,this.name=a,this.dvIndexReady=!1,this.isChild=t=>{const{pi:i,pd:n,ci:s,cd:u,fd:r}=this.getRelationVector(t);return!u||n||r?i||n||!s||u||r?null:e.INFERRED:e.DEFINED},a||(this.name=n?"md"===n.extension?n.basename:n.name:(e=>{const t=e.endsWith(".md"),i=e.substring(e.lastIndexOf("/")+1);return t?i.slice(0,-3):i})(i)),this.mtime=n?n.stat.mtime:null,this.neighbours=new Map}addDVFieldLinksToPage(){var t,n,s;if(this.dvIndexReady||this.isFolder||!this.pages)return;if(this.dvIndexReady=!0,this.isTag){const t=this.plugin.DVAPI.index.etags.getInverse("#"+this.path.substring(4));if(!t)return;return void t.forEach((t=>{const n=this.pages.get(t);n&&(this.neighbours.has(t)||(n.addParent(this,e.DEFINED,i.FROM,"tag-tree"),this.addChild(n,e.DEFINED,i.TO,"tag-tree")))}))}if(!this.file)return;const u=this.plugin.DVAPI.page(this.file.path);if(!u)return;if(this.dvPage=u,!u)return;this.primaryStyleTag=a(this.dvPage,this.plugin.settings),(null!==(s=null===(n=null===(t=u.file)||void 0===t?void 0:t.etags)||void 0===n?void 0:n.values)&&void 0!==s?s:[]).forEach((t=>{t="tag:"+t.substring(1);const n=this.pages.get(t);n&&(this.addParent(n,e.DEFINED,i.FROM,"tag-tree"),n.addChild(this,e.DEFINED,i.TO,"tag-tree"))}));const o=this.plugin.hierarchyLowerCase.parents;r(this.plugin,u,o).forEach((t=>{const n=this.pages.get(t.link);n&&(this.addParent(n,e.DEFINED,i.TO,t.field),n.addChild(this,e.DEFINED,i.FROM,t.field))}));const D=this.plugin.hierarchyLowerCase.children;r(this.plugin,u,D).forEach((t=>{const n=this.pages.get(t.link);n&&(this.addChild(n,e.DEFINED,i.TO,t.field),n.addParent(this,e.DEFINED,i.FROM,t.field))}));const l=this.plugin.hierarchyLowerCase.friends;r(this.plugin,u,l).forEach((t=>{const n=this.pages.get(t.link);n&&(this.addFriend(n,e.DEFINED,i.TO,t.field),n.addFriend(this,e.DEFINED,i.FROM,t.field))}))}getTitle(){var e,t,i,n,s,u;const r=this.file&&this.plugin.settings.renderAlias&&null!==(n=null===(i=null===(t=null===(e=this.dvPage)||void 0===e?void 0:e.file)||void 0===t?void 0:t.aliases)||void 0===i?void 0:i.values)&&void 0!==n?n:[];let a=r.length>0?r[0]:this.name;if("[object Object]"===a&&(a=(null===(s=this.dvPage.aliases)||void 0===s?void 0:s[0])?Object.entries(this.dvPage.aliases[0])[0].join(": "):this.name),(null===(u=this.dvPage)||void 0===u?void 0:u.file)&&this.plugin.customNodeLabel)try{return this.plugin.customNodeLabel(this.dvPage,a)}catch(e){D({fn:this.getTitle,message:"Error executing cutomer node label function. The script is: "+this.plugin.settings.nodeTitleScript,data:this.dvPage,where:"Page.getTitle()",error:e})}return a}getRelationVector(t){return{pi:t.isParent&&t.parentType===e.INFERRED,pd:t.isParent&&t.parentType===e.DEFINED,ci:t.isChild&&t.childType===e.INFERRED,cd:t.isChild&&t.childType===e.DEFINED,fd:!this.plugin.settings.inferAllLinksAsFriends&&t.isFriend||this.plugin.settings.inferAllLinksAsFriends&&t.isFriend&&!(t.parentType===e.DEFINED||t.childType===e.DEFINED)}}getNeighbours(){this.addDVFieldLinksToPage(),this.neighbours.forEach((e=>e.target.addDVFieldLinksToPage()));const{showVirtualNodes:e,showAttachments:t,showFolderNodes:i,showTagNodes:n,showPageNodes:s}=this.plugin.settings;return Array.from(this.neighbours).filter((u=>(e||!u[1].target.isVirtual)&&(t||!u[1].target.isAttachment)&&(i||!u[1].target.isFolder)&&(n||!u[1].target.isTag)&&(s||u[1].target.isFolder||u[1].target.isTag||u[1].target.isAttachment)))}get isVirtual(){return null===this.file&&!this.isFolder&&!this.isTag}get isAttachment(){return!!this.file&&"md"!==this.file.extension}get isMarkdown(){var e;return"md"===(null===(e=this.file)||void 0===e?void 0:e.extension)||!this.file}addParent(e,t,i,n){var s;if(e.path===this.plugin.settings.excalibrainFilepath||e.path===this.path)return;const u=this.neighbours.get(e.path);if(u)return u.isParent=!0,u.parentType=g(u.parentType,t),n&&!(null===(s=u.parentTypeDefinition)||void 0===s?void 0:s.contains(n))&&(u.parentTypeDefinition=h(n,u.parentTypeDefinition)),void(u.direction=p(u.direction,i));this.neighbours.set(e.path,Object.assign(Object.assign({},d),{target:e,isParent:!0,parentType:t,parentTypeDefinition:n,direction:i}))}addChild(e,t,i,n){var s;if(e.path===this.plugin.settings.excalibrainFilepath||e.path===this.path)return;const u=this.neighbours.get(e.path);if(u)return u.isChild=!0,u.childType=g(u.childType,t),n&&!(null===(s=u.childTypeDefinition)||void 0===s?void 0:s.contains(n))&&(u.childTypeDefinition=h(n,u.childTypeDefinition)),void(u.direction=p(u.direction,i));this.neighbours.set(e.path,Object.assign(Object.assign({},d),{target:e,isChild:!0,childType:t,childTypeDefinition:n,direction:i}))}addFriend(e,t,i,n){var s;if(e.path===this.plugin.settings.excalibrainFilepath||e.path===this.path)return;const u=this.neighbours.get(e.path);if(u)return u.isFriend=!0,u.friendType=g(u.friendType,t),n&&!(null===(s=u.friendTypeDefinition)||void 0===s?void 0:s.contains(n))&&(u.friendTypeDefinition=h(n,u.friendTypeDefinition)),void(u.direction=p(u.direction,i));this.neighbours.set(e.path,Object.assign(Object.assign({},d),{target:e,isFriend:!0,friendType:t,friendTypeDefinition:n,direction:i}))}unlinkNeighbour(e){this.neighbours.delete(e)}childrenCount(){return this.getNeighbours().reduce(((t,i)=>{const n=this.isChild(i[1]);return t+(n&&this.plugin.settings.showInferredNodes||n===e.DEFINED?1:0)}),0)}hasChildren(){return this.getNeighbours().some((t=>{const i=this.isChild(t[1]);return i&&this.plugin.settings.showInferredNodes||i===e.DEFINED}))}getChildren(){return this.getNeighbours().filter((t=>{const i=this.isChild(t[1]);return i&&this.plugin.settings.showInferredNodes||i===e.DEFINED})).map((e=>({page:e[1].target,relationType:e[1].childType,typeDefinition:e[1].childTypeDefinition,linkDirection:e[1].direction})))}isParent(t){const{pi:i,pd:n,ci:s,cd:u,fd:r}=this.getRelationVector(t);return u||!n||r?!i||n||s||u||r?null:e.INFERRED:e.DEFINED}parentCount(){return this.getNeighbours().reduce(((t,i)=>{const n=this.isParent(i[1]);return t+(n&&this.plugin.settings.showInferredNodes||n===e.DEFINED?1:0)}),0)}hasParents(){return this.getNeighbours().some((t=>{const i=this.isParent(t[1]);return i&&this.plugin.settings.showInferredNodes||i===e.DEFINED}))}getParents(){return this.getNeighbours().filter((t=>{const i=this.isParent(t[1]);return i&&this.plugin.settings.showInferredNodes||i===e.DEFINED})).map((e=>({page:e[1].target,relationType:e[1].parentType,typeDefinition:e[1].parentTypeDefinition,linkDirection:e[1].direction})))}isFriend(t){const{pi:i,pd:n,ci:s,cd:u,fd:r}=this.getRelationVector(t);return r?e.DEFINED:!i||n||!s||u||r?null:e.INFERRED}friendCount(){return this.getNeighbours().reduce(((t,i)=>{const n=this.isFriend(i[1]);return t+(n&&this.plugin.settings.showInferredNodes||n===e.DEFINED?1:0)}),0)}hasFriends(){return this.getNeighbours().some((t=>{const i=this.isFriend(t[1]);return i&&this.plugin.settings.showInferredNodes||i===e.DEFINED}))}getFriends(){return this.getNeighbours().filter((t=>{const i=this.isFriend(t[1]);return i&&this.plugin.settings.showInferredNodes||i===e.DEFINED})).map((t=>{var i;return{page:t[1].target,relationType:null!==(i=t[1].friendType)&&void 0!==i?i:t[1].parentType===e.DEFINED&&t[1].childType===e.DEFINED?e.DEFINED:e.INFERRED,typeDefinition:t[1].friendTypeDefinition,linkDirection:t[1].direction}}))}getRelationToPage(e){const t=this.neighbours.get(e.path);return t?this.isChild(t)?{type:"child",relationType:t.childType,typeDefinition:t.childTypeDefinition}:this.isParent(t)?{type:"parent",relationType:t.parentType,typeDefinition:t.parentTypeDefinition}:{type:"friend",relationType:t.friendType,typeDefinition:t.friendTypeDefinition}:null}getSiblings(){const t=new Map;return this.getParents().forEach((i=>i.page.getChildren().forEach((i=>{t.has(i.page.path)?i.relationType===e.DEFINED&&(t.get(i.page.path).relationType=e.DEFINED):t.set(i.page.path,i)})))),Array.from(t.values())}}var f="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},E={};Object.defineProperty(E,"__esModule",{value:!0});const m=e=>{try{return window.ExcalidrawAutomate.getAPI(e)}catch(e){return console.log({message:"Excalidraw not available",fn:m}),null}};var C=E.getEA=m;const y="ExcaliBrain",w=["base","inferred","file-tree","tag-tree"],v={strokeColor:"#696969FF",strokeWidth:1,strokeStyle:"solid",roughness:0,startArrowHead:"none",endArrowHead:"none",showLabel:!1,fontSize:10,fontFamily:3,textColor:"#ffffffff"},b={prefix:"",backgroundColor:"#00000066",fillStyle:"solid",textColor:"#ffffffff",borderColor:"#00000000",fontSize:20,fontFamily:3,maxLabelLength:30,roughness:0,strokeShaprness:"round",strokeWidth:1,strokeStyle:"solid",padding:10,gateRadius:5,gateOffset:15,gateStrokeColor:"#ffffffff",gateBackgroundColor:"#ffffffff",gateFillStyle:"solid"};var S={JSON_MALFORMED:"Malformed JSON",JSON_MISSING_KEYS:'JSON must have these 3 keys: "parents", "children", "friends"',JSON_VALUES_NOT_STRING_ARRAYS:'Key values must be a non-empty array of strings. e.g. "parents": ["Parent", "Parents", "up"]',EXCALIBRAIN_FILE_NAME:"Filepath of Excalibrain drawing",EXCALIBRAIN_FILE_DESC:"âš  This file will be overwritten by the plugin. If you stop the script and make changes to the graph, you should rename the file so your edits are preserved, because the next time you initiate ExcaliBrain your edits will be overwritten by the automatically generated ExcaliBrain graph.",INDEX_REFRESH_FREQ_NAME:"Index refresh frequency",INDEX_REFRESH_FREQ_DESC:"ExcaliBrain will update its index whenever you switch work panes, in case a file has changed in your Vault since the last index update. <br>This setting is thus only relevant when you are typing in a markdown editor (not switching files or panes) and you still want ExcaliBrain to update it's graph as you type. Because frequent background index updates can be resource intensive you have an option to increase the time interval for the index-updates which in turn will reduce the overhead on your system.",HIERARCHY_HEAD:"Ontology",HIERARCHY_DESC:"Enter the Dataview field names separated by comma (,) that you will use to define link directions in your graph.<br>You can also add fields to the ontology on the fly from the markdown editor by typing the new field at the beginning of a paragraph (e.g.: 'Consits of::') and then calling one of the command palette actions to <code>Add dataview field to ontology as PARENT</code>, or <code>as CHILD</code>, or <code>as FRIEND</code>",INFER_NAME:"Infer all implicit relationships as Friend",INFER_DESC:"<b>Toggle On:</b> All implicit links in the document are interpreted as FRIENDS.<br><b>Toggle Off:</b> The following logic is used:<ul><li>A forward link is inferred as a CHILD</li><li>A backlink is inferred as a PARENT</li><li>If files mutually link to each other, they are FRIENDS</li></ul>",REVERSE_NAME:"Reverse infer logic",REVERSE_DESC:"<b>Toggle ON:</b> Treat backlinks as children and forward links as parents.<br><b>Toggle OFF:</b> Treat backlinks as parents and forward links as children</b>",PARENTS_NAME:"Parents",CHILDREN_NAME:"Children",FRIENDS_NAME:"Friends",EXCLUSIONS_NAME:"Excluded",EXCLUSIONS_DESC:"Dataview or YAML fields that are never used for ontology",UNASSIGNED_NAME:"Unassigned",UNASSIGNED_DESC:"Fields in your Vault that are neither excluded nor part of the defined ontology.",ONTOLOGY_SUGGESTER_NAME:"Ontology Suggester",ONTOLOGY_SUGGESTER_DESC:"Activate ontology suggester in the markdown editor. If enabled then typing the trigger sequence at the beginning of a paragraph will activate the suggester listing your ontology fields defined above.",ONTOLOGY_SUGGESTER_ALL_NAME:"Character sequence to trigger generic suggester. The Generic suggester will include all the ontology fields regardless of their direction.",ONTOLOGY_SUGGESTER_PARENT_NAME:"Character sequence to trigger parent suggester",ONTOLOGY_SUGGESTER_CHILD_NAME:"Character sequence to trigger child suggester",ONTOLOGY_SUGGESTER_FRIEND_NAME:"Character sequence to trigger friend suggester",MID_SENTENCE_SUGGESTER_TRIGGER_NAME:"Mid-sentence dataview field suggester trigger",MID_SENTENCE_SUGGESTER_TRIGGER_DESC:"You may add fields mid-way in sentences following one of these two formats:<br><code>We met at [location:: [[XYZ restaurant]]] with [candidate:: [[John Doe]]]</code><br><code>We met at (location:: [[XYZ restaurant]]) with (candidate:: [[John Doe]])</code><br>If you set this trigger to e.g. <code>(</code> then typing <code>(:::</code> anywhere in the sentence will activate the suggester (assuming you are using the default generic suggester trigger commbination of <code>:::</code> - see setting above).<br>More info on inline fields: [DataView Help](https://blacksmithgu.github.io/obsidian-dataview/data-annotation/)",BOLD_FIELDS_NAME:"Add selected field with BOLD",BOLD_FIELDS_DESC:"Add selected field to text with bold typeface, i.e. (**field name**:: ) resulting in (<b>field name</b>:: )",DISPLAY_HEAD:"Display",COMPACT_VIEW_NAME:"Compact view",COMPACT_VIEW_DESC:"Display the graph in a compact view",EXCLUDE_PATHLIST_NAME:"Filepaths to exclude",EXCLUDE_PATHLIST_DESC:"Enter comma-separated list of filepaths to exclude from the index.",RENDERALIAS_NAME:"Display alias if available",RENDERALIAS_DESC:"Displays the page alias instead of the filename if it is specified in the page's front matter.",NODETITLE_SCRIPT_NAME:"Javascript for rendering node names",NODETITLE_SCRIPT_DESC:"Javascript code to render the node title. If you don't need it, just leave this field empty.<br>Function definition: <code>customNodeLabel: (dvPage: Literal, defaultName:string) => string</code><br>In your script you may refer to the dataview page object via the <code>dvPage</code> variable; and the default page name (filename or alias if available) via the <code>defaultName</code> variable. Use the following expression syntax:<br><code>dvPage['field 1']??defaultName</code> - this example will display the vaule of 'field 1' if available else the defaultName<br>âš  Your line of code will be executed as is, make sure you add proper exception handling. Beyond <code>defaultName</code> and dataview field names, you also have the freedom to use any javascript function (e.g. <code>defaultName.toLowerCase()</code>) and any value that appears on the <code>dvPage</code> object, e.g. <code>dvPage.file.path</code>, etc. <br> To explore the dataview page object open Developer Console and enter the following code:<br><code>DataviewAPI.page('full filepath including extension')</code><br>Here's an example code that will display the value of the title field if available, else the filename, followed by the state (if available): <br><code>dvPage.title??defaultName & (dvPage.state ? ' - ' & dvPage.state : '')</code>",SHOWINFERRED_NAME:"Display inferred relationships",SHOWINFERRED_DESC:"<b>Toggle ON</b>: Display both explicitly defined and inferred links. Forward links are children, backlinks are parents, if two page mutually referes to one another then relationship is inferred to be a friendship. Explicitly defined relationships always take priority.<br><b>Toggle OFF</b>: Display only explicitely defined relationships.",SHOWVIRTUAL_NAME:"Display virtual child nodes",SHOWVIRTUAL_DESC:"<b>Toggle ON</b>: Display unresolved links.<br><b>Toggle OFF</b>: Do not display unresolved links.",SHOWATTACHMENTS_NAME:"Include attachments",SHOWATTACHMENTS_DESC:"<b>Toggle ON</b>: Display every type of file on the graph. <br><b>Toggle OFF</b>: Display only markdown files.",STYLE_HEAD:"Styling",STYLE_DESC:"Styles are applied in sequence.<br><ol><li><b>Base</b> node style</li><li><b>Inferred</b> node style (only applied if the node is inferred)</li><li><b>Virtual</b> node style (only applied if the node is virtual)</li> <li><b>Central</b> node style (only applied if the node is in the center)</li><li><b>Sibling</b> node style (only applied if the node is a sibling)</li> <li><b>Attachment</b> node style (only applied if the node is an attachment)</li><li><b>Optional</b> tag based style</li></ol>All the attributes of the base node style must be specified. All other styles may have partial definitions. e.g. You may add a prefix and override the base node-background color in the tag-based style, override the font color in the inferred-node style and set the border stroke style to dotted in the virtual-node style.",CANVAS_BGCOLOR:"Canvas color",SHOW_FULL_TAG_PATH_NAME:"Display full tag name",SHOW_FULL_TAG_PATH_DESC:"<b>Toggle on:</b> will display the full tag e.g. #reading/books/sci-fi</br><b>Toggle off:</b> will display the current section of the tag, e.g. assuming the tag above, the graph will display only #reading, #books, #sci-fi respectively as you navigate the tag hierarchy.",SHOW_COUNT_NAME:"Display neighbor count",SHOW_COUNT_DESC:"Show the number of children, parents, friends next to the node gate",ALLOW_AUTOZOOM_NAME:"Autozoom",ALLOW_AUTOZOOM_DESC:"<b>Toggle ON:</b> Allow autozoom<br><b>Toggle OFF:</b> Disable autozoom",ALLOW_AUTOFOCUS_ON_SEARCH_NAME:"Autofocus on search",ALLOW_AUTOFOCUS_ON_SEARCH_DESC:"<b>Toggle ON:</b> Allow autofocus on Search<br><b>Toggle OFF:</b> Disable autofocus",ALWAYS_ON_TOP_NAME:"Popout default 'always on top' behavior",ALWAYS_ON_TOP_DESC:"<b>Toggle ON:</b> When opening ExcaliBrain in a popout window, it will open with the new window in 'always on top' mode.<br><b>Toggle OFF:</b> The new window will not be in 'always on top' mode.",TAGLIST_NAME:"Formatted tags",TAGLIST_DESC:"You can specify special formatting rules for Nodes based on tags. If multiple tags are present on the page the first matching a specification will be used. <br>Tagnames should start with <mark>#</mark> and may be incomplete. i.e. <code>#book</code> will match #books, #book/fiction, etc.<br>Enter a comma separated list of tags here, then select from the dropdown list to change the formatting.",MAX_ITEMCOUNT_DESC:"Maximum node count",MAX_ITEMCOUNT_NAME:"Maximum number of nodes to display in a given area of the layout.i.e. the maximum number of parents, the maximum number of children, the maximum number of friends, and the maximum number of siblings to display. If there are more items, they will be ommitted from the drawing.",NODESTYLE_INCLUDE_TOGGLE:"Toggle ON: override base node style for this attribute; OFF: apply base node style for this attribute",NODESTYLE_PREFIX_NAME:"Prefix",NODESTYLE_PREFIX_DESC:"Prefix character or emoji to display in front of the node's label",NODESTYLE_BGCOLOR:"Background color",NODESTYLE_BG_FILLSTYLE:"Background fill-style",NODESTYLE_TEXTCOLOR:"Text color",NODESTYLE_BORDERCOLOR:"Border color",NODESTYLE_FONTSIZE:"Font size",NODESTYLE_FONTFAMILY:"Font family",NODESTYLE_MAXLABELLENGTH_NAME:"Max label length",NODESTYLE_MAXLABELLENGTH_DESC:"Maximum number of characters to display from node title. Longer nodes will end with '...'",NODESTYLE_ROUGHNESS:"Stroke roughness",NODESTYLE_SHARPNESS:"Stroke sharpness",NODESTYLE_STROKEWIDTH:"Stroke width",NODESTYLE_STROKESTYLE:"Stroke style",NODESTYLE_RECTANGLEPADDING:"Padding of the node rectangle",NODESTYLE_GATE_RADIUS_NAME:"Gate radius",NODESTYLE_GATE_RADIUS_DESC:"The radius of the 3 small circles (alias: gates) serving as connection points for nodes",NODESTYLE_GATE_OFFSET_NAME:"Gate offset",NODESTYLE_GATE_OFFSET_DESC:"The offset to the left and right of the parent and child gates.",NODESTYLE_GATE_COLOR:"Gate border color",NODESTYLE_GATE_BGCOLOR_NAME:"Gate background color",NODESTYLE_GATE_BGCOLOR_DESC:"The fill color of the gate if it has children",NODESTYLE_GATE_FILLSTYLE:"Gate background fill-style",NODESTYLE_BASE:"Base node style",NODESTYLE_CENTRAL:"Style of central node",NODESTYLE_INFERRED:"Style of inferred nodes",NODESTYLE_VIRTUAL:"Style of virtual nodes",NODESTYLE_SIBLING:"Style of sibling nodes",NODESTYLE_ATTACHMENT:"Style of attachment nodes",NODESTYLE_FOLDER:"Style of folder nodes",NODESTYLE_TAG:"Style of tag nodes",LINKSTYLE_COLOR:"Color",LINKSTYLE_WIDTH:"Width",LINKSTYLE_STROKE:"Stroke style",LINKSTYLE_ROUGHNESS:"Roughness",LINKSTYLE_ARROWSTART:"Start arrow head",LINKSTYLE_ARROWEND:"End arrow head",LINKSTYLE_SHOWLABEL:"Show label on link",LINKSTYLE_FONTSIZE:"Label font size",LINKSTYLE_FONTFAMILY:"Label font family",LINKSTYLE_BASE:"Base link style",LINKSTYLE_INFERRED:"Style of inferred link",LINKSTYLE_FOLDER:"Style of folder link",LINKSTYLE_TAG:"Style of tag link",DATAVIEW_NOT_FOUND:`Dataview plugin not found. Please install or enable Dataview then try restarting ${y}.`,DATAVIEW_UPGRADE:`Please upgrade Dataview to 0.5.31 or newer. Please update Dataview then try restarting ${y}.`,EXCALIDRAW_NOT_FOUND:`Excalidraw plugin not found. Please install or enable Excalidraw then try restarting ${y}.`,EXCALIDRAW_MINAPP_VERSION:`ExcaliBrain requires Excalidraw 1.6.33 or higher. Please upgrade Excalidraw then try restarting ${y}.`,COMMAND_ADD_PARENT_FIELD:"Add dataview field to ontology as PARENT",COMMAND_ADD_CHILD_FIELD:"Add dataview field to ontology as CHILD",COMMAND_ADD_FRIEND_FIELD:"Add dataview field to ontology as FRIEND",COMMAND_START:"ExcaliBrain Normal",COMMAND_START_HOVER:"ExcaliBrain Hover-Editor",COMMAND_START_POPOUT:"ExcaliBrain Popout Window",COMMAND_STOP:"Stop ExcaliBrain",HOVER_EDITOR_ERROR:"I am sorry. Something went wrong. Most likely there was a version update to Hover Editor which I haven't addressed properly in ExcaliBrain. Normally I should get this fixed within few days",OPEN_DRAWING:"Save snapshot for editing",SEARCH_IN_VAULT:"Starred items will be listed in empty search.\nSearch for a file, a folder or a tag in your Vault.\nToggle folders and tags on/off to show in the list.",SHOW_HIDE_ATTACHMENTS:"Show/Hide attachments",SHOW_HIDE_VIRTUAL:"Show/Hide virtual nodes",SHOW_HIDE_INFERRED:"Show/Hide inferred nodes",SHOW_HIDE_ALIAS:"Show/Hide document alias",SHOW_HIDE_SIBLINGS:"Show/Hide siblings",SHOW_HIDE_FOLDER:"Show/Hide folder nodes",SHOW_HIDE_TAG:"Show/Hide tag nodes",SHOW_HIDE_PAGES:"Show/Hide page nodes (incl. defined, inferred, virtual and attachments)",PIN_LEAF:"Link ExcaliBrain to most recent active leaf"};const x={en:S}[n.moment.locale()];function A(e){return x||D({fn:A,where:"src/lang/helpers.ts",message:"Error: locale not found",data:n.moment.locale()}),x&&x[e]||S[e]}class T extends n.Modal{constructor(e,t,i){super(e),this.title=t,this.message=i}onOpen(){this.createForm()}onClose(){}createForm(){this.titleEl.setText(this.title),this.contentEl.createDiv({cls:"excalibrain-prompt-center",text:this.message}),this.contentEl.createDiv({cls:"excalibrain-prompt-center"},(e=>{e.style.textAlign="right",e.createEl("button",{text:"Ok"}).onclick=()=>{this.resolve(!0),this.close()},e.createEl("button",{text:"Cancel"}).onclick=()=>{this.resolve(!1),this.close()}}))}show(e){this.resolve=e,this.open()}}class B{constructor(e){this.style={},this.center={x:0,y:0},this.page=e.page,this.settings=e.page.plugin.settings,this.ea=e.ea,this.page.isFolder?this.style=Object.assign(Object.assign(Object.assign(Object.assign({},this.settings.baseNodeStyle),e.isCentral?this.settings.centralNodeStyle:{}),e.isSibling?this.settings.siblingNodeStyle:{}),this.settings.folderNodeStyle):this.page.isTag?this.style=Object.assign(Object.assign(Object.assign(Object.assign({},this.settings.baseNodeStyle),e.isCentral?this.settings.centralNodeStyle:{}),e.isSibling?this.settings.siblingNodeStyle:{}),this.settings.tagNodeStyle):this.style=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},this.settings.baseNodeStyle),e.isInferred?this.settings.inferredNodeStyle:{}),e.page.isVirtual?this.settings.virtualNodeStyle:{}),e.isCentral?this.settings.centralNodeStyle:{}),e.isSibling?this.settings.siblingNodeStyle:{}),e.page.isAttachment?this.settings.attachmentNodeStyle:{}),o(this.page.primaryStyleTag,this.settings)),this.friendGateOnLeft=e.friendGateOnLeft,this.title=this.page.getTitle()}displayText(){var e;const t=(null!==(e=this.style.prefix)&&void 0!==e?e:"")+this.title;return t.length>this.style.maxLabelLength?t.substring(0,this.style.maxLabelLength-1)+"...":t}setCenter(e){this.center=e}render(){var e,t;const i=this.ea,n=this.displayText(),s=2*this.style.gateRadius;i.style.fontSize=this.style.fontSize,i.style.fontFamily=this.style.fontFamily;const u=i.measureText(`${n}`);i.style.fillStyle=this.style.fillStyle,i.style.roughness=this.style.roughness,i.style.strokeSharpness=this.style.strokeShaprness,i.style.strokeWidth=this.style.strokeWidth,i.style.strokeColor=this.style.textColor,i.style.backgroundColor="transparent",this.id=i.addText(this.center.x-u.width/2,this.center.y-u.height/2,n,{wrapAt:this.style.maxLabelLength+5,textAlign:"center",box:!0,boxPadding:this.style.padding});const r=i.getElement(this.id);r.link=`[[${null!==(t=null===(e=this.page.file)||void 0===e?void 0:e.path)&&void 0!==t?t:this.page.path}]]`,r.backgroundColor=this.style.backgroundColor,r.strokeColor=this.style.borderColor,r.strokeStyle=this.style.strokeStyle,i.style.fillStyle=this.style.gateFillStyle,i.style.strokeColor=this.style.gateStrokeColor,i.style.strokeStyle="solid";const a=this.page.friendCount();i.style.backgroundColor=a>0?this.style.gateBackgroundColor:"transparent",this.friendGateId=i.addEllipse(this.friendGateOnLeft?this.center.x-s-this.style.padding-u.width/2:this.center.x+this.style.padding+u.width/2,this.center.y-this.style.gateRadius,s,s),this.settings.showNeighborCount&&a>0&&(i.style.fontSize=s,i.addText(this.friendGateOnLeft?a>9?this.center.x-2*s-this.style.padding-u.width/2:this.center.x-s-this.style.padding-u.width/2:this.center.x+this.style.padding+u.width/2,this.friendGateOnLeft?this.center.y-2*s:this.center.y-this.style.gateRadius+s,a.toString()));const o=this.page.parentCount();i.style.backgroundColor=o>0?this.style.gateBackgroundColor:"transparent",this.parentGateId=i.addEllipse(this.center.x-this.style.gateRadius-this.style.gateOffset,this.center.y-s-this.style.padding-u.height/2,s,s),this.settings.showNeighborCount&&o>0&&(i.style.fontSize=s,i.addText(this.center.x+s-this.style.gateOffset,this.center.y-s-this.style.padding-u.height/2,o.toString()));const D=this.page.childrenCount();i.style.backgroundColor=D>0?this.style.gateBackgroundColor:"transparent",this.childGateId=i.addEllipse(this.center.x-this.style.gateRadius+this.style.gateOffset,this.center.y+this.style.padding+u.height/2,s,s),this.settings.showNeighborCount&&D>0&&(i.style.fontSize=s,i.addText(this.center.x+s+this.style.gateOffset,this.center.y+this.style.padding+u.height/2,D.toString())),i.addToGroup([this.friendGateId,this.parentGateId,this.childGateId,this.id,r.boundElements[0].id])}}class O{constructor(t,i,n,s,u,r,a,o){this.nodeA=t,this.nodeB=i,this.nodeBRole=n,this.hierarchyDefinition=u,this.ea=r,this.isInferred=!1;const D=null==u?void 0:u.split(",").map((e=>e.trim()));this.isInferred=s===e.INFERRED;let l={};D&&D.forEach((e=>{if(o.hierarchyLinkStylesExtended[e])l=Object.assign(Object.assign({},l),o.hierarchyLinkStylesExtended[e]);else switch(e){case"file-tree":l=Object.assign(Object.assign({},l),o.settings.folderLinkStyle);break;case"tag-tree":l=Object.assign(Object.assign({},l),o.settings.tagLinkStyle)}})),this.style=Object.assign(Object.assign(Object.assign({},a.baseLinkStyle),this.isInferred?a.inferredLinkStyle:{}),l)}render(e){const i=this.ea,n=this.style;let s,u;switch(i.style.strokeStyle=n.strokeStyle,i.style.roughness=n.roughness,i.style.strokeColor=n.strokeColor,i.style.strokeWidth=n.strokeWidth,i.style.opacity=e?10:100,this.nodeBRole){case t.CHILD:s=this.nodeA.childGateId,u=this.nodeB.parentGateId;break;case t.PARENT:s=this.nodeA.parentGateId,u=this.nodeB.childGateId;break;default:s=this.nodeA.friendGateId,u=this.nodeB.friendGateId}const r=i.connectObjects(s,null,u,null,{startArrowHead:"none"===n.startArrowHead?null:n.startArrowHead,endArrowHead:"none"===n.endArrowHead?null:n.endArrowHead});n.showLabel&&this.hierarchyDefinition&&(i.style.fontSize=n.fontSize,i.style.fontFamily=n.fontFamily,i.style.strokeColor=n.textColor,i.addLabelToLine(r,this.hierarchyDefinition))}}const N={compactView:!1,excalibrainFilepath:"excalibrain.md",indexUpdateInterval:5e3,hierarchy:{exclusions:["excalidraw-font","excalidraw-font-color","excalidraw-css","excalidraw-plugin","excalidraw-link-brackets","excalidraw-link-prefix","excalidraw-border-color","excalidraw-default-mode","excalidraw-export-dark","excalidraw-export-transparent","excalidraw-export-svgpadding","excalidraw-export-pngscale","excalidraw-url-prefix","excalidraw-linkbutton-opacity","excalidraw-onload-script","kanban-plugin"],parents:["Parent","Parents","up","u"],children:["Children","Child","down","d"],friends:["Friends","Friend","Jump","Jumps","j"]},inferAllLinksAsFriends:!1,inverseInfer:!1,renderAlias:!0,nodeTitleScript:"",backgroundColor:"#0c3e6aff",excludeFilepaths:[],showInferredNodes:!0,showAttachments:!0,showVirtualNodes:!0,showFolderNodes:!1,showTagNodes:!1,showPageNodes:!0,showNeighborCount:!0,showFullTagName:!1,maxItemCount:30,renderSiblings:!0,baseNodeStyle:b,centralNodeStyle:{fontSize:30,backgroundColor:"#C49A13FF",textColor:"#000000ff"},inferredNodeStyle:{backgroundColor:"#000005b3",textColor:"#95c7f3ff"},virtualNodeStyle:{backgroundColor:"#ff000066",fillStyle:"hachure",textColor:"#ffffffff"},siblingNodeStyle:{fontSize:15},attachmentNodeStyle:{prefix:"ðŸ“Ž "},folderNodeStyle:{prefix:"ðŸ“‚ ",strokeShaprness:"sharp",borderColor:"#ffd700ff",textColor:"#ffd700ff"},tagNodeStyle:{prefix:"#",strokeShaprness:"sharp",borderColor:"#4682b4ff",textColor:"#4682b4ff"},tagNodeStyles:{},tagStyleList:[],baseLinkStyle:v,inferredLinkStyle:{strokeStyle:"dashed"},folderLinkStyle:{strokeColor:"#ffd700ff"},tagLinkStyle:{strokeColor:"#4682b4ff"},hierarchyLinkStyles:{},navigationHistory:[],allowOntologySuggester:!0,ontologySuggesterParentTrigger:"::p",ontologySuggesterChildTrigger:"::c",ontologySuggesterFriendTrigger:"::f",ontologySuggesterTrigger:":::",ontologySuggesterMidSentenceTrigger:"(",boldFields:!1,allowAutozoom:!0,allowAutofocuOnSearch:!0,defaultAlwaysOnTop:!1},L="excalibrain-settings-disabled",k=e=>(255*e|256).toString(16).slice(1),I=e=>createFragment((t=>t.createDiv().innerHTML=e)),_=e=>{const t=document.getElementById(e);if(!t)return;const i=t.parentNode;i&&i.removeChild(t)},M=(e,t)=>{const i=document.createElement("style");i.id=e,i.innerHTML=`.${t} {display: none;}`,document.body.appendChild(i)};class R extends n.PluginSettingTab{constructor(e,t){super(e,t),this.dirty=!1,this.updateTimer=!1,this.plugin=t}get hierarchyStyleList(){return w.concat(Array.from(this.plugin.settings.hierarchy.parents)).concat(Array.from(this.plugin.settings.hierarchy.children)).concat(Array.from(this.plugin.settings.hierarchy.friends))}async updateNodeDemoImg(){this.ea.reset(),this.ea.canvas.viewBackgroundColor=this.plugin.settings.backgroundColor,this.demoNode.style=Object.assign(Object.assign({},this.demoNodeStyle.getInheritedStyle()),this.demoNodeStyle.style),this.demoNode.render();const e=await this.ea.createSVG(null,!0,{withBackground:!0,withTheme:!1},null,"",40);e.removeAttribute("width"),e.removeAttribute("height"),this.demoNodeImg.setAttribute("src",l(e.outerHTML))}async updateLinkDemoImg(){this.ea.reset(),this.ea.canvas.viewBackgroundColor=this.plugin.settings.backgroundColor;const n=new F(null,"Start node",null,this.plugin),s=new F(null,"End node",null,this.plugin),u=this.plugin.settings.hierarchy;u.friends.contains(this.demoLinkStyle.display)?(n.addFriend(s,e.DEFINED,i.FROM),s.addFriend(n,e.DEFINED,i.TO)):u.parents.contains(this.demoLinkStyle.display)?(n.addParent(s,e.DEFINED,i.FROM),s.addChild(n,e.DEFINED,i.TO)):(n.addChild(s,e.DEFINED,i.FROM),s.addParent(n,e.DEFINED,i.TO));const r=new B({ea:this.ea,page:n,isInferred:!1,isCentral:!0,isSibling:!1,friendGateOnLeft:!0});r.ea=this.ea,r.setCenter({x:0,y:0});const a=new B({ea:this.ea,page:s,isInferred:!1,isCentral:!1,isSibling:!1,friendGateOnLeft:!1});a.ea=this.ea;let o=t.CHILD;u.friends.contains(this.demoLinkStyle.display)?(a.setCenter({x:-300,y:0}),o=t.FRIEND):u.parents.contains(this.demoLinkStyle.display)?(a.setCenter({x:0,y:-150}),o=t.PARENT):a.setCenter({x:0,y:150});const D=new O(r,a,o,e.DEFINED,"base",this.ea,this.plugin.settings,this.plugin);r.style=Object.assign(Object.assign({},this.plugin.settings.baseNodeStyle),this.plugin.settings.centralNodeStyle),r.render(),a.style=Object.assign(Object.assign({},this.demoNodeStyle.getInheritedStyle()),this.demoNodeStyle.style),a.render(),D.style=Object.assign(Object.assign({},this.demoLinkStyle.getInheritedStyle()),this.demoLinkStyle.style),D.render(!1);const c=await this.ea.createSVG(null,!0,{withBackground:!0,withTheme:!1},null,"",40);c.removeAttribute("width"),c.removeAttribute("height"),this.demoLinkImg.setAttribute("src",l(c.outerHTML))}async hide(){var e;this.dirty&&(""===this.plugin.settings.ontologySuggesterParentTrigger&&(this.plugin.settings.ontologySuggesterParentTrigger="::p"),""===this.plugin.settings.ontologySuggesterChildTrigger&&(this.plugin.settings.ontologySuggesterChildTrigger="::c"),""===this.plugin.settings.ontologySuggesterFriendTrigger&&(this.plugin.settings.ontologySuggesterFriendTrigger="::c"),""===this.plugin.settings.ontologySuggesterTrigger&&(this.plugin.settings.ontologySuggesterTrigger=":::"),""===this.plugin.settings.ontologySuggesterMidSentenceTrigger&&(this.plugin.settings.ontologySuggesterMidSentenceTrigger="("),this.plugin.setHierarchyLinkStylesExtended(),this.plugin.settings.tagStyleList=Object.keys(this.plugin.settings.tagNodeStyles),this.plugin.loadCustomNodeLabelFunction(),this.plugin.saveSettings(),this.updateTimer&&this.plugin.scene&&!this.plugin.scene.terminated&&this.plugin.scene.setTimer(),null===(e=this.plugin.scene)||void 0===e||e.reRender())}colorpicker(e,t,i,s,u,r,a,o){let D,l,c,d,h,p;const g=new n.Setting(e).setName(t);i&&g.setDesc(I(i));const F=e=>{e?g.settingEl.addClass(L):g.settingEl.removeClass(L),l.disabled=e,l.style.opacity=e?"0.3":"1",D.setDisabled(e),D.sliderEl.style.opacity=e?"0.3":"1",d.style.opacity=e?"0.3":"1",h.style.opacity=e?"0.3":"1",p.style.opacity=e?"0.3":"1"};a&&g.addToggle((e=>{c=e,e.toggleEl.addClass("excalibrain-settings-toggle"),e.setValue(void 0!==s()).setTooltip(A("NODESTYLE_INCLUDE_TOGGLE")).onChange((e=>{if(this.dirty=!0,!e)return F(!0),void r();u(l.value+k(D.getValue())),F(!1)}))})),g.settingEl.removeClass("mod-toggle"),d=createEl("span",{text:"color:",cls:"excalibrain-settings-colorlabel"}),g.controlEl.appendChild(d),l=createEl("input",{type:"color",cls:"excalibrain-settings-colorpicker"},(e=>{var t;e.value=(null!==(t=s())&&void 0!==t?t:o).substring(0,7),e.onchange=()=>{u(e.value+k(D.getValue())),this.dirty=!0}})),g.controlEl.appendChild(l),h=createEl("span",{text:"opacity:",cls:"excalibrain-settings-opacitylabel"}),g.controlEl.appendChild(h),g.addSlider((e=>{var t,i;D=e,e.setLimits(0,1,.1).setValue((i=null!==(t=s())&&void 0!==t?t:o,parseInt(i.substring(7,9),16)/255)).onChange((e=>{u(l.value+k(e)),p.innerText=` ${e.toString()}`,l.style.opacity=e.toString(),this.dirty=!0}))})),p=createDiv({text:`${D.getValue().toString()}`,cls:"excalibrain-settings-sliderlabel"}),g.controlEl.appendChild(p),l.style.opacity=D.getValue().toString(),F(a&&!c.getValue())}numberslider(e,t,i,s,u,r,a,o,D){let l,c,d;const h=new n.Setting(e).setName(t),p=e=>{e?h.settingEl.addClass(L):h.settingEl.removeClass(L),d.setDisabled(e),d.sliderEl.style.opacity=e?"0.3":"1",l.style.opacity=e?"0.3":"1"};o&&h.addToggle((e=>{c=e,e.toggleEl.addClass("excalibrain-settings-toggle"),e.setValue(void 0!==u()).setTooltip(A("NODESTYLE_INCLUDE_TOGGLE")).onChange((e=>{if(this.dirty=!0,!e)return p(!0),void a();r(d.getValue()),p(!1)}))})),h.addSlider((e=>{var t;d=e,e.setLimits(s.min,s.max,s.step).setValue(null!==(t=u())&&void 0!==t?t:D).onChange((async e=>{l.innerText=` ${e.toString()}`,r(e),this.dirty=!0}))})),i&&h.setDesc(I(i)),h.settingEl.createDiv("",(e=>{l=e,e.style.minWidth="2.3em",e.style.textAlign="right",e.innerText=` ${d.getValue().toString()}`})),p(o&&!c.getValue())}toggle(e,t,i,s,u,r,a,o){let D,l;const c=new n.Setting(e).setName(t),d=e=>{e?c.settingEl.addClass(L):c.settingEl.removeClass(L),l.setDisabled(e),l.toggleEl.style.opacity=e?"0.3":"1"};a&&c.addToggle((e=>{D=e,e.toggleEl.addClass("excalibrain-settings-toggle"),e.setValue(void 0!==s()).setTooltip(A("NODESTYLE_INCLUDE_TOGGLE")).onChange((e=>{if(this.dirty=!0,!e)return d(!0),void r();u(l.getValue()),d(!1)}))})),c.addToggle((e=>{var t;l=e,e.setValue(null!==(t=s())&&void 0!==t?t:o).onChange((async e=>{u(e),this.dirty=!0}))})),i&&c.setDesc(I(i)),d(a&&!D.getValue())}dropdownpicker(e,t,i,s,u,r,a,o,D){let l,c;const d=new n.Setting(e).setName(t),h=e=>{e?d.settingEl.addClass(L):d.settingEl.removeClass(L),l.setDisabled(e),l.selectEl.style.opacity=e?"0.3":"1"};o&&d.addToggle((e=>{c=e,e.toggleEl.addClass("excalibrain-settings-toggle"),e.setValue(void 0!==u()).setTooltip(A("NODESTYLE_INCLUDE_TOGGLE")).onChange((e=>{if(this.dirty=!0,!e)return h(!0),void a();r(l.getValue()),h(!1)}))})),d.addDropdown((e=>{var t;l=e,e.addOptions(s).setValue(null!==(t=u())&&void 0!==t?t:D).onChange((e=>{r(e),this.dirty=!0}))})),i&&d.setDesc(I(i)),h(o&&!c.getValue())}nodeSettings(e,t,i=!0,s){let u,r;const a=new n.Setting(e).setName(A("NODESTYLE_PREFIX_NAME")).setDesc(I(A("NODESTYLE_PREFIX_DESC"))),o=e=>{e?a.settingEl.addClass(L):a.settingEl.removeClass(L),u.setDisabled(e),u.inputEl.style.opacity=e?"0.3":"1"};i&&a.addToggle((e=>{r=e,e.toggleEl.addClass("excalibrain-settings-toggle"),e.setValue(void 0!==t.prefix).setTooltip(A("NODESTYLE_INCLUDE_TOGGLE")).onChange((e=>{if(this.dirty=!0,!e)return o(!0),t.prefix=void 0,void this.updateNodeDemoImg();o(!1)}))})),a.addText((e=>{var i;u=e,e.setValue(null!==(i=t.prefix)&&void 0!==i?i:s.prefix).onChange((e=>{t.prefix=e,this.updateNodeDemoImg(),this.dirty=!0}))})),o(i&&!r.getValue()),this.colorpicker(e,A("NODESTYLE_BGCOLOR"),null,(()=>t.backgroundColor),(e=>{t.backgroundColor=e,this.updateNodeDemoImg()}),(()=>{delete t.backgroundColor,this.updateNodeDemoImg()}),i,s.backgroundColor),this.dropdownpicker(e,A("NODESTYLE_BG_FILLSTYLE"),null,{hachure:"Hachure","cross-hatch":"Cross-hatch",solid:"Solid"},(()=>{var e;return null===(e=t.fillStyle)||void 0===e?void 0:e.toString()}),(e=>{t.fillStyle=e,this.updateNodeDemoImg()}),(()=>{delete t.fillStyle,this.updateNodeDemoImg()}),i,s.fillStyle.toString()),this.colorpicker(e,A("NODESTYLE_TEXTCOLOR"),null,(()=>t.textColor),(e=>{t.textColor=e,this.updateNodeDemoImg()}),(()=>{delete t.textColor,this.updateNodeDemoImg()}),i,s.textColor),this.colorpicker(e,A("NODESTYLE_BORDERCOLOR"),null,(()=>t.borderColor),(e=>{t.borderColor=e,this.updateNodeDemoImg()}),(()=>{delete t.borderColor,this.updateNodeDemoImg()}),i,s.borderColor),this.numberslider(e,A("NODESTYLE_FONTSIZE"),null,{min:10,max:50,step:5},(()=>t.fontSize),(e=>{t.fontSize=e,this.updateNodeDemoImg()}),(()=>{delete t.fontSize,this.updateNodeDemoImg()}),i,s.fontSize),this.dropdownpicker(e,A("NODESTYLE_FONTFAMILY"),null,{1:"Hand-drawn",2:"Normal",3:"Code",4:"Fourth (custom) Font"},(()=>{var e;return null===(e=t.fontFamily)||void 0===e?void 0:e.toString()}),(e=>{t.fontFamily=parseInt(e),this.updateNodeDemoImg()}),(()=>{delete t.fontFamily,this.updateNodeDemoImg()}),i,s.fontFamily.toString()),this.numberslider(e,A("NODESTYLE_MAXLABELLENGTH_NAME"),A("NODESTYLE_MAXLABELLENGTH_DESC"),{min:15,max:100,step:5},(()=>t.maxLabelLength),(e=>{t.maxLabelLength=e,this.updateNodeDemoImg()}),(()=>{delete t.maxLabelLength,this.updateNodeDemoImg()}),i,s.maxLabelLength),this.dropdownpicker(e,A("NODESTYLE_ROUGHNESS"),null,{0:"Architect",1:"Artist",2:"Cartoonist"},(()=>{var e;return null===(e=t.roughness)||void 0===e?void 0:e.toString()}),(e=>{t.roughness=parseInt(e),this.updateNodeDemoImg()}),(()=>{delete t.roughness,this.updateNodeDemoImg()}),i,s.roughness.toString()),this.dropdownpicker(e,A("NODESTYLE_SHARPNESS"),null,{sharp:"Sharp",round:"Round"},(()=>t.strokeShaprness),(e=>{t.strokeShaprness=e,this.updateNodeDemoImg()}),(()=>{delete t.strokeShaprness,this.updateNodeDemoImg()}),i,s.strokeShaprness),this.numberslider(e,A("NODESTYLE_STROKEWIDTH"),null,{min:.5,max:6,step:.5},(()=>t.strokeWidth),(e=>{t.strokeWidth=e,this.updateNodeDemoImg()}),(()=>{delete t.strokeWidth,this.updateNodeDemoImg()}),i,s.strokeWidth),this.dropdownpicker(e,A("NODESTYLE_STROKESTYLE"),null,{solid:"Solid",dashed:"Dashed",dotted:"Dotted"},(()=>t.strokeStyle),(e=>{t.strokeStyle=e,this.updateNodeDemoImg()}),(()=>{delete t.strokeStyle,this.updateNodeDemoImg()}),i,s.strokeStyle),this.numberslider(e,A("NODESTYLE_RECTANGLEPADDING"),null,{min:5,max:50,step:5},(()=>t.padding),(e=>{t.padding=e,this.updateNodeDemoImg()}),(()=>{delete t.padding,this.updateNodeDemoImg()}),i,s.padding),this.numberslider(e,A("NODESTYLE_GATE_RADIUS_NAME"),A("NODESTYLE_GATE_RADIUS_DESC"),{min:3,max:10,step:1},(()=>t.gateRadius),(e=>{t.gateRadius=e,this.updateNodeDemoImg()}),(()=>{delete t.gateRadius,this.updateNodeDemoImg()}),i,s.gateRadius),this.numberslider(e,A("NODESTYLE_GATE_OFFSET_NAME"),A("NODESTYLE_GATE_OFFSET_DESC"),{min:0,max:25,step:1},(()=>t.gateOffset),(e=>{t.gateOffset=e,this.updateNodeDemoImg()}),(()=>{delete t.gateOffset,this.updateNodeDemoImg()}),i,s.gateOffset),this.colorpicker(e,A("NODESTYLE_GATE_COLOR"),null,(()=>t.gateStrokeColor),(e=>{t.gateStrokeColor=e,this.updateNodeDemoImg()}),(()=>{delete t.gateStrokeColor,this.updateNodeDemoImg()}),i,s.gateStrokeColor),this.colorpicker(e,A("NODESTYLE_GATE_BGCOLOR_NAME"),A("NODESTYLE_GATE_BGCOLOR_DESC"),(()=>t.gateBackgroundColor),(e=>{t.gateBackgroundColor=e,this.updateNodeDemoImg()}),(()=>{delete t.gateBackgroundColor,this.updateNodeDemoImg()}),i,s.gateBackgroundColor),this.dropdownpicker(e,A("NODESTYLE_GATE_FILLSTYLE"),null,{hachure:"Hachure","cross-hatch":"Cross-hatch",solid:"Solid"},(()=>{var e;return null===(e=t.gateFillStyle)||void 0===e?void 0:e.toString()}),(e=>{t.gateFillStyle=e,this.updateNodeDemoImg()}),(()=>{delete t.gateFillStyle,this.updateNodeDemoImg()}),i,s.gateFillStyle.toString())}linkSettings(e,t,i=!0,n){this.colorpicker(e,A("LINKSTYLE_COLOR"),null,(()=>t.strokeColor),(e=>{t.strokeColor=e,this.updateLinkDemoImg()}),(()=>{delete t.strokeColor,this.updateLinkDemoImg()}),i,n.strokeColor),this.numberslider(e,A("LINKSTYLE_WIDTH"),null,{min:.5,max:10,step:.5},(()=>t.strokeWidth),(e=>{t.strokeWidth=e,this.updateLinkDemoImg()}),(()=>{delete t.strokeWidth,this.updateLinkDemoImg()}),i,n.strokeWidth),this.dropdownpicker(e,A("LINKSTYLE_ROUGHNESS"),null,{0:"Architect",1:"Artist",2:"Cartoonist"},(()=>{var e;return null===(e=t.roughness)||void 0===e?void 0:e.toString()}),(e=>{t.roughness=parseInt(e),this.updateLinkDemoImg()}),(()=>{delete t.roughness,this.updateLinkDemoImg()}),i,n.roughness.toString()),this.dropdownpicker(e,A("LINKSTYLE_STROKE"),null,{solid:"Solid",dashed:"Dashed",dotted:"Dotted"},(()=>t.strokeStyle),(e=>{t.strokeStyle=e,this.updateLinkDemoImg()}),(()=>{delete t.strokeStyle,this.updateLinkDemoImg()}),i,n.strokeStyle),this.dropdownpicker(e,A("LINKSTYLE_ARROWSTART"),null,{none:"None",arrow:"Arrow",bar:"Bar",dot:"Dot",triangle:"Triangle"},(()=>t.startArrowHead),(e=>{t.startArrowHead=""===e?null:e,this.updateLinkDemoImg()}),(()=>{delete t.startArrowHead,this.updateLinkDemoImg()}),i,n.startArrowHead),this.dropdownpicker(e,A("LINKSTYLE_ARROWEND"),null,{none:"None",arrow:"Arrow",bar:"Bar",dot:"Dot",triangle:"Triangle"},(()=>t.endArrowHead),(e=>{t.endArrowHead=""===e?null:e,this.updateLinkDemoImg()}),(()=>{delete t.endArrowHead,this.updateLinkDemoImg()}),i,n.endArrowHead),this.toggle(e,A("LINKSTYLE_SHOWLABEL"),null,(()=>t.showLabel),(e=>{t.showLabel=e,this.updateLinkDemoImg()}),(()=>{delete t.showLabel,this.updateLinkDemoImg()}),i,n.showLabel),this.colorpicker(e,A("NODESTYLE_TEXTCOLOR"),null,(()=>t.textColor),(e=>{t.textColor=e,this.updateLinkDemoImg()}),(()=>{delete t.textColor,this.updateLinkDemoImg()}),i,n.textColor),this.numberslider(e,A("LINKSTYLE_FONTSIZE"),null,{min:6,max:30,step:3},(()=>t.fontSize),(e=>{t.fontSize=e,this.updateLinkDemoImg()}),(()=>{delete t.fontSize,this.updateLinkDemoImg()}),i,n.fontSize),this.dropdownpicker(e,A("LINKSTYLE_FONTFAMILY"),null,{1:"Hand-drawn",2:"Normal",3:"Code",4:"Fourth (custom) Font"},(()=>{var e;return null===(e=t.fontFamily)||void 0===e?void 0:e.toString()}),(e=>{t.fontFamily=parseInt(e),this.updateLinkDemoImg()}),(()=>{delete t.fontFamily,this.updateLinkDemoImg()}),i,n.fontFamily.toString())}getUnusedFieldNames(){const e=new Set;this.plugin.DVAPI.index.pages.forEach((t=>{const i=null==t?void 0:t.fields.keys();if(!i)return;let n;for(;!(n=i.next()).done;)n.value.contains(",")||n.value.startsWith("**")&&n.value.endsWith("**")||e.add(n.value)}));const t=new Map;e.forEach((e=>{t.set(e,e.toLowerCase().replaceAll(" ","-"))}));const i=new Set;return this.plugin.settings.hierarchy.parents.forEach((e=>i.add(e.toLowerCase().replaceAll(" ","-")))),this.plugin.settings.hierarchy.children.forEach((e=>i.add(e.toLowerCase().replaceAll(" ","-")))),this.plugin.settings.hierarchy.friends.forEach((e=>i.add(e.toLowerCase().replaceAll(" ","-")))),this.plugin.settings.hierarchy.exclusions.forEach((e=>i.add(e.toLowerCase().replaceAll(" ","-")))),Array.from(t.entries()).forEach((([e,n])=>i.has(e.toLowerCase().replaceAll(" ","-"))||i.has(n)?(t.delete(e),void t.delete(n)):void(e!==n&&t.delete(n)))),Array.from(t.keys()).sort(((e,t)=>e.toLowerCase()<t.toLowerCase()?-1:1)).join(", ")}async display(){const t=this.plugin.settings.navigationHistory;await this.plugin.loadSettings(),this.plugin.settings.navigationHistory=t,this.ea=C();const s=new F(null,"This is a demo node that is 46 characters long",null,this.plugin),u=new F(null,"This is a child node",null,this.plugin);s.addChild(u,e.DEFINED,i.FROM),u.addParent(s,e.DEFINED,i.TO),this.demoNode=new B({ea:this.ea,page:s,isInferred:!1,isCentral:!1,isSibling:!1,friendGateOnLeft:!0}),this.demoNode.ea=this.ea,this.demoNode.setCenter({x:0,y:0});const{containerEl:r}=this;this.containerEl.empty();const a=r.createDiv("coffee");a.addClass("ex-coffee-div"),a.createEl("a",{href:"https://ko-fi.com/zsolt"}).createEl("img",{attr:{src:"https://cdn.ko-fi.com/cdn/kofi3.png?v=3"}}).height=45,new n.Setting(r).setName(A("EXCALIBRAIN_FILE_NAME")).setDesc(I(A("EXCALIBRAIN_FILE_DESC"))).addText((e=>e.setValue(this.plugin.settings.excalibrainFilepath).onChange((t=>{this.dirty=!0,t.endsWith(".md")||(t+=t.endsWith(".m")?"d":t.endsWith(".")?"md":".md"),this.app.vault.getAbstractFileByPath(t)?new T(this.app,"âš  File Exists",`${t} already exists in your Vault. Is it ok to overwrite this file?`).show((i=>{i&&(this.plugin.settings.excalibrainFilepath=t,this.dirty=!0,e.inputEl.value=t)})):(this.plugin.settings.excalibrainFilepath=t,this.dirty=!0)})).inputEl.onblur=()=>{e.setValue(this.plugin.settings.excalibrainFilepath)})),this.numberslider(r,A("INDEX_REFRESH_FREQ_NAME"),A("INDEX_REFRESH_FREQ_DESC"),{min:5,max:120,step:5},(()=>this.plugin.settings.indexUpdateInterval/1e3),(e=>{this.plugin.settings.indexUpdateInterval=1e3*e,this.updateTimer=!0}),(()=>{}),!1,5e3),this.containerEl.createEl("h1",{cls:"excalibrain-settings-h1",text:A("HIERARCHY_HEAD")}),this.containerEl.createEl("p",{}).innerHTML=A("HIERARCHY_DESC");let o=()=>{};const D=new n.Setting(r).setName(A("PARENTS_NAME")).addTextArea((e=>{e.inputEl.style.height="90px",e.inputEl.style.width="100%",e.setValue(this.plugin.settings.hierarchy.parents.join(", ")).onChange((e=>{this.plugin.settings.hierarchy.parents=e.split(",").map((e=>e.trim())).sort(((e,t)=>e.toLowerCase()<t.toLowerCase()?-1:1)),this.plugin.hierarchyLowerCase.parents=[],this.plugin.settings.hierarchy.parents.forEach((e=>this.plugin.hierarchyLowerCase.parents.push(e.toLowerCase().replaceAll(" ","-")))),o(),this.dirty=!0}))}));D.nameEl.addClass("excalibrain-setting-nameEl"),D.descEl.addClass("excalibrain-setting-descEl"),D.controlEl.addClass("excalibrain-setting-controlEl");const l=new n.Setting(r).setName(A("CHILDREN_NAME")).addTextArea((e=>{e.inputEl.style.height="90px",e.inputEl.style.width="100%",e.setValue(this.plugin.settings.hierarchy.children.join(", ")).onChange((e=>{this.plugin.settings.hierarchy.children=e.split(",").map((e=>e.trim())).sort(((e,t)=>e.toLowerCase()<t.toLowerCase()?-1:1)),this.plugin.hierarchyLowerCase.children=[],this.plugin.settings.hierarchy.children.forEach((e=>this.plugin.hierarchyLowerCase.children.push(e.toLowerCase().replaceAll(" ","-")))),o(),this.dirty=!0}))}));l.nameEl.addClass("excalibrain-setting-nameEl"),l.descEl.addClass("excalibrain-setting-descEl"),l.controlEl.addClass("excalibrain-setting-controlEl");const c=new n.Setting(r).setName(A("FRIENDS_NAME")).addTextArea((e=>{e.inputEl.style.height="90px",e.inputEl.style.width="100%",e.setValue(this.plugin.settings.hierarchy.friends.join(", ")).onChange((e=>{this.plugin.settings.hierarchy.friends=e.split(",").map((e=>e.trim())).sort(((e,t)=>e.toLowerCase()<t.toLowerCase()?-1:1)),this.plugin.hierarchyLowerCase.friends=[],this.plugin.settings.hierarchy.friends.forEach((e=>this.plugin.hierarchyLowerCase.friends.push(e.toLowerCase().replaceAll(" ","-")))),o(),this.dirty=!0}))}));c.nameEl.addClass("excalibrain-setting-nameEl"),c.descEl.addClass("excalibrain-setting-descEl"),c.controlEl.addClass("excalibrain-setting-controlEl");const d=new n.Setting(r).setName(A("EXCLUSIONS_NAME")).setDesc(A("EXCLUSIONS_DESC")).addTextArea((e=>{e.inputEl.style.height="90px",e.inputEl.style.width="100%",e.setValue(this.plugin.settings.hierarchy.exclusions.join(", ")).onChange((e=>{this.plugin.settings.hierarchy.exclusions=e.split(",").map((e=>e.trim())).sort(((e,t)=>e.toLowerCase()<t.toLowerCase()?-1:1)),o(),this.dirty=!0}))}));let h;d.nameEl.addClass("excalibrain-setting-nameEl"),d.descEl.addClass("excalibrain-setting-descEl"),d.controlEl.addClass("excalibrain-setting-controlEl");const p=new n.Setting(r).setName(A("UNASSIGNED_NAME")).setDesc(A("UNASSIGNED_DESC")).addTextArea((e=>{h=e,e.inputEl.style.height="90px",e.inputEl.style.width="100%",e.setValue(this.getUnusedFieldNames()),e.setDisabled(!0)}));let g,f,E,m,y,v;p.nameEl.addClass("excalibrain-setting-nameEl"),p.descEl.addClass("excalibrain-setting-descEl"),p.controlEl.addClass("excalibrain-setting-controlEl"),new n.Setting(r).setName(A("INFER_NAME")).setDesc(I(A("INFER_DESC"))).addToggle((e=>e.setValue(this.plugin.settings.inferAllLinksAsFriends).onChange((e=>{this.plugin.settings.inferAllLinksAsFriends=e,this.dirty=!0})))),new n.Setting(r).setName(A("REVERSE_NAME")).setDesc(I(A("REVERSE_DESC"))).addToggle((e=>e.setValue(this.plugin.settings.inverseInfer).onChange((e=>{this.plugin.settings.inverseInfer=e,this.dirty=!0})))),new n.Setting(r).setName(A("ONTOLOGY_SUGGESTER_NAME")).setDesc(A("ONTOLOGY_SUGGESTER_DESC")).addToggle((e=>e.setValue(this.plugin.settings.allowOntologySuggester).onChange((e=>{this.plugin.settings.allowOntologySuggester=e,m.setDisabled(!e),g.setDisabled(!e),f.setDisabled(!e),E.setDisabled(!e),y.setDisabled(!e),v.setDisabled(!e),this.dirty=!0})))),m=new n.Setting(r).setName(A("ONTOLOGY_SUGGESTER_ALL_NAME")).setDisabled(!this.plugin.settings.allowOntologySuggester).addText((e=>e.setValue(this.plugin.settings.ontologySuggesterTrigger).onChange((e=>{this.plugin.settings.ontologySuggesterTrigger=e,this.dirty=!0})))),g=new n.Setting(r).setName(A("ONTOLOGY_SUGGESTER_PARENT_NAME")).setDisabled(!this.plugin.settings.allowOntologySuggester).addText((e=>e.setValue(this.plugin.settings.ontologySuggesterParentTrigger).onChange((e=>{this.plugin.settings.ontologySuggesterParentTrigger=e,this.dirty=!0})))),f=new n.Setting(r).setName(A("ONTOLOGY_SUGGESTER_CHILD_NAME")).setDisabled(!this.plugin.settings.allowOntologySuggester).addText((e=>e.setValue(this.plugin.settings.ontologySuggesterChildTrigger).onChange((e=>{this.plugin.settings.ontologySuggesterChildTrigger=e,this.dirty=!0})))),E=new n.Setting(r).setName(A("ONTOLOGY_SUGGESTER_FRIEND_NAME")).setDisabled(!this.plugin.settings.allowOntologySuggester).addText((e=>e.setValue(this.plugin.settings.ontologySuggesterFriendTrigger).onChange((e=>{this.plugin.settings.ontologySuggesterFriendTrigger=e,this.dirty=!0})))),y=new n.Setting(r).setName(A("MID_SENTENCE_SUGGESTER_TRIGGER_NAME")).setDesc(I(A("MID_SENTENCE_SUGGESTER_TRIGGER_DESC"))).addDropdown((e=>{e.addOption("(","(").addOption("[","[").setValue(this.plugin.settings.ontologySuggesterMidSentenceTrigger).onChange((e=>{this.plugin.settings.ontologySuggesterMidSentenceTrigger=e,this.dirty=!0}))})),v=new n.Setting(r).setName(A("BOLD_FIELDS_NAME")).setDesc(I(A("BOLD_FIELDS_DESC"))).addToggle((e=>e.setValue(this.plugin.settings.boldFields).onChange((e=>{this.plugin.settings.boldFields=e,this.dirty=!0})))),this.containerEl.createEl("h1",{cls:"excalibrain-settings-h1",text:A("DISPLAY_HEAD")}),new n.Setting(r).setName(A("COMPACT_VIEW_NAME")).setDesc(I(A("COMPACT_VIEW_DESC"))).addToggle((e=>e.setValue(this.plugin.settings.compactView).onChange((e=>{this.plugin.settings.compactView=e,this.dirty=!0}))));const b=new n.Setting(r).setName(A("EXCLUDE_PATHLIST_NAME")).setDesc(I(A("EXCLUDE_PATHLIST_DESC"))).addTextArea((e=>{e.inputEl.style.height="100px",e.inputEl.style.width="100%",e.setValue(this.plugin.settings.excludeFilepaths.join(", ")).onChange((e=>{const t=(e=e.replaceAll("\n"," ")).split(",").map((e=>e.trim()));this.plugin.settings.excludeFilepaths=t.filter((e=>""!==e)),this.dirty=!0}))}));b.descEl.style.width="90%",b.controlEl.style.width="90%",new n.Setting(r).setName(A("SHOW_FULL_TAG_PATH_NAME")).setDesc(I(A("SHOW_FULL_TAG_PATH_DESC"))).addToggle((e=>e.setValue(this.plugin.settings.showFullTagName).onChange((e=>{this.plugin.settings.showFullTagName=e,this.dirty=!0})))),new n.Setting(r).setName(A("RENDERALIAS_NAME")).setDesc(I(A("RENDERALIAS_DESC"))).addToggle((e=>e.setValue(this.plugin.settings.renderAlias).onChange((e=>{this.plugin.settings.renderAlias=e,this.dirty=!0}))));const S=new n.Setting(r).setName(A("NODETITLE_SCRIPT_NAME")).setDesc(I(A("NODETITLE_SCRIPT_DESC"))).addTextArea((e=>{e.inputEl.style.height="200px",e.inputEl.style.width="100%",e.setValue(this.plugin.settings.nodeTitleScript).onChange((e=>{this.plugin.settings.nodeTitleScript=e,this.dirty=!0}))}));let x,O;S.descEl.style.width="90%",S.controlEl.style.width="90%",new n.Setting(r).setName(A("SHOWINFERRED_NAME")).setDesc(I(A("SHOWINFERRED_DESC"))).addToggle((e=>e.setValue(this.plugin.settings.showInferredNodes).onChange((e=>{this.plugin.settings.showInferredNodes=e,this.dirty=!0})))),new n.Setting(r).setName(A("SHOWATTACHMENTS_NAME")).setDesc(I(A("SHOWATTACHMENTS_DESC"))).addToggle((e=>e.setValue(this.plugin.settings.showAttachments).onChange((e=>{this.plugin.settings.showAttachments=e,this.dirty=!0})))),new n.Setting(r).setName(A("SHOWVIRTUAL_NAME")).setDesc(I(A("SHOWVIRTUAL_DESC"))).addToggle((e=>e.setValue(this.plugin.settings.showVirtualNodes).onChange((e=>{this.plugin.settings.showVirtualNodes=e,this.dirty=!0})))),this.numberslider(r,A("MAX_ITEMCOUNT_NAME"),A("MAX_ITEMCOUNT_DESC"),{min:5,max:150,step:5},(()=>this.plugin.settings.maxItemCount),(e=>this.plugin.settings.maxItemCount=e),(()=>{}),!1,30),new n.Setting(r).setName(A("SHOW_COUNT_NAME")).setDesc(I(A("SHOW_COUNT_DESC"))).addToggle((e=>e.setValue(this.plugin.settings.showNeighborCount).onChange((e=>{this.plugin.settings.showNeighborCount=e,this.dirty=!0})))),new n.Setting(r).setName(A("ALLOW_AUTOZOOM_NAME")).setDesc(I(A("ALLOW_AUTOZOOM_DESC"))).addToggle((e=>e.setValue(this.plugin.settings.allowAutozoom).onChange((e=>{this.plugin.settings.allowAutozoom=e,this.dirty=!0})))),new n.Setting(r).setName(A("ALLOW_AUTOFOCUS_ON_SEARCH_NAME")).setDesc(I(A("ALLOW_AUTOFOCUS_ON_SEARCH_DESC"))).addToggle((e=>e.setValue(this.plugin.settings.allowAutofocuOnSearch).onChange((e=>{this.plugin.settings.allowAutofocuOnSearch=e,this.dirty=!0})))),new n.Setting(r).setName(A("ALWAYS_ON_TOP_NAME")).setDesc(I(A("ALWAYS_ON_TOP_DESC"))).addToggle((e=>e.setValue(this.plugin.settings.defaultAlwaysOnTop).onChange((e=>{this.plugin.settings.defaultAlwaysOnTop=e,this.dirty=!0})))),r.createEl("h1",{cls:"excalibrain-settings-h1",text:A("STYLE_HEAD")}),this.containerEl.createEl("p",{}).innerHTML=A("STYLE_DESC"),this.colorpicker(r,A("CANVAS_BGCOLOR"),null,(()=>this.plugin.settings.backgroundColor),(e=>{this.plugin.settings.backgroundColor=e,this.updateNodeDemoImg()}),(()=>{}),!1,this.plugin.settings.backgroundColor);const N=e=>{O.empty();const t=this.plugin.nodeStyles[e];this.nodeSettings(O,t.style,t.allowOverride,t.getInheritedStyle()),this.demoNodeStyle=t,this.updateNodeDemoImg()},k=new n.Setting(r).setName(A("TAGLIST_NAME")).setDesc(A("TAGLIST_DESC")).addTextArea((e=>{e.inputEl.style.height="200px",e.inputEl.style.width="100%",e.setValue(this.plugin.settings.tagStyleList.sort(((e,t)=>e.toLowerCase()<t.toLowerCase()?-1:1)).join(", ")).onChange((e=>{const t=this.plugin.settings.tagNodeStyles,i=this.plugin.nodeStyles,n=(e=e.replaceAll("\n"," ")).split(",").map((e=>e.trim())).sort(((e,t)=>e.toLocaleLowerCase()<t.toLocaleLowerCase()?-1:1));this.plugin.settings.tagStyleList=n,Object.keys(t).forEach((e=>{n.contains(e)||(delete t[e],delete i[e])})),n.forEach((e=>{Object.keys(t).contains(e)||(t[e]={},i[e]={style:t[e],allowOverride:!0,userStyle:!0,display:e,getInheritedStyle:()=>this.plugin.settings.baseNodeStyle})}));const s=x.getValue();for(let e=x.selectEl.options.length-1;e>=0;e--)x.selectEl.remove(e);Object.entries(i).forEach((e=>{x.addOption(e[0],e[1].display)})),i[s]?x.setValue(s):(x.setValue("base"),N("base")),this.dirty=!0}))}));k.descEl.style.width="90%",k.controlEl.style.width="90%";const R=r.createDiv({cls:"setting-item"}),P=R.createDiv({cls:"setting-item-info"});let V;x=new n.DropdownComponent(P),R.createDiv({text:"Show inherited",cls:"setting-item-name"}).style.marginRight="10px";let H=!1;const j=new n.ToggleComponent(R);j.setValue(!0).setTooltip("Show/Hide Inherited Properties").onChange((e=>{H?H=!1:(e?_("excalibrain-hide-disabled"):M("excalibrain-hide-disabled",L),H=!0,V.setValue(e))})),Object.entries(this.plugin.nodeStyles).forEach((e=>{x.addOption(e[0],e[1].display)})),this.demoNodeImg=r.createEl("img",{cls:"excalibrain-settings-demoimg"}),O=r.createDiv({cls:"excalibrain-setting-style-section"}),_("excalibrain-hide-disabled"),x.setValue("base").onChange(N);const W=this.plugin.nodeStyles.base;let G,Y;this.nodeSettings(O,W.style,W.allowOverride,W.getInheritedStyle()),this.demoNodeStyle=W,this.updateNodeDemoImg();const U=e=>{Y.empty();const t=this.plugin.linkStyles[e];this.linkSettings(Y,t.style,t.allowOverride,t.getInheritedStyle()),this.demoLinkStyle=t,this.updateLinkDemoImg()},z=r.createDiv({cls:"setting-item"}),q=z.createDiv({cls:"setting-item-info"});G=new n.DropdownComponent(q),z.createDiv({text:"Show inherited",cls:"setting-item-name"}).style.marginRight="10px",V=new n.ToggleComponent(z),V.setValue(!0).setTooltip("Show/Hide Inherited Properties").onChange((e=>{H?H=!1:(e?_("excalibrain-hide-disabled"):M("excalibrain-hide-disabled",L),H=!0,j.setValue(e))})),Object.entries(this.plugin.linkStyles).forEach((e=>{G.addOption(e[0],e[1].display)})),this.demoLinkImg=r.createEl("img",{cls:"excalibrain-settings-demoimg"}),Y=r.createDiv({cls:"excalibrain-setting-nodestyle-section"}),G.setValue("base").onChange(U);const $=this.plugin.linkStyles.base;this.linkSettings(Y,$.style,$.allowOverride,$.getInheritedStyle()),this.demoLinkStyle=$,this.updateLinkDemoImg(),o=()=>{h.setValue(this.getUnusedFieldNames());const e=this.plugin.settings.hierarchyLinkStyles,t=this.plugin.linkStyles;Object.keys(t).forEach((i=>{w.contains(i)||this.hierarchyStyleList.contains(i)||(delete t[i],delete e[i])})),this.hierarchyStyleList.forEach((i=>{Object.keys(e).contains(i)||w.contains(i)||(e[i]={},t[i]={style:e[i],allowOverride:!0,userStyle:!0,display:i,getInheritedStyle:()=>this.plugin.settings.baseLinkStyle})}));const i=G.getValue();for(let e=G.selectEl.options.length-1;e>=0;e--)G.selectEl.remove(e);const n=this.plugin.settings.hierarchy,s=e=>w.includes(e)?"0"+e.toLowerCase():n.parents.includes(e)?"1"+e.toLowerCase():n.children.includes(e)?"2"+e.toLowerCase():"3"+e.toLowerCase();Object.entries(t).sort(((e,t)=>s(e[0])<s(t[0])?-1:1)).forEach((e=>{G.addOption(e[0],this.plugin.settings.hierarchy.parents.includes(e[1].display)?"Parent > "+e[1].display:this.plugin.settings.hierarchy.children.includes(e[1].display)?"Child > "+e[1].display:this.plugin.settings.hierarchy.friends.includes(e[1].display)?"Friend > "+e[1].display:e[1].display)})),t[i]?G.setValue(i):(G.setValue("base"),U("base"))},o()}}var P={};Object.defineProperty(P,"__esModule",{value:!0});class V extends Error{}class H extends V{constructor(e){super(`Invalid DateTime: ${e.toMessage()}`)}}class j extends V{constructor(e){super(`Invalid Interval: ${e.toMessage()}`)}}class W extends V{constructor(e){super(`Invalid Duration: ${e.toMessage()}`)}}class G extends V{}class Y extends V{constructor(e){super(`Invalid unit ${e}`)}}class U extends V{}class z extends V{constructor(){super("Zone is an abstract class")}}const q="numeric",$="short",Z="long",J={year:q,month:q,day:q},K={year:q,month:$,day:q},X={year:q,month:$,day:q,weekday:$},Q={year:q,month:Z,day:q},ee={year:q,month:Z,day:q,weekday:Z},te={hour:q,minute:q},ie={hour:q,minute:q,second:q},ne={hour:q,minute:q,second:q,timeZoneName:$},se={hour:q,minute:q,second:q,timeZoneName:Z},ue={hour:q,minute:q,hourCycle:"h23"},re={hour:q,minute:q,second:q,hourCycle:"h23"},ae={hour:q,minute:q,second:q,hourCycle:"h23",timeZoneName:$},oe={hour:q,minute:q,second:q,hourCycle:"h23",timeZoneName:Z},De={year:q,month:q,day:q,hour:q,minute:q},le={year:q,month:q,day:q,hour:q,minute:q,second:q},ce={year:q,month:$,day:q,hour:q,minute:q},de={year:q,month:$,day:q,hour:q,minute:q,second:q},he={year:q,month:$,day:q,weekday:$,hour:q,minute:q},pe={year:q,month:Z,day:q,hour:q,minute:q,timeZoneName:$},ge={year:q,month:Z,day:q,hour:q,minute:q,second:q,timeZoneName:$},Fe={year:q,month:Z,day:q,weekday:Z,hour:q,minute:q,timeZoneName:Z},fe={year:q,month:Z,day:q,weekday:Z,hour:q,minute:q,second:q,timeZoneName:Z};class Ee{get type(){throw new z}get name(){throw new z}get ianaName(){return this.name}get isUniversal(){throw new z}offsetName(e,t){throw new z}formatOffset(e,t){throw new z}offset(e){throw new z}equals(e){throw new z}get isValid(){throw new z}}let me=null;class Ce extends Ee{static get instance(){return null===me&&(me=new Ce),me}get type(){return"system"}get name(){return(new Intl.DateTimeFormat).resolvedOptions().timeZone}get isUniversal(){return!1}offsetName(e,{format:t,locale:i}){return dt(e,t,i)}formatOffset(e,t){return Ft(this.offset(e),t)}offset(e){return-new Date(e).getTimezoneOffset()}equals(e){return"system"===e.type}get isValid(){return!0}}let ye={};const we={year:0,month:1,day:2,era:3,hour:4,minute:5,second:6};let ve={};class be extends Ee{static create(e){return ve[e]||(ve[e]=new be(e)),ve[e]}static resetCache(){ve={},ye={}}static isValidSpecifier(e){return this.isValidZone(e)}static isValidZone(e){if(!e)return!1;try{return new Intl.DateTimeFormat("en-US",{timeZone:e}).format(),!0}catch(e){return!1}}constructor(e){super(),this.zoneName=e,this.valid=be.isValidZone(e)}get type(){return"iana"}get name(){return this.zoneName}get isUniversal(){return!1}offsetName(e,{format:t,locale:i}){return dt(e,t,i,this.name)}formatOffset(e,t){return Ft(this.offset(e),t)}offset(e){const t=new Date(e);if(isNaN(t))return NaN;const i=(n=this.name,ye[n]||(ye[n]=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:n,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",era:"short"})),ye[n]);var n;let[s,u,r,a,o,D,l]=i.formatToParts?function(e,t){const i=e.formatToParts(t),n=[];for(let e=0;e<i.length;e++){const{type:t,value:s}=i[e],u=we[t];"era"===t?n[u]=s:$e(u)||(n[u]=parseInt(s,10))}return n}(i,t):function(e,t){const i=e.format(t).replace(/\u200E/g,""),n=/(\d+)\/(\d+)\/(\d+) (AD|BC),? (\d+):(\d+):(\d+)/.exec(i),[,s,u,r,a,o,D,l]=n;return[r,s,u,a,o,D,l]}(i,t);"BC"===a&&(s=1-Math.abs(s));let c=+t;const d=c%1e3;return c-=d>=0?d:1e3+d,(Dt({year:s,month:u,day:r,hour:24===o?0:o,minute:D,second:l,millisecond:0})-c)/6e4}equals(e){return"iana"===e.type&&e.name===this.name}get isValid(){return this.valid}}let Se={},xe={};function Ae(e,t={}){const i=JSON.stringify([e,t]);let n=xe[i];return n||(n=new Intl.DateTimeFormat(e,t),xe[i]=n),n}let Te={},Be={},Oe=null;function Ne(e,t,i,n,s){const u=e.listingMode(i);return"error"===u?null:"en"===u?n(t):s(t)}class Le{constructor(e,t,i){this.padTo=i.padTo||0,this.floor=i.floor||!1;const{padTo:n,floor:s,...u}=i;if(!t||Object.keys(u).length>0){const t={useGrouping:!1,...i};i.padTo>0&&(t.minimumIntegerDigits=i.padTo),this.inf=function(e,t={}){const i=JSON.stringify([e,t]);let n=Te[i];return n||(n=new Intl.NumberFormat(e,t),Te[i]=n),n}(e,t)}}format(e){if(this.inf){const t=this.floor?Math.floor(e):e;return this.inf.format(t)}return tt(this.floor?Math.floor(e):ut(e,3),this.padTo)}}class ke{constructor(e,t,i){let n;if(this.opts=i,e.zone.isUniversal){const t=e.offset/60*-1,s=t>=0?`Etc/GMT+${t}`:`Etc/GMT${t}`;0!==e.offset&&be.create(s).valid?(n=s,this.dt=e):(n="UTC",i.timeZoneName?this.dt=e:this.dt=0===e.offset?e:Ln.fromMillis(e.ts+60*e.offset*1e3))}else"system"===e.zone.type?this.dt=e:(this.dt=e,n=e.zone.name);const s={...this.opts};s.timeZone=s.timeZone||n,this.dtf=Ae(t,s)}format(){return this.dtf.format(this.dt.toJSDate())}formatToParts(){return this.dtf.formatToParts(this.dt.toJSDate())}resolvedOptions(){return this.dtf.resolvedOptions()}}class Ie{constructor(e,t,i){this.opts={style:"long",...i},!t&&Ke()&&(this.rtf=function(e,t={}){const{base:i,...n}=t,s=JSON.stringify([e,n]);let u=Be[s];return u||(u=new Intl.RelativeTimeFormat(e,t),Be[s]=u),u}(e,i))}format(e,t){return this.rtf?this.rtf.format(e,t):function(e,t,i="always",n=!1){const s={years:["year","yr."],quarters:["quarter","qtr."],months:["month","mo."],weeks:["week","wk."],days:["day","day","days"],hours:["hour","hr."],minutes:["minute","min."],seconds:["second","sec."]},u=-1===["hours","minutes","seconds"].indexOf(e);if("auto"===i&&u){const i="days"===e;switch(t){case 1:return i?"tomorrow":`next ${s[e][0]}`;case-1:return i?"yesterday":`last ${s[e][0]}`;case 0:return i?"today":`this ${s[e][0]}`}}const r=Object.is(t,-0)||t<0,a=Math.abs(t),o=1===a,D=s[e],l=n?o?D[1]:D[2]||D[1]:o?s[e][0]:e;return r?`${a} ${l} ago`:`in ${a} ${l}`}(t,e,this.opts.numeric,"long"!==this.opts.style)}formatToParts(e,t){return this.rtf?this.rtf.formatToParts(e,t):[]}}class _e{static fromOpts(e){return _e.create(e.locale,e.numberingSystem,e.outputCalendar,e.defaultToEN)}static create(e,t,i,n=!1){const s=e||qe.defaultLocale,u=s||(n?"en-US":Oe||(Oe=(new Intl.DateTimeFormat).resolvedOptions().locale,Oe)),r=t||qe.defaultNumberingSystem,a=i||qe.defaultOutputCalendar;return new _e(u,r,a,s)}static resetCache(){Oe=null,xe={},Te={},Be={}}static fromObject({locale:e,numberingSystem:t,outputCalendar:i}={}){return _e.create(e,t,i)}constructor(e,t,i,n){const[s,u,r]=function(e){const t=e.indexOf("-x-");-1!==t&&(e=e.substring(0,t));const i=e.indexOf("-u-");if(-1===i)return[e];{let t,n;try{t=Ae(e).resolvedOptions(),n=e}catch(s){const u=e.substring(0,i);t=Ae(u).resolvedOptions(),n=u}const{numberingSystem:s,calendar:u}=t;return[n,s,u]}}(e);this.locale=s,this.numberingSystem=t||u||null,this.outputCalendar=i||r||null,this.intl=function(e,t,i){return i||t?(e.includes("-u-")||(e+="-u"),i&&(e+=`-ca-${i}`),t&&(e+=`-nu-${t}`),e):e}(this.locale,this.numberingSystem,this.outputCalendar),this.weekdaysCache={format:{},standalone:{}},this.monthsCache={format:{},standalone:{}},this.meridiemCache=null,this.eraCache={},this.specifiedLocale=n,this.fastNumbersCached=null}get fastNumbers(){var e;return null==this.fastNumbersCached&&(this.fastNumbersCached=(!(e=this).numberingSystem||"latn"===e.numberingSystem)&&("latn"===e.numberingSystem||!e.locale||e.locale.startsWith("en")||"latn"===new Intl.DateTimeFormat(e.intl).resolvedOptions().numberingSystem)),this.fastNumbersCached}listingMode(){const e=this.isEnglish(),t=!(null!==this.numberingSystem&&"latn"!==this.numberingSystem||null!==this.outputCalendar&&"gregory"!==this.outputCalendar);return e&&t?"en":"intl"}clone(e){return e&&0!==Object.getOwnPropertyNames(e).length?_e.create(e.locale||this.specifiedLocale,e.numberingSystem||this.numberingSystem,e.outputCalendar||this.outputCalendar,e.defaultToEN||!1):this}redefaultToEN(e={}){return this.clone({...e,defaultToEN:!0})}redefaultToSystem(e={}){return this.clone({...e,defaultToEN:!1})}months(e,t=!1,i=!0){return Ne(this,e,i,yt,(()=>{const i=t?{month:e,day:"numeric"}:{month:e},n=t?"format":"standalone";return this.monthsCache[n][e]||(this.monthsCache[n][e]=function(e){const t=[];for(let i=1;i<=12;i++){const n=Ln.utc(2016,i,1);t.push(e(n))}return t}((e=>this.extract(e,i,"month")))),this.monthsCache[n][e]}))}weekdays(e,t=!1,i=!0){return Ne(this,e,i,St,(()=>{const i=t?{weekday:e,year:"numeric",month:"long",day:"numeric"}:{weekday:e},n=t?"format":"standalone";return this.weekdaysCache[n][e]||(this.weekdaysCache[n][e]=function(e){const t=[];for(let i=1;i<=7;i++){const n=Ln.utc(2016,11,13+i);t.push(e(n))}return t}((e=>this.extract(e,i,"weekday")))),this.weekdaysCache[n][e]}))}meridiems(e=!0){return Ne(this,void 0,e,(()=>xt),(()=>{if(!this.meridiemCache){const e={hour:"numeric",hourCycle:"h12"};this.meridiemCache=[Ln.utc(2016,11,13,9),Ln.utc(2016,11,13,19)].map((t=>this.extract(t,e,"dayperiod")))}return this.meridiemCache}))}eras(e,t=!0){return Ne(this,e,t,Ot,(()=>{const t={era:e};return this.eraCache[e]||(this.eraCache[e]=[Ln.utc(-40,1,1),Ln.utc(2017,1,1)].map((e=>this.extract(e,t,"era")))),this.eraCache[e]}))}extract(e,t,i){const n=this.dtFormatter(e,t).formatToParts().find((e=>e.type.toLowerCase()===i));return n?n.value:null}numberFormatter(e={}){return new Le(this.intl,e.forceSimple||this.fastNumbers,e)}dtFormatter(e,t={}){return new ke(e,this.intl,t)}relFormatter(e={}){return new Ie(this.intl,this.isEnglish(),e)}listFormatter(e={}){return function(e,t={}){const i=JSON.stringify([e,t]);let n=Se[i];return n||(n=new Intl.ListFormat(e,t),Se[i]=n),n}(this.intl,e)}isEnglish(){return"en"===this.locale||"en-us"===this.locale.toLowerCase()||new Intl.DateTimeFormat(this.intl).resolvedOptions().locale.startsWith("en-us")}equals(e){return this.locale===e.locale&&this.numberingSystem===e.numberingSystem&&this.outputCalendar===e.outputCalendar}}let Me=null;class Re extends Ee{static get utcInstance(){return null===Me&&(Me=new Re(0)),Me}static instance(e){return 0===e?Re.utcInstance:new Re(e)}static parseSpecifier(e){if(e){const t=e.match(/^utc(?:([+-]\d{1,2})(?::(\d{2}))?)?$/i);if(t)return new Re(ht(t[1],t[2]))}return null}constructor(e){super(),this.fixed=e}get type(){return"fixed"}get name(){return 0===this.fixed?"UTC":`UTC${Ft(this.fixed,"narrow")}`}get ianaName(){return 0===this.fixed?"Etc/UTC":`Etc/GMT${Ft(-this.fixed,"narrow")}`}offsetName(){return this.name}formatOffset(e,t){return Ft(this.fixed,t)}get isUniversal(){return!0}offset(){return this.fixed}equals(e){return"fixed"===e.type&&e.fixed===this.fixed}get isValid(){return!0}}class Pe extends Ee{constructor(e){super(),this.zoneName=e}get type(){return"invalid"}get name(){return this.zoneName}get isUniversal(){return!1}offsetName(){return null}formatOffset(){return""}offset(){return NaN}equals(){return!1}get isValid(){return!1}}function Ve(e,t){if($e(e)||null===e)return t;if(e instanceof Ee)return e;if("string"==typeof e){const i=e.toLowerCase();return"default"===i?t:"local"===i||"system"===i?Ce.instance:"utc"===i||"gmt"===i?Re.utcInstance:Re.parseSpecifier(i)||be.create(e)}return Ze(e)?Re.instance(e):"object"==typeof e&&e.offset&&"number"==typeof e.offset?e:new Pe(e)}let He,je=()=>Date.now(),We="system",Ge=null,Ye=null,Ue=null,ze=60;class qe{static get now(){return je}static set now(e){je=e}static set defaultZone(e){We=e}static get defaultZone(){return Ve(We,Ce.instance)}static get defaultLocale(){return Ge}static set defaultLocale(e){Ge=e}static get defaultNumberingSystem(){return Ye}static set defaultNumberingSystem(e){Ye=e}static get defaultOutputCalendar(){return Ue}static set defaultOutputCalendar(e){Ue=e}static get twoDigitCutoffYear(){return ze}static set twoDigitCutoffYear(e){ze=e%100}static get throwOnInvalid(){return He}static set throwOnInvalid(e){He=e}static resetCaches(){_e.resetCache(),be.resetCache()}}function $e(e){return void 0===e}function Ze(e){return"number"==typeof e}function Je(e){return"number"==typeof e&&e%1==0}function Ke(){try{return"undefined"!=typeof Intl&&!!Intl.RelativeTimeFormat}catch(e){return!1}}function Xe(e,t,i){if(0!==e.length)return e.reduce(((e,n)=>{const s=[t(n),n];return e&&i(e[0],s[0])===e[0]?e:s}),null)[1]}function Qe(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function et(e,t,i){return Je(e)&&e>=t&&e<=i}function tt(e,t=2){let i;return i=e<0?"-"+(""+-e).padStart(t,"0"):(""+e).padStart(t,"0"),i}function it(e){return $e(e)||null===e||""===e?void 0:parseInt(e,10)}function nt(e){return $e(e)||null===e||""===e?void 0:parseFloat(e)}function st(e){if(!$e(e)&&null!==e&&""!==e){const t=1e3*parseFloat("0."+e);return Math.floor(t)}}function ut(e,t,i=!1){const n=10**t;return(i?Math.trunc:Math.round)(e*n)/n}function rt(e){return e%4==0&&(e%100!=0||e%400==0)}function at(e){return rt(e)?366:365}function ot(e,t){const i=(n=t-1)-12*Math.floor(n/12)+1;var n;return 2===i?rt(e+(t-i)/12)?29:28:[31,null,31,30,31,30,31,31,30,31,30,31][i-1]}function Dt(e){let t=Date.UTC(e.year,e.month-1,e.day,e.hour,e.minute,e.second,e.millisecond);return e.year<100&&e.year>=0&&(t=new Date(t),t.setUTCFullYear(t.getUTCFullYear()-1900)),+t}function lt(e){const t=(e+Math.floor(e/4)-Math.floor(e/100)+Math.floor(e/400))%7,i=e-1,n=(i+Math.floor(i/4)-Math.floor(i/100)+Math.floor(i/400))%7;return 4===t||3===n?53:52}function ct(e){return e>99?e:e>qe.twoDigitCutoffYear?1900+e:2e3+e}function dt(e,t,i,n=null){const s=new Date(e),u={hourCycle:"h23",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"};n&&(u.timeZone=n);const r={timeZoneName:t,...u},a=new Intl.DateTimeFormat(i,r).formatToParts(s).find((e=>"timezonename"===e.type.toLowerCase()));return a?a.value:null}function ht(e,t){let i=parseInt(e,10);Number.isNaN(i)&&(i=0);const n=parseInt(t,10)||0;return 60*i+(i<0||Object.is(i,-0)?-n:n)}function pt(e){const t=Number(e);if("boolean"==typeof e||""===e||Number.isNaN(t))throw new U(`Invalid unit value ${e}`);return t}function gt(e,t){const i={};for(const n in e)if(Qe(e,n)){const s=e[n];if(null==s)continue;i[t(n)]=pt(s)}return i}function Ft(e,t){const i=Math.trunc(Math.abs(e/60)),n=Math.trunc(Math.abs(e%60)),s=e>=0?"+":"-";switch(t){case"short":return`${s}${tt(i,2)}:${tt(n,2)}`;case"narrow":return`${s}${i}${n>0?`:${n}`:""}`;case"techie":return`${s}${tt(i,2)}${tt(n,2)}`;default:throw new RangeError(`Value format ${t} is out of range for property format`)}}function ft(e){return function(e,t){return["hour","minute","second","millisecond"].reduce(((t,i)=>(t[i]=e[i],t)),{})}(e)}const Et=["January","February","March","April","May","June","July","August","September","October","November","December"],mt=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],Ct=["J","F","M","A","M","J","J","A","S","O","N","D"];function yt(e){switch(e){case"narrow":return[...Ct];case"short":return[...mt];case"long":return[...Et];case"numeric":return["1","2","3","4","5","6","7","8","9","10","11","12"];case"2-digit":return["01","02","03","04","05","06","07","08","09","10","11","12"];default:return null}}const wt=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],vt=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],bt=["M","T","W","T","F","S","S"];function St(e){switch(e){case"narrow":return[...bt];case"short":return[...vt];case"long":return[...wt];case"numeric":return["1","2","3","4","5","6","7"];default:return null}}const xt=["AM","PM"],At=["Before Christ","Anno Domini"],Tt=["BC","AD"],Bt=["B","A"];function Ot(e){switch(e){case"narrow":return[...Bt];case"short":return[...Tt];case"long":return[...At];default:return null}}function Nt(e,t){let i="";for(const n of e)n.literal?i+=n.val:i+=t(n.val);return i}const Lt={D:J,DD:K,DDD:Q,DDDD:ee,t:te,tt:ie,ttt:ne,tttt:se,T:ue,TT:re,TTT:ae,TTTT:oe,f:De,ff:ce,fff:pe,ffff:Fe,F:le,FF:de,FFF:ge,FFFF:fe};class kt{static create(e,t={}){return new kt(e,t)}static parseFormat(e){let t=null,i="",n=!1;const s=[];for(let u=0;u<e.length;u++){const r=e.charAt(u);"'"===r?(i.length>0&&s.push({literal:n,val:i}),t=null,i="",n=!n):n||r===t?i+=r:(i.length>0&&s.push({literal:!1,val:i}),i=r,t=r)}return i.length>0&&s.push({literal:n,val:i}),s}static macroTokenToFormatOpts(e){return Lt[e]}constructor(e,t){this.opts=t,this.loc=e,this.systemLoc=null}formatWithSystemDefault(e,t){return null===this.systemLoc&&(this.systemLoc=this.loc.redefaultToSystem()),this.systemLoc.dtFormatter(e,{...this.opts,...t}).format()}formatDateTime(e,t={}){return this.loc.dtFormatter(e,{...this.opts,...t}).format()}formatDateTimeParts(e,t={}){return this.loc.dtFormatter(e,{...this.opts,...t}).formatToParts()}formatInterval(e,t={}){return this.loc.dtFormatter(e.start,{...this.opts,...t}).dtf.formatRange(e.start.toJSDate(),e.end.toJSDate())}resolvedOptions(e,t={}){return this.loc.dtFormatter(e,{...this.opts,...t}).resolvedOptions()}num(e,t=0){if(this.opts.forceSimple)return tt(e,t);const i={...this.opts};return t>0&&(i.padTo=t),this.loc.numberFormatter(i).format(e)}formatDateTimeFromString(e,t){const i="en"===this.loc.listingMode(),n=this.loc.outputCalendar&&"gregory"!==this.loc.outputCalendar,s=(t,i)=>this.loc.extract(e,t,i),u=t=>e.isOffsetFixed&&0===e.offset&&t.allowZ?"Z":e.isValid?e.zone.formatOffset(e.ts,t.format):"",r=(t,n)=>i?function(e,t){return yt(t)[e.month-1]}(e,t):s(n?{month:t}:{month:t,day:"numeric"},"month"),a=(t,n)=>i?function(e,t){return St(t)[e.weekday-1]}(e,t):s(n?{weekday:t}:{weekday:t,month:"long",day:"numeric"},"weekday"),o=t=>{const i=kt.macroTokenToFormatOpts(t);return i?this.formatWithSystemDefault(e,i):t},D=t=>i?function(e,t){return Ot(t)[e.year<0?0:1]}(e,t):s({era:t},"era");return Nt(kt.parseFormat(t),(t=>{switch(t){case"S":return this.num(e.millisecond);case"u":case"SSS":return this.num(e.millisecond,3);case"s":return this.num(e.second);case"ss":return this.num(e.second,2);case"uu":return this.num(Math.floor(e.millisecond/10),2);case"uuu":return this.num(Math.floor(e.millisecond/100));case"m":return this.num(e.minute);case"mm":return this.num(e.minute,2);case"h":return this.num(e.hour%12==0?12:e.hour%12);case"hh":return this.num(e.hour%12==0?12:e.hour%12,2);case"H":return this.num(e.hour);case"HH":return this.num(e.hour,2);case"Z":return u({format:"narrow",allowZ:this.opts.allowZ});case"ZZ":return u({format:"short",allowZ:this.opts.allowZ});case"ZZZ":return u({format:"techie",allowZ:this.opts.allowZ});case"ZZZZ":return e.zone.offsetName(e.ts,{format:"short",locale:this.loc.locale});case"ZZZZZ":return e.zone.offsetName(e.ts,{format:"long",locale:this.loc.locale});case"z":return e.zoneName;case"a":return i?function(e){return xt[e.hour<12?0:1]}(e):s({hour:"numeric",hourCycle:"h12"},"dayperiod");case"d":return n?s({day:"numeric"},"day"):this.num(e.day);case"dd":return n?s({day:"2-digit"},"day"):this.num(e.day,2);case"c":case"E":return this.num(e.weekday);case"ccc":return a("short",!0);case"cccc":return a("long",!0);case"ccccc":return a("narrow",!0);case"EEE":return a("short",!1);case"EEEE":return a("long",!1);case"EEEEE":return a("narrow",!1);case"L":return n?s({month:"numeric",day:"numeric"},"month"):this.num(e.month);case"LL":return n?s({month:"2-digit",day:"numeric"},"month"):this.num(e.month,2);case"LLL":return r("short",!0);case"LLLL":return r("long",!0);case"LLLLL":return r("narrow",!0);case"M":return n?s({month:"numeric"},"month"):this.num(e.month);case"MM":return n?s({month:"2-digit"},"month"):this.num(e.month,2);case"MMM":return r("short",!1);case"MMMM":return r("long",!1);case"MMMMM":return r("narrow",!1);case"y":return n?s({year:"numeric"},"year"):this.num(e.year);case"yy":return n?s({year:"2-digit"},"year"):this.num(e.year.toString().slice(-2),2);case"yyyy":return n?s({year:"numeric"},"year"):this.num(e.year,4);case"yyyyyy":return n?s({year:"numeric"},"year"):this.num(e.year,6);case"G":return D("short");case"GG":return D("long");case"GGGGG":return D("narrow");case"kk":return this.num(e.weekYear.toString().slice(-2),2);case"kkkk":return this.num(e.weekYear,4);case"W":return this.num(e.weekNumber);case"WW":return this.num(e.weekNumber,2);case"o":return this.num(e.ordinal);case"ooo":return this.num(e.ordinal,3);case"q":return this.num(e.quarter);case"qq":return this.num(e.quarter,2);case"X":return this.num(Math.floor(e.ts/1e3));case"x":return this.num(e.ts);default:return o(t)}}))}formatDurationFromString(e,t){const i=e=>{switch(e[0]){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":return"hour";case"d":return"day";case"w":return"week";case"M":return"month";case"y":return"year";default:return null}},n=kt.parseFormat(t),s=n.reduce(((e,{literal:t,val:i})=>t?e:e.concat(i)),[]);return Nt(n,(e=>t=>{const n=i(t);return n?this.num(e.get(n),t.length):t})(e.shiftTo(...s.map(i).filter((e=>e)))))}}class It{constructor(e,t){this.reason=e,this.explanation=t}toMessage(){return this.explanation?`${this.reason}: ${this.explanation}`:this.reason}}const _t=/[A-Za-z_+-]{1,256}(?::?\/[A-Za-z0-9_+-]{1,256}(?:\/[A-Za-z0-9_+-]{1,256})?)?/;function Mt(...e){const t=e.reduce(((e,t)=>e+t.source),"");return RegExp(`^${t}$`)}function Rt(...e){return t=>e.reduce((([e,i,n],s)=>{const[u,r,a]=s(t,n);return[{...e,...u},r||i,a]}),[{},null,1]).slice(0,2)}function Pt(e,...t){if(null==e)return[null,null];for(const[i,n]of t){const t=i.exec(e);if(t)return n(t)}return[null,null]}function Vt(...e){return(t,i)=>{const n={};let s;for(s=0;s<e.length;s++)n[e[s]]=it(t[i+s]);return[n,null,i+s]}}const Ht=/(?:(Z)|([+-]\d\d)(?::?(\d\d))?)/,jt=/(\d\d)(?::?(\d\d)(?::?(\d\d)(?:[.,](\d{1,30}))?)?)?/,Wt=RegExp(`${jt.source}(?:${Ht.source}?(?:\\[(${_t.source})\\])?)?`),Gt=RegExp(`(?:T${Wt.source})?`),Yt=Vt("weekYear","weekNumber","weekDay"),Ut=Vt("year","ordinal"),zt=RegExp(`${jt.source} ?(?:${Ht.source}|(${_t.source}))?`),qt=RegExp(`(?: ${zt.source})?`);function $t(e,t,i){const n=e[t];return $e(n)?i:it(n)}function Zt(e,t){return[{hours:$t(e,t,0),minutes:$t(e,t+1,0),seconds:$t(e,t+2,0),milliseconds:st(e[t+3])},null,t+4]}function Jt(e,t){const i=!e[t]&&!e[t+1],n=ht(e[t+1],e[t+2]);return[{},i?null:Re.instance(n),t+3]}function Kt(e,t){return[{},e[t]?be.create(e[t]):null,t+1]}const Xt=RegExp(`^T?${jt.source}$`),Qt=/^-?P(?:(?:(-?\d{1,20}(?:\.\d{1,20})?)Y)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20}(?:\.\d{1,20})?)W)?(?:(-?\d{1,20}(?:\.\d{1,20})?)D)?(?:T(?:(-?\d{1,20}(?:\.\d{1,20})?)H)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20})(?:[.,](-?\d{1,20}))?S)?)?)$/;function ei(e){const[t,i,n,s,u,r,a,o,D]=e,l="-"===t[0],c=o&&"-"===o[0],d=(e,t=!1)=>void 0!==e&&(t||e&&l)?-e:e;return[{years:d(nt(i)),months:d(nt(n)),weeks:d(nt(s)),days:d(nt(u)),hours:d(nt(r)),minutes:d(nt(a)),seconds:d(nt(o),"-0"===o),milliseconds:d(st(D),c)}]}const ti={GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};function ii(e,t,i,n,s,u,r){const a={year:2===t.length?ct(it(t)):it(t),month:mt.indexOf(i)+1,day:it(n),hour:it(s),minute:it(u)};return r&&(a.second=it(r)),e&&(a.weekday=e.length>3?wt.indexOf(e)+1:vt.indexOf(e)+1),a}const ni=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|(?:([+-]\d\d)(\d\d)))$/;function si(e){const[,t,i,n,s,u,r,a,o,D,l,c]=e,d=ii(t,s,n,i,u,r,a);let h;return h=o?ti[o]:D?0:ht(l,c),[d,new Re(h)]}const ui=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), (\d\d) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) (\d{4}) (\d\d):(\d\d):(\d\d) GMT$/,ri=/^(Monday|Tuesday|Wednesday|Thursday|Friday|Saturday|Sunday), (\d\d)-(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)-(\d\d) (\d\d):(\d\d):(\d\d) GMT$/,ai=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) ( \d|\d\d) (\d\d):(\d\d):(\d\d) (\d{4})$/;function oi(e){const[,t,i,n,s,u,r,a]=e;return[ii(t,s,n,i,u,r,a),Re.utcInstance]}function Di(e){const[,t,i,n,s,u,r,a]=e;return[ii(t,a,i,n,s,u,r),Re.utcInstance]}const li=Mt(/([+-]\d{6}|\d{4})(?:-?(\d\d)(?:-?(\d\d))?)?/,Gt),ci=Mt(/(\d{4})-?W(\d\d)(?:-?(\d))?/,Gt),di=Mt(/(\d{4})-?(\d{3})/,Gt),hi=Mt(Wt),pi=Rt((function(e,t){return[{year:$t(e,t),month:$t(e,t+1,1),day:$t(e,t+2,1)},null,t+3]}),Zt,Jt,Kt),gi=Rt(Yt,Zt,Jt,Kt),Fi=Rt(Ut,Zt,Jt,Kt),fi=Rt(Zt,Jt,Kt),Ei=Rt(Zt),mi=Mt(/(\d{4})-(\d\d)-(\d\d)/,qt),Ci=Mt(zt),yi=Rt(Zt,Jt,Kt),wi={weeks:{days:7,hours:168,minutes:10080,seconds:604800,milliseconds:6048e5},days:{hours:24,minutes:1440,seconds:86400,milliseconds:864e5},hours:{minutes:60,seconds:3600,milliseconds:36e5},minutes:{seconds:60,milliseconds:6e4},seconds:{milliseconds:1e3}},vi={years:{quarters:4,months:12,weeks:52,days:365,hours:8760,minutes:525600,seconds:31536e3,milliseconds:31536e6},quarters:{months:3,weeks:13,days:91,hours:2184,minutes:131040,seconds:7862400,milliseconds:78624e5},months:{weeks:4,days:30,hours:720,minutes:43200,seconds:2592e3,milliseconds:2592e6},...wi},bi={years:{quarters:4,months:12,weeks:52.1775,days:365.2425,hours:8765.82,minutes:525949.2,seconds:525949.2*60,milliseconds:525949.2*60*1e3},quarters:{months:3,weeks:13.044375,days:91.310625,hours:2191.455,minutes:131487.3,seconds:525949.2*60/4,milliseconds:7889237999.999999},months:{weeks:30.436875/7,days:30.436875,hours:730.485,minutes:43829.1,seconds:2629746,milliseconds:2629746e3},...wi},Si=["years","quarters","months","weeks","days","hours","minutes","seconds","milliseconds"],xi=Si.slice(0).reverse();function Ai(e,t,i=!1){const n={values:i?t.values:{...e.values,...t.values||{}},loc:e.loc.clone(t.loc),conversionAccuracy:t.conversionAccuracy||e.conversionAccuracy,matrix:t.matrix||e.matrix};return new Bi(n)}function Ti(e,t,i,n,s){const u=e[s][i],r=t[i]/u,a=Math.sign(r)!==Math.sign(n[s])&&0!==n[s]&&Math.abs(r)<=1?function(e){return e<0?Math.floor(e):Math.ceil(e)}(r):Math.trunc(r);n[s]+=a,t[i]-=a*u}class Bi{constructor(e){const t="longterm"===e.conversionAccuracy||!1;let i=t?bi:vi;e.matrix&&(i=e.matrix),this.values=e.values,this.loc=e.loc||_e.create(),this.conversionAccuracy=t?"longterm":"casual",this.invalid=e.invalid||null,this.matrix=i,this.isLuxonDuration=!0}static fromMillis(e,t){return Bi.fromObject({milliseconds:e},t)}static fromObject(e,t={}){if(null==e||"object"!=typeof e)throw new U("Duration.fromObject: argument expected to be an object, got "+(null===e?"null":typeof e));return new Bi({values:gt(e,Bi.normalizeUnit),loc:_e.fromObject(t),conversionAccuracy:t.conversionAccuracy,matrix:t.matrix})}static fromDurationLike(e){if(Ze(e))return Bi.fromMillis(e);if(Bi.isDuration(e))return e;if("object"==typeof e)return Bi.fromObject(e);throw new U(`Unknown duration argument ${e} of type ${typeof e}`)}static fromISO(e,t){const[i]=function(e){return Pt(e,[Qt,ei])}(e);return i?Bi.fromObject(i,t):Bi.invalid("unparsable",`the input "${e}" can't be parsed as ISO 8601`)}static fromISOTime(e,t){const[i]=function(e){return Pt(e,[Xt,Ei])}(e);return i?Bi.fromObject(i,t):Bi.invalid("unparsable",`the input "${e}" can't be parsed as ISO 8601`)}static invalid(e,t=null){if(!e)throw new U("need to specify a reason the Duration is invalid");const i=e instanceof It?e:new It(e,t);if(qe.throwOnInvalid)throw new W(i);return new Bi({invalid:i})}static normalizeUnit(e){const t={year:"years",years:"years",quarter:"quarters",quarters:"quarters",month:"months",months:"months",week:"weeks",weeks:"weeks",day:"days",days:"days",hour:"hours",hours:"hours",minute:"minutes",minutes:"minutes",second:"seconds",seconds:"seconds",millisecond:"milliseconds",milliseconds:"milliseconds"}[e?e.toLowerCase():e];if(!t)throw new Y(e);return t}static isDuration(e){return e&&e.isLuxonDuration||!1}get locale(){return this.isValid?this.loc.locale:null}get numberingSystem(){return this.isValid?this.loc.numberingSystem:null}toFormat(e,t={}){const i={...t,floor:!1!==t.round&&!1!==t.floor};return this.isValid?kt.create(this.loc,i).formatDurationFromString(this,e):"Invalid Duration"}toHuman(e={}){const t=Si.map((t=>{const i=this.values[t];return $e(i)?null:this.loc.numberFormatter({style:"unit",unitDisplay:"long",...e,unit:t.slice(0,-1)}).format(i)})).filter((e=>e));return this.loc.listFormatter({type:"conjunction",style:e.listStyle||"narrow",...e}).format(t)}toObject(){return this.isValid?{...this.values}:{}}toISO(){if(!this.isValid)return null;let e="P";return 0!==this.years&&(e+=this.years+"Y"),0===this.months&&0===this.quarters||(e+=this.months+3*this.quarters+"M"),0!==this.weeks&&(e+=this.weeks+"W"),0!==this.days&&(e+=this.days+"D"),0===this.hours&&0===this.minutes&&0===this.seconds&&0===this.milliseconds||(e+="T"),0!==this.hours&&(e+=this.hours+"H"),0!==this.minutes&&(e+=this.minutes+"M"),0===this.seconds&&0===this.milliseconds||(e+=ut(this.seconds+this.milliseconds/1e3,3)+"S"),"P"===e&&(e+="T0S"),e}toISOTime(e={}){if(!this.isValid)return null;const t=this.toMillis();if(t<0||t>=864e5)return null;e={suppressMilliseconds:!1,suppressSeconds:!1,includePrefix:!1,format:"extended",...e};const i=this.shiftTo("hours","minutes","seconds","milliseconds");let n="basic"===e.format?"hhmm":"hh:mm";e.suppressSeconds&&0===i.seconds&&0===i.milliseconds||(n+="basic"===e.format?"ss":":ss",e.suppressMilliseconds&&0===i.milliseconds||(n+=".SSS"));let s=i.toFormat(n);return e.includePrefix&&(s="T"+s),s}toJSON(){return this.toISO()}toString(){return this.toISO()}toMillis(){return this.as("milliseconds")}valueOf(){return this.toMillis()}plus(e){if(!this.isValid)return this;const t=Bi.fromDurationLike(e),i={};for(const e of Si)(Qe(t.values,e)||Qe(this.values,e))&&(i[e]=t.get(e)+this.get(e));return Ai(this,{values:i},!0)}minus(e){if(!this.isValid)return this;const t=Bi.fromDurationLike(e);return this.plus(t.negate())}mapUnits(e){if(!this.isValid)return this;const t={};for(const i of Object.keys(this.values))t[i]=pt(e(this.values[i],i));return Ai(this,{values:t},!0)}get(e){return this[Bi.normalizeUnit(e)]}set(e){return this.isValid?Ai(this,{values:{...this.values,...gt(e,Bi.normalizeUnit)}}):this}reconfigure({locale:e,numberingSystem:t,conversionAccuracy:i,matrix:n}={}){return Ai(this,{loc:this.loc.clone({locale:e,numberingSystem:t}),matrix:n,conversionAccuracy:i})}as(e){return this.isValid?this.shiftTo(e).get(e):NaN}normalize(){if(!this.isValid)return this;const e=this.toObject();return function(e,t){xi.reduce(((i,n)=>$e(t[n])?i:(i&&Ti(e,t,i,t,n),n)),null)}(this.matrix,e),Ai(this,{values:e},!0)}rescale(){return this.isValid?Ai(this,{values:function(e){const t={};for(const[i,n]of Object.entries(e))0!==n&&(t[i]=n);return t}(this.normalize().shiftToAll().toObject())},!0):this}shiftTo(...e){if(!this.isValid)return this;if(0===e.length)return this;e=e.map((e=>Bi.normalizeUnit(e)));const t={},i={},n=this.toObject();let s;for(const u of Si)if(e.indexOf(u)>=0){s=u;let e=0;for(const t in i)e+=this.matrix[t][u]*i[t],i[t]=0;Ze(n[u])&&(e+=n[u]);const r=Math.trunc(e);t[u]=r,i[u]=(1e3*e-1e3*r)/1e3;for(const e in n)Si.indexOf(e)>Si.indexOf(u)&&Ti(this.matrix,n,e,t,u)}else Ze(n[u])&&(i[u]=n[u]);for(const e in i)0!==i[e]&&(t[s]+=e===s?i[e]:i[e]/this.matrix[s][e]);return Ai(this,{values:t},!0).normalize()}shiftToAll(){return this.isValid?this.shiftTo("years","months","weeks","days","hours","minutes","seconds","milliseconds"):this}negate(){if(!this.isValid)return this;const e={};for(const t of Object.keys(this.values))e[t]=0===this.values[t]?0:-this.values[t];return Ai(this,{values:e},!0)}get years(){return this.isValid?this.values.years||0:NaN}get quarters(){return this.isValid?this.values.quarters||0:NaN}get months(){return this.isValid?this.values.months||0:NaN}get weeks(){return this.isValid?this.values.weeks||0:NaN}get days(){return this.isValid?this.values.days||0:NaN}get hours(){return this.isValid?this.values.hours||0:NaN}get minutes(){return this.isValid?this.values.minutes||0:NaN}get seconds(){return this.isValid?this.values.seconds||0:NaN}get milliseconds(){return this.isValid?this.values.milliseconds||0:NaN}get isValid(){return null===this.invalid}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}equals(e){if(!this.isValid||!e.isValid)return!1;if(!this.loc.equals(e.loc))return!1;for(const n of Si)if(t=this.values[n],i=e.values[n],!(void 0===t||0===t?void 0===i||0===i:t===i))return!1;var t,i;return!0}}const Oi="Invalid Interval";class Ni{constructor(e){this.s=e.start,this.e=e.end,this.invalid=e.invalid||null,this.isLuxonInterval=!0}static invalid(e,t=null){if(!e)throw new U("need to specify a reason the Interval is invalid");const i=e instanceof It?e:new It(e,t);if(qe.throwOnInvalid)throw new j(i);return new Ni({invalid:i})}static fromDateTimes(e,t){const i=kn(e),n=kn(t),s=function(e,t){return e&&e.isValid?t&&t.isValid?t<e?Ni.invalid("end before start",`The end of an interval must be after its start, but you had start=${e.toISO()} and end=${t.toISO()}`):null:Ni.invalid("missing or invalid end"):Ni.invalid("missing or invalid start")}(i,n);return null==s?new Ni({start:i,end:n}):s}static after(e,t){const i=Bi.fromDurationLike(t),n=kn(e);return Ni.fromDateTimes(n,n.plus(i))}static before(e,t){const i=Bi.fromDurationLike(t),n=kn(e);return Ni.fromDateTimes(n.minus(i),n)}static fromISO(e,t){const[i,n]=(e||"").split("/",2);if(i&&n){let e,s,u,r;try{e=Ln.fromISO(i,t),s=e.isValid}catch(n){s=!1}try{u=Ln.fromISO(n,t),r=u.isValid}catch(n){r=!1}if(s&&r)return Ni.fromDateTimes(e,u);if(s){const i=Bi.fromISO(n,t);if(i.isValid)return Ni.after(e,i)}else if(r){const e=Bi.fromISO(i,t);if(e.isValid)return Ni.before(u,e)}}return Ni.invalid("unparsable",`the input "${e}" can't be parsed as ISO 8601`)}static isInterval(e){return e&&e.isLuxonInterval||!1}get start(){return this.isValid?this.s:null}get end(){return this.isValid?this.e:null}get isValid(){return null===this.invalidReason}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}length(e="milliseconds"){return this.isValid?this.toDuration(e).get(e):NaN}count(e="milliseconds"){if(!this.isValid)return NaN;const t=this.start.startOf(e),i=this.end.startOf(e);return Math.floor(i.diff(t,e).get(e))+1}hasSame(e){return!!this.isValid&&(this.isEmpty()||this.e.minus(1).hasSame(this.s,e))}isEmpty(){return this.s.valueOf()===this.e.valueOf()}isAfter(e){return!!this.isValid&&this.s>e}isBefore(e){return!!this.isValid&&this.e<=e}contains(e){return!!this.isValid&&this.s<=e&&this.e>e}set({start:e,end:t}={}){return this.isValid?Ni.fromDateTimes(e||this.s,t||this.e):this}splitAt(...e){if(!this.isValid)return[];const t=e.map(kn).filter((e=>this.contains(e))).sort(),i=[];let{s:n}=this,s=0;for(;n<this.e;){const e=t[s]||this.e,u=+e>+this.e?this.e:e;i.push(Ni.fromDateTimes(n,u)),n=u,s+=1}return i}splitBy(e){const t=Bi.fromDurationLike(e);if(!this.isValid||!t.isValid||0===t.as("milliseconds"))return[];let i,{s:n}=this,s=1;const u=[];for(;n<this.e;){const e=this.start.plus(t.mapUnits((e=>e*s)));i=+e>+this.e?this.e:e,u.push(Ni.fromDateTimes(n,i)),n=i,s+=1}return u}divideEqually(e){return this.isValid?this.splitBy(this.length()/e).slice(0,e):[]}overlaps(e){return this.e>e.s&&this.s<e.e}abutsStart(e){return!!this.isValid&&+this.e==+e.s}abutsEnd(e){return!!this.isValid&&+e.e==+this.s}engulfs(e){return!!this.isValid&&this.s<=e.s&&this.e>=e.e}equals(e){return!(!this.isValid||!e.isValid)&&this.s.equals(e.s)&&this.e.equals(e.e)}intersection(e){if(!this.isValid)return this;const t=this.s>e.s?this.s:e.s,i=this.e<e.e?this.e:e.e;return t>=i?null:Ni.fromDateTimes(t,i)}union(e){if(!this.isValid)return this;const t=this.s<e.s?this.s:e.s,i=this.e>e.e?this.e:e.e;return Ni.fromDateTimes(t,i)}static merge(e){const[t,i]=e.sort(((e,t)=>e.s-t.s)).reduce((([e,t],i)=>t?t.overlaps(i)||t.abutsStart(i)?[e,t.union(i)]:[e.concat([t]),i]:[e,i]),[[],null]);return i&&t.push(i),t}static xor(e){let t=null,i=0;const n=[],s=e.map((e=>[{time:e.s,type:"s"},{time:e.e,type:"e"}])),u=Array.prototype.concat(...s).sort(((e,t)=>e.time-t.time));for(const e of u)i+="s"===e.type?1:-1,1===i?t=e.time:(t&&+t!=+e.time&&n.push(Ni.fromDateTimes(t,e.time)),t=null);return Ni.merge(n)}difference(...e){return Ni.xor([this].concat(e)).map((e=>this.intersection(e))).filter((e=>e&&!e.isEmpty()))}toString(){return this.isValid?`[${this.s.toISO()} â€“ ${this.e.toISO()})`:Oi}toLocaleString(e=J,t={}){return this.isValid?kt.create(this.s.loc.clone(t),e).formatInterval(this):Oi}toISO(e){return this.isValid?`${this.s.toISO(e)}/${this.e.toISO(e)}`:Oi}toISODate(){return this.isValid?`${this.s.toISODate()}/${this.e.toISODate()}`:Oi}toISOTime(e){return this.isValid?`${this.s.toISOTime(e)}/${this.e.toISOTime(e)}`:Oi}toFormat(e,{separator:t=" â€“ "}={}){return this.isValid?`${this.s.toFormat(e)}${t}${this.e.toFormat(e)}`:Oi}toDuration(e,t){return this.isValid?this.e.diff(this.s,e,t):Bi.invalid(this.invalidReason)}mapEndpoints(e){return Ni.fromDateTimes(e(this.s),e(this.e))}}class Li{static hasDST(e=qe.defaultZone){const t=Ln.now().setZone(e).set({month:12});return!e.isUniversal&&t.offset!==t.set({month:6}).offset}static isValidIANAZone(e){return be.isValidZone(e)}static normalizeZone(e){return Ve(e,qe.defaultZone)}static months(e="long",{locale:t=null,numberingSystem:i=null,locObj:n=null,outputCalendar:s="gregory"}={}){return(n||_e.create(t,i,s)).months(e)}static monthsFormat(e="long",{locale:t=null,numberingSystem:i=null,locObj:n=null,outputCalendar:s="gregory"}={}){return(n||_e.create(t,i,s)).months(e,!0)}static weekdays(e="long",{locale:t=null,numberingSystem:i=null,locObj:n=null}={}){return(n||_e.create(t,i,null)).weekdays(e)}static weekdaysFormat(e="long",{locale:t=null,numberingSystem:i=null,locObj:n=null}={}){return(n||_e.create(t,i,null)).weekdays(e,!0)}static meridiems({locale:e=null}={}){return _e.create(e).meridiems()}static eras(e="short",{locale:t=null}={}){return _e.create(t,null,"gregory").eras(e)}static features(){return{relative:Ke()}}}function ki(e,t){const i=e=>e.toUTC(0,{keepLocalTime:!0}).startOf("day").valueOf(),n=i(t)-i(e);return Math.floor(Bi.fromMillis(n).as("days"))}const Ii={arab:"[Ù -Ù©]",arabext:"[Û°-Û¹]",bali:"[á­-á­™]",beng:"[à§¦-à§¯]",deva:"[à¥¦-à¥¯]",fullwide:"[ï¼-ï¼™]",gujr:"[à«¦-à«¯]",hanidec:"[ã€‡|ä¸€|äºŒ|ä¸‰|å››|äº”|å…­|ä¸ƒ|å…«|ä¹]",khmr:"[áŸ -áŸ©]",knda:"[à³¦-à³¯]",laoo:"[à»-à»™]",limb:"[á¥†-á¥]",mlym:"[àµ¦-àµ¯]",mong:"[á -á ™]",mymr:"[á€-á‰]",orya:"[à­¦-à­¯]",tamldec:"[à¯¦-à¯¯]",telu:"[à±¦-à±¯]",thai:"[à¹-à¹™]",tibt:"[à¼ -à¼©]",latn:"\\d"},_i={arab:[1632,1641],arabext:[1776,1785],bali:[6992,7001],beng:[2534,2543],deva:[2406,2415],fullwide:[65296,65303],gujr:[2790,2799],khmr:[6112,6121],knda:[3302,3311],laoo:[3792,3801],limb:[6470,6479],mlym:[3430,3439],mong:[6160,6169],mymr:[4160,4169],orya:[2918,2927],tamldec:[3046,3055],telu:[3174,3183],thai:[3664,3673],tibt:[3872,3881]},Mi=Ii.hanidec.replace(/[\[|\]]/g,"").split("");function Ri({numberingSystem:e},t=""){return new RegExp(`${Ii[e||"latn"]}${t}`)}function Pi(e,t=(e=>e)){return{regex:e,deser:([e])=>t(function(e){let t=parseInt(e,10);if(isNaN(t)){t="";for(let i=0;i<e.length;i++){const n=e.charCodeAt(i);if(-1!==e[i].search(Ii.hanidec))t+=Mi.indexOf(e[i]);else for(const e in _i){const[i,s]=_i[e];n>=i&&n<=s&&(t+=n-i)}}return parseInt(t,10)}return t}(e))}}const Vi=`[ ${String.fromCharCode(160)}]`,Hi=new RegExp(Vi,"g");function ji(e){return e.replace(/\./g,"\\.?").replace(Hi,Vi)}function Wi(e){return e.replace(/\./g,"").replace(Hi," ").toLowerCase()}function Gi(e,t){return null===e?null:{regex:RegExp(e.map(ji).join("|")),deser:([i])=>e.findIndex((e=>Wi(i)===Wi(e)))+t}}function Yi(e,t){return{regex:e,deser:([,e,t])=>ht(e,t),groups:t}}function Ui(e){return{regex:e,deser:([e])=>e}}const zi={year:{"2-digit":"yy",numeric:"yyyyy"},month:{numeric:"M","2-digit":"MM",short:"MMM",long:"MMMM"},day:{numeric:"d","2-digit":"dd"},weekday:{short:"EEE",long:"EEEE"},dayperiod:"a",dayPeriod:"a",hour:{numeric:"h","2-digit":"hh"},minute:{numeric:"m","2-digit":"mm"},second:{numeric:"s","2-digit":"ss"},timeZoneName:{long:"ZZZZZ",short:"ZZZ"}};let qi=null;function $i(e,t){return Array.prototype.concat(...e.map((e=>function(e,t){if(e.literal)return e;const i=Ji(kt.macroTokenToFormatOpts(e.val),t);return null==i||i.includes(void 0)?e:i}(e,t))))}function Zi(e,t,i){const n=$i(kt.parseFormat(i),e),s=n.map((t=>function(e,t){const i=Ri(t),n=Ri(t,"{2}"),s=Ri(t,"{3}"),u=Ri(t,"{4}"),r=Ri(t,"{6}"),a=Ri(t,"{1,2}"),o=Ri(t,"{1,3}"),D=Ri(t,"{1,6}"),l=Ri(t,"{1,9}"),c=Ri(t,"{2,4}"),d=Ri(t,"{4,6}"),h=e=>{return{regex:RegExp((t=e.val,t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&"))),deser:([e])=>e,literal:!0};var t},p=(p=>{if(e.literal)return h(p);switch(p.val){case"G":return Gi(t.eras("short",!1),0);case"GG":return Gi(t.eras("long",!1),0);case"y":return Pi(D);case"yy":case"kk":return Pi(c,ct);case"yyyy":case"kkkk":return Pi(u);case"yyyyy":return Pi(d);case"yyyyyy":return Pi(r);case"M":case"L":case"d":case"H":case"h":case"m":case"q":case"s":case"W":return Pi(a);case"MM":case"LL":case"dd":case"HH":case"hh":case"mm":case"qq":case"ss":case"WW":return Pi(n);case"MMM":return Gi(t.months("short",!0,!1),1);case"MMMM":return Gi(t.months("long",!0,!1),1);case"LLL":return Gi(t.months("short",!1,!1),1);case"LLLL":return Gi(t.months("long",!1,!1),1);case"o":case"S":return Pi(o);case"ooo":case"SSS":return Pi(s);case"u":return Ui(l);case"uu":return Ui(a);case"uuu":case"E":case"c":return Pi(i);case"a":return Gi(t.meridiems(),0);case"EEE":return Gi(t.weekdays("short",!1,!1),1);case"EEEE":return Gi(t.weekdays("long",!1,!1),1);case"ccc":return Gi(t.weekdays("short",!0,!1),1);case"cccc":return Gi(t.weekdays("long",!0,!1),1);case"Z":case"ZZ":return Yi(new RegExp(`([+-]${a.source})(?::(${n.source}))?`),2);case"ZZZ":return Yi(new RegExp(`([+-]${a.source})(${n.source})?`),2);case"z":return Ui(/[a-z_+-/]{1,256}?/i);default:return h(p)}})(e)||{invalidReason:"missing Intl.DateTimeFormat.formatToParts support"};return p.token=e,p}(t,e))),u=s.find((e=>e.invalidReason));if(u)return{input:t,tokens:n,invalidReason:u.invalidReason};{const[e,i]=function(e){return[`^${e.map((e=>e.regex)).reduce(((e,t)=>`${e}(${t.source})`),"")}$`,e]}(s),u=RegExp(e,"i"),[r,a]=function(e,t,i){const n=e.match(t);if(n){const e={};let t=1;for(const s in i)if(Qe(i,s)){const u=i[s],r=u.groups?u.groups+1:1;!u.literal&&u.token&&(e[u.token.val[0]]=u.deser(n.slice(t,t+r))),t+=r}return[n,e]}return[n,{}]}(t,u,i),[o,D,l]=a?function(e){let t,i=null;return $e(e.z)||(i=be.create(e.z)),$e(e.Z)||(i||(i=new Re(e.Z)),t=e.Z),$e(e.q)||(e.M=3*(e.q-1)+1),$e(e.h)||(e.h<12&&1===e.a?e.h+=12:12===e.h&&0===e.a&&(e.h=0)),0===e.G&&e.y&&(e.y=-e.y),$e(e.u)||(e.S=st(e.u)),[Object.keys(e).reduce(((t,i)=>{const n=(e=>{switch(e){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":case"H":return"hour";case"d":return"day";case"o":return"ordinal";case"L":case"M":return"month";case"y":return"year";case"E":case"c":return"weekday";case"W":return"weekNumber";case"k":return"weekYear";case"q":return"quarter";default:return null}})(i);return n&&(t[n]=e[i]),t}),{}),i,t]}(a):[null,null,void 0];if(Qe(a,"a")&&Qe(a,"H"))throw new G("Can't include meridiem when specifying 24-hour format");return{input:t,tokens:n,regex:u,rawMatches:r,matches:a,result:o,zone:D,specificOffset:l}}}function Ji(e,t){return e?kt.create(t,e).formatDateTimeParts((qi||(qi=Ln.fromMillis(1555555555555)),qi)).map((t=>function(e,t){const{type:i,value:n}=e;if("literal"===i)return{literal:!0,val:n};const s=t[i];let u=zi[i];return"object"==typeof u&&(u=u[s]),u?{literal:!1,val:u}:void 0}(t,e))):null}const Ki=[0,31,59,90,120,151,181,212,243,273,304,334],Xi=[0,31,60,91,121,152,182,213,244,274,305,335];function Qi(e,t){return new It("unit out of range",`you specified ${t} (of type ${typeof t}) as a ${e}, which is invalid`)}function en(e,t,i){const n=new Date(Date.UTC(e,t-1,i));e<100&&e>=0&&n.setUTCFullYear(n.getUTCFullYear()-1900);const s=n.getUTCDay();return 0===s?7:s}function tn(e,t,i){return i+(rt(e)?Xi:Ki)[t-1]}function nn(e,t){const i=rt(e)?Xi:Ki,n=i.findIndex((e=>e<t));return{month:n+1,day:t-i[n]}}function sn(e){const{year:t,month:i,day:n}=e,s=tn(t,i,n),u=en(t,i,n);let r,a=Math.floor((s-u+10)/7);return a<1?(r=t-1,a=lt(r)):a>lt(t)?(r=t+1,a=1):r=t,{weekYear:r,weekNumber:a,weekday:u,...ft(e)}}function un(e){const{weekYear:t,weekNumber:i,weekday:n}=e,s=en(t,1,4),u=at(t);let r,a=7*i+n-s-3;a<1?(r=t-1,a+=at(r)):a>u?(r=t+1,a-=at(t)):r=t;const{month:o,day:D}=nn(r,a);return{year:r,month:o,day:D,...ft(e)}}function rn(e){const{year:t,month:i,day:n}=e;return{year:t,ordinal:tn(t,i,n),...ft(e)}}function an(e){const{year:t,ordinal:i}=e,{month:n,day:s}=nn(t,i);return{year:t,month:n,day:s,...ft(e)}}function on(e){const t=Je(e.year),i=et(e.month,1,12),n=et(e.day,1,ot(e.year,e.month));return t?i?!n&&Qi("day",e.day):Qi("month",e.month):Qi("year",e.year)}function Dn(e){const{hour:t,minute:i,second:n,millisecond:s}=e,u=et(t,0,23)||24===t&&0===i&&0===n&&0===s,r=et(i,0,59),a=et(n,0,59),o=et(s,0,999);return u?r?a?!o&&Qi("millisecond",s):Qi("second",n):Qi("minute",i):Qi("hour",t)}const ln="Invalid DateTime";function cn(e){return new It("unsupported zone",`the zone "${e.name}" is not supported`)}function dn(e){return null===e.weekData&&(e.weekData=sn(e.c)),e.weekData}function hn(e,t){const i={ts:e.ts,zone:e.zone,c:e.c,o:e.o,loc:e.loc,invalid:e.invalid};return new Ln({...i,...t,old:i})}function pn(e,t,i){let n=e-60*t*1e3;const s=i.offset(n);if(t===s)return[n,t];n-=60*(s-t)*1e3;const u=i.offset(n);return s===u?[n,s]:[e-60*Math.min(s,u)*1e3,Math.max(s,u)]}function gn(e,t){const i=new Date(e+=60*t*1e3);return{year:i.getUTCFullYear(),month:i.getUTCMonth()+1,day:i.getUTCDate(),hour:i.getUTCHours(),minute:i.getUTCMinutes(),second:i.getUTCSeconds(),millisecond:i.getUTCMilliseconds()}}function Fn(e,t,i){return pn(Dt(e),t,i)}function fn(e,t){const i=e.o,n=e.c.year+Math.trunc(t.years),s=e.c.month+Math.trunc(t.months)+3*Math.trunc(t.quarters),u={...e.c,year:n,month:s,day:Math.min(e.c.day,ot(n,s))+Math.trunc(t.days)+7*Math.trunc(t.weeks)},r=Bi.fromObject({years:t.years-Math.trunc(t.years),quarters:t.quarters-Math.trunc(t.quarters),months:t.months-Math.trunc(t.months),weeks:t.weeks-Math.trunc(t.weeks),days:t.days-Math.trunc(t.days),hours:t.hours,minutes:t.minutes,seconds:t.seconds,milliseconds:t.milliseconds}).as("milliseconds"),a=Dt(u);let[o,D]=pn(a,i,e.zone);return 0!==r&&(o+=r,D=e.zone.offset(o)),{ts:o,o:D}}function En(e,t,i,n,s,u){const{setZone:r,zone:a}=i;if(e&&0!==Object.keys(e).length){const n=t||a,s=Ln.fromObject(e,{...i,zone:n,specificOffset:u});return r?s:s.setZone(a)}return Ln.invalid(new It("unparsable",`the input "${s}" can't be parsed as ${n}`))}function mn(e,t,i=!0){return e.isValid?kt.create(_e.create("en-US"),{allowZ:i,forceSimple:!0}).formatDateTimeFromString(e,t):null}function Cn(e,t){const i=e.c.year>9999||e.c.year<0;let n="";return i&&e.c.year>=0&&(n+="+"),n+=tt(e.c.year,i?6:4),t?(n+="-",n+=tt(e.c.month),n+="-",n+=tt(e.c.day)):(n+=tt(e.c.month),n+=tt(e.c.day)),n}function yn(e,t,i,n,s,u){let r=tt(e.c.hour);return t?(r+=":",r+=tt(e.c.minute),0===e.c.second&&i||(r+=":")):r+=tt(e.c.minute),0===e.c.second&&i||(r+=tt(e.c.second),0===e.c.millisecond&&n||(r+=".",r+=tt(e.c.millisecond,3))),s&&(e.isOffsetFixed&&0===e.offset&&!u?r+="Z":e.o<0?(r+="-",r+=tt(Math.trunc(-e.o/60)),r+=":",r+=tt(Math.trunc(-e.o%60))):(r+="+",r+=tt(Math.trunc(e.o/60)),r+=":",r+=tt(Math.trunc(e.o%60)))),u&&(r+="["+e.zone.ianaName+"]"),r}const wn={month:1,day:1,hour:0,minute:0,second:0,millisecond:0},vn={weekNumber:1,weekday:1,hour:0,minute:0,second:0,millisecond:0},bn={ordinal:1,hour:0,minute:0,second:0,millisecond:0},Sn=["year","month","day","hour","minute","second","millisecond"],xn=["weekYear","weekNumber","weekday","hour","minute","second","millisecond"],An=["year","ordinal","hour","minute","second","millisecond"];function Tn(e){const t={year:"year",years:"year",month:"month",months:"month",day:"day",days:"day",hour:"hour",hours:"hour",minute:"minute",minutes:"minute",quarter:"quarter",quarters:"quarter",second:"second",seconds:"second",millisecond:"millisecond",milliseconds:"millisecond",weekday:"weekday",weekdays:"weekday",weeknumber:"weekNumber",weeksnumber:"weekNumber",weeknumbers:"weekNumber",weekyear:"weekYear",weekyears:"weekYear",ordinal:"ordinal"}[e.toLowerCase()];if(!t)throw new Y(e);return t}function Bn(e,t){const i=Ve(t.zone,qe.defaultZone),n=_e.fromObject(t),s=qe.now();let u,r;if($e(e.year))u=s;else{for(const t of Sn)$e(e[t])&&(e[t]=wn[t]);const t=on(e)||Dn(e);if(t)return Ln.invalid(t);const n=i.offset(s);[u,r]=Fn(e,n,i)}return new Ln({ts:u,zone:i,loc:n,o:r})}function On(e,t,i){const n=!!$e(i.round)||i.round,s=(e,s)=>(e=ut(e,n||i.calendary?0:2,!0),t.loc.clone(i).relFormatter(i).format(e,s)),u=n=>i.calendary?t.hasSame(e,n)?0:t.startOf(n).diff(e.startOf(n),n).get(n):t.diff(e,n).get(n);if(i.unit)return s(u(i.unit),i.unit);for(const e of i.units){const t=u(e);if(Math.abs(t)>=1)return s(t,e)}return s(e>t?-0:0,i.units[i.units.length-1])}function Nn(e){let t,i={};return e.length>0&&"object"==typeof e[e.length-1]?(i=e[e.length-1],t=Array.from(e).slice(0,e.length-1)):t=Array.from(e),[i,t]}class Ln{constructor(e){const t=e.zone||qe.defaultZone;let i=e.invalid||(Number.isNaN(e.ts)?new It("invalid input"):null)||(t.isValid?null:cn(t));this.ts=$e(e.ts)?qe.now():e.ts;let n=null,s=null;if(!i)if(e.old&&e.old.ts===this.ts&&e.old.zone.equals(t))[n,s]=[e.old.c,e.old.o];else{const e=t.offset(this.ts);n=gn(this.ts,e),i=Number.isNaN(n.year)?new It("invalid input"):null,n=i?null:n,s=i?null:e}this._zone=t,this.loc=e.loc||_e.create(),this.invalid=i,this.weekData=null,this.c=n,this.o=s,this.isLuxonDateTime=!0}static now(){return new Ln({})}static local(){const[e,t]=Nn(arguments),[i,n,s,u,r,a,o]=t;return Bn({year:i,month:n,day:s,hour:u,minute:r,second:a,millisecond:o},e)}static utc(){const[e,t]=Nn(arguments),[i,n,s,u,r,a,o]=t;return e.zone=Re.utcInstance,Bn({year:i,month:n,day:s,hour:u,minute:r,second:a,millisecond:o},e)}static fromJSDate(e,t={}){const i=(n=e,"[object Date]"===Object.prototype.toString.call(n)?e.valueOf():NaN);var n;if(Number.isNaN(i))return Ln.invalid("invalid input");const s=Ve(t.zone,qe.defaultZone);return s.isValid?new Ln({ts:i,zone:s,loc:_e.fromObject(t)}):Ln.invalid(cn(s))}static fromMillis(e,t={}){if(Ze(e))return e<-864e13||e>864e13?Ln.invalid("Timestamp out of range"):new Ln({ts:e,zone:Ve(t.zone,qe.defaultZone),loc:_e.fromObject(t)});throw new U(`fromMillis requires a numerical input, but received a ${typeof e} with value ${e}`)}static fromSeconds(e,t={}){if(Ze(e))return new Ln({ts:1e3*e,zone:Ve(t.zone,qe.defaultZone),loc:_e.fromObject(t)});throw new U("fromSeconds requires a numerical input")}static fromObject(e,t={}){e=e||{};const i=Ve(t.zone,qe.defaultZone);if(!i.isValid)return Ln.invalid(cn(i));const n=qe.now(),s=$e(t.specificOffset)?i.offset(n):t.specificOffset,u=gt(e,Tn),r=!$e(u.ordinal),a=!$e(u.year),o=!$e(u.month)||!$e(u.day),D=a||o,l=u.weekYear||u.weekNumber,c=_e.fromObject(t);if((D||r)&&l)throw new G("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(o&&r)throw new G("Can't mix ordinal dates with month/day");const d=l||u.weekday&&!D;let h,p,g=gn(n,s);d?(h=xn,p=vn,g=sn(g)):r?(h=An,p=bn,g=rn(g)):(h=Sn,p=wn);let F=!1;for(const e of h)$e(u[e])?u[e]=F?p[e]:g[e]:F=!0;const f=d?function(e){const t=Je(e.weekYear),i=et(e.weekNumber,1,lt(e.weekYear)),n=et(e.weekday,1,7);return t?i?!n&&Qi("weekday",e.weekday):Qi("week",e.week):Qi("weekYear",e.weekYear)}(u):r?function(e){const t=Je(e.year),i=et(e.ordinal,1,at(e.year));return t?!i&&Qi("ordinal",e.ordinal):Qi("year",e.year)}(u):on(u),E=f||Dn(u);if(E)return Ln.invalid(E);const m=d?un(u):r?an(u):u,[C,y]=Fn(m,s,i),w=new Ln({ts:C,zone:i,o:y,loc:c});return u.weekday&&D&&e.weekday!==w.weekday?Ln.invalid("mismatched weekday",`you can't specify both a weekday of ${u.weekday} and a date of ${w.toISO()}`):w}static fromISO(e,t={}){const[i,n]=function(e){return Pt(e,[li,pi],[ci,gi],[di,Fi],[hi,fi])}(e);return En(i,n,t,"ISO 8601",e)}static fromRFC2822(e,t={}){const[i,n]=function(e){return Pt(function(e){return e.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").trim()}(e),[ni,si])}(e);return En(i,n,t,"RFC 2822",e)}static fromHTTP(e,t={}){const[i,n]=function(e){return Pt(e,[ui,oi],[ri,oi],[ai,Di])}(e);return En(i,n,t,"HTTP",t)}static fromFormat(e,t,i={}){if($e(e)||$e(t))throw new U("fromFormat requires an input string and a format");const{locale:n=null,numberingSystem:s=null}=i,u=_e.fromOpts({locale:n,numberingSystem:s,defaultToEN:!0}),[r,a,o,D]=function(e,t,i){const{result:n,zone:s,specificOffset:u,invalidReason:r}=Zi(e,t,i);return[n,s,u,r]}(u,e,t);return D?Ln.invalid(D):En(r,a,i,`format ${t}`,e,o)}static fromString(e,t,i={}){return Ln.fromFormat(e,t,i)}static fromSQL(e,t={}){const[i,n]=function(e){return Pt(e,[mi,pi],[Ci,yi])}(e);return En(i,n,t,"SQL",e)}static invalid(e,t=null){if(!e)throw new U("need to specify a reason the DateTime is invalid");const i=e instanceof It?e:new It(e,t);if(qe.throwOnInvalid)throw new H(i);return new Ln({invalid:i})}static isDateTime(e){return e&&e.isLuxonDateTime||!1}static parseFormatForOpts(e,t={}){const i=Ji(e,_e.fromObject(t));return i?i.map((e=>e?e.val:null)).join(""):null}static expandFormat(e,t={}){return $i(kt.parseFormat(e),_e.fromObject(t)).map((e=>e.val)).join("")}get(e){return this[e]}get isValid(){return null===this.invalid}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}get locale(){return this.isValid?this.loc.locale:null}get numberingSystem(){return this.isValid?this.loc.numberingSystem:null}get outputCalendar(){return this.isValid?this.loc.outputCalendar:null}get zone(){return this._zone}get zoneName(){return this.isValid?this.zone.name:null}get year(){return this.isValid?this.c.year:NaN}get quarter(){return this.isValid?Math.ceil(this.c.month/3):NaN}get month(){return this.isValid?this.c.month:NaN}get day(){return this.isValid?this.c.day:NaN}get hour(){return this.isValid?this.c.hour:NaN}get minute(){return this.isValid?this.c.minute:NaN}get second(){return this.isValid?this.c.second:NaN}get millisecond(){return this.isValid?this.c.millisecond:NaN}get weekYear(){return this.isValid?dn(this).weekYear:NaN}get weekNumber(){return this.isValid?dn(this).weekNumber:NaN}get weekday(){return this.isValid?dn(this).weekday:NaN}get ordinal(){return this.isValid?rn(this.c).ordinal:NaN}get monthShort(){return this.isValid?Li.months("short",{locObj:this.loc})[this.month-1]:null}get monthLong(){return this.isValid?Li.months("long",{locObj:this.loc})[this.month-1]:null}get weekdayShort(){return this.isValid?Li.weekdays("short",{locObj:this.loc})[this.weekday-1]:null}get weekdayLong(){return this.isValid?Li.weekdays("long",{locObj:this.loc})[this.weekday-1]:null}get offset(){return this.isValid?+this.o:NaN}get offsetNameShort(){return this.isValid?this.zone.offsetName(this.ts,{format:"short",locale:this.locale}):null}get offsetNameLong(){return this.isValid?this.zone.offsetName(this.ts,{format:"long",locale:this.locale}):null}get isOffsetFixed(){return this.isValid?this.zone.isUniversal:null}get isInDST(){return!this.isOffsetFixed&&(this.offset>this.set({month:1,day:1}).offset||this.offset>this.set({month:5}).offset)}get isInLeapYear(){return rt(this.year)}get daysInMonth(){return ot(this.year,this.month)}get daysInYear(){return this.isValid?at(this.year):NaN}get weeksInWeekYear(){return this.isValid?lt(this.weekYear):NaN}resolvedLocaleOptions(e={}){const{locale:t,numberingSystem:i,calendar:n}=kt.create(this.loc.clone(e),e).resolvedOptions(this);return{locale:t,numberingSystem:i,outputCalendar:n}}toUTC(e=0,t={}){return this.setZone(Re.instance(e),t)}toLocal(){return this.setZone(qe.defaultZone)}setZone(e,{keepLocalTime:t=!1,keepCalendarTime:i=!1}={}){if((e=Ve(e,qe.defaultZone)).equals(this.zone))return this;if(e.isValid){let n=this.ts;if(t||i){const t=e.offset(this.ts),i=this.toObject();[n]=Fn(i,t,e)}return hn(this,{ts:n,zone:e})}return Ln.invalid(cn(e))}reconfigure({locale:e,numberingSystem:t,outputCalendar:i}={}){return hn(this,{loc:this.loc.clone({locale:e,numberingSystem:t,outputCalendar:i})})}setLocale(e){return this.reconfigure({locale:e})}set(e){if(!this.isValid)return this;const t=gt(e,Tn),i=!$e(t.weekYear)||!$e(t.weekNumber)||!$e(t.weekday),n=!$e(t.ordinal),s=!$e(t.year),u=!$e(t.month)||!$e(t.day),r=s||u,a=t.weekYear||t.weekNumber;if((r||n)&&a)throw new G("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(u&&n)throw new G("Can't mix ordinal dates with month/day");let o;i?o=un({...sn(this.c),...t}):$e(t.ordinal)?(o={...this.toObject(),...t},$e(t.day)&&(o.day=Math.min(ot(o.year,o.month),o.day))):o=an({...rn(this.c),...t});const[D,l]=Fn(o,this.o,this.zone);return hn(this,{ts:D,o:l})}plus(e){return this.isValid?hn(this,fn(this,Bi.fromDurationLike(e))):this}minus(e){return this.isValid?hn(this,fn(this,Bi.fromDurationLike(e).negate())):this}startOf(e){if(!this.isValid)return this;const t={},i=Bi.normalizeUnit(e);switch(i){case"years":t.month=1;case"quarters":case"months":t.day=1;case"weeks":case"days":t.hour=0;case"hours":t.minute=0;case"minutes":t.second=0;case"seconds":t.millisecond=0}if("weeks"===i&&(t.weekday=1),"quarters"===i){const e=Math.ceil(this.month/3);t.month=3*(e-1)+1}return this.set(t)}endOf(e){return this.isValid?this.plus({[e]:1}).startOf(e).minus(1):this}toFormat(e,t={}){return this.isValid?kt.create(this.loc.redefaultToEN(t)).formatDateTimeFromString(this,e):ln}toLocaleString(e=J,t={}){return this.isValid?kt.create(this.loc.clone(t),e).formatDateTime(this):ln}toLocaleParts(e={}){return this.isValid?kt.create(this.loc.clone(e),e).formatDateTimeParts(this):[]}toISO({format:e="extended",suppressSeconds:t=!1,suppressMilliseconds:i=!1,includeOffset:n=!0,extendedZone:s=!1}={}){if(!this.isValid)return null;const u="extended"===e;let r=Cn(this,u);return r+="T",r+=yn(this,u,t,i,n,s),r}toISODate({format:e="extended"}={}){return this.isValid?Cn(this,"extended"===e):null}toISOWeekDate(){return mn(this,"kkkk-'W'WW-c")}toISOTime({suppressMilliseconds:e=!1,suppressSeconds:t=!1,includeOffset:i=!0,includePrefix:n=!1,extendedZone:s=!1,format:u="extended"}={}){return this.isValid?(n?"T":"")+yn(this,"extended"===u,t,e,i,s):null}toRFC2822(){return mn(this,"EEE, dd LLL yyyy HH:mm:ss ZZZ",!1)}toHTTP(){return mn(this.toUTC(),"EEE, dd LLL yyyy HH:mm:ss 'GMT'")}toSQLDate(){return this.isValid?Cn(this,!0):null}toSQLTime({includeOffset:e=!0,includeZone:t=!1,includeOffsetSpace:i=!0}={}){let n="HH:mm:ss.SSS";return(t||e)&&(i&&(n+=" "),t?n+="z":e&&(n+="ZZ")),mn(this,n,!0)}toSQL(e={}){return this.isValid?`${this.toSQLDate()} ${this.toSQLTime(e)}`:null}toString(){return this.isValid?this.toISO():ln}valueOf(){return this.toMillis()}toMillis(){return this.isValid?this.ts:NaN}toSeconds(){return this.isValid?this.ts/1e3:NaN}toUnixInteger(){return this.isValid?Math.floor(this.ts/1e3):NaN}toJSON(){return this.toISO()}toBSON(){return this.toJSDate()}toObject(e={}){if(!this.isValid)return{};const t={...this.c};return e.includeConfig&&(t.outputCalendar=this.outputCalendar,t.numberingSystem=this.loc.numberingSystem,t.locale=this.loc.locale),t}toJSDate(){return new Date(this.isValid?this.ts:NaN)}diff(e,t="milliseconds",i={}){if(!this.isValid||!e.isValid)return Bi.invalid("created by diffing an invalid DateTime");const n={locale:this.locale,numberingSystem:this.numberingSystem,...i},s=(a=t,Array.isArray(a)?a:[a]).map(Bi.normalizeUnit),u=e.valueOf()>this.valueOf(),r=function(e,t,i,n){let[s,u,r,a]=function(e,t,i){const n=[["years",(e,t)=>t.year-e.year],["quarters",(e,t)=>t.quarter-e.quarter+4*(t.year-e.year)],["months",(e,t)=>t.month-e.month+12*(t.year-e.year)],["weeks",(e,t)=>{const i=ki(e,t);return(i-i%7)/7}],["days",ki]],s={},u=e;let r,a;for(const[o,D]of n)i.indexOf(o)>=0&&(r=o,s[o]=D(e,t),a=u.plus(s),a>t?(s[o]--,e=u.plus(s)):e=a);return[e,s,a,r]}(e,t,i);const o=t-s,D=i.filter((e=>["hours","minutes","seconds","milliseconds"].indexOf(e)>=0));0===D.length&&(r<t&&(r=s.plus({[a]:1})),r!==s&&(u[a]=(u[a]||0)+o/(r-s)));const l=Bi.fromObject(u,n);return D.length>0?Bi.fromMillis(o,n).shiftTo(...D).plus(l):l}(u?this:e,u?e:this,s,n);var a;return u?r.negate():r}diffNow(e="milliseconds",t={}){return this.diff(Ln.now(),e,t)}until(e){return this.isValid?Ni.fromDateTimes(this,e):this}hasSame(e,t){if(!this.isValid)return!1;const i=e.valueOf(),n=this.setZone(e.zone,{keepLocalTime:!0});return n.startOf(t)<=i&&i<=n.endOf(t)}equals(e){return this.isValid&&e.isValid&&this.valueOf()===e.valueOf()&&this.zone.equals(e.zone)&&this.loc.equals(e.loc)}toRelative(e={}){if(!this.isValid)return null;const t=e.base||Ln.fromObject({},{zone:this.zone}),i=e.padding?this<t?-e.padding:e.padding:0;let n=["years","months","days","hours","minutes","seconds"],s=e.unit;return Array.isArray(e.unit)&&(n=e.unit,s=void 0),On(t,this.plus(i),{...e,numeric:"always",units:n,unit:s})}toRelativeCalendar(e={}){return this.isValid?On(e.base||Ln.fromObject({},{zone:this.zone}),this,{...e,numeric:"auto",units:["years","months","days"],calendary:!0}):null}static min(...e){if(!e.every(Ln.isDateTime))throw new U("min requires all arguments be DateTimes");return Xe(e,(e=>e.valueOf()),Math.min)}static max(...e){if(!e.every(Ln.isDateTime))throw new U("max requires all arguments be DateTimes");return Xe(e,(e=>e.valueOf()),Math.max)}static fromFormatExplain(e,t,i={}){const{locale:n=null,numberingSystem:s=null}=i;return Zi(_e.fromOpts({locale:n,numberingSystem:s,defaultToEN:!0}),e,t)}static fromStringExplain(e,t,i={}){return Ln.fromFormatExplain(e,t,i)}static get DATE_SHORT(){return J}static get DATE_MED(){return K}static get DATE_MED_WITH_WEEKDAY(){return X}static get DATE_FULL(){return Q}static get DATE_HUGE(){return ee}static get TIME_SIMPLE(){return te}static get TIME_WITH_SECONDS(){return ie}static get TIME_WITH_SHORT_OFFSET(){return ne}static get TIME_WITH_LONG_OFFSET(){return se}static get TIME_24_SIMPLE(){return ue}static get TIME_24_WITH_SECONDS(){return re}static get TIME_24_WITH_SHORT_OFFSET(){return ae}static get TIME_24_WITH_LONG_OFFSET(){return oe}static get DATETIME_SHORT(){return De}static get DATETIME_SHORT_WITH_SECONDS(){return le}static get DATETIME_MED(){return ce}static get DATETIME_MED_WITH_SECONDS(){return de}static get DATETIME_MED_WITH_WEEKDAY(){return he}static get DATETIME_FULL(){return pe}static get DATETIME_FULL_WITH_SECONDS(){return ge}static get DATETIME_HUGE(){return Fe}static get DATETIME_HUGE_WITH_SECONDS(){return fe}}function kn(e){if(Ln.isDateTime(e))return e;if(e&&e.valueOf&&Ze(e.valueOf()))return Ln.fromJSDate(e);if(e&&"object"==typeof e)return Ln.fromObject(e);throw new U(`Unknown datetime argument: ${e}, of type ${typeof e}`)}const In={renderNullAs:"\\-",taskCompletionTracking:!1,taskCompletionUseEmojiShorthand:!1,taskCompletionText:"completion",taskCompletionDateFormat:"yyyy-MM-dd",recursiveSubTaskCompletion:!1,warnOnEmptyResult:!0,refreshEnabled:!0,refreshInterval:2500,defaultDateFormat:"MMMM dd, yyyy",defaultDateTimeFormat:"h:mm a - MMMM dd, yyyy",maxRecursiveRenderDepth:4,tableIdColumnName:"File",tableGroupColumnName:"Group",showResultCount:!0};class _n{constructor(e){this.value=e,this.successful=!0}map(e){return new _n(e(this.value))}flatMap(e){return e(this.value)}mapErr(e){return this}bimap(e,t){return this.map(e)}orElse(e){return this.value}cast(){return this}orElseThrow(e){return this.value}}class Mn{constructor(e){this.error=e,this.successful=!1}map(e){return this}flatMap(e){return this}mapErr(e){return new Mn(e(this.error))}bimap(e,t){return this.mapErr(t)}orElse(e){return e}cast(){return this}orElseThrow(e){throw e?new Error(e(this.error)):new Error(""+this.error)}}var Rn;!function(e){function t(e){return new _n(e)}function i(e){return new Mn(e)}function n(e,t,n){return e.successful?t.successful?n(e.value,t.value):i(t.error):i(e.error)}e.success=t,e.failure=i,e.flatMap2=n,e.map2=function(e,i,s){return n(e,i,((e,i)=>t(s(e,i))))}}(Rn||(Rn={})),"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==f||"undefined"!=typeof self&&self;var Pn={exports:{}};function Vn(e){return null==e?e:e.shiftToAll().normalize()}function Hn(e){return e.includes("/")&&(e=e.substring(e.lastIndexOf("/")+1)),e.endsWith(".md")&&(e=e.substring(0,e.length-3)),e}"undefined"!=typeof self&&self,Pn.exports=function(e){var t={};function i(n){if(t[n])return t[n].exports;var s=t[n]={i:n,l:!1,exports:{}};return e[n].call(s.exports,s,s.exports,i),s.l=!0,s.exports}return i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},i.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=0)}([function(e,t,i){function n(e){if(!(this instanceof n))return new n(e);this._=e}var s=n.prototype;function u(e,t){for(var i=0;i<e;i++)t(i)}function r(e,t,i){return function(e,t){u(t.length,(function(i){e(t[i],i,t)}))}((function(i,n,s){t=e(t,i,n,s)}),i),t}function a(e,t){return r((function(t,i,n,s){return t.concat([e(i,n,s)])}),[],t)}function o(e,t){var i={v:0,buf:t};return u(e,(function(){var e;i={v:i.v<<1|(e=i.buf,e[0]>>7),buf:function(e){var t=r((function(e,t,i,n){return e.concat(i===n.length-1?Buffer.from([t,0]).readUInt16BE(0):n.readUInt16BE(i))}),[],e);return Buffer.from(a((function(e){return(e<<1&65535)>>8}),t))}(i.buf)}})),i}function D(){return"undefined"!=typeof Buffer}function l(){if(!D())throw new Error("Buffer global does not exist; please use webpack if you need to parse Buffers in the browser.")}function c(e){l();var t=r((function(e,t){return e+t}),0,e);if(t%8!=0)throw new Error("The bits ["+e.join(", ")+"] add up to "+t+" which is not an even number of bytes; the total should be divisible by 8");var i,s=t/8,u=(i=function(e){return e>48},r((function(e,t){return e||(i(t)?t:e)}),null,e));if(u)throw new Error(u+" bit range requested exceeds 48 bit (6 byte) Number max.");return new n((function(t,i){var n=s+i;return n>t.length?w(i,s.toString()+" bytes"):y(n,r((function(e,t){var i=o(t,e.buf);return{coll:e.coll.concat(i.v),buf:i.buf}}),{coll:[],buf:t.slice(i,n)},e).coll)}))}function d(e,t){return new n((function(i,n){return l(),n+t>i.length?w(n,t+" bytes for "+e):y(n+t,i.slice(n,n+t))}))}function h(e,t){if("number"!=typeof(i=t)||Math.floor(i)!==i||t<0||t>6)throw new Error(e+" requires integer length in range [0, 6].");var i}function p(e){return h("uintBE",e),d("uintBE("+e+")",e).map((function(t){return t.readUIntBE(0,e)}))}function g(e){return h("uintLE",e),d("uintLE("+e+")",e).map((function(t){return t.readUIntLE(0,e)}))}function F(e){return h("intBE",e),d("intBE("+e+")",e).map((function(t){return t.readIntBE(0,e)}))}function f(e){return h("intLE",e),d("intLE("+e+")",e).map((function(t){return t.readIntLE(0,e)}))}function E(e){return e instanceof n}function m(e){return"[object Array]"==={}.toString.call(e)}function C(e){return D()&&Buffer.isBuffer(e)}function y(e,t){return{status:!0,index:e,value:t,furthest:-1,expected:[]}}function w(e,t){return m(t)||(t=[t]),{status:!1,index:-1,value:null,furthest:e,expected:t}}function v(e,t){if(!t)return e;if(e.furthest>t.furthest)return e;var i=e.furthest===t.furthest?function(e,t){if(function(){if(void 0!==n._supportsSet)return n._supportsSet;var e="undefined"!=typeof Set;return n._supportsSet=e,e}()&&Array.from){for(var i=new Set(e),s=0;s<t.length;s++)i.add(t[s]);var u=Array.from(i);return u.sort(),u}for(var r={},a=0;a<e.length;a++)r[e[a]]=!0;for(var o=0;o<t.length;o++)r[t[o]]=!0;var D=[];for(var l in r)({}).hasOwnProperty.call(r,l)&&D.push(l);return D.sort(),D}(e.expected,t.expected):t.expected;return{status:e.status,index:e.index,value:e.value,furthest:t.furthest,expected:i}}var b={};function S(e,t){if(C(e))return{offset:t,line:-1,column:-1};e in b||(b[e]={});for(var i=b[e],n=0,s=0,u=0,r=t;r>=0;){if(r in i){n=i[r].line,0===u&&(u=i[r].lineStart);break}("\n"===e.charAt(r)||"\r"===e.charAt(r)&&"\n"!==e.charAt(r+1))&&(s++,0===u&&(u=r+1)),r--}var a=n+s,o=t-u;return i[t]={line:a,lineStart:u},{offset:t,line:a+1,column:o+1}}function x(e){if(!E(e))throw new Error("not a parser: "+e)}function A(e,t){return"string"==typeof e?e.charAt(t):e[t]}function T(e){if("number"!=typeof e)throw new Error("not a number: "+e)}function B(e){if("function"!=typeof e)throw new Error("not a function: "+e)}function O(e){if("string"!=typeof e)throw new Error("not a string: "+e)}function N(e,t){return new Array(t+1).join(e)}function L(e,t,i){var n=t-e.length;return n<=0?e:N(i,n)+e}function k(e,t,i,n){return{from:e-t>0?e-t:0,to:e+i>n?n:e+i}}function I(e,t){var i,n,s,u,o,D=t.index,l=D.offset,c=1;if(l===e.length)return"Got the end of the input";if(C(e)){var d=l-l%8,h=l-d,p=k(d,40,40,e.length),g=a((function(e){return a((function(e){return L(e.toString(16),2,"0")}),e)}),function(e,t){var i=e.length,n=[],s=0;if(i<=8)return[e.slice()];for(var u=0;u<i;u++)n[s]||n.push([]),n[s].push(e[u]),(u+1)%8==0&&s++;return n}(e.slice(p.from,p.to).toJSON().data));u=function(e){return 0===e.from&&1===e.to?{from:e.from,to:e.to}:{from:e.from/8,to:Math.floor(e.to/8)}}(p),n=d/8,i=3*h,h>=4&&(i+=1),c=2,s=a((function(e){return e.length<=4?e.join(" "):e.slice(0,4).join(" ")+"  "+e.slice(4).join(" ")}),g),(o=(8*(u.to>0?u.to-1:u.to)).toString(16).length)<2&&(o=2)}else{var F=e.split(/\r\n|[\n\r\u2028\u2029]/);i=D.column-1,n=D.line-1,u=k(n,2,3,F.length),s=F.slice(u.from,u.to),o=u.to.toString().length}var f=n-u.from;return C(e)&&(o=(8*(u.to>0?u.to-1:u.to)).toString(16).length)<2&&(o=2),r((function(t,n,s){var r,a=s===f,D=a?"> ":"  ";return r=C(e)?L((8*(u.from+s)).toString(16),o,"0"):L((u.from+s+1).toString(),o," "),[].concat(t,[D+r+" | "+n],a?["  "+N(" ",o)+" | "+L("",i," ")+N("^",c)]:[])}),[],s).join("\n")}function _(e,t){return["\n","-- PARSING FAILED "+N("-",50),"\n\n",I(e,t),"\n\n",(i=t.expected,1===i.length?"Expected:\n\n"+i[0]:"Expected one of the following: \n\n"+i.join(", ")),"\n"].join("");var i}function M(e){return void 0!==e.flags?e.flags:[e.global?"g":"",e.ignoreCase?"i":"",e.multiline?"m":"",e.unicode?"u":"",e.sticky?"y":""].join("")}function R(){for(var e=[].slice.call(arguments),t=e.length,i=0;i<t;i+=1)x(e[i]);return n((function(i,n){for(var s,u=new Array(t),r=0;r<t;r+=1){if(!(s=v(e[r]._(i,n),s)).status)return s;u[r]=s.value,n=s.index}return v(y(n,u),s)}))}function P(){var e=[].slice.call(arguments);if(0===e.length)throw new Error("seqMap needs at least one argument");var t=e.pop();return B(t),R.apply(null,e).map((function(e){return t.apply(null,e)}))}function V(){var e=[].slice.call(arguments),t=e.length;if(0===t)return U("zero alternates");for(var i=0;i<t;i+=1)x(e[i]);return n((function(t,i){for(var n,s=0;s<e.length;s+=1)if((n=v(e[s]._(t,i),n)).status)return n;return n}))}function H(e,t){return j(e,t).or(Y([]))}function j(e,t){return x(e),x(t),P(e,t.then(e).many(),(function(e,t){return[e].concat(t)}))}function W(e){O(e);var t="'"+e+"'";return n((function(i,n){var s=n+e.length,u=i.slice(n,s);return u===e?y(s,u):w(n,t)}))}function G(e,t){!function(e){if(!(e instanceof RegExp))throw new Error("not a regexp: "+e);for(var t=M(e),i=0;i<t.length;i++){var n=t.charAt(i);if("i"!==n&&"m"!==n&&"u"!==n&&"s"!==n)throw new Error('unsupported regexp flag "'+n+'": '+e)}}(e),arguments.length>=2?T(t):t=0;var i=function(e){return RegExp("^(?:"+e.source+")",M(e))}(e),s=""+e;return n((function(e,n){var u=i.exec(e.slice(n));if(u){if(0<=t&&t<=u.length){var r=u[0],a=u[t];return y(n+r.length,a)}return w(n,"valid match group (0 to "+u.length+") in "+s)}return w(n,s)}))}function Y(e){return n((function(t,i){return y(i,e)}))}function U(e){return n((function(t,i){return w(i,e)}))}function z(e){if(E(e))return n((function(t,i){var n=e._(t,i);return n.index=i,n.value="",n}));if("string"==typeof e)return z(W(e));if(e instanceof RegExp)return z(G(e));throw new Error("not a string, regexp, or parser: "+e)}function q(e){return x(e),n((function(t,i){var n=e._(t,i),s=t.slice(i,n.index);return n.status?w(i,'not "'+s+'"'):y(i,null)}))}function $(e){return B(e),n((function(t,i){var n=A(t,i);return i<t.length&&e(n)?y(i+1,n):w(i,"a character/byte matching "+e)}))}function Z(e,t){arguments.length<2&&(t=e,e=void 0);var i=n((function(e,n){return i._=t()._,i._(e,n)}));return e?i.desc(e):i}function J(){return U("fantasy-land/empty")}s.parse=function(e){if("string"!=typeof e&&!C(e))throw new Error(".parse must be called with a string or Buffer as its argument");var t,i=this.skip(ee)._(e,0);return t=i.status?{status:!0,value:i.value}:{status:!1,index:S(e,i.furthest),expected:i.expected},delete b[e],t},s.tryParse=function(e){var t=this.parse(e);if(t.status)return t.value;var i=_(e,t),n=new Error(i);throw n.type="ParsimmonError",n.result=t,n},s.assert=function(e,t){return this.chain((function(i){return e(i)?Y(i):U(t)}))},s.or=function(e){return V(this,e)},s.trim=function(e){return this.wrap(e,e)},s.wrap=function(e,t){return P(e,this,t,(function(e,t){return t}))},s.thru=function(e){return e(this)},s.then=function(e){return x(e),R(this,e).map((function(e){return e[1]}))},s.many=function(){var e=this;return n((function(t,i){for(var n=[],s=void 0;;){if(!(s=v(e._(t,i),s)).status)return v(y(i,n),s);if(i===s.index)throw new Error("infinite loop detected in .many() parser --- calling .many() on a parser which can accept zero characters is usually the cause");i=s.index,n.push(s.value)}}))},s.tieWith=function(e){return O(e),this.map((function(t){if(function(e){if(!m(e))throw new Error("not an array: "+e)}(t),t.length){O(t[0]);for(var i=t[0],n=1;n<t.length;n++)O(t[n]),i+=e+t[n];return i}return""}))},s.tie=function(){return this.tieWith("")},s.times=function(e,t){var i=this;return arguments.length<2&&(t=e),T(e),T(t),n((function(n,s){for(var u=[],r=void 0,a=void 0,o=0;o<e;o+=1){if(a=v(r=i._(n,s),a),!r.status)return a;s=r.index,u.push(r.value)}for(;o<t&&(a=v(r=i._(n,s),a),r.status);o+=1)s=r.index,u.push(r.value);return v(y(s,u),a)}))},s.result=function(e){return this.map((function(){return e}))},s.atMost=function(e){return this.times(0,e)},s.atLeast=function(e){return P(this.times(e),this.many(),(function(e,t){return e.concat(t)}))},s.map=function(e){B(e);var t=this;return n((function(i,n){var s=t._(i,n);return s.status?v(y(s.index,e(s.value)),s):s}))},s.contramap=function(e){B(e);var t=this;return n((function(i,n){var s=t.parse(e(i.slice(n)));return s.status?y(n+i.length,s.value):s}))},s.promap=function(e,t){return B(e),B(t),this.contramap(e).map(t)},s.skip=function(e){return R(this,e).map((function(e){return e[0]}))},s.mark=function(){return P(K,this,K,(function(e,t,i){return{start:e,value:t,end:i}}))},s.node=function(e){return P(K,this,K,(function(t,i,n){return{name:e,value:i,start:t,end:n}}))},s.sepBy=function(e){return H(this,e)},s.sepBy1=function(e){return j(this,e)},s.lookahead=function(e){return this.skip(z(e))},s.notFollowedBy=function(e){return this.skip(q(e))},s.desc=function(e){m(e)||(e=[e]);var t=this;return n((function(i,n){var s=t._(i,n);return s.status||(s.expected=e),s}))},s.fallback=function(e){return this.or(Y(e))},s.ap=function(e){return P(e,this,(function(e,t){return e(t)}))},s.chain=function(e){var t=this;return n((function(i,n){var s=t._(i,n);return s.status?v(e(s.value)._(i,s.index),s):s}))},s.concat=s.or,s.empty=J,s.of=Y,s["fantasy-land/ap"]=s.ap,s["fantasy-land/chain"]=s.chain,s["fantasy-land/concat"]=s.concat,s["fantasy-land/empty"]=s.empty,s["fantasy-land/of"]=s.of,s["fantasy-land/map"]=s.map;var K=n((function(e,t){return y(t,S(e,t))})),X=n((function(e,t){return t>=e.length?w(t,"any character/byte"):y(t+1,A(e,t))})),Q=n((function(e,t){return y(e.length,e.slice(t))})),ee=n((function(e,t){return t<e.length?w(t,"EOF"):y(t,null)})),te=G(/[0-9]/).desc("a digit"),ie=G(/[0-9]*/).desc("optional digits"),ne=G(/[a-z]/i).desc("a letter"),se=G(/[a-z]*/i).desc("optional letters"),ue=G(/\s*/).desc("optional whitespace"),re=G(/\s+/).desc("whitespace"),ae=W("\r"),oe=W("\n"),De=W("\r\n"),le=V(De,oe,ae).desc("newline"),ce=V(le,ee);n.all=Q,n.alt=V,n.any=X,n.cr=ae,n.createLanguage=function(e){var t={};for(var i in e)({}).hasOwnProperty.call(e,i)&&function(i){t[i]=Z((function(){return e[i](t)}))}(i);return t},n.crlf=De,n.custom=function(e){return n(e(y,w))},n.digit=te,n.digits=ie,n.empty=J,n.end=ce,n.eof=ee,n.fail=U,n.formatError=_,n.index=K,n.isParser=E,n.lazy=Z,n.letter=ne,n.letters=se,n.lf=oe,n.lookahead=z,n.makeFailure=w,n.makeSuccess=y,n.newline=le,n.noneOf=function(e){return $((function(t){return e.indexOf(t)<0})).desc("none of '"+e+"'")},n.notFollowedBy=q,n.of=Y,n.oneOf=function(e){for(var t=e.split(""),i=0;i<t.length;i++)t[i]="'"+t[i]+"'";return $((function(t){return e.indexOf(t)>=0})).desc(t)},n.optWhitespace=ue,n.Parser=n,n.range=function(e,t){return $((function(i){return e<=i&&i<=t})).desc(e+"-"+t)},n.regex=G,n.regexp=G,n.sepBy=H,n.sepBy1=j,n.seq=R,n.seqMap=P,n.seqObj=function(){for(var e,t={},i=0,s=(e=arguments,Array.prototype.slice.call(e)),u=s.length,r=0;r<u;r+=1){var a=s[r];if(!E(a)){if(m(a)&&2===a.length&&"string"==typeof a[0]&&E(a[1])){var o=a[0];if(Object.prototype.hasOwnProperty.call(t,o))throw new Error("seqObj: duplicate key "+o);t[o]=!0,i++;continue}throw new Error("seqObj arguments must be parsers or [string, parser] array pairs.")}}if(0===i)throw new Error("seqObj expects at least one named parser, found zero");return n((function(e,t){for(var i,n={},r=0;r<u;r+=1){var a,o;if(m(s[r])?(a=s[r][0],o=s[r][1]):(a=null,o=s[r]),!(i=v(o._(e,t),i)).status)return i;a&&(n[a]=i.value),t=i.index}return v(y(t,n),i)}))},n.string=W,n.succeed=Y,n.takeWhile=function(e){return B(e),n((function(t,i){for(var n=i;n<t.length&&e(A(t,n));)n++;return y(n,t.slice(i,n))}))},n.test=$,n.whitespace=re,n["fantasy-land/empty"]=J,n["fantasy-land/of"]=Y,n.Binary={bitSeq:c,bitSeqObj:function(e){l();var t={},i=0,n=a((function(e){if(m(e)){var n=e;if(2!==n.length)throw new Error("["+n.join(", ")+"] should be length 2, got length "+n.length);if(O(n[0]),T(n[1]),Object.prototype.hasOwnProperty.call(t,n[0]))throw new Error("duplicate key in bitSeqObj: "+n[0]);return t[n[0]]=!0,i++,n}return T(e),[null,e]}),e);if(i<1)throw new Error("bitSeqObj expects at least one named pair, got ["+e.join(", ")+"]");var s=a((function(e){return e[0]}),n);return c(a((function(e){return e[1]}),n)).map((function(e){return r((function(e,t){return null!==t[0]&&(e[t[0]]=t[1]),e}),{},a((function(t,i){return[t,e[i]]}),s))}))},byte:function(e){if(l(),T(e),e>255)throw new Error("Value specified to byte constructor ("+e+"=0x"+e.toString(16)+") is larger in value than a single byte.");var t=(e>15?"0x":"0x0")+e.toString(16);return n((function(i,n){var s=A(i,n);return s===e?y(n+1,s):w(n,t)}))},buffer:function(e){return d("buffer",e).map((function(e){return Buffer.from(e)}))},encodedString:function(e,t){return d("string",t).map((function(t){return t.toString(e)}))},uintBE:p,uint8BE:p(1),uint16BE:p(2),uint32BE:p(4),uintLE:g,uint8LE:g(1),uint16LE:g(2),uint32LE:g(4),intBE:F,int8BE:F(1),int16BE:F(2),int32BE:F(4),intLE:f,int8LE:f(1),int16LE:f(2),int32LE:f(4),floatBE:d("floatBE",4).map((function(e){return e.readFloatBE(0)})),floatLE:d("floatLE",4).map((function(e){return e.readFloatLE(0)})),doubleBE:d("doubleBE",8).map((function(e){return e.readDoubleBE(0)})),doubleLE:d("doubleLE",8).map((function(e){return e.readDoubleLE(0)}))},e.exports=n}]),Pn.exports.alt(Pn.exports.regex(new RegExp(/(?:[#*0-9]\uFE0F?\u20E3|[\xA9\xAE\u203C\u2049\u2122\u2139\u2194-\u2199\u21A9\u21AA\u231A\u231B\u2328\u23CF\u23ED-\u23EF\u23F1\u23F2\u23F8-\u23FA\u24C2\u25AA\u25AB\u25B6\u25C0\u25FB\u25FC\u25FE\u2600-\u2604\u260E\u2611\u2614\u2615\u2618\u2620\u2622\u2623\u2626\u262A\u262E\u262F\u2638-\u263A\u2640\u2642\u2648-\u2653\u265F\u2660\u2663\u2665\u2666\u2668\u267B\u267E\u267F\u2692\u2694-\u2697\u2699\u269B\u269C\u26A0\u26A7\u26AA\u26B0\u26B1\u26BD\u26BE\u26C4\u26C8\u26CF\u26D1\u26D3\u26E9\u26F0-\u26F5\u26F7\u26F8\u26FA\u2702\u2708\u2709\u270F\u2712\u2714\u2716\u271D\u2721\u2733\u2734\u2744\u2747\u2757\u2763\u27A1\u2934\u2935\u2B05-\u2B07\u2B1B\u2B1C\u2B55\u3030\u303D\u3297\u3299]\uFE0F?|[\u261D\u270C\u270D](?:\uFE0F|\uD83C[\uDFFB-\uDFFF])?|[\u270A\u270B](?:\uD83C[\uDFFB-\uDFFF])?|[\u23E9-\u23EC\u23F0\u23F3\u25FD\u2693\u26A1\u26AB\u26C5\u26CE\u26D4\u26EA\u26FD\u2705\u2728\u274C\u274E\u2753-\u2755\u2795-\u2797\u27B0\u27BF\u2B50]|\u26F9(?:\uFE0F|\uD83C[\uDFFB-\uDFFF])?(?:\u200D[\u2640\u2642]\uFE0F?)?|\u2764\uFE0F?(?:\u200D(?:\uD83D\uDD25|\uD83E\uDE79))?|\uD83C(?:[\uDC04\uDD70\uDD71\uDD7E\uDD7F\uDE02\uDE37\uDF21\uDF24-\uDF2C\uDF36\uDF7D\uDF96\uDF97\uDF99-\uDF9B\uDF9E\uDF9F\uDFCD\uDFCE\uDFD4-\uDFDF\uDFF5\uDFF7]\uFE0F?|[\uDF85\uDFC2\uDFC7](?:\uD83C[\uDFFB-\uDFFF])?|[\uDFC3\uDFC4\uDFCA](?:\uD83C[\uDFFB-\uDFFF])?(?:\u200D[\u2640\u2642]\uFE0F?)?|[\uDFCB\uDFCC](?:\uFE0F|\uD83C[\uDFFB-\uDFFF])?(?:\u200D[\u2640\u2642]\uFE0F?)?|[\uDCCF\uDD8E\uDD91-\uDD9A\uDE01\uDE1A\uDE2F\uDE32-\uDE36\uDE38-\uDE3A\uDE50\uDE51\uDF00-\uDF20\uDF2D-\uDF35\uDF37-\uDF7C\uDF7E-\uDF84\uDF86-\uDF93\uDFA0-\uDFC1\uDFC5\uDFC6\uDFC8\uDFC9\uDFCF-\uDFD3\uDFE0-\uDFF0\uDFF8-\uDFFF]|\uDDE6\uD83C[\uDDE8-\uDDEC\uDDEE\uDDF1\uDDF2\uDDF4\uDDF6-\uDDFA\uDDFC\uDDFD\uDDFF]|\uDDE7\uD83C[\uDDE6\uDDE7\uDDE9-\uDDEF\uDDF1-\uDDF4\uDDF6-\uDDF9\uDDFB\uDDFC\uDDFE\uDDFF]|\uDDE8\uD83C[\uDDE6\uDDE8\uDDE9\uDDEB-\uDDEE\uDDF0-\uDDF5\uDDF7\uDDFA-\uDDFF]|\uDDE9\uD83C[\uDDEA\uDDEC\uDDEF\uDDF0\uDDF2\uDDF4\uDDFF]|\uDDEA\uD83C[\uDDE6\uDDE8\uDDEA\uDDEC\uDDED\uDDF7-\uDDFA]|\uDDEB\uD83C[\uDDEE-\uDDF0\uDDF2\uDDF4\uDDF7]|\uDDEC\uD83C[\uDDE6\uDDE7\uDDE9-\uDDEE\uDDF1-\uDDF3\uDDF5-\uDDFA\uDDFC\uDDFE]|\uDDED\uD83C[\uDDF0\uDDF2\uDDF3\uDDF7\uDDF9\uDDFA]|\uDDEE\uD83C[\uDDE8-\uDDEA\uDDF1-\uDDF4\uDDF6-\uDDF9]|\uDDEF\uD83C[\uDDEA\uDDF2\uDDF4\uDDF5]|\uDDF0\uD83C[\uDDEA\uDDEC-\uDDEE\uDDF2\uDDF3\uDDF5\uDDF7\uDDFC\uDDFE\uDDFF]|\uDDF1\uD83C[\uDDE6-\uDDE8\uDDEE\uDDF0\uDDF7-\uDDFB\uDDFE]|\uDDF2\uD83C[\uDDE6\uDDE8-\uDDED\uDDF0-\uDDFF]|\uDDF3\uD83C[\uDDE6\uDDE8\uDDEA-\uDDEC\uDDEE\uDDF1\uDDF4\uDDF5\uDDF7\uDDFA\uDDFF]|\uDDF4\uD83C\uDDF2|\uDDF5\uD83C[\uDDE6\uDDEA-\uDDED\uDDF0-\uDDF3\uDDF7-\uDDF9\uDDFC\uDDFE]|\uDDF6\uD83C\uDDE6|\uDDF7\uD83C[\uDDEA\uDDF4\uDDF8\uDDFA\uDDFC]|\uDDF8\uD83C[\uDDE6-\uDDEA\uDDEC-\uDDF4\uDDF7-\uDDF9\uDDFB\uDDFD-\uDDFF]|\uDDF9\uD83C[\uDDE6\uDDE8\uDDE9\uDDEB-\uDDED\uDDEF-\uDDF4\uDDF7\uDDF9\uDDFB\uDDFC\uDDFF]|\uDDFA\uD83C[\uDDE6\uDDEC\uDDF2\uDDF3\uDDF8\uDDFE\uDDFF]|\uDDFB\uD83C[\uDDE6\uDDE8\uDDEA\uDDEC\uDDEE\uDDF3\uDDFA]|\uDDFC\uD83C[\uDDEB\uDDF8]|\uDDFD\uD83C\uDDF0|\uDDFE\uD83C[\uDDEA\uDDF9]|\uDDFF\uD83C[\uDDE6\uDDF2\uDDFC]|\uDFF3\uFE0F?(?:\u200D(?:\u26A7\uFE0F?|\uD83C\uDF08))?|\uDFF4(?:\u200D\u2620\uFE0F?|\uDB40\uDC67\uDB40\uDC62\uDB40(?:\uDC65\uDB40\uDC6E\uDB40\uDC67|\uDC73\uDB40\uDC63\uDB40\uDC74|\uDC77\uDB40\uDC6C\uDB40\uDC73)\uDB40\uDC7F)?)|\uD83D(?:[\uDC3F\uDCFD\uDD49\uDD4A\uDD6F\uDD70\uDD73\uDD76-\uDD79\uDD87\uDD8A-\uDD8D\uDDA5\uDDA8\uDDB1\uDDB2\uDDBC\uDDC2-\uDDC4\uDDD1-\uDDD3\uDDDC-\uDDDE\uDDE1\uDDE3\uDDE8\uDDEF\uDDF3\uDDFA\uDECB\uDECD-\uDECF\uDEE0-\uDEE5\uDEE9\uDEF0\uDEF3]\uFE0F?|[\uDC42\uDC43\uDC46-\uDC50\uDC66\uDC67\uDC6B-\uDC6D\uDC72\uDC74-\uDC76\uDC78\uDC7C\uDC83\uDC85\uDC8F\uDC91\uDCAA\uDD7A\uDD95\uDD96\uDE4C\uDE4F\uDEC0\uDECC](?:\uD83C[\uDFFB-\uDFFF])?|[\uDC6E\uDC70\uDC71\uDC73\uDC77\uDC81\uDC82\uDC86\uDC87\uDE45-\uDE47\uDE4B\uDE4D\uDE4E\uDEA3\uDEB4-\uDEB6](?:\uD83C[\uDFFB-\uDFFF])?(?:\u200D[\u2640\u2642]\uFE0F?)?|[\uDD74\uDD90](?:\uFE0F|\uD83C[\uDFFB-\uDFFF])?|[\uDC00-\uDC07\uDC09-\uDC14\uDC16-\uDC3A\uDC3C-\uDC3E\uDC40\uDC44\uDC45\uDC51-\uDC65\uDC6A\uDC79-\uDC7B\uDC7D-\uDC80\uDC84\uDC88-\uDC8E\uDC90\uDC92-\uDCA9\uDCAB-\uDCFC\uDCFF-\uDD3D\uDD4B-\uDD4E\uDD50-\uDD67\uDDA4\uDDFB-\uDE2D\uDE2F-\uDE34\uDE37-\uDE44\uDE48-\uDE4A\uDE80-\uDEA2\uDEA4-\uDEB3\uDEB7-\uDEBF\uDEC1-\uDEC5\uDED0-\uDED2\uDED5-\uDED7\uDEDD-\uDEDF\uDEEB\uDEEC\uDEF4-\uDEFC\uDFE0-\uDFEB\uDFF0]|\uDC08(?:\u200D\u2B1B)?|\uDC15(?:\u200D\uD83E\uDDBA)?|\uDC3B(?:\u200D\u2744\uFE0F?)?|\uDC41\uFE0F?(?:\u200D\uD83D\uDDE8\uFE0F?)?|\uDC68(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D(?:[\uDC68\uDC69]\u200D\uD83D(?:\uDC66(?:\u200D\uD83D\uDC66)?|\uDC67(?:\u200D\uD83D[\uDC66\uDC67])?)|[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uDC66(?:\u200D\uD83D\uDC66)?|\uDC67(?:\u200D\uD83D[\uDC66\uDC67])?)|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\uD83C(?:\uDFFB(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83D\uDC68\uD83C[\uDFFC-\uDFFF])))?|\uDFFC(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83D\uDC68\uD83C[\uDFFB\uDFFD-\uDFFF])))?|\uDFFD(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83D\uDC68\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF])))?|\uDFFE(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83D\uDC68\uD83C[\uDFFB-\uDFFD\uDFFF])))?|\uDFFF(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83D\uDC68\uD83C[\uDFFB-\uDFFE])))?))?|\uDC69(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?[\uDC68\uDC69]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D(?:[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uDC66(?:\u200D\uD83D\uDC66)?|\uDC67(?:\u200D\uD83D[\uDC66\uDC67])?|\uDC69\u200D\uD83D(?:\uDC66(?:\u200D\uD83D\uDC66)?|\uDC67(?:\u200D\uD83D[\uDC66\uDC67])?))|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\uD83C(?:\uDFFB(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:[\uDC68\uDC69]|\uDC8B\u200D\uD83D[\uDC68\uDC69])\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83D[\uDC68\uDC69]\uD83C[\uDFFC-\uDFFF])))?|\uDFFC(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:[\uDC68\uDC69]|\uDC8B\u200D\uD83D[\uDC68\uDC69])\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83D[\uDC68\uDC69]\uD83C[\uDFFB\uDFFD-\uDFFF])))?|\uDFFD(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:[\uDC68\uDC69]|\uDC8B\u200D\uD83D[\uDC68\uDC69])\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83D[\uDC68\uDC69]\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF])))?|\uDFFE(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:[\uDC68\uDC69]|\uDC8B\u200D\uD83D[\uDC68\uDC69])\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83D[\uDC68\uDC69]\uD83C[\uDFFB-\uDFFD\uDFFF])))?|\uDFFF(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:[\uDC68\uDC69]|\uDC8B\u200D\uD83D[\uDC68\uDC69])\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83D[\uDC68\uDC69]\uD83C[\uDFFB-\uDFFE])))?))?|\uDC6F(?:\u200D[\u2640\u2642]\uFE0F?)?|\uDD75(?:\uFE0F|\uD83C[\uDFFB-\uDFFF])?(?:\u200D[\u2640\u2642]\uFE0F?)?|\uDE2E(?:\u200D\uD83D\uDCA8)?|\uDE35(?:\u200D\uD83D\uDCAB)?|\uDE36(?:\u200D\uD83C\uDF2B\uFE0F?)?)|\uD83E(?:[\uDD0C\uDD0F\uDD18-\uDD1F\uDD30-\uDD34\uDD36\uDD77\uDDB5\uDDB6\uDDBB\uDDD2\uDDD3\uDDD5\uDEC3-\uDEC5\uDEF0\uDEF2-\uDEF6](?:\uD83C[\uDFFB-\uDFFF])?|[\uDD26\uDD35\uDD37-\uDD39\uDD3D\uDD3E\uDDB8\uDDB9\uDDCD-\uDDCF\uDDD4\uDDD6-\uDDDD](?:\uD83C[\uDFFB-\uDFFF])?(?:\u200D[\u2640\u2642]\uFE0F?)?|[\uDDDE\uDDDF](?:\u200D[\u2640\u2642]\uFE0F?)?|[\uDD0D\uDD0E\uDD10-\uDD17\uDD20-\uDD25\uDD27-\uDD2F\uDD3A\uDD3F-\uDD45\uDD47-\uDD76\uDD78-\uDDB4\uDDB7\uDDBA\uDDBC-\uDDCC\uDDD0\uDDE0-\uDDFF\uDE70-\uDE74\uDE78-\uDE7C\uDE80-\uDE86\uDE90-\uDEAC\uDEB0-\uDEBA\uDEC0-\uDEC2\uDED0-\uDED9\uDEE0-\uDEE7]|\uDD3C(?:\u200D[\u2640\u2642]\uFE0F?|\uD83C[\uDFFB-\uDFFF])?|\uDDD1(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83E\uDDD1))|\uD83C(?:\uDFFB(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D(?:\uD83D\uDC8B\u200D)?\uD83E\uDDD1\uD83C[\uDFFC-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83E\uDDD1\uD83C[\uDFFB-\uDFFF])))?|\uDFFC(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D(?:\uD83D\uDC8B\u200D)?\uD83E\uDDD1\uD83C[\uDFFB\uDFFD-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83E\uDDD1\uD83C[\uDFFB-\uDFFF])))?|\uDFFD(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D(?:\uD83D\uDC8B\u200D)?\uD83E\uDDD1\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83E\uDDD1\uD83C[\uDFFB-\uDFFF])))?|\uDFFE(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D(?:\uD83D\uDC8B\u200D)?\uD83E\uDDD1\uD83C[\uDFFB-\uDFFD\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83E\uDDD1\uD83C[\uDFFB-\uDFFF])))?|\uDFFF(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D(?:\uD83D\uDC8B\u200D)?\uD83E\uDDD1\uD83C[\uDFFB-\uDFFE]|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83E\uDDD1\uD83C[\uDFFB-\uDFFF])))?))?|\uDEF1(?:\uD83C(?:\uDFFB(?:\u200D\uD83E\uDEF2\uD83C[\uDFFC-\uDFFF])?|\uDFFC(?:\u200D\uD83E\uDEF2\uD83C[\uDFFB\uDFFD-\uDFFF])?|\uDFFD(?:\u200D\uD83E\uDEF2\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF])?|\uDFFE(?:\u200D\uD83E\uDEF2\uD83C[\uDFFB-\uDFFD\uDFFF])?|\uDFFF(?:\u200D\uD83E\uDEF2\uD83C[\uDFFB-\uDFFE])?))?))/g,"")),Pn.exports.regex(/[0-9\p{Letter}_-]+/u).map((e=>e.toLocaleLowerCase())),Pn.exports.whitespace.map((e=>"-")),Pn.exports.any.map((e=>""))).many().map((e=>e.join("")));const jn=Pn.exports.alt(Pn.exports.regex(new RegExp(/(?:[#*0-9]\uFE0F?\u20E3|[\xA9\xAE\u203C\u2049\u2122\u2139\u2194-\u2199\u21A9\u21AA\u231A\u231B\u2328\u23CF\u23ED-\u23EF\u23F1\u23F2\u23F8-\u23FA\u24C2\u25AA\u25AB\u25B6\u25C0\u25FB\u25FC\u25FE\u2600-\u2604\u260E\u2611\u2614\u2615\u2618\u2620\u2622\u2623\u2626\u262A\u262E\u262F\u2638-\u263A\u2640\u2642\u2648-\u2653\u265F\u2660\u2663\u2665\u2666\u2668\u267B\u267E\u267F\u2692\u2694-\u2697\u2699\u269B\u269C\u26A0\u26A7\u26AA\u26B0\u26B1\u26BD\u26BE\u26C4\u26C8\u26CF\u26D1\u26D3\u26E9\u26F0-\u26F5\u26F7\u26F8\u26FA\u2702\u2708\u2709\u270F\u2712\u2714\u2716\u271D\u2721\u2733\u2734\u2744\u2747\u2757\u2763\u27A1\u2934\u2935\u2B05-\u2B07\u2B1B\u2B1C\u2B55\u3030\u303D\u3297\u3299]\uFE0F?|[\u261D\u270C\u270D](?:\uFE0F|\uD83C[\uDFFB-\uDFFF])?|[\u270A\u270B](?:\uD83C[\uDFFB-\uDFFF])?|[\u23E9-\u23EC\u23F0\u23F3\u25FD\u2693\u26A1\u26AB\u26C5\u26CE\u26D4\u26EA\u26FD\u2705\u2728\u274C\u274E\u2753-\u2755\u2795-\u2797\u27B0\u27BF\u2B50]|\u26F9(?:\uFE0F|\uD83C[\uDFFB-\uDFFF])?(?:\u200D[\u2640\u2642]\uFE0F?)?|\u2764\uFE0F?(?:\u200D(?:\uD83D\uDD25|\uD83E\uDE79))?|\uD83C(?:[\uDC04\uDD70\uDD71\uDD7E\uDD7F\uDE02\uDE37\uDF21\uDF24-\uDF2C\uDF36\uDF7D\uDF96\uDF97\uDF99-\uDF9B\uDF9E\uDF9F\uDFCD\uDFCE\uDFD4-\uDFDF\uDFF5\uDFF7]\uFE0F?|[\uDF85\uDFC2\uDFC7](?:\uD83C[\uDFFB-\uDFFF])?|[\uDFC3\uDFC4\uDFCA](?:\uD83C[\uDFFB-\uDFFF])?(?:\u200D[\u2640\u2642]\uFE0F?)?|[\uDFCB\uDFCC](?:\uFE0F|\uD83C[\uDFFB-\uDFFF])?(?:\u200D[\u2640\u2642]\uFE0F?)?|[\uDCCF\uDD8E\uDD91-\uDD9A\uDE01\uDE1A\uDE2F\uDE32-\uDE36\uDE38-\uDE3A\uDE50\uDE51\uDF00-\uDF20\uDF2D-\uDF35\uDF37-\uDF7C\uDF7E-\uDF84\uDF86-\uDF93\uDFA0-\uDFC1\uDFC5\uDFC6\uDFC8\uDFC9\uDFCF-\uDFD3\uDFE0-\uDFF0\uDFF8-\uDFFF]|\uDDE6\uD83C[\uDDE8-\uDDEC\uDDEE\uDDF1\uDDF2\uDDF4\uDDF6-\uDDFA\uDDFC\uDDFD\uDDFF]|\uDDE7\uD83C[\uDDE6\uDDE7\uDDE9-\uDDEF\uDDF1-\uDDF4\uDDF6-\uDDF9\uDDFB\uDDFC\uDDFE\uDDFF]|\uDDE8\uD83C[\uDDE6\uDDE8\uDDE9\uDDEB-\uDDEE\uDDF0-\uDDF5\uDDF7\uDDFA-\uDDFF]|\uDDE9\uD83C[\uDDEA\uDDEC\uDDEF\uDDF0\uDDF2\uDDF4\uDDFF]|\uDDEA\uD83C[\uDDE6\uDDE8\uDDEA\uDDEC\uDDED\uDDF7-\uDDFA]|\uDDEB\uD83C[\uDDEE-\uDDF0\uDDF2\uDDF4\uDDF7]|\uDDEC\uD83C[\uDDE6\uDDE7\uDDE9-\uDDEE\uDDF1-\uDDF3\uDDF5-\uDDFA\uDDFC\uDDFE]|\uDDED\uD83C[\uDDF0\uDDF2\uDDF3\uDDF7\uDDF9\uDDFA]|\uDDEE\uD83C[\uDDE8-\uDDEA\uDDF1-\uDDF4\uDDF6-\uDDF9]|\uDDEF\uD83C[\uDDEA\uDDF2\uDDF4\uDDF5]|\uDDF0\uD83C[\uDDEA\uDDEC-\uDDEE\uDDF2\uDDF3\uDDF5\uDDF7\uDDFC\uDDFE\uDDFF]|\uDDF1\uD83C[\uDDE6-\uDDE8\uDDEE\uDDF0\uDDF7-\uDDFB\uDDFE]|\uDDF2\uD83C[\uDDE6\uDDE8-\uDDED\uDDF0-\uDDFF]|\uDDF3\uD83C[\uDDE6\uDDE8\uDDEA-\uDDEC\uDDEE\uDDF1\uDDF4\uDDF5\uDDF7\uDDFA\uDDFF]|\uDDF4\uD83C\uDDF2|\uDDF5\uD83C[\uDDE6\uDDEA-\uDDED\uDDF0-\uDDF3\uDDF7-\uDDF9\uDDFC\uDDFE]|\uDDF6\uD83C\uDDE6|\uDDF7\uD83C[\uDDEA\uDDF4\uDDF8\uDDFA\uDDFC]|\uDDF8\uD83C[\uDDE6-\uDDEA\uDDEC-\uDDF4\uDDF7-\uDDF9\uDDFB\uDDFD-\uDDFF]|\uDDF9\uD83C[\uDDE6\uDDE8\uDDE9\uDDEB-\uDDED\uDDEF-\uDDF4\uDDF7\uDDF9\uDDFB\uDDFC\uDDFF]|\uDDFA\uD83C[\uDDE6\uDDEC\uDDF2\uDDF3\uDDF8\uDDFE\uDDFF]|\uDDFB\uD83C[\uDDE6\uDDE8\uDDEA\uDDEC\uDDEE\uDDF3\uDDFA]|\uDDFC\uD83C[\uDDEB\uDDF8]|\uDDFD\uD83C\uDDF0|\uDDFE\uD83C[\uDDEA\uDDF9]|\uDDFF\uD83C[\uDDE6\uDDF2\uDDFC]|\uDFF3\uFE0F?(?:\u200D(?:\u26A7\uFE0F?|\uD83C\uDF08))?|\uDFF4(?:\u200D\u2620\uFE0F?|\uDB40\uDC67\uDB40\uDC62\uDB40(?:\uDC65\uDB40\uDC6E\uDB40\uDC67|\uDC73\uDB40\uDC63\uDB40\uDC74|\uDC77\uDB40\uDC6C\uDB40\uDC73)\uDB40\uDC7F)?)|\uD83D(?:[\uDC3F\uDCFD\uDD49\uDD4A\uDD6F\uDD70\uDD73\uDD76-\uDD79\uDD87\uDD8A-\uDD8D\uDDA5\uDDA8\uDDB1\uDDB2\uDDBC\uDDC2-\uDDC4\uDDD1-\uDDD3\uDDDC-\uDDDE\uDDE1\uDDE3\uDDE8\uDDEF\uDDF3\uDDFA\uDECB\uDECD-\uDECF\uDEE0-\uDEE5\uDEE9\uDEF0\uDEF3]\uFE0F?|[\uDC42\uDC43\uDC46-\uDC50\uDC66\uDC67\uDC6B-\uDC6D\uDC72\uDC74-\uDC76\uDC78\uDC7C\uDC83\uDC85\uDC8F\uDC91\uDCAA\uDD7A\uDD95\uDD96\uDE4C\uDE4F\uDEC0\uDECC](?:\uD83C[\uDFFB-\uDFFF])?|[\uDC6E\uDC70\uDC71\uDC73\uDC77\uDC81\uDC82\uDC86\uDC87\uDE45-\uDE47\uDE4B\uDE4D\uDE4E\uDEA3\uDEB4-\uDEB6](?:\uD83C[\uDFFB-\uDFFF])?(?:\u200D[\u2640\u2642]\uFE0F?)?|[\uDD74\uDD90](?:\uFE0F|\uD83C[\uDFFB-\uDFFF])?|[\uDC00-\uDC07\uDC09-\uDC14\uDC16-\uDC3A\uDC3C-\uDC3E\uDC40\uDC44\uDC45\uDC51-\uDC65\uDC6A\uDC79-\uDC7B\uDC7D-\uDC80\uDC84\uDC88-\uDC8E\uDC90\uDC92-\uDCA9\uDCAB-\uDCFC\uDCFF-\uDD3D\uDD4B-\uDD4E\uDD50-\uDD67\uDDA4\uDDFB-\uDE2D\uDE2F-\uDE34\uDE37-\uDE44\uDE48-\uDE4A\uDE80-\uDEA2\uDEA4-\uDEB3\uDEB7-\uDEBF\uDEC1-\uDEC5\uDED0-\uDED2\uDED5-\uDED7\uDEDD-\uDEDF\uDEEB\uDEEC\uDEF4-\uDEFC\uDFE0-\uDFEB\uDFF0]|\uDC08(?:\u200D\u2B1B)?|\uDC15(?:\u200D\uD83E\uDDBA)?|\uDC3B(?:\u200D\u2744\uFE0F?)?|\uDC41\uFE0F?(?:\u200D\uD83D\uDDE8\uFE0F?)?|\uDC68(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D(?:[\uDC68\uDC69]\u200D\uD83D(?:\uDC66(?:\u200D\uD83D\uDC66)?|\uDC67(?:\u200D\uD83D[\uDC66\uDC67])?)|[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uDC66(?:\u200D\uD83D\uDC66)?|\uDC67(?:\u200D\uD83D[\uDC66\uDC67])?)|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\uD83C(?:\uDFFB(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83D\uDC68\uD83C[\uDFFC-\uDFFF])))?|\uDFFC(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83D\uDC68\uD83C[\uDFFB\uDFFD-\uDFFF])))?|\uDFFD(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83D\uDC68\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF])))?|\uDFFE(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83D\uDC68\uD83C[\uDFFB-\uDFFD\uDFFF])))?|\uDFFF(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83D\uDC68\uD83C[\uDFFB-\uDFFE])))?))?|\uDC69(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?[\uDC68\uDC69]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D(?:[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uDC66(?:\u200D\uD83D\uDC66)?|\uDC67(?:\u200D\uD83D[\uDC66\uDC67])?|\uDC69\u200D\uD83D(?:\uDC66(?:\u200D\uD83D\uDC66)?|\uDC67(?:\u200D\uD83D[\uDC66\uDC67])?))|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\uD83C(?:\uDFFB(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:[\uDC68\uDC69]|\uDC8B\u200D\uD83D[\uDC68\uDC69])\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83D[\uDC68\uDC69]\uD83C[\uDFFC-\uDFFF])))?|\uDFFC(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:[\uDC68\uDC69]|\uDC8B\u200D\uD83D[\uDC68\uDC69])\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83D[\uDC68\uDC69]\uD83C[\uDFFB\uDFFD-\uDFFF])))?|\uDFFD(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:[\uDC68\uDC69]|\uDC8B\u200D\uD83D[\uDC68\uDC69])\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83D[\uDC68\uDC69]\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF])))?|\uDFFE(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:[\uDC68\uDC69]|\uDC8B\u200D\uD83D[\uDC68\uDC69])\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83D[\uDC68\uDC69]\uD83C[\uDFFB-\uDFFD\uDFFF])))?|\uDFFF(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:[\uDC68\uDC69]|\uDC8B\u200D\uD83D[\uDC68\uDC69])\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83D[\uDC68\uDC69]\uD83C[\uDFFB-\uDFFE])))?))?|\uDC6F(?:\u200D[\u2640\u2642]\uFE0F?)?|\uDD75(?:\uFE0F|\uD83C[\uDFFB-\uDFFF])?(?:\u200D[\u2640\u2642]\uFE0F?)?|\uDE2E(?:\u200D\uD83D\uDCA8)?|\uDE35(?:\u200D\uD83D\uDCAB)?|\uDE36(?:\u200D\uD83C\uDF2B\uFE0F?)?)|\uD83E(?:[\uDD0C\uDD0F\uDD18-\uDD1F\uDD30-\uDD34\uDD36\uDD77\uDDB5\uDDB6\uDDBB\uDDD2\uDDD3\uDDD5\uDEC3-\uDEC5\uDEF0\uDEF2-\uDEF6](?:\uD83C[\uDFFB-\uDFFF])?|[\uDD26\uDD35\uDD37-\uDD39\uDD3D\uDD3E\uDDB8\uDDB9\uDDCD-\uDDCF\uDDD4\uDDD6-\uDDDD](?:\uD83C[\uDFFB-\uDFFF])?(?:\u200D[\u2640\u2642]\uFE0F?)?|[\uDDDE\uDDDF](?:\u200D[\u2640\u2642]\uFE0F?)?|[\uDD0D\uDD0E\uDD10-\uDD17\uDD20-\uDD25\uDD27-\uDD2F\uDD3A\uDD3F-\uDD45\uDD47-\uDD76\uDD78-\uDDB4\uDDB7\uDDBA\uDDBC-\uDDCC\uDDD0\uDDE0-\uDDFF\uDE70-\uDE74\uDE78-\uDE7C\uDE80-\uDE86\uDE90-\uDEAC\uDEB0-\uDEBA\uDEC0-\uDEC2\uDED0-\uDED9\uDEE0-\uDEE7]|\uDD3C(?:\u200D[\u2640\u2642]\uFE0F?|\uD83C[\uDFFB-\uDFFF])?|\uDDD1(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83E\uDDD1))|\uD83C(?:\uDFFB(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D(?:\uD83D\uDC8B\u200D)?\uD83E\uDDD1\uD83C[\uDFFC-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83E\uDDD1\uD83C[\uDFFB-\uDFFF])))?|\uDFFC(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D(?:\uD83D\uDC8B\u200D)?\uD83E\uDDD1\uD83C[\uDFFB\uDFFD-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83E\uDDD1\uD83C[\uDFFB-\uDFFF])))?|\uDFFD(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D(?:\uD83D\uDC8B\u200D)?\uD83E\uDDD1\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83E\uDDD1\uD83C[\uDFFB-\uDFFF])))?|\uDFFE(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D(?:\uD83D\uDC8B\u200D)?\uD83E\uDDD1\uD83C[\uDFFB-\uDFFD\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83E\uDDD1\uD83C[\uDFFB-\uDFFF])))?|\uDFFF(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D(?:\uD83D\uDC8B\u200D)?\uD83E\uDDD1\uD83C[\uDFFB-\uDFFE]|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83E\uDDD1\uD83C[\uDFFB-\uDFFF])))?))?|\uDEF1(?:\uD83C(?:\uDFFB(?:\u200D\uD83E\uDEF2\uD83C[\uDFFC-\uDFFF])?|\uDFFC(?:\u200D\uD83E\uDEF2\uD83C[\uDFFB\uDFFD-\uDFFF])?|\uDFFD(?:\u200D\uD83E\uDEF2\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF])?|\uDFFE(?:\u200D\uD83E\uDEF2\uD83C[\uDFFB-\uDFFD\uDFFF])?|\uDFFF(?:\u200D\uD83E\uDEF2\uD83C[\uDFFB-\uDFFE])?))?))/g,"")),Pn.exports.regex(/[0-9\p{Letter}_-]+/u),Pn.exports.whitespace.map((e=>" ")),Pn.exports.any.map((e=>" "))).many().map((e=>e.join("").split(/\s+/).join(" ").trim()));function Wn(e){return jn.tryParse(e)}var Gn,Yn,Un,zn,qn;!function(e){function t(e){return r(e)?{type:"null",value:e}:n(e)?{type:"number",value:e}:i(e)?{type:"string",value:e}:o(e)?{type:"boolean",value:e}:u(e)?{type:"duration",value:e}:s(e)?{type:"date",value:e}:l(e)?{type:"widget",value:e}:a(e)?{type:"array",value:e}:D(e)?{type:"link",value:e}:h(e)?{type:"function",value:e}:c(e)?{type:"html",value:e}:d(e)?{type:"object",value:e}:void 0}function i(e){return"string"==typeof e}function n(e){return"number"==typeof e}function s(e){return e instanceof Ln}function u(e){return e instanceof Bi}function r(e){return null==e}function a(e){return Array.isArray(e)}function o(e){return"boolean"==typeof e}function D(e){return e instanceof $n}function l(e){return e instanceof Zn}function c(e){return"undefined"!=typeof HTMLElement&&e instanceof HTMLElement}function d(e){return!("object"!=typeof e||c(e)||l(e)||a(e)||u(e)||s(e)||D(e)||void 0===e||r(e))}function h(e){return"function"==typeof e}e.toString=function e(i,n=In,s=!1){let u=t(i);if(!u)return n.renderNullAs;switch(u.type){case"null":return n.renderNullAs;case"string":return u.value;case"number":case"boolean":return""+u.value;case"html":return u.value.outerHTML;case"widget":case"link":return u.value.markdown();case"function":return"<function>";case"array":let t="";return s&&(t+="["),t+=u.value.map((t=>e(t,n,!0))).join(", "),s&&(t+="]"),t;case"object":return"{ "+Object.entries(u.value).map((t=>t[0]+": "+e(t[1],n,!0))).join(", ")+" }";case"date":return 0==u.value.second&&0==u.value.hour&&0==u.value.minute?u.value.toFormat(n.defaultDateFormat):u.value.toFormat(n.defaultDateTimeFormat);case"duration":return r=Vn(r=u.value),(r=Bi.fromObject(Object.fromEntries(Object.entries(r.toObject()).filter((([,e])=>e>0))))).toHuman()}var r},e.wrapValue=t,e.mapLeaves=function e(t,i){if(d(t)){let n={};for(let[s,u]of Object.entries(t))n[s]=e(u,i);return n}if(a(t)){let n=[];for(let s of t)n.push(e(s,i));return n}return i(t)},e.compareValue=function e(i,n,s){var u,r;if(void 0===i&&(i=null),void 0===n&&(n=null),null===i&&null===n)return 0;if(null===i)return-1;if(null===n)return 1;let a=t(i),o=t(n);if(void 0===a&&void 0===o)return 0;if(void 0===a)return-1;if(void 0===o)return 1;if(a.type!=o.type)return a.type.localeCompare(o.type);if(a.value===o.value)return 0;switch(a.type){case"string":return a.value.localeCompare(o.value);case"number":return a.value<o.value?-1:a.value==o.value?0:1;case"null":case"widget":case"html":case"function":return 0;case"boolean":return a.value==o.value?0:a.value?1:-1;case"link":let t=a.value,i=o.value,n=null!=s?s:e=>e,D=n(t.path).localeCompare(n(i.path));if(0!=D)return D;let l=t.type.localeCompare(i.type);return 0!=l?l:t.subpath&&!i.subpath?1:!t.subpath&&i.subpath?-1:t.subpath||i.subpath?(null!==(u=t.subpath)&&void 0!==u?u:"").localeCompare(null!==(r=i.subpath)&&void 0!==r?r:""):0;case"date":case"duration":return a.value<o.value?-1:a.value.equals(o.value)?0:1;case"array":let c=a.value,d=o.value;for(let t=0;t<Math.min(c.length,d.length);t++){let i=e(c[t],d[t]);if(0!=i)return i}return c.length-d.length;case"object":let h=a.value,p=o.value,g=Array.from(Object.keys(h)),F=Array.from(Object.keys(p));g.sort(),F.sort();let f=e(g,F);if(0!=f)return f;for(let t of g){let i=e(h[t],p[t]);if(0!=i)return i}return 0}},e.typeOf=function(e){var i;return null===(i=t(e))||void 0===i?void 0:i.type},e.isTruthy=function(e){let i=t(e);if(!i)return!1;switch(i.type){case"number":return 0!=i.value;case"string":case"array":return i.value.length>0;case"boolean":return i.value;case"link":return!!i.value.path;case"date":return 0!=i.value.toMillis();case"duration":return 0!=i.value.as("seconds");case"object":return Object.keys(i.value).length>0;case"null":return!1;case"html":case"widget":case"function":return!0}},e.deepCopy=function t(i){if(null==i)return i;if(e.isArray(i))return[].concat(i.map((e=>t(e))));if(e.isObject(i)){let e={};for(let[n,s]of Object.entries(i))e[n]=t(s);return e}return i},e.isString=i,e.isNumber=n,e.isDate=s,e.isDuration=u,e.isNull=r,e.isArray=a,e.isBoolean=o,e.isLink=D,e.isWidget=l,e.isHtml=c,e.isObject=d,e.isFunction=h}(Gn||(Gn={})),function(e){function t(e){return Gn.isObject(e)&&2==Object.keys(e).length&&"key"in e&&"rows"in e}function i(e){for(let i of e)if(!t(i))return!1;return!0}e.isElementGroup=t,e.isGrouping=i,e.count=function e(t){if(i(t)){let i=0;for(let n of t)i+=e(n.rows);return i}return t.length}}(Yn||(Yn={}));class $n{constructor(e){Object.assign(this,e)}static file(e,t=!1,i){return new $n({path:e,embed:t,display:i,subpath:void 0,type:"file"})}static infer(e,t=!1,i){if(e.includes("#^")){let n=e.split("#^");return $n.block(n[0],n[1],t,i)}if(e.includes("#")){let n=e.split("#");return $n.header(n[0],n[1],t,i)}return $n.file(e,t,i)}static header(e,t,i,n){return new $n({path:e,embed:i,display:n,subpath:Wn(t),type:"header"})}static block(e,t,i,n){return new $n({path:e,embed:i,display:n,subpath:t,type:"block"})}static fromObject(e){return new $n(e)}equals(e){return null!=e&&null!=e&&this.path==e.path&&this.type==e.type&&this.subpath==e.subpath}toString(){return this.markdown()}toObject(){return{path:this.path,type:this.type,subpath:this.subpath,display:this.display,embed:this.embed}}withPath(e){return new $n(Object.assign({},this,{path:e}))}withDisplay(e){return new $n(Object.assign({},this,{display:e}))}withHeader(e){return $n.header(this.path,e,this.embed,this.display)}toFile(){return $n.file(this.path,this.embed,this.display)}toEmbed(){if(this.embed)return this;{let e=new $n(this);return e.embed=!0,e}}fromEmbed(){if(this.embed){let e=new $n(this);return e.embed=!1,e}return this}markdown(){let e=(this.embed?"!":"")+"[["+this.obsidianLink();return this.display?e+="|"+this.display:(e+="|"+Hn(this.path),"header"!=this.type&&"block"!=this.type||(e+=" > "+this.subpath)),e+="]]",e}obsidianLink(){var e,t;const i=this.path.replace("|","\\|");return"header"==this.type?i+"#"+(null===(e=this.subpath)||void 0===e?void 0:e.replace("|","\\|")):"block"==this.type?i+"#^"+(null===(t=this.subpath)||void 0===t?void 0:t.replace("|","\\|")):i}fileName(){return Hn(this.path).replace(".md","")}}class Zn{constructor(e){this.$widget=e}}class Jn extends Zn{constructor(e,t){super("dataview:list-pair"),this.key=e,this.value=t}markdown(){return`${Gn.toString(this.key)}: ${Gn.toString(this.value)}`}}class Kn extends Zn{constructor(e,t){super("dataview:external-link"),this.url=e,this.display=t}markdown(){var e;return`[${null!==(e=this.display)&&void 0!==e?e:this.url}](${this.url})`}}!function(e){function t(e){return"dataview:list-pair"===e.$widget}function i(e){return"dataview:external-link"===e.$widget}e.listPair=function(e,t){return new Jn(e,t)},e.externalLink=function(e,t){return new Kn(e,t)},e.isListPair=t,e.isExternalLink=i,e.isBuiltin=function(e){return t(e)||i(e)}}(Un||(Un={})),function(e){e.variable=function(e){return{type:"variable",name:e}},e.literal=function(e){return{type:"literal",value:e}},e.binaryOp=function(e,t,i){return{type:"binaryop",left:e,op:t,right:i}},e.index=function(e,t){return{type:"index",object:e,index:t}},e.indexVariable=function(t){let i=t.split("."),n=e.variable(i[0]);for(let t=1;t<i.length;t++)n=e.index(n,e.literal(i[t]));return n},e.lambda=function(e,t){return{type:"lambda",arguments:e,value:t}},e.func=function(e,t){return{type:"function",func:e,arguments:t}},e.list=function(e){return{type:"list",values:e}},e.object=function(e){return{type:"object",values:e}},e.negate=function(e){return{type:"negated",child:e}},e.isCompareOp=function(e){return"<="==e||"<"==e||">"==e||">="==e||"!="==e||"="==e},e.NULL=e.literal(null)}(zn||(zn={})),function(e){e.tag=function(e){return{type:"tag",tag:e}},e.csv=function(e){return{type:"csv",path:e}},e.folder=function(e){return{type:"folder",folder:e}},e.link=function(e,t){return{type:"link",file:e,direction:t?"incoming":"outgoing"}},e.binaryOp=function(e,t,i){return{type:"binaryop",left:e,op:t,right:i}},e.and=function(e,t){return{type:"binaryop",left:e,op:"&",right:t}},e.or=function(e,t){return{type:"binaryop",left:e,op:"|",right:t}},e.negate=function(e){return{type:"negate",child:e}},e.empty=function(){return{type:"empty"}}}(qn||(qn={}));const Xn=new RegExp(/(?:[#*0-9]\uFE0F?\u20E3|[\xA9\xAE\u203C\u2049\u2122\u2139\u2194-\u2199\u21A9\u21AA\u231A\u231B\u2328\u23CF\u23ED-\u23EF\u23F1\u23F2\u23F8-\u23FA\u24C2\u25AA\u25AB\u25B6\u25C0\u25FB\u25FC\u25FE\u2600-\u2604\u260E\u2611\u2614\u2615\u2618\u2620\u2622\u2623\u2626\u262A\u262E\u262F\u2638-\u263A\u2640\u2642\u2648-\u2653\u265F\u2660\u2663\u2665\u2666\u2668\u267B\u267E\u267F\u2692\u2694-\u2697\u2699\u269B\u269C\u26A0\u26A7\u26AA\u26B0\u26B1\u26BD\u26BE\u26C4\u26C8\u26CF\u26D1\u26D3\u26E9\u26F0-\u26F5\u26F7\u26F8\u26FA\u2702\u2708\u2709\u270F\u2712\u2714\u2716\u271D\u2721\u2733\u2734\u2744\u2747\u2757\u2763\u27A1\u2934\u2935\u2B05-\u2B07\u2B1B\u2B1C\u2B55\u3030\u303D\u3297\u3299]\uFE0F?|[\u261D\u270C\u270D](?:\uFE0F|\uD83C[\uDFFB-\uDFFF])?|[\u270A\u270B](?:\uD83C[\uDFFB-\uDFFF])?|[\u23E9-\u23EC\u23F0\u23F3\u25FD\u2693\u26A1\u26AB\u26C5\u26CE\u26D4\u26EA\u26FD\u2705\u2728\u274C\u274E\u2753-\u2755\u2795-\u2797\u27B0\u27BF\u2B50]|\u26F9(?:\uFE0F|\uD83C[\uDFFB-\uDFFF])?(?:\u200D[\u2640\u2642]\uFE0F?)?|\u2764\uFE0F?(?:\u200D(?:\uD83D\uDD25|\uD83E\uDE79))?|\uD83C(?:[\uDC04\uDD70\uDD71\uDD7E\uDD7F\uDE02\uDE37\uDF21\uDF24-\uDF2C\uDF36\uDF7D\uDF96\uDF97\uDF99-\uDF9B\uDF9E\uDF9F\uDFCD\uDFCE\uDFD4-\uDFDF\uDFF5\uDFF7]\uFE0F?|[\uDF85\uDFC2\uDFC7](?:\uD83C[\uDFFB-\uDFFF])?|[\uDFC3\uDFC4\uDFCA](?:\uD83C[\uDFFB-\uDFFF])?(?:\u200D[\u2640\u2642]\uFE0F?)?|[\uDFCB\uDFCC](?:\uFE0F|\uD83C[\uDFFB-\uDFFF])?(?:\u200D[\u2640\u2642]\uFE0F?)?|[\uDCCF\uDD8E\uDD91-\uDD9A\uDE01\uDE1A\uDE2F\uDE32-\uDE36\uDE38-\uDE3A\uDE50\uDE51\uDF00-\uDF20\uDF2D-\uDF35\uDF37-\uDF7C\uDF7E-\uDF84\uDF86-\uDF93\uDFA0-\uDFC1\uDFC5\uDFC6\uDFC8\uDFC9\uDFCF-\uDFD3\uDFE0-\uDFF0\uDFF8-\uDFFF]|\uDDE6\uD83C[\uDDE8-\uDDEC\uDDEE\uDDF1\uDDF2\uDDF4\uDDF6-\uDDFA\uDDFC\uDDFD\uDDFF]|\uDDE7\uD83C[\uDDE6\uDDE7\uDDE9-\uDDEF\uDDF1-\uDDF4\uDDF6-\uDDF9\uDDFB\uDDFC\uDDFE\uDDFF]|\uDDE8\uD83C[\uDDE6\uDDE8\uDDE9\uDDEB-\uDDEE\uDDF0-\uDDF5\uDDF7\uDDFA-\uDDFF]|\uDDE9\uD83C[\uDDEA\uDDEC\uDDEF\uDDF0\uDDF2\uDDF4\uDDFF]|\uDDEA\uD83C[\uDDE6\uDDE8\uDDEA\uDDEC\uDDED\uDDF7-\uDDFA]|\uDDEB\uD83C[\uDDEE-\uDDF0\uDDF2\uDDF4\uDDF7]|\uDDEC\uD83C[\uDDE6\uDDE7\uDDE9-\uDDEE\uDDF1-\uDDF3\uDDF5-\uDDFA\uDDFC\uDDFE]|\uDDED\uD83C[\uDDF0\uDDF2\uDDF3\uDDF7\uDDF9\uDDFA]|\uDDEE\uD83C[\uDDE8-\uDDEA\uDDF1-\uDDF4\uDDF6-\uDDF9]|\uDDEF\uD83C[\uDDEA\uDDF2\uDDF4\uDDF5]|\uDDF0\uD83C[\uDDEA\uDDEC-\uDDEE\uDDF2\uDDF3\uDDF5\uDDF7\uDDFC\uDDFE\uDDFF]|\uDDF1\uD83C[\uDDE6-\uDDE8\uDDEE\uDDF0\uDDF7-\uDDFB\uDDFE]|\uDDF2\uD83C[\uDDE6\uDDE8-\uDDED\uDDF0-\uDDFF]|\uDDF3\uD83C[\uDDE6\uDDE8\uDDEA-\uDDEC\uDDEE\uDDF1\uDDF4\uDDF5\uDDF7\uDDFA\uDDFF]|\uDDF4\uD83C\uDDF2|\uDDF5\uD83C[\uDDE6\uDDEA-\uDDED\uDDF0-\uDDF3\uDDF7-\uDDF9\uDDFC\uDDFE]|\uDDF6\uD83C\uDDE6|\uDDF7\uD83C[\uDDEA\uDDF4\uDDF8\uDDFA\uDDFC]|\uDDF8\uD83C[\uDDE6-\uDDEA\uDDEC-\uDDF4\uDDF7-\uDDF9\uDDFB\uDDFD-\uDDFF]|\uDDF9\uD83C[\uDDE6\uDDE8\uDDE9\uDDEB-\uDDED\uDDEF-\uDDF4\uDDF7\uDDF9\uDDFB\uDDFC\uDDFF]|\uDDFA\uD83C[\uDDE6\uDDEC\uDDF2\uDDF3\uDDF8\uDDFE\uDDFF]|\uDDFB\uD83C[\uDDE6\uDDE8\uDDEA\uDDEC\uDDEE\uDDF3\uDDFA]|\uDDFC\uD83C[\uDDEB\uDDF8]|\uDDFD\uD83C\uDDF0|\uDDFE\uD83C[\uDDEA\uDDF9]|\uDDFF\uD83C[\uDDE6\uDDF2\uDDFC]|\uDFF3\uFE0F?(?:\u200D(?:\u26A7\uFE0F?|\uD83C\uDF08))?|\uDFF4(?:\u200D\u2620\uFE0F?|\uDB40\uDC67\uDB40\uDC62\uDB40(?:\uDC65\uDB40\uDC6E\uDB40\uDC67|\uDC73\uDB40\uDC63\uDB40\uDC74|\uDC77\uDB40\uDC6C\uDB40\uDC73)\uDB40\uDC7F)?)|\uD83D(?:[\uDC3F\uDCFD\uDD49\uDD4A\uDD6F\uDD70\uDD73\uDD76-\uDD79\uDD87\uDD8A-\uDD8D\uDDA5\uDDA8\uDDB1\uDDB2\uDDBC\uDDC2-\uDDC4\uDDD1-\uDDD3\uDDDC-\uDDDE\uDDE1\uDDE3\uDDE8\uDDEF\uDDF3\uDDFA\uDECB\uDECD-\uDECF\uDEE0-\uDEE5\uDEE9\uDEF0\uDEF3]\uFE0F?|[\uDC42\uDC43\uDC46-\uDC50\uDC66\uDC67\uDC6B-\uDC6D\uDC72\uDC74-\uDC76\uDC78\uDC7C\uDC83\uDC85\uDC8F\uDC91\uDCAA\uDD7A\uDD95\uDD96\uDE4C\uDE4F\uDEC0\uDECC](?:\uD83C[\uDFFB-\uDFFF])?|[\uDC6E\uDC70\uDC71\uDC73\uDC77\uDC81\uDC82\uDC86\uDC87\uDE45-\uDE47\uDE4B\uDE4D\uDE4E\uDEA3\uDEB4-\uDEB6](?:\uD83C[\uDFFB-\uDFFF])?(?:\u200D[\u2640\u2642]\uFE0F?)?|[\uDD74\uDD90](?:\uFE0F|\uD83C[\uDFFB-\uDFFF])?|[\uDC00-\uDC07\uDC09-\uDC14\uDC16-\uDC3A\uDC3C-\uDC3E\uDC40\uDC44\uDC45\uDC51-\uDC65\uDC6A\uDC79-\uDC7B\uDC7D-\uDC80\uDC84\uDC88-\uDC8E\uDC90\uDC92-\uDCA9\uDCAB-\uDCFC\uDCFF-\uDD3D\uDD4B-\uDD4E\uDD50-\uDD67\uDDA4\uDDFB-\uDE2D\uDE2F-\uDE34\uDE37-\uDE44\uDE48-\uDE4A\uDE80-\uDEA2\uDEA4-\uDEB3\uDEB7-\uDEBF\uDEC1-\uDEC5\uDED0-\uDED2\uDED5-\uDED7\uDEDD-\uDEDF\uDEEB\uDEEC\uDEF4-\uDEFC\uDFE0-\uDFEB\uDFF0]|\uDC08(?:\u200D\u2B1B)?|\uDC15(?:\u200D\uD83E\uDDBA)?|\uDC3B(?:\u200D\u2744\uFE0F?)?|\uDC41\uFE0F?(?:\u200D\uD83D\uDDE8\uFE0F?)?|\uDC68(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D(?:[\uDC68\uDC69]\u200D\uD83D(?:\uDC66(?:\u200D\uD83D\uDC66)?|\uDC67(?:\u200D\uD83D[\uDC66\uDC67])?)|[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uDC66(?:\u200D\uD83D\uDC66)?|\uDC67(?:\u200D\uD83D[\uDC66\uDC67])?)|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\uD83C(?:\uDFFB(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83D\uDC68\uD83C[\uDFFC-\uDFFF])))?|\uDFFC(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83D\uDC68\uD83C[\uDFFB\uDFFD-\uDFFF])))?|\uDFFD(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83D\uDC68\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF])))?|\uDFFE(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83D\uDC68\uD83C[\uDFFB-\uDFFD\uDFFF])))?|\uDFFF(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83D\uDC68\uD83C[\uDFFB-\uDFFE])))?))?|\uDC69(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?[\uDC68\uDC69]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D(?:[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uDC66(?:\u200D\uD83D\uDC66)?|\uDC67(?:\u200D\uD83D[\uDC66\uDC67])?|\uDC69\u200D\uD83D(?:\uDC66(?:\u200D\uD83D\uDC66)?|\uDC67(?:\u200D\uD83D[\uDC66\uDC67])?))|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\uD83C(?:\uDFFB(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:[\uDC68\uDC69]|\uDC8B\u200D\uD83D[\uDC68\uDC69])\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83D[\uDC68\uDC69]\uD83C[\uDFFC-\uDFFF])))?|\uDFFC(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:[\uDC68\uDC69]|\uDC8B\u200D\uD83D[\uDC68\uDC69])\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83D[\uDC68\uDC69]\uD83C[\uDFFB\uDFFD-\uDFFF])))?|\uDFFD(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:[\uDC68\uDC69]|\uDC8B\u200D\uD83D[\uDC68\uDC69])\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83D[\uDC68\uDC69]\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF])))?|\uDFFE(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:[\uDC68\uDC69]|\uDC8B\u200D\uD83D[\uDC68\uDC69])\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83D[\uDC68\uDC69]\uD83C[\uDFFB-\uDFFD\uDFFF])))?|\uDFFF(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:[\uDC68\uDC69]|\uDC8B\u200D\uD83D[\uDC68\uDC69])\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83D[\uDC68\uDC69]\uD83C[\uDFFB-\uDFFE])))?))?|\uDC6F(?:\u200D[\u2640\u2642]\uFE0F?)?|\uDD75(?:\uFE0F|\uD83C[\uDFFB-\uDFFF])?(?:\u200D[\u2640\u2642]\uFE0F?)?|\uDE2E(?:\u200D\uD83D\uDCA8)?|\uDE35(?:\u200D\uD83D\uDCAB)?|\uDE36(?:\u200D\uD83C\uDF2B\uFE0F?)?)|\uD83E(?:[\uDD0C\uDD0F\uDD18-\uDD1F\uDD30-\uDD34\uDD36\uDD77\uDDB5\uDDB6\uDDBB\uDDD2\uDDD3\uDDD5\uDEC3-\uDEC5\uDEF0\uDEF2-\uDEF6](?:\uD83C[\uDFFB-\uDFFF])?|[\uDD26\uDD35\uDD37-\uDD39\uDD3D\uDD3E\uDDB8\uDDB9\uDDCD-\uDDCF\uDDD4\uDDD6-\uDDDD](?:\uD83C[\uDFFB-\uDFFF])?(?:\u200D[\u2640\u2642]\uFE0F?)?|[\uDDDE\uDDDF](?:\u200D[\u2640\u2642]\uFE0F?)?|[\uDD0D\uDD0E\uDD10-\uDD17\uDD20-\uDD25\uDD27-\uDD2F\uDD3A\uDD3F-\uDD45\uDD47-\uDD76\uDD78-\uDDB4\uDDB7\uDDBA\uDDBC-\uDDCC\uDDD0\uDDE0-\uDDFF\uDE70-\uDE74\uDE78-\uDE7C\uDE80-\uDE86\uDE90-\uDEAC\uDEB0-\uDEBA\uDEC0-\uDEC2\uDED0-\uDED9\uDEE0-\uDEE7]|\uDD3C(?:\u200D[\u2640\u2642]\uFE0F?|\uD83C[\uDFFB-\uDFFF])?|\uDDD1(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83E\uDDD1))|\uD83C(?:\uDFFB(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D(?:\uD83D\uDC8B\u200D)?\uD83E\uDDD1\uD83C[\uDFFC-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83E\uDDD1\uD83C[\uDFFB-\uDFFF])))?|\uDFFC(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D(?:\uD83D\uDC8B\u200D)?\uD83E\uDDD1\uD83C[\uDFFB\uDFFD-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83E\uDDD1\uD83C[\uDFFB-\uDFFF])))?|\uDFFD(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D(?:\uD83D\uDC8B\u200D)?\uD83E\uDDD1\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83E\uDDD1\uD83C[\uDFFB-\uDFFF])))?|\uDFFE(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D(?:\uD83D\uDC8B\u200D)?\uD83E\uDDD1\uD83C[\uDFFB-\uDFFD\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83E\uDDD1\uD83C[\uDFFB-\uDFFF])))?|\uDFFF(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D(?:\uD83D\uDC8B\u200D)?\uD83E\uDDD1\uD83C[\uDFFB-\uDFFE]|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83E\uDDD1\uD83C[\uDFFB-\uDFFF])))?))?|\uDEF1(?:\uD83C(?:\uDFFB(?:\u200D\uD83E\uDEF2\uD83C[\uDFFC-\uDFFF])?|\uDFFC(?:\u200D\uD83E\uDEF2\uD83C[\uDFFB\uDFFD-\uDFFF])?|\uDFFD(?:\u200D\uD83E\uDEF2\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF])?|\uDFFE(?:\u200D\uD83E\uDEF2\uD83C[\uDFFB-\uDFFD\uDFFF])?|\uDFFF(?:\u200D\uD83E\uDEF2\uD83C[\uDFFB-\uDFFE])?))?))/g,""),Qn={year:Bi.fromObject({years:1}),years:Bi.fromObject({years:1}),yr:Bi.fromObject({years:1}),yrs:Bi.fromObject({years:1}),month:Bi.fromObject({months:1}),months:Bi.fromObject({months:1}),mo:Bi.fromObject({months:1}),mos:Bi.fromObject({months:1}),week:Bi.fromObject({weeks:1}),weeks:Bi.fromObject({weeks:1}),wk:Bi.fromObject({weeks:1}),wks:Bi.fromObject({weeks:1}),w:Bi.fromObject({weeks:1}),day:Bi.fromObject({days:1}),days:Bi.fromObject({days:1}),d:Bi.fromObject({days:1}),hour:Bi.fromObject({hours:1}),hours:Bi.fromObject({hours:1}),hr:Bi.fromObject({hours:1}),hrs:Bi.fromObject({hours:1}),h:Bi.fromObject({hours:1}),minute:Bi.fromObject({minutes:1}),minutes:Bi.fromObject({minutes:1}),min:Bi.fromObject({minutes:1}),mins:Bi.fromObject({minutes:1}),m:Bi.fromObject({minutes:1}),second:Bi.fromObject({seconds:1}),seconds:Bi.fromObject({seconds:1}),sec:Bi.fromObject({seconds:1}),secs:Bi.fromObject({seconds:1}),s:Bi.fromObject({seconds:1})},es={now:()=>Ln.local(),today:()=>Ln.local().startOf("day"),yesterday:()=>Ln.local().startOf("day").minus(Bi.fromObject({days:1})),tomorrow:()=>Ln.local().startOf("day").plus(Bi.fromObject({days:1})),sow:()=>Ln.local().startOf("week"),"start-of-week":()=>Ln.local().startOf("week"),eow:()=>Ln.local().endOf("week"),"end-of-week":()=>Ln.local().endOf("week"),soy:()=>Ln.local().startOf("year"),"start-of-year":()=>Ln.local().startOf("year"),eoy:()=>Ln.local().endOf("year"),"end-of-year":()=>Ln.local().endOf("year"),som:()=>Ln.local().startOf("month"),"start-of-month":()=>Ln.local().startOf("month"),eom:()=>Ln.local().endOf("month"),"end-of-month":()=>Ln.local().endOf("month")},ts=["FROM","WHERE","LIMIT","GROUP","FLATTEN"];function is(e,t,i){return Pn.exports.seqMap(e,Pn.exports.seq(Pn.exports.optWhitespace,t,Pn.exports.optWhitespace,e).many(),((e,t)=>{if(0==t.length)return e;let n=i(e,t[0][1],t[0][3]);for(let e=1;e<t.length;e++)n=i(n,t[e][1],t[e][3]);return n}))}const ns=Pn.exports.createLanguage({number:e=>Pn.exports.regexp(/-?[0-9]+(\.[0-9]+)?/).map((e=>Number.parseFloat(e))).desc("number"),string:e=>Pn.exports.string('"').then(Pn.exports.alt(e.escapeCharacter,Pn.exports.noneOf('"\\')).atLeast(0).map((e=>e.join("")))).skip(Pn.exports.string('"')).desc("string"),escapeCharacter:e=>Pn.exports.string("\\").then(Pn.exports.any).map((e=>'"'===e?'"':"\\"===e?"\\":"\\"+e)),bool:e=>Pn.exports.regexp(/true|false|True|False/).map((e=>"true"==e.toLowerCase())).desc("boolean ('true' or 'false')"),tag:e=>Pn.exports.seqMap(Pn.exports.string("#"),Pn.exports.alt(Pn.exports.regexp(/[^\u2000-\u206F\u2E00-\u2E7F'!"#$%&()*+,.:;<=>?@^`{|}~\[\]\\\s]/).desc("text")).many(),((e,t)=>e+t.join(""))).desc("tag ('#hello/stuff')"),identifier:e=>Pn.exports.seqMap(Pn.exports.alt(Pn.exports.regexp(/\p{Letter}/u),Pn.exports.regexp(Xn).desc("text")),Pn.exports.alt(Pn.exports.regexp(/[0-9\p{Letter}_-]/u),Pn.exports.regexp(Xn).desc("text")).many(),((e,t)=>e+t.join(""))).desc("variable identifier"),link:e=>Pn.exports.regexp(/\[\[([^\[\]]*?)\]\]/u,1).map((e=>function(e){let[t,i]=function(e){let t=-1;for(;(t=e.indexOf("|",t+1))>=0;)if(!(t>0&&"\\"==e[t-1]))return[e.substring(0,t).replace(/\\\|/g,"|"),e.substring(t+1)];return[e.replace(/\\\|/g,"|"),void 0]}(e);return $n.infer(t,!1,i)}(e))).desc("file link"),embedLink:e=>Pn.exports.seqMap(Pn.exports.string("!").atMost(1),e.link,((e,t)=>(e.length>0&&(t.embed=!0),t))).desc("file link"),binaryPlusMinus:e=>Pn.exports.regexp(/\+|-/).map((e=>e)).desc("'+' or '-'"),binaryMulDiv:e=>Pn.exports.regexp(/\*|\/|%/).map((e=>e)).desc("'*' or '/' or '%'"),binaryCompareOp:e=>Pn.exports.regexp(/>=|<=|!=|>|<|=/).map((e=>e)).desc("'>=' or '<=' or '!=' or '=' or '>' or '<'"),binaryBooleanOp:e=>Pn.exports.regexp(/and|or|&|\|/i).map((e=>"and"==e.toLowerCase()?"&":"or"==e.toLowerCase()?"|":e)).desc("'and' or 'or'"),rootDate:e=>Pn.exports.seqMap(Pn.exports.regexp(/\d{4}/),Pn.exports.string("-"),Pn.exports.regexp(/\d{2}/),((e,t,i)=>Ln.fromObject({year:Number.parseInt(e),month:Number.parseInt(i)}))).desc("date in format YYYY-MM[-DDTHH-MM-SS.MS]"),dateShorthand:e=>Pn.exports.alt(...Object.keys(es).sort(((e,t)=>t.length-e.length)).map(Pn.exports.string)),date:e=>function(e,...t){return Pn.exports.custom(((i,n)=>(i,n)=>{let s=e._(i,n);if(!s.status)return s;for(let e of t){let t=e(s.value)._(i,s.index);if(!t.status)return s;s=t}return s}))}(e.rootDate,(e=>Pn.exports.seqMap(Pn.exports.string("-"),Pn.exports.regexp(/\d{2}/),((t,i)=>e.set({day:Number.parseInt(i)})))),(e=>Pn.exports.seqMap(Pn.exports.string("T"),Pn.exports.regexp(/\d{2}/),((t,i)=>e.set({hour:Number.parseInt(i)})))),(e=>Pn.exports.seqMap(Pn.exports.string(":"),Pn.exports.regexp(/\d{2}/),((t,i)=>e.set({minute:Number.parseInt(i)})))),(e=>Pn.exports.seqMap(Pn.exports.string(":"),Pn.exports.regexp(/\d{2}/),((t,i)=>e.set({second:Number.parseInt(i)})))),(e=>Pn.exports.alt(Pn.exports.seqMap(Pn.exports.string("."),Pn.exports.regexp(/\d{3}/),((t,i)=>e.set({millisecond:Number.parseInt(i)}))),Pn.exports.succeed(e))),(e=>Pn.exports.alt(Pn.exports.seqMap(Pn.exports.string("+").or(Pn.exports.string("-")),Pn.exports.regexp(/\d{1,2}(:\d{2})?/),((t,i)=>e.setZone("UTC"+t+i,{keepLocalTime:!0}))),Pn.exports.seqMap(Pn.exports.string("Z"),(()=>e.setZone("utc",{keepLocalTime:!0}))),Pn.exports.seqMap(Pn.exports.string("["),Pn.exports.regexp(/[0-9A-Za-z+-\/]+/u),Pn.exports.string("]"),((t,i,n)=>e.setZone(i,{keepLocalTime:!0})))))).assert((e=>e.isValid),"valid date").desc("date in format YYYY-MM[-DDTHH-MM-SS.MS]"),datePlus:e=>Pn.exports.alt(e.dateShorthand.map((e=>es[e]())),e.date).desc("date in format YYYY-MM[-DDTHH-MM-SS.MS] or in shorthand"),durationType:e=>Pn.exports.alt(...Object.keys(Qn).sort(((e,t)=>t.length-e.length)).map(Pn.exports.string)),duration:e=>Pn.exports.seqMap(e.number,Pn.exports.optWhitespace,e.durationType,((e,t,i)=>Qn[i].mapUnits((t=>t*e)))).sepBy1(Pn.exports.string(",").trim(Pn.exports.optWhitespace).or(Pn.exports.optWhitespace)).map((e=>e.reduce(((e,t)=>e.plus(t))))).desc("duration like 4hr2min"),rawNull:e=>Pn.exports.string("null"),tagSource:e=>e.tag.map((e=>qn.tag(e))),csvSource:e=>Pn.exports.seqMap(Pn.exports.string("csv(").skip(Pn.exports.optWhitespace),e.string,Pn.exports.string(")"),((e,t,i)=>qn.csv(t))),linkIncomingSource:e=>e.link.map((e=>qn.link(e.path,!0))),linkOutgoingSource:e=>Pn.exports.seqMap(Pn.exports.string("outgoing(").skip(Pn.exports.optWhitespace),e.link,Pn.exports.string(")"),((e,t,i)=>qn.link(t.path,!1))),folderSource:e=>e.string.map((e=>qn.folder(e))),parensSource:e=>Pn.exports.seqMap(Pn.exports.string("("),Pn.exports.optWhitespace,e.source,Pn.exports.optWhitespace,Pn.exports.string(")"),((e,t,i,n,s)=>i)),negateSource:e=>Pn.exports.seqMap(Pn.exports.alt(Pn.exports.string("-"),Pn.exports.string("!")),e.atomSource,((e,t)=>qn.negate(t))),atomSource:e=>Pn.exports.alt(e.parensSource,e.negateSource,e.linkOutgoingSource,e.linkIncomingSource,e.folderSource,e.tagSource,e.csvSource),binaryOpSource:e=>is(e.atomSource,e.binaryBooleanOp.map((e=>e)),qn.binaryOp),source:e=>e.binaryOpSource,variableField:e=>e.identifier.chain((e=>ts.includes(e.toUpperCase())?Pn.exports.fail("Variable fields cannot be a keyword ("+ts.join(" or ")+")"):Pn.exports.succeed(zn.variable(e)))).desc("variable"),numberField:e=>e.number.map((e=>zn.literal(e))).desc("number"),stringField:e=>e.string.map((e=>zn.literal(e))).desc("string"),boolField:e=>e.bool.map((e=>zn.literal(e))).desc("boolean"),dateField:e=>Pn.exports.seqMap(Pn.exports.string("date("),Pn.exports.optWhitespace,e.datePlus,Pn.exports.optWhitespace,Pn.exports.string(")"),((e,t,i,n,s)=>zn.literal(i))).desc("date"),durationField:e=>Pn.exports.seqMap(Pn.exports.string("dur("),Pn.exports.optWhitespace,e.duration,Pn.exports.optWhitespace,Pn.exports.string(")"),((e,t,i,n,s)=>zn.literal(i))).desc("duration"),nullField:e=>e.rawNull.map((e=>zn.NULL)),linkField:e=>e.link.map((e=>zn.literal(e))),listField:e=>e.field.sepBy(Pn.exports.string(",").trim(Pn.exports.optWhitespace)).wrap(Pn.exports.string("[").skip(Pn.exports.optWhitespace),Pn.exports.optWhitespace.then(Pn.exports.string("]"))).map((e=>zn.list(e))).desc("list ('[1, 2, 3]')"),objectField:e=>Pn.exports.seqMap(e.identifier.or(e.string),Pn.exports.string(":").trim(Pn.exports.optWhitespace),e.field,((e,t,i)=>({name:e,value:i}))).sepBy(Pn.exports.string(",").trim(Pn.exports.optWhitespace)).wrap(Pn.exports.string("{").skip(Pn.exports.optWhitespace),Pn.exports.optWhitespace.then(Pn.exports.string("}"))).map((e=>{let t={};for(let i of e)t[i.name]=i.value;return zn.object(t)})).desc("object ('{ a: 1, b: 2 }')"),atomInlineField:e=>Pn.exports.alt(e.date,e.duration.map((e=>Vn(e))),e.string,e.tag,e.embedLink,e.bool,e.number,e.rawNull),inlineFieldList:e=>e.atomInlineField.sepBy(Pn.exports.string(",").trim(Pn.exports.optWhitespace).lookahead(e.atomInlineField)),inlineField:e=>Pn.exports.alt(Pn.exports.seqMap(e.atomInlineField,Pn.exports.string(",").trim(Pn.exports.optWhitespace),e.inlineFieldList,((e,t,i)=>[e].concat(i))),e.atomInlineField),atomField:e=>Pn.exports.alt(e.embedLink.map((e=>zn.literal(e))),e.negatedField,e.linkField,e.listField,e.objectField,e.lambdaField,e.parensField,e.boolField,e.numberField,e.stringField,e.dateField,e.durationField,e.nullField,e.variableField),indexField:e=>Pn.exports.seqMap(e.atomField,Pn.exports.alt(e.dotPostfix,e.indexPostfix,e.functionPostfix).many(),((e,t)=>{let i=e;for(let e of t)switch(e.type){case"dot":i=zn.index(i,zn.literal(e.field));break;case"index":i=zn.index(i,e.field);break;case"function":i=zn.func(i,e.fields)}return i})),negatedField:e=>Pn.exports.seqMap(Pn.exports.string("!"),e.indexField,((e,t)=>zn.negate(t))).desc("negated field"),parensField:e=>Pn.exports.seqMap(Pn.exports.string("("),Pn.exports.optWhitespace,e.field,Pn.exports.optWhitespace,Pn.exports.string(")"),((e,t,i,n,s)=>i)),lambdaField:e=>Pn.exports.seqMap(e.identifier.sepBy(Pn.exports.string(",").trim(Pn.exports.optWhitespace)).wrap(Pn.exports.string("(").trim(Pn.exports.optWhitespace),Pn.exports.string(")").trim(Pn.exports.optWhitespace)),Pn.exports.string("=>").trim(Pn.exports.optWhitespace),e.field,((e,t,i)=>({type:"lambda",arguments:e,value:i}))),dotPostfix:e=>Pn.exports.seqMap(Pn.exports.string("."),e.identifier,((e,t)=>({type:"dot",field:t}))),indexPostfix:e=>Pn.exports.seqMap(Pn.exports.string("["),Pn.exports.optWhitespace,e.field,Pn.exports.optWhitespace,Pn.exports.string("]"),((e,t,i,n,s)=>({type:"index",field:i}))),functionPostfix:e=>Pn.exports.seqMap(Pn.exports.string("("),Pn.exports.optWhitespace,e.field.sepBy(Pn.exports.string(",").trim(Pn.exports.optWhitespace)),Pn.exports.optWhitespace,Pn.exports.string(")"),((e,t,i,n,s)=>({type:"function",fields:i}))),binaryMulDivField:e=>is(e.indexField,e.binaryMulDiv,zn.binaryOp),binaryPlusMinusField:e=>is(e.binaryMulDivField,e.binaryPlusMinus,zn.binaryOp),binaryCompareField:e=>is(e.binaryPlusMinusField,e.binaryCompareOp,zn.binaryOp),binaryBooleanField:e=>is(e.binaryCompareField,e.binaryBooleanOp,zn.binaryOp),binaryOpField:e=>e.binaryBooleanField,field:e=>e.binaryOpField});var ss;!function(e){e.named=function(e,t){return{name:e,field:t}},e.sortBy=function(e,t){return{field:e,direction:t}}}(ss||(ss={}));const us=Pn.exports.createLanguage({queryType:e=>Pn.exports.alt(Pn.exports.regexp(/TABLE|LIST|TASK|CALENDAR/i)).map((e=>e.toLowerCase())).desc("query type ('TABLE', 'LIST', 'TASK', or 'CALENDAR')"),explicitNamedField:e=>Pn.exports.seqMap(ns.field.skip(Pn.exports.whitespace),Pn.exports.regexp(/AS/i).skip(Pn.exports.whitespace),ns.identifier.or(ns.string),((e,t,i)=>ss.named(i,e))),namedField:e=>{return Pn.exports.alt(e.explicitNamedField,(t=ns.field,Pn.exports.custom(((e,i)=>(e,i)=>{let n=t._(e,i);return n.status?Object.assign({},n,{value:[n.value,e.substring(i,n.index)]}):n}))).map((([e,t])=>ss.named(function(e){return e.split(/[\r\n]+/).map((e=>e.trim())).join("")}(t),e))));var t},sortField:e=>Pn.exports.seqMap(ns.field.skip(Pn.exports.optWhitespace),Pn.exports.regexp(/ASCENDING|DESCENDING|ASC|DESC/i).atMost(1),((e,t)=>{let i=0==t.length?"ascending":t[0].toLowerCase();return"desc"==i&&(i="descending"),"asc"==i&&(i="ascending"),{field:e,direction:i}})),headerClause:e=>e.queryType.skip(Pn.exports.whitespace).chain((t=>{switch(t){case"table":return Pn.exports.seqMap(Pn.exports.regexp(/WITHOUT\s+ID/i).skip(Pn.exports.optWhitespace).atMost(1),Pn.exports.sepBy(e.namedField,Pn.exports.string(",").trim(Pn.exports.optWhitespace)),((e,t)=>({type:"table",fields:t,showId:0==e.length})));case"list":return Pn.exports.seqMap(Pn.exports.regexp(/WITHOUT\s+ID/i).skip(Pn.exports.optWhitespace).atMost(1),ns.field.atMost(1),((e,t)=>({type:"list",format:1==t.length?t[0]:void 0,showId:0==e.length})));case"task":return Pn.exports.succeed({type:"task"});case"calendar":return Pn.exports.seqMap(e.namedField,(e=>({type:"calendar",showId:!0,field:e})));default:return Pn.exports.fail(`Unrecognized query type '${t}'`)}})).desc("TABLE or LIST or TASK or CALENDAR"),fromClause:e=>Pn.exports.seqMap(Pn.exports.regexp(/FROM/i),Pn.exports.whitespace,ns.source,((e,t,i)=>i)),whereClause:e=>Pn.exports.seqMap(Pn.exports.regexp(/WHERE/i),Pn.exports.whitespace,ns.field,((e,t,i)=>({type:"where",clause:i}))).desc("WHERE <expression>"),sortByClause:e=>Pn.exports.seqMap(Pn.exports.regexp(/SORT/i),Pn.exports.whitespace,e.sortField.sepBy1(Pn.exports.string(",").trim(Pn.exports.optWhitespace)),((e,t,i)=>({type:"sort",fields:i}))).desc("SORT field [ASC/DESC]"),limitClause:e=>Pn.exports.seqMap(Pn.exports.regexp(/LIMIT/i),Pn.exports.whitespace,ns.field,((e,t,i)=>({type:"limit",amount:i}))).desc("LIMIT <value>"),flattenClause:e=>Pn.exports.seqMap(Pn.exports.regexp(/FLATTEN/i).skip(Pn.exports.whitespace),e.namedField,((e,t)=>({type:"flatten",field:t}))).desc("FLATTEN <value> [AS <name>]"),groupByClause:e=>Pn.exports.seqMap(Pn.exports.regexp(/GROUP BY/i).skip(Pn.exports.whitespace),e.namedField,((e,t)=>({type:"group",field:t}))).desc("GROUP BY <value> [AS <name>]"),clause:e=>Pn.exports.alt(e.fromClause,e.whereClause,e.sortByClause,e.limitClause,e.groupByClause,e.flattenClause),query:e=>Pn.exports.seqMap(e.headerClause.trim(Pn.exports.optWhitespace),e.fromClause.trim(Pn.exports.optWhitespace).atMost(1),e.clause.trim(Pn.exports.optWhitespace).many(),((e,t,i)=>({header:e,source:0==t.length?qn.folder(""):t[0],operations:i,settings:In})))});P.DATE_SHORTHANDS=es,P.DURATION_TYPES=Qn,P.EXPRESSION=ns,P.KEYWORDS=ts,P.QUERY_LANGUAGE=us;var rs=P.getAPI=e=>{var t;return e?null===(t=e.plugins.plugins.dataview)||void 0===t?void 0:t.api:window.DataviewAPI};P.isPluginEnabled=e=>e.plugins.enabledPlugins.has("dataview"),P.parseField=function(e){try{return Rn.success(ns.field.tryParse(e))}catch(e){return Rn.failure(""+e)}};class as{constructor(e){this.pages=new Map,this.forEach=this.pages.forEach.bind(this.pages),this.app=e.app,this.plugin=e}add(e,t){this.pages.set(e,t)}has(e){return this.pages.has(e)}get(e){return this.pages.get(e)}getPages(){return Array.from(this.pages.values())}get size(){return this.pages.size}delete(e){const t=this.pages.get(e);t&&(t.neighbours.forEach(((t,i)=>{const n=this.pages.get(i);n&&(n.unlinkNeighbour(e),n.file||0!==n.neighbours.size||this.pages.delete(i))})),this.pages.delete(e))}addResolvedLinks(t){const n=this.app.metadataCache.resolvedLinks;Object.keys(n).forEach((s=>{if(t&&t.path!==s)return;const u=this.pages.get(s);Object.keys(n[s]).forEach((t=>{let n=this.pages.get(t);n||(n=this.pages.get(this.plugin.lowercasePathMap.get(t.toLowerCase()))),this.plugin.settings.inferAllLinksAsFriends?(n.addFriend(u,e.INFERRED,i.FROM),u.addFriend(n,e.INFERRED,i.TO)):this.plugin.settings.inverseInfer?(n.addChild(u,e.INFERRED,i.FROM),u.addParent(n,e.INFERRED,i.TO)):(n.addParent(u,e.INFERRED,i.FROM),u.addChild(n,e.INFERRED,i.TO))}))}))}addUnresolvedLinks(t){if(t&&(t.isFolder||t.isTag))return;const n=this.app.metadataCache.unresolvedLinks;Object.keys(n).forEach((s=>{if(t&&t.path!==s)return;let u=this.pages.get(s);u&&s!==this.plugin.settings.excalibrainFilepath&&Object.keys(n[s]).forEach((t=>{var n;const s=null!==(n=this.get(t))&&void 0!==n?n:new F(this,t,null,this.plugin);this.plugin.settings.inferAllLinksAsFriends?(s.addFriend(u,e.INFERRED,i.FROM),u.addFriend(s,e.INFERRED,i.TO)):this.plugin.settings.inverseInfer?(s.addChild(u,e.INFERRED,i.FROM),u.addParent(s,e.INFERRED,i.TO)):(s.addParent(u,e.INFERRED,i.FROM),u.addChild(s,e.INFERRED,i.TO)),this.add(t,s)}))}))}}const os=`---\n\nexcalidraw-plugin: parsed\nexcalidraw-default-mode: view\nexcalidraw-export-dark: false\nexcalidraw-export-transparent: false\nexcalidraw-linkbutton-opacity: 0.3\nexcalidraw-onload-script: "app.plugins.plugins[${String.fromCharCode(96)}excalibrain${String.fromCharCode(96)}].start(ea.targetView.leaf);"\n\ntags: [excalidraw]\n\n---\n\n# Text Elements\nOpen a document in another pane and click it to get started.\n\nFor the best experience enable 'Open in adjacent pane'\nin Excalidraw settings under 'Links and Transclusion'. ^4mylk7KK\n\n%%\n# Drawing\n${String.fromCharCode(96,96,96)}json\n{\n\t"type": "excalidraw",\n\t"version": 2,\n\t"source": "https://excalidraw.com",\n\t"elements": [\n\t\t{\n\t\t\t"type": "text",\n\t\t\t"version": 1,\n\t\t\t"versionNonce": 423577018,\n\t\t\t"isDeleted": false,\n\t\t\t"id": "4mylk7KK",\n\t\t\t"fillStyle": "hachure",\n\t\t\t"strokeWidth": 1,\n\t\t\t"strokeStyle": "solid",\n\t\t\t"roughness": 1,\n\t\t\t"opacity": 100,\n\t\t\t"angle": 0,\n\t\t\t"x": 0,\n\t\t\t"y": 0,\n\t\t\t"strokeColor": "white",\n\t\t\t"backgroundColor": "transparent",\n\t\t\t"width": 703,\n\t\t\t"height": 96,\n\t\t\t"seed": 4429,\n\t\t\t"groupIds": [],\n\t\t\t"strokeSharpness": "sharp",\n\t\t\t"boundElements": [],\n\t\t\t"updated": 1650784785611,\n\t\t\t"link": null,\n\t\t\t"locked": false,\n\t\t\t"fontSize": 20,\n\t\t\t"fontFamily": 3,\n\t\t\t"text": "Open a document in another pane and click it to get started.\\n\\nFor the best experience enable 'Open in adjacent pane'\\nin Excalidraw settings under 'Links and Transclusion'.",\n\t\t\t"rawText": "Open a document in another pane and click it to get started.\\n\\nFor the best experience enable 'Open in adjacent pane'\\nin Excalidraw settings under 'Links and Transclusion'.",\n\t\t\t"baseline": 91,\n\t\t\t"textAlign": "center",\n\t\t\t"verticalAlign": "top",\n\t\t\t"containerId": null,\n\t\t\t"originalText": "Open a document in another pane and click it to get started.\\n\\nFor the best experience enable 'Open in adjacent pane'\\nin Excalidraw settings under 'Links and Transclusion'."\n\t\t}\n\t],\n\t"appState": {\n\t\t"theme": "dark",\n\t\t"viewBackgroundColor": "hsl(208, 80%, 23%)",\n\t\t"currentItemStrokeColor": "#000000",\n\t\t"currentItemBackgroundColor": "transparent",\n\t\t"currentItemFillStyle": "hachure",\n\t\t"currentItemStrokeWidth": 2,\n\t\t"currentItemStrokeStyle": "solid",\n\t\t"currentItemRoughness": 1,\n\t\t"currentItemOpacity": 100,\n\t\t"currentItemFontFamily": 1,\n\t\t"currentItemFontSize": 16,\n\t\t"currentItemTextAlign": "left",\n\t\t"currentItemStrokeSharpness": "sharp",\n\t\t"currentItemStartArrowhead": null,\n\t\t"currentItemEndArrowhead": "arrow",\n\t\t"currentItemLinearStrokeSharpness": "round",\n\t\t"gridSize": null,\n\t\t"colorPalette": {}\n\t},\n\t"files": {}\n}\n${String.fromCharCode(96,96,96)}\n%%\n`;class Ds{constructor(e){this.nodes=[],this.renderedNodes=[],this.spec=e}layout(e=this.spec.columns){const t=this.nodes.sort(((e,t)=>e.title.toLowerCase()<t.title.toLowerCase()?-1:1)),i=t.length;if(0===i)return;const n=Math.ceil(i/e);this.renderedNodes=Array(n).fill(null).map(((s,u)=>{return u+1<n||i%e==0?Array(e).fill(null).map(((i,n)=>t[u*e+n])):(r=i%e,e%2?(t=>{const i=[];let n=0;for(n=e/2;n>t[0];n--)i.push(null);for(n=0;n<t[0];n++)i.push(n+1);for(n=0;n<e/2;n++)i.push(n<t[1]?t[0]+n+1:null);return i})(r%2?[(r+1)/2,(r-1)/2]:[r/2,r/2]):(e=>{const t=[];let i=1,n=!0;return e.map((e=>Math.floor(e))).forEach((e=>{for(let s=0;s<e;s++)t.push(n?null:i++);n=!n})),t})(r%2?[(e-r)/2,r,(e-r)/2]:[(e-r)/2,r/2,1,r/2,(e-r)/2])).map((i=>i?t[u*e+i-1]:null));var r}))}render(){this.layout();const e=this.renderedNodes.length*this.spec.rowHeight,t=null===this.spec.top&&null===this.spec.bottom?this.spec.origoY-e/2:null!==this.spec.top?this.spec.origoY-e/2<this.spec.top?this.spec.top:this.spec.origoY-e/2:this.spec.origoY+e/2>this.spec.bottom?this.spec.bottom-e:this.spec.origoY-e/2,i=this.spec.origoX-(1===this.spec.columns?0:(this.spec.columns-1)/2*this.spec.columnWidth),n=t;this.renderedNodes.forEach(((e,t)=>e.forEach(((e,s)=>{e&&(e.setCenter({x:i+s*this.spec.columnWidth,y:n+t*this.spec.rowHeight}),e.render())}))))}}class ls{constructor(e){this.plugin=e,this.links=new Map,this.reverseLinks=new Set}addLink(e,n,s,u,r,a,o,D){const l=e.page.path+"|:?:|"+n.page.path;if(this.links.has(l)||this.reverseLinks.has(l))return;const c=n.page.path+"|:?:|"+e.page.path,d=new O(a===i.FROM?n:e,a===i.FROM?e:n,a===i.FROM?s===t.FRIEND?t.FRIEND:s===t.CHILD?t.PARENT:t.CHILD:s,u,r,o,D,this.plugin);this.links.set(l,d),this.reverseLinks.add(c)}render(e){this.links.forEach((t=>t.render(e.some((e=>{var i;return null===(i=t.hierarchyDefinition)||void 0===i?void 0:i.includes(e)}))||t.isInferred&&e.includes("inferred-link"))))}}class cs{constructor(e,t,i,n,s,u=!0){this.getVal=t,this.updateIndex=u,this.button=n.createEl("button",{cls:"excalibrain-button"}),this.button.createSpan({text:s.display}),this.button.ariaLabel=s.tooltip,this.setColor(),this.button.onclick=()=>{var n;i(!t()),e.saveSettings(),this.setColor(),null===(n=e.scene)||void 0===n||n.reRender(this.updateIndex)}}setColor(){if(this.getVal())return this.button.removeClass("off"),void this.button.addClass("on");this.button.removeClass("on"),this.button.addClass("off")}}var ds="top",hs="bottom",ps="right",gs="left",Fs=[ds,hs,ps,gs],fs=Fs.reduce((function(e,t){return e.concat([t+"-start",t+"-end"])}),[]),Es=[].concat(Fs,["auto"]).reduce((function(e,t){return e.concat([t,t+"-start",t+"-end"])}),[]),ms=["beforeRead","read","afterRead","beforeMain","main","afterMain","beforeWrite","write","afterWrite"];function Cs(e){return e?(e.nodeName||"").toLowerCase():null}function ys(e){if(null==e)return window;if("[object Window]"!==e.toString()){var t=e.ownerDocument;return t&&t.defaultView||window}return e}function ws(e){return e instanceof ys(e).Element||e instanceof Element}function vs(e){return e instanceof ys(e).HTMLElement||e instanceof HTMLElement}function bs(e){return"undefined"!=typeof ShadowRoot&&(e instanceof ys(e).ShadowRoot||e instanceof ShadowRoot)}var Ss={name:"applyStyles",enabled:!0,phase:"write",fn:function(e){var t=e.state;Object.keys(t.elements).forEach((function(e){var i=t.styles[e]||{},n=t.attributes[e]||{},s=t.elements[e];vs(s)&&Cs(s)&&(Object.assign(s.style,i),Object.keys(n).forEach((function(e){var t=n[e];!1===t?s.removeAttribute(e):s.setAttribute(e,!0===t?"":t)})))}))},effect:function(e){var t=e.state,i={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(t.elements.popper.style,i.popper),t.styles=i,t.elements.arrow&&Object.assign(t.elements.arrow.style,i.arrow),function(){Object.keys(t.elements).forEach((function(e){var n=t.elements[e],s=t.attributes[e]||{},u=Object.keys(t.styles.hasOwnProperty(e)?t.styles[e]:i[e]).reduce((function(e,t){return e[t]="",e}),{});vs(n)&&Cs(n)&&(Object.assign(n.style,u),Object.keys(s).forEach((function(e){n.removeAttribute(e)})))}))}},requires:["computeStyles"]};function xs(e){return e.split("-")[0]}var As=Math.max,Ts=Math.min,Bs=Math.round;function Os(){var e=navigator.userAgentData;return null!=e&&e.brands?e.brands.map((function(e){return e.brand+"/"+e.version})).join(" "):navigator.userAgent}function Ns(){return!/^((?!chrome|android).)*safari/i.test(Os())}function Ls(e,t,i){void 0===t&&(t=!1),void 0===i&&(i=!1);var n=e.getBoundingClientRect(),s=1,u=1;t&&vs(e)&&(s=e.offsetWidth>0&&Bs(n.width)/e.offsetWidth||1,u=e.offsetHeight>0&&Bs(n.height)/e.offsetHeight||1);var r=(ws(e)?ys(e):window).visualViewport,a=!Ns()&&i,o=(n.left+(a&&r?r.offsetLeft:0))/s,D=(n.top+(a&&r?r.offsetTop:0))/u,l=n.width/s,c=n.height/u;return{width:l,height:c,top:D,right:o+l,bottom:D+c,left:o,x:o,y:D}}function ks(e){var t=Ls(e),i=e.offsetWidth,n=e.offsetHeight;return Math.abs(t.width-i)<=1&&(i=t.width),Math.abs(t.height-n)<=1&&(n=t.height),{x:e.offsetLeft,y:e.offsetTop,width:i,height:n}}function Is(e,t){var i=t.getRootNode&&t.getRootNode();if(e.contains(t))return!0;if(i&&bs(i)){var n=t;do{if(n&&e.isSameNode(n))return!0;n=n.parentNode||n.host}while(n)}return!1}function _s(e){return ys(e).getComputedStyle(e)}function Ms(e){return["table","td","th"].indexOf(Cs(e))>=0}function Rs(e){return((ws(e)?e.ownerDocument:e.document)||window.document).documentElement}function Ps(e){return"html"===Cs(e)?e:e.assignedSlot||e.parentNode||(bs(e)?e.host:null)||Rs(e)}function Vs(e){return vs(e)&&"fixed"!==_s(e).position?e.offsetParent:null}function Hs(e){for(var t=ys(e),i=Vs(e);i&&Ms(i)&&"static"===_s(i).position;)i=Vs(i);return i&&("html"===Cs(i)||"body"===Cs(i)&&"static"===_s(i).position)?t:i||function(e){var t=/firefox/i.test(Os());if(/Trident/i.test(Os())&&vs(e)&&"fixed"===_s(e).position)return null;var i=Ps(e);for(bs(i)&&(i=i.host);vs(i)&&["html","body"].indexOf(Cs(i))<0;){var n=_s(i);if("none"!==n.transform||"none"!==n.perspective||"paint"===n.contain||-1!==["transform","perspective"].indexOf(n.willChange)||t&&"filter"===n.willChange||t&&n.filter&&"none"!==n.filter)return i;i=i.parentNode}return null}(e)||t}function js(e){return["top","bottom"].indexOf(e)>=0?"x":"y"}function Ws(e,t,i){return As(e,Ts(t,i))}function Gs(e){return Object.assign({},{top:0,right:0,bottom:0,left:0},e)}function Ys(e,t){return t.reduce((function(t,i){return t[i]=e,t}),{})}var Us={name:"arrow",enabled:!0,phase:"main",fn:function(e){var t,i=e.state,n=e.name,s=e.options,u=i.elements.arrow,r=i.modifiersData.popperOffsets,a=xs(i.placement),o=js(a),D=[gs,ps].indexOf(a)>=0?"height":"width";if(u&&r){var l=function(e,t){return Gs("number"!=typeof(e="function"==typeof e?e(Object.assign({},t.rects,{placement:t.placement})):e)?e:Ys(e,Fs))}(s.padding,i),c=ks(u),d="y"===o?ds:gs,h="y"===o?hs:ps,p=i.rects.reference[D]+i.rects.reference[o]-r[o]-i.rects.popper[D],g=r[o]-i.rects.reference[o],F=Hs(u),f=F?"y"===o?F.clientHeight||0:F.clientWidth||0:0,E=p/2-g/2,m=l[d],C=f-c[D]-l[h],y=f/2-c[D]/2+E,w=Ws(m,y,C),v=o;i.modifiersData[n]=((t={})[v]=w,t.centerOffset=w-y,t)}},effect:function(e){var t=e.state,i=e.options.element,n=void 0===i?"[data-popper-arrow]":i;null!=n&&("string"!=typeof n||(n=t.elements.popper.querySelector(n)))&&Is(t.elements.popper,n)&&(t.elements.arrow=n)},requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function zs(e){return e.split("-")[1]}var qs={top:"auto",right:"auto",bottom:"auto",left:"auto"};function $s(e){var t,i=e.popper,n=e.popperRect,s=e.placement,u=e.variation,r=e.offsets,a=e.position,o=e.gpuAcceleration,D=e.adaptive,l=e.roundOffsets,c=e.isFixed,d=r.x,h=void 0===d?0:d,p=r.y,g=void 0===p?0:p,F="function"==typeof l?l({x:h,y:g}):{x:h,y:g};h=F.x,g=F.y;var f=r.hasOwnProperty("x"),E=r.hasOwnProperty("y"),m=gs,C=ds,y=window;if(D){var w=Hs(i),v="clientHeight",b="clientWidth";w===ys(i)&&"static"!==_s(w=Rs(i)).position&&"absolute"===a&&(v="scrollHeight",b="scrollWidth"),(s===ds||(s===gs||s===ps)&&"end"===u)&&(C=hs,g-=(c&&w===y&&y.visualViewport?y.visualViewport.height:w[v])-n.height,g*=o?1:-1),s!==gs&&(s!==ds&&s!==hs||"end"!==u)||(m=ps,h-=(c&&w===y&&y.visualViewport?y.visualViewport.width:w[b])-n.width,h*=o?1:-1)}var S,x=Object.assign({position:a},D&&qs),A=!0===l?function(e){var t=e.x,i=e.y,n=window.devicePixelRatio||1;return{x:Bs(t*n)/n||0,y:Bs(i*n)/n||0}}({x:h,y:g}):{x:h,y:g};return h=A.x,g=A.y,o?Object.assign({},x,((S={})[C]=E?"0":"",S[m]=f?"0":"",S.transform=(y.devicePixelRatio||1)<=1?"translate("+h+"px, "+g+"px)":"translate3d("+h+"px, "+g+"px, 0)",S)):Object.assign({},x,((t={})[C]=E?g+"px":"",t[m]=f?h+"px":"",t.transform="",t))}var Zs={passive:!0},Js={left:"right",right:"left",bottom:"top",top:"bottom"};function Ks(e){return e.replace(/left|right|bottom|top/g,(function(e){return Js[e]}))}var Xs={start:"end",end:"start"};function Qs(e){return e.replace(/start|end/g,(function(e){return Xs[e]}))}function eu(e){var t=ys(e);return{scrollLeft:t.pageXOffset,scrollTop:t.pageYOffset}}function tu(e){return Ls(Rs(e)).left+eu(e).scrollLeft}function iu(e){var t=_s(e),i=t.overflow,n=t.overflowX,s=t.overflowY;return/auto|scroll|overlay|hidden/.test(i+s+n)}function nu(e){return["html","body","#document"].indexOf(Cs(e))>=0?e.ownerDocument.body:vs(e)&&iu(e)?e:nu(Ps(e))}function su(e,t){var i;void 0===t&&(t=[]);var n=nu(e),s=n===(null==(i=e.ownerDocument)?void 0:i.body),u=ys(n),r=s?[u].concat(u.visualViewport||[],iu(n)?n:[]):n,a=t.concat(r);return s?a:a.concat(su(Ps(r)))}function uu(e){return Object.assign({},e,{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function ru(e,t,i){return"viewport"===t?uu(function(e,t){var i=ys(e),n=Rs(e),s=i.visualViewport,u=n.clientWidth,r=n.clientHeight,a=0,o=0;if(s){u=s.width,r=s.height;var D=Ns();(D||!D&&"fixed"===t)&&(a=s.offsetLeft,o=s.offsetTop)}return{width:u,height:r,x:a+tu(e),y:o}}(e,i)):ws(t)?function(e,t){var i=Ls(e,!1,"fixed"===t);return i.top=i.top+e.clientTop,i.left=i.left+e.clientLeft,i.bottom=i.top+e.clientHeight,i.right=i.left+e.clientWidth,i.width=e.clientWidth,i.height=e.clientHeight,i.x=i.left,i.y=i.top,i}(t,i):uu(function(e){var t,i=Rs(e),n=eu(e),s=null==(t=e.ownerDocument)?void 0:t.body,u=As(i.scrollWidth,i.clientWidth,s?s.scrollWidth:0,s?s.clientWidth:0),r=As(i.scrollHeight,i.clientHeight,s?s.scrollHeight:0,s?s.clientHeight:0),a=-n.scrollLeft+tu(e),o=-n.scrollTop;return"rtl"===_s(s||i).direction&&(a+=As(i.clientWidth,s?s.clientWidth:0)-u),{width:u,height:r,x:a,y:o}}(Rs(e)))}function au(e){var t,i=e.reference,n=e.element,s=e.placement,u=s?xs(s):null,r=s?zs(s):null,a=i.x+i.width/2-n.width/2,o=i.y+i.height/2-n.height/2;switch(u){case ds:t={x:a,y:i.y-n.height};break;case hs:t={x:a,y:i.y+i.height};break;case ps:t={x:i.x+i.width,y:o};break;case gs:t={x:i.x-n.width,y:o};break;default:t={x:i.x,y:i.y}}var D=u?js(u):null;if(null!=D){var l="y"===D?"height":"width";switch(r){case"start":t[D]=t[D]-(i[l]/2-n[l]/2);break;case"end":t[D]=t[D]+(i[l]/2-n[l]/2)}}return t}function ou(e,t){void 0===t&&(t={});var i=t,n=i.placement,s=void 0===n?e.placement:n,u=i.strategy,r=void 0===u?e.strategy:u,a=i.boundary,o=void 0===a?"clippingParents":a,D=i.rootBoundary,l=void 0===D?"viewport":D,c=i.elementContext,d=void 0===c?"popper":c,h=i.altBoundary,p=void 0!==h&&h,g=i.padding,F=void 0===g?0:g,f=Gs("number"!=typeof F?F:Ys(F,Fs)),E="popper"===d?"reference":"popper",m=e.rects.popper,C=e.elements[p?E:d],y=function(e,t,i,n){var s="clippingParents"===t?function(e){var t=su(Ps(e)),i=["absolute","fixed"].indexOf(_s(e).position)>=0&&vs(e)?Hs(e):e;return ws(i)?t.filter((function(e){return ws(e)&&Is(e,i)&&"body"!==Cs(e)})):[]}(e):[].concat(t),u=[].concat(s,[i]),r=u[0],a=u.reduce((function(t,i){var s=ru(e,i,n);return t.top=As(s.top,t.top),t.right=Ts(s.right,t.right),t.bottom=Ts(s.bottom,t.bottom),t.left=As(s.left,t.left),t}),ru(e,r,n));return a.width=a.right-a.left,a.height=a.bottom-a.top,a.x=a.left,a.y=a.top,a}(ws(C)?C:C.contextElement||Rs(e.elements.popper),o,l,r),w=Ls(e.elements.reference),v=au({reference:w,element:m,strategy:"absolute",placement:s}),b=uu(Object.assign({},m,v)),S="popper"===d?b:w,x={top:y.top-S.top+f.top,bottom:S.bottom-y.bottom+f.bottom,left:y.left-S.left+f.left,right:S.right-y.right+f.right},A=e.modifiersData.offset;if("popper"===d&&A){var T=A[s];Object.keys(x).forEach((function(e){var t=[ps,hs].indexOf(e)>=0?1:-1,i=[ds,hs].indexOf(e)>=0?"y":"x";x[e]+=T[i]*t}))}return x}var lu={name:"flip",enabled:!0,phase:"main",fn:function(e){var t=e.state,i=e.options,n=e.name;if(!t.modifiersData[n]._skip){for(var s=i.mainAxis,u=void 0===s||s,r=i.altAxis,a=void 0===r||r,o=i.fallbackPlacements,D=i.padding,l=i.boundary,c=i.rootBoundary,d=i.altBoundary,h=i.flipVariations,p=void 0===h||h,g=i.allowedAutoPlacements,F=t.options.placement,f=xs(F),E=o||(f!==F&&p?function(e){if("auto"===xs(e))return[];var t=Ks(e);return[Qs(e),t,Qs(t)]}(F):[Ks(F)]),m=[F].concat(E).reduce((function(e,i){return e.concat("auto"===xs(i)?function(e,t){void 0===t&&(t={});var i=t,n=i.placement,s=i.boundary,u=i.rootBoundary,r=i.padding,a=i.flipVariations,o=i.allowedAutoPlacements,D=void 0===o?Es:o,l=zs(n),c=l?a?fs:fs.filter((function(e){return zs(e)===l})):Fs,d=c.filter((function(e){return D.indexOf(e)>=0}));0===d.length&&(d=c);var h=d.reduce((function(t,i){return t[i]=ou(e,{placement:i,boundary:s,rootBoundary:u,padding:r})[xs(i)],t}),{});return Object.keys(h).sort((function(e,t){return h[e]-h[t]}))}(t,{placement:i,boundary:l,rootBoundary:c,padding:D,flipVariations:p,allowedAutoPlacements:g}):i)}),[]),C=t.rects.reference,y=t.rects.popper,w=new Map,v=!0,b=m[0],S=0;S<m.length;S++){var x=m[S],A=xs(x),T="start"===zs(x),B=[ds,hs].indexOf(A)>=0,O=B?"width":"height",N=ou(t,{placement:x,boundary:l,rootBoundary:c,altBoundary:d,padding:D}),L=B?T?ps:gs:T?hs:ds;C[O]>y[O]&&(L=Ks(L));var k=Ks(L),I=[];if(u&&I.push(N[A]<=0),a&&I.push(N[L]<=0,N[k]<=0),I.every((function(e){return e}))){b=x,v=!1;break}w.set(x,I)}if(v)for(var _=function(e){var t=m.find((function(t){var i=w.get(t);if(i)return i.slice(0,e).every((function(e){return e}))}));if(t)return b=t,"break"},M=p?3:1;M>0&&"break"!==_(M);M--);t.placement!==b&&(t.modifiersData[n]._skip=!0,t.placement=b,t.reset=!0)}},requiresIfExists:["offset"],data:{_skip:!1}};function cu(e,t,i){return void 0===i&&(i={x:0,y:0}),{top:e.top-t.height-i.y,right:e.right-t.width+i.x,bottom:e.bottom-t.height+i.y,left:e.left-t.width-i.x}}function du(e){return[ds,ps,hs,gs].some((function(t){return e[t]>=0}))}function hu(e,t,i){void 0===i&&(i=!1);var n,s,u=vs(t),r=vs(t)&&function(e){var t=e.getBoundingClientRect(),i=Bs(t.width)/e.offsetWidth||1,n=Bs(t.height)/e.offsetHeight||1;return 1!==i||1!==n}(t),a=Rs(t),o=Ls(e,r,i),D={scrollLeft:0,scrollTop:0},l={x:0,y:0};return(u||!u&&!i)&&(("body"!==Cs(t)||iu(a))&&(D=(n=t)!==ys(n)&&vs(n)?{scrollLeft:(s=n).scrollLeft,scrollTop:s.scrollTop}:eu(n)),vs(t)?((l=Ls(t,!0)).x+=t.clientLeft,l.y+=t.clientTop):a&&(l.x=tu(a))),{x:o.left+D.scrollLeft-l.x,y:o.top+D.scrollTop-l.y,width:o.width,height:o.height}}function pu(e){var t=new Map,i=new Set,n=[];function s(e){i.add(e.name),[].concat(e.requires||[],e.requiresIfExists||[]).forEach((function(e){if(!i.has(e)){var n=t.get(e);n&&s(n)}})),n.push(e)}return e.forEach((function(e){t.set(e.name,e)})),e.forEach((function(e){i.has(e.name)||s(e)})),n}var gu={placement:"bottom",modifiers:[],strategy:"absolute"};function Fu(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return!t.some((function(e){return!(e&&"function"==typeof e.getBoundingClientRect)}))}var Eu,mu=function(e){void 0===e&&(e={});var t=e,i=t.defaultModifiers,n=void 0===i?[]:i,s=t.defaultOptions,u=void 0===s?gu:s;return function(e,t,i){void 0===i&&(i=u);var s,r,a={placement:"bottom",orderedModifiers:[],options:Object.assign({},gu,u),modifiersData:{},elements:{reference:e,popper:t},attributes:{},styles:{}},o=[],D=!1,l={state:a,setOptions:function(i){var s="function"==typeof i?i(a.options):i;c(),a.options=Object.assign({},u,a.options,s),a.scrollParents={reference:ws(e)?su(e):e.contextElement?su(e.contextElement):[],popper:su(t)};var r,D,d=function(e){var t=pu(e);return ms.reduce((function(e,i){return e.concat(t.filter((function(e){return e.phase===i})))}),[])}((r=[].concat(n,a.options.modifiers),D=r.reduce((function(e,t){var i=e[t.name];return e[t.name]=i?Object.assign({},i,t,{options:Object.assign({},i.options,t.options),data:Object.assign({},i.data,t.data)}):t,e}),{}),Object.keys(D).map((function(e){return D[e]}))));return a.orderedModifiers=d.filter((function(e){return e.enabled})),a.orderedModifiers.forEach((function(e){var t=e.name,i=e.options,n=void 0===i?{}:i,s=e.effect;if("function"==typeof s){var u=s({state:a,name:t,instance:l,options:n});o.push(u||function(){})}})),l.update()},forceUpdate:function(){if(!D){var e=a.elements,t=e.reference,i=e.popper;if(Fu(t,i)){a.rects={reference:hu(t,Hs(i),"fixed"===a.options.strategy),popper:ks(i)},a.reset=!1,a.placement=a.options.placement,a.orderedModifiers.forEach((function(e){return a.modifiersData[e.name]=Object.assign({},e.data)}));for(var n=0;n<a.orderedModifiers.length;n++)if(!0!==a.reset){var s=a.orderedModifiers[n],u=s.fn,r=s.options,o=void 0===r?{}:r,c=s.name;"function"==typeof u&&(a=u({state:a,options:o,name:c,instance:l})||a)}else a.reset=!1,n=-1}}},update:(s=function(){return new Promise((function(e){l.forceUpdate(),e(a)}))},function(){return r||(r=new Promise((function(e){Promise.resolve().then((function(){r=void 0,e(s())}))}))),r}),destroy:function(){c(),D=!0}};if(!Fu(e,t))return l;function c(){o.forEach((function(e){return e()})),o=[]}return l.setOptions(i).then((function(e){!D&&i.onFirstUpdate&&i.onFirstUpdate(e)})),l}}({defaultModifiers:[{name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:function(e){var t=e.state,i=e.instance,n=e.options,s=n.scroll,u=void 0===s||s,r=n.resize,a=void 0===r||r,o=ys(t.elements.popper),D=[].concat(t.scrollParents.reference,t.scrollParents.popper);return u&&D.forEach((function(e){e.addEventListener("scroll",i.update,Zs)})),a&&o.addEventListener("resize",i.update,Zs),function(){u&&D.forEach((function(e){e.removeEventListener("scroll",i.update,Zs)})),a&&o.removeEventListener("resize",i.update,Zs)}},data:{}},{name:"popperOffsets",enabled:!0,phase:"read",fn:function(e){var t=e.state,i=e.name;t.modifiersData[i]=au({reference:t.rects.reference,element:t.rects.popper,strategy:"absolute",placement:t.placement})},data:{}},{name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:function(e){var t=e.state,i=e.options,n=i.gpuAcceleration,s=void 0===n||n,u=i.adaptive,r=void 0===u||u,a=i.roundOffsets,o=void 0===a||a,D={placement:xs(t.placement),variation:zs(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:s,isFixed:"fixed"===t.options.strategy};null!=t.modifiersData.popperOffsets&&(t.styles.popper=Object.assign({},t.styles.popper,$s(Object.assign({},D,{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:r,roundOffsets:o})))),null!=t.modifiersData.arrow&&(t.styles.arrow=Object.assign({},t.styles.arrow,$s(Object.assign({},D,{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:o})))),t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-placement":t.placement})},data:{}},Ss,{name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:function(e){var t=e.state,i=e.options,n=e.name,s=i.offset,u=void 0===s?[0,0]:s,r=Es.reduce((function(e,i){return e[i]=function(e,t,i){var n=xs(e),s=[gs,ds].indexOf(n)>=0?-1:1,u="function"==typeof i?i(Object.assign({},t,{placement:e})):i,r=u[0],a=u[1];return r=r||0,a=(a||0)*s,[gs,ps].indexOf(n)>=0?{x:a,y:r}:{x:r,y:a}}(i,t.rects,u),e}),{}),a=r[t.placement],o=a.x,D=a.y;null!=t.modifiersData.popperOffsets&&(t.modifiersData.popperOffsets.x+=o,t.modifiersData.popperOffsets.y+=D),t.modifiersData[n]=r}},lu,{name:"preventOverflow",enabled:!0,phase:"main",fn:function(e){var t=e.state,i=e.options,n=e.name,s=i.mainAxis,u=void 0===s||s,r=i.altAxis,a=void 0!==r&&r,o=i.boundary,D=i.rootBoundary,l=i.altBoundary,c=i.padding,d=i.tether,h=void 0===d||d,p=i.tetherOffset,g=void 0===p?0:p,F=ou(t,{boundary:o,rootBoundary:D,padding:c,altBoundary:l}),f=xs(t.placement),E=zs(t.placement),m=!E,C=js(f),y="x"===C?"y":"x",w=t.modifiersData.popperOffsets,v=t.rects.reference,b=t.rects.popper,S="function"==typeof g?g(Object.assign({},t.rects,{placement:t.placement})):g,x="number"==typeof S?{mainAxis:S,altAxis:S}:Object.assign({mainAxis:0,altAxis:0},S),A=t.modifiersData.offset?t.modifiersData.offset[t.placement]:null,T={x:0,y:0};if(w){if(u){var B,O="y"===C?ds:gs,N="y"===C?hs:ps,L="y"===C?"height":"width",k=w[C],I=k+F[O],_=k-F[N],M=h?-b[L]/2:0,R="start"===E?v[L]:b[L],P="start"===E?-b[L]:-v[L],V=t.elements.arrow,H=h&&V?ks(V):{width:0,height:0},j=t.modifiersData["arrow#persistent"]?t.modifiersData["arrow#persistent"].padding:{top:0,right:0,bottom:0,left:0},W=j[O],G=j[N],Y=Ws(0,v[L],H[L]),U=m?v[L]/2-M-Y-W-x.mainAxis:R-Y-W-x.mainAxis,z=m?-v[L]/2+M+Y+G+x.mainAxis:P+Y+G+x.mainAxis,q=t.elements.arrow&&Hs(t.elements.arrow),$=q?"y"===C?q.clientTop||0:q.clientLeft||0:0,Z=null!=(B=null==A?void 0:A[C])?B:0,J=k+z-Z,K=Ws(h?Ts(I,k+U-Z-$):I,k,h?As(_,J):_);w[C]=K,T[C]=K-k}if(a){var X,Q="x"===C?ds:gs,ee="x"===C?hs:ps,te=w[y],ie="y"===y?"height":"width",ne=te+F[Q],se=te-F[ee],ue=-1!==[ds,gs].indexOf(f),re=null!=(X=null==A?void 0:A[y])?X:0,ae=ue?ne:te-v[ie]-b[ie]-re+x.altAxis,oe=ue?te+v[ie]+b[ie]-re-x.altAxis:se,De=h&&ue?function(e,t,i){var n=Ws(e,t,i);return n>i?i:n}(ae,te,oe):Ws(h?ae:ne,te,h?oe:se);w[y]=De,T[y]=De-te}t.modifiersData[n]=T}},requiresIfExists:["offset"]},Us,{name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:function(e){var t=e.state,i=e.name,n=t.rects.reference,s=t.rects.popper,u=t.modifiersData.preventOverflow,r=ou(t,{elementContext:"reference"}),a=ou(t,{altBoundary:!0}),o=cu(r,n),D=cu(a,s,u),l=du(o),c=du(D);t.modifiersData[i]={referenceClippingOffsets:o,popperEscapeOffsets:D,isReferenceHidden:l,hasPopperEscaped:c},t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-reference-hidden":l,"data-popper-escaped":c})}}]});class Cu{constructor(e,t,i,n=30){this.owner=e,this.containerEl=t,this.limit=n,this.owner=e,this.containerEl=t,t.on("click",".suggestion-item",this.onSuggestionClick.bind(this)),t.on("mousemove",".suggestion-item",this.onSuggestionMouseover.bind(this)),i.register([],"ArrowUp",(e=>{if(!e.isComposing)return this.setSelectedItem(this.selectedItem-1,!0),!1})),i.register([],"ArrowDown",(e=>{if(!e.isComposing)return this.setSelectedItem(this.selectedItem+1,!0),!1})),i.register([],"Enter",(e=>{if(!e.isComposing)return this.useSelectedItem(e),!1}))}onSuggestionClick(e,t){e.preventDefault();const i=this.suggestions.indexOf(t);this.setSelectedItem(i,!1),this.useSelectedItem(e)}onSuggestionMouseover(e,t){const i=this.suggestions.indexOf(t);this.setSelectedItem(i,!1)}setSuggestions(e){this.containerEl.empty();const t=[];e.slice(0,this.limit).forEach((e=>{const i=this.containerEl.createDiv("suggestion-item");this.owner.renderSuggestion(e,i),t.push(i)})),this.values=e,this.suggestions=t,this.setSelectedItem(0,!1)}useSelectedItem(e){const t=this.values[this.selectedItem];t&&this.owner.selectSuggestion(t,e)}setSelectedItem(e,t){const i=(e%(n=this.suggestions.length)+n)%n;var n;const s=this.suggestions[this.selectedItem],u=this.suggestions[i];null==s||s.removeClass("is-selected"),null==u||u.addClass("is-selected"),this.selectedItem=i,t&&u.scrollIntoView(!1)}}class yu{constructor(e,t,i){this.app=e,this.inputEl=t,this.containerEl=i,this.scope=new n.Scope,this.suggestEl=i.createDiv("suggestion-container");const s=this.suggestEl.createDiv("suggestion");this.suggest=new Cu(this,s,this.scope),this.scope.register([],"Escape",this.close.bind(this)),this.inputEl.addEventListener("input",this.onInputChanged.bind(this)),this.inputEl.addEventListener("focus",this.onInputChanged.bind(this)),this.inputEl.addEventListener("blur",this.close.bind(this)),this.suggestEl.on("mousedown",".suggestion-container",(e=>{e.preventDefault()}))}onInputChanged(){const e=this.inputEl.value,t=this.getSuggestions(e);t&&t.length>0?(this.suggest.setSuggestions(t),this.open(this.containerEl,this.inputEl)):this.close()}open(e,t){this.app.keymap.pushScope(this.scope),e.appendChild(this.suggestEl),this.popper=mu(t,this.suggestEl,{placement:"bottom-start",modifiers:[{name:"sameWidth",enabled:!0,fn:({state:e,instance:t})=>{const i=`${e.rects.reference.width}px`;e.styles.popper.width!==i&&(e.styles.popper.width=i,t.update())},phase:"beforeWrite",requires:["computeStyles"]}]})}close(){this.app.keymap.popScope(this.scope),this.suggest.setSuggestions([]),this.popper&&this.popper.destroy(),this.suggestEl.detach()}}!function(e){e[e.TemplateFiles=0]="TemplateFiles",e[e.ScriptFiles=1]="ScriptFiles"}(Eu||(Eu={}));class wu extends yu{constructor(e,t,i,n){super(e,t,n),this.plugin=i}getSuggestions(e){var t,i,s;if(""===e)return this.plugin.starred;const u=e.toLowerCase(),r=null===(t=this.plugin.pages)||void 0===t?void 0:t.getPages().filter((e=>(!e.file||(this.plugin.settings.showAttachments||"md"===e.file.extension)&&!this.plugin.settings.excludeFilepaths.some((t=>e.path.startsWith(t))))&&(e.file||(this.plugin.settings.showFolderNodes||!e.path.startsWith("folder:"))&&(this.plugin.settings.showTagNodes||!e.path.startsWith("tag:")))&&e.name.toLowerCase().contains(u)));if(r.length>30)return r;const a=r.concat(null===(i=this.plugin.pages)||void 0===i?void 0:i.getPages().filter((e=>!r.contains(e)&&(!e.file||(this.plugin.settings.showAttachments||"md"===e.file.extension)&&!this.plugin.settings.excludeFilepaths.some((t=>e.path.startsWith(t))))&&(e.file||(this.plugin.settings.showFolderNodes||!e.path.startsWith("folder:"))&&(this.plugin.settings.showTagNodes||!e.path.startsWith("tag:")))&&e.path.toLowerCase().contains(u))));if(a.length>30)return a;const o=n.prepareFuzzySearch(e);return a.concat(null===(s=this.plugin.pages)||void 0===s?void 0:s.getPages().filter((e=>!e.isVirtual&&(!e.file||(this.plugin.settings.showAttachments||"md"===e.file.extension)&&!this.plugin.settings.excludeFilepaths.some((t=>e.path.startsWith(t))))&&(e.file||(this.plugin.settings.showFolderNodes||!e.path.startsWith("folder:"))&&(this.plugin.settings.showTagNodes||!e.path.startsWith("tag:")))&&!a.contains(e)&&o(e.path))))}renderSuggestion(e,t){var i,n;t.ariaLabel=e.path,t.setText(e.isFolder||e.isTag?e.path.replace(/^folder:/,null!==(i=this.plugin.settings.folderNodeStyle.prefix)&&void 0!==i?i:"ðŸ“‚").replace(/^tag:/,null!==(n=this.plugin.settings.tagNodeStyle.prefix)&&void 0!==n?n:"ðŸ·ï¸"):e.name)}selectSuggestion(e){this.inputEl.value=e.path,this.inputEl.trigger("input"),this.close()}}class vu{constructor(e,t,i,n){this.label="",this.selected=!1,this.value=e,this.label=t,this.multiple=i,this.onChange=n,this.createOptionElement(),this.createListeners()}select(e=!0){this.selected=!0,this.setAttribute(),e&&this.onChange(this)}deselect(e=!0){this.selected=!1,this.setAttribute(),e&&this.onChange(this)}createOptionElement(){const e=document.createElement("div");e.classList.add("option"),this.singleSelectTextSpanRef=document.createElement("span"),this.singleSelectTextSpanRef.classList.add("option-text"),this.singleSelectTextSpanRef.innerText=this.label,e.appendChild(this.singleSelectTextSpanRef),e.appendChild(this.createCheckbox()),this.optionRef=e}createCheckbox(){const e=document.createElement("label");e.classList.add("checkbox-wrapper");const t=document.createElement("span");t.classList.add("checkbox-text"),t.innerText=this.label;const i=document.createElement("input");i.setAttribute("type","checkbox"),this.checkboxRef=i;const n=document.createElement("span");return n.classList.add("checkbox-checkmark"),e.appendChild(t),e.appendChild(i),e.appendChild(n),e}setAttribute(){this.multiple?this.selected?this.checkboxRef.setAttribute("checked","checked"):this.checkboxRef.removeAttribute("checked"):this.selected?this.singleSelectTextSpanRef.classList.add("selected"):this.singleSelectTextSpanRef.classList.remove("selected")}createListeners(){this.multiple?this.checkboxRef.addEventListener("change",(()=>{this.selected=this.checkboxRef.checked,this.onChange(this)})):this.singleSelectTextSpanRef.addEventListener("click",(()=>{this.selected=!0,this.onChange(this)}))}}class bu{constructor(e){if(this.options=[],this.dropdownOpened=!1,this.destroyed=!1,this.rendered=!1,this.documentClickDropdownToggle=e=>{this.selectWrapperRef.contains(e.target)||this.handleDropdownToggle(!1,this.dropdownOpened)},this.config=e,this.assignConfig(),this.setOrigin(),!this.origin)throw"You have to pass origin element!";this.init()}init(){this.destroyed=!1,this.dropdownOpened=!1,this.createSelect(),this.createListeners()}destroy(){this.destroyed=!0,this.rendered=!1,this.hide(),document.removeEventListener("click",this.documentClickDropdownToggle),this.selectWrapperRef.cloneNode(!0),this.origin=null,this.selectHeaderRef=null,this.selectWrapperRef=null,this.selectedValueRef=null,this.optionsWrapperRef=null,this.options=[]}reset(){this.options.forEach((e=>e.deselect(!1))),this.updateSelection()}hide(){this.origin.innerHTML="",this.rendered=!1}render(){if(this.destroyed)throw"But you destroyed me... :(";if(this.origin.innerText.trim())throw"Hey! I am rendered already!";this.origin.appendChild(this.selectWrapperRef),this.rendered=!0,this.selectHeaderRef&&this.origin.prepend(this.selectHeaderRef)}assignConfig(){var e,t;this.origin=this.config.origin,this.configOptions=this.config.options,this.multiple=null===(e=this.config.multiple)||void 0===e||e,this.singularNominativeLabel=this.config.singularNominativeLabel,this.pluralNominativeLabel=this.config.pluralNominativeLabel,this.pluralGenitiveLabel=this.config.pluralGenitiveLabel,this.placeholder=null!==(t=this.config.placeholder)&&void 0!==t?t:"",this.headerLabel=this.config.headerLabel,this.selected=this.config.selected,this.onDropdownOpen=this.config.onDropdownOpen,this.onDropdownClose=this.config.onDropdownClose,this.onSelectionChange=this.config.onSelectionChange}setOrigin(){this.origin&&this.origin.classList.add("multiselect-container")}createHeader(){this.headerLabel&&(this.selectHeaderRef=document.createElement("div"),this.selectHeaderRef.classList.add("multiselect-header"),this.selectHeaderRef.innerText=this.headerLabel)}createSelect(){this.selectWrapperRef=document.createElement("div"),this.selectWrapperRef.classList.add("multiselect-wrapper"),this.multiple||this.selectWrapperRef.classList.add("single-select"),this.selectedValueRef=document.createElement("div"),this.selectedValueRef.classList.add("selected-value"),this.selectWrapperRef.appendChild(this.selectedValueRef),this.optionsWrapperRef=document.createElement("div"),this.optionsWrapperRef.classList.add("options-wrapper"),this.configOptions.forEach((e=>{var t;const i=new vu(e.value,e.label,this.multiple,this.onSelectChange.bind(this));(null===(t=this.selected)||void 0===t?void 0:t.includes(e.value))&&i.select(!1),this.options.push(i),this.optionsWrapperRef.appendChild(i.optionRef)})),this.updateSelection(),this.selectWrapperRef.appendChild(this.optionsWrapperRef),this.createHeader(),this.render()}createListeners(){this.selectWrapperRef.addEventListener("click",(e=>{this.selectWrapperRef.contains(e.target)&&!this.optionsWrapperRef.contains(e.target)&&this.handleDropdownToggle(!this.dropdownOpened)})),document.addEventListener("click",this.documentClickDropdownToggle)}handleDropdownToggle(e,t=!0){this.dropdownOpened=e,this.dropdownOpened?(this.selectWrapperRef.classList.add("opened"),this.onDropdownOpen&&t&&this.onDropdownOpen()):(this.selectWrapperRef.classList.remove("opened"),this.onDropdownClose&&t&&this.onDropdownClose(this.selected))}onSelectChange(e){this.multiple||(this.options.forEach((e=>e.deselect(!1))),e.select(!1)),this.updateSelection(),this.onSelectionChange&&this.onSelectionChange(this.selected),this.multiple||this.handleDropdownToggle(!1)}updateSelection(){this.selected=this.options.filter((e=>!!e.selected)).map((e=>e.value));const e=this.options.filter((e=>!!e.selected)).map((e=>e.label));let t=this.placeholder;1===e.length?t=e[0]:e.length>1&&(t=`${e.length} ${this.transformPluralLabel(e.length)}`),this.selectedValueRef.innerText=t}transformPluralLabel(e){var t,i,n;return 1===e?null!==(t=this.singularNominativeLabel)&&void 0!==t?t:"items":e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?null!==(i=this.pluralNominativeLabel)&&void 0!==i?i:"items":null!==(n=this.pluralGenitiveLabel)&&void 0!==n?n:"items"}}class Su{constructor(e,t){this.plugin=e,this.selectedLinks=new Set,this.selectedTags=new Set,this.isOpen=!1,this.filterDiv=t.createDiv({attr:{id:"filter"}})}render(){if(this.isOpen)return;if(this.filterDiv.empty(),!this.plugin.scene)return;const e=Array.from(this.selectedTags);this.selectedLinks.forEach((t=>e.push("link::"+t)));const t=[],i=new Set(this.selectedLinks.keys());this.plugin.scene.links.links.forEach((e=>{var t;null===(t=e.hierarchyDefinition)||void 0===t||t.split(",").map((e=>e.trim())).forEach((e=>i.add(e))),e.hierarchyDefinition||(e.isInferred?i.add("inferred-link"):i.add("normal-link"))})),i.forEach((e=>t.push({label:e,value:"link::"+e})));const n=new Set(this.selectedTags.keys());this.plugin.scene.nodesMap.forEach((e=>{e.page.primaryStyleTag&&n.add(e.page.primaryStyleTag)})),n.forEach((e=>t.push({label:e,value:e})));const s=new bu({origin:this.filterDiv,placeholder:"filter links and tags",options:t.sort(((e,t)=>e.label>t.label?1:-1)),selected:e,onDropdownOpen:()=>{this.isOpen=!0,this.selectedItems=s.selected},onSelectionChange:e=>{var t;this.selectedLinks.clear(),this.selectedTags.clear(),e.forEach((e=>{e.startsWith("link::")?this.selectedLinks.add(e.substring(6)):this.selectedTags.add(e)})),null===(t=this.plugin.scene)||void 0===t||t.reRender(!1)},onDropdownClose:e=>{var t;this.isOpen=!1,e!==this.selectedItems&&(null===(t=this.plugin.scene)||void 0===t||t.reRender(!1))}})}}class xu{constructor(e,t){this.contentEl=e,this.plugin=t,this.buttons=[],e.addClass("excalibrain-contentEl"),this.wrapperDiv=this.contentEl.createDiv({cls:"excalibrain-toolspanel-wrapper"});const i=this.wrapperDiv.createDiv({cls:"excalibrain-dropdown-wrapper"}),n=i.createEl("input",{type:"text",cls:"excalibrain-searchinput"});n.ariaLabel=A("SEARCH_IN_VAULT"),n.oninput=()=>{var e;const t=this.plugin.pages.get(n.value);t&&(null===(e=this.plugin.scene)||void 0===e||e.renderGraphForPath(t.path))},n.onblur=()=>{n.value=""},new wu(this.plugin.app,n,this.plugin,e),this.searchElement=n,this.linkTagFilter=new Su(t,i),this.linkTagFilter.render();const s=this.wrapperDiv.createDiv({cls:"excalibrain-buttons"}),u=s.createEl("button",{cls:"excalibrain-button",text:"âœ"});u.ariaLabel=A("OPEN_DRAWING"),u.onclick=()=>{const e=this.plugin.EA.getExcalidrawAPI().getSceneElements(),t=this.plugin.EA.getExcalidrawAPI().getAppState(),i=this.plugin.EA;i.reset(),i.canvas.viewBackgroundColor=t.viewBackgroundColor,i.canvas.theme="light",e.forEach((e=>i.elementsDict[e.id]=e)),i.create({filename:`ExcaliBrain Snapshot - ${c(this.plugin.scene.centralPagePath).basename}`,onNewPane:!0})},this.buttons.push(new cs(this.plugin,(()=>this.plugin.settings.showAttachments),(e=>this.plugin.settings.showAttachments=e),s,{display:"ðŸ“Ž",tooltip:A("SHOW_HIDE_ATTACHMENTS")})),this.buttons.push(new cs(this.plugin,(()=>this.plugin.settings.showVirtualNodes),(e=>this.plugin.settings.showVirtualNodes=e),s,{display:"âˆ…",tooltip:A("SHOW_HIDE_VIRTUAL")},!1)),this.buttons.push(new cs(this.plugin,(()=>this.plugin.settings.showInferredNodes),(e=>this.plugin.settings.showInferredNodes=e),s,{display:"ðŸ¤”",tooltip:A("SHOW_HIDE_INFERRED")})),this.buttons.push(new cs(this.plugin,(()=>this.plugin.settings.showPageNodes),(e=>this.plugin.settings.showPageNodes=e),s,{display:"ðŸ“„",tooltip:A("SHOW_HIDE_PAGES")})),this.buttons.push(new cs(this.plugin,(()=>this.plugin.settings.showFolderNodes),(e=>this.plugin.settings.showFolderNodes=e),s,{display:"ðŸ“‚",tooltip:A("SHOW_HIDE_FOLDER")},!0)),this.buttons.push(new cs(this.plugin,(()=>this.plugin.settings.showTagNodes),(e=>this.plugin.settings.showTagNodes=e),s,{display:"#",tooltip:A("SHOW_HIDE_TAG")},!1)),this.buttons.push(new cs(this.plugin,(()=>this.plugin.settings.renderAlias),(e=>this.plugin.settings.renderAlias=e),s,{display:"ðŸ§¥",tooltip:A("SHOW_HIDE_ALIAS")},!1)),this.buttons.push(new cs(this.plugin,(()=>this.plugin.scene.pinLeaf),(e=>this.plugin.scene.pinLeaf=e),s,{display:"ðŸ“Œ",tooltip:A("PIN_LEAF")},!1)),this.buttons.push(new cs(this.plugin,(()=>this.plugin.settings.renderSiblings),(e=>this.plugin.settings.renderSiblings=e),s,{display:"ðŸ‘¨â€ðŸ‘©â€ðŸ‘§â€ðŸ‘¦",tooltip:A("SHOW_HIDE_SIBLINGS")},!1)),this.contentEl.appendChild(this.wrapperDiv)}rerender(){this.buttons.forEach((e=>e.setColor())),this.linkTagFilter.render()}terminate(){var e;if(this.contentEl&&this.contentEl.removeClass("excalibrain-contentEl"),this.wrapperDiv){try{null===(e=this.contentEl)||void 0===e||e.removeChild(this.wrapperDiv)}catch(e){}this.wrapperDiv=null}}}class Au{constructor(e,t){this.contentEl=e,this.plugin=t,this.wrapperDiv=this.contentEl.createDiv({cls:"excalibrain-history-wrapper"}),this.rerender(),this.contentEl.appendChild(this.wrapperDiv)}rerender(){this.wrapperDiv.empty();const e=this.wrapperDiv.createDiv({cls:"excalibrain-history-container"}),t=this.plugin.settings.navigationHistory;for(let i=t.length-1;i>=0;i--){i!==t.length-1&&e.createDiv({text:"â€¢",cls:"excalibrain-history-divider"});let n="",s="";const u=this.plugin.pages.get(t[i]);if(!u)return;const r=u.path.startsWith("folder:")?this.plugin.settings.folderNodeStyle:u.path.startsWith("tag:")?this.plugin.settings.tagNodeStyle:Object.assign(Object.assign({},this.plugin.settings.baseNodeStyle),o(a(u.dvPage,this.plugin.settings),this.plugin.settings));u.file?(n=r.prefix+u.getTitle(),s=u.path):(n=r.prefix+u.name,u.path,s=u.path),e.createDiv({text:n,cls:"excalibrain-history-item"},(e=>{e.onclick=()=>{var e;return null===(e=this.plugin.scene)||void 0===e?void 0:e.renderGraphForPath(s)}}))}}terminate(){var e;if(this.wrapperDiv){try{null===(e=this.contentEl)||void 0===e||e.removeChild(this.wrapperDiv)}catch(e){}this.wrapperDiv=null}}}class Tu{constructor(e,t,i){this.disregardLeafChange=!1,this.nodesMap=new Map,this.layouts=[],this.blockUpdateTimer=!1,this.vaultFileChanged=!1,this.pinLeaf=!1,this.focusSearchAfterInitiation=!0,this.zoomToFitOnNextBrainLeafActivate=!1,this.ea=e.EA,this.plugin=e,this.app=e.app,this.leaf=null!=i?i:app.workspace.getLeaf(t),this.terminated=!1,this.links=new ls(e)}async initialize(e){var t;this.focusSearchAfterInitiation=e,await this.plugin.loadSettings(),(null===(t=this.leaf)||void 0===t?void 0:t.view)&&(this.toolsPanel=new xu(this.leaf.view.contentEl,this.plugin),this.initializeScene())}isActive(){var e;return!this.terminated&&app.workspace.getLeafById(null===(e=this.leaf)||void 0===e?void 0:e.id)}async reRender(e=!0){this.isActive()&&this.centralLeaf&&this.centralPagePath&&(e&&(this.vaultFileChanged=!1,await this.plugin.createIndex()),await this.render())}async renderGraphForPath(e,t=!0){var i;if(!this.isActive())return;this.blockUpdateTimer=!0;const n=this.plugin.pages.get(e);if(!n)return void(this.blockUpdateTimer=!1);const s=!(n.isFolder||n.isTag||n.isVirtual);if(s&&!n.file)return void(this.blockUpdateTimer=!1);if(!(null===(i=this.ea.targetView)||void 0===i?void 0:i.file)||this.ea.targetView.file.path!==this.plugin.settings.excalibrainFilepath)return void this.unloadScene();if(s&&n.file.path===this.ea.targetView.file.path)return void(this.blockUpdateTimer=!1);const u=this.plugin.pages.get(this.centralPagePath);u&&u.path===e&&s&&n.file.stat.mtime===u.mtime?this.blockUpdateTimer=!1:(s&&t?(this.centralLeaf&&app.workspace.getLeafById(this.centralLeaf.id)?this.centralLeaf.openFile(n.file,{active:!1}):this.centralLeaf=this.ea.openFileInNewOrAdjacentLeaf(n.file),this.addToHistory(n.file.path)):this.addToHistory(n.path),n.isFolder&&!this.plugin.settings.showFolderNodes&&(this.plugin.settings.showFolderNodes=!0,this.toolsPanel.rerender()),n.isTag&&!this.plugin.settings.showTagNodes&&(this.plugin.settings.showTagNodes=!0,this.toolsPanel.rerender()),this.centralPagePath=e,await this.render())}async addToHistory(e){const t=this.plugin.settings.navigationHistory;if(t.last()===e)return;const i=t.indexOf(e);i>-1&&t.splice(i,1),t.length>50&&t.shift(),t.push(e)}static async openExcalidrawLeaf(e,t,i){var s;let u=0,r=app.vault.getAbstractFileByPath(t.excalibrainFilepath);if(!r||r instanceof n.TFile){if(!r)for(r=await app.vault.create(t.excalibrainFilepath,os);r instanceof n.TFile&&!e.isExcalidrawFile(r)&&u++<10;)await sleep(50);if(u=0,r&&r instanceof n.TFile&&!e.isExcalidrawFile(r))new T(app,"âš  File Exists",`${r.path} already exists in your Vault. Is it ok to overwrite this file? If not, change ExcaliBrain file path in plugin settings.`).show((async s=>{if(s){for(await app.vault.modify(r,os);r instanceof n.TFile&&!e.isExcalidrawFile(r)&&u++<10;)await sleep(50);Tu.openExcalidrawLeaf(e,t,i)}else new n.Notice("Could not start ExcaliBrain. Please change the ExcaliBrain file path in plugin settings.")}));else if(await(null!=i?i:app.workspace.getLeaf(!0)).openFile(r),t.defaultAlwaysOnTop&&i){const e=null===(s=i.view)||void 0===s?void 0:s.ownerWindow;e&&e!==window&&!e.electronWindow.isMaximized()&&e.electronWindow.setAlwaysOnTop(!0)}}else new n.Notice(`Please check settings. ExcaliBrain path (${t.excalibrainFilepath}) points to a folder, not a file`)}async initializeScene(){this.disregardLeafChange=!1;const e=this.ea,t=this.plugin.settings.baseNodeStyle;let i=0;for(e.clear(),e.setView(this.leaf.view);!e.targetView.excalidrawAPI&&i++<10;)await sleep(50);if(!e.targetView.excalidrawAPI)return void new n.Notice("Error initializing Excalidraw view");const s=e.getExcalidrawAPI();this.ea.registerThisAsViewEA(),this.ea.targetView.semaphores.saving=!0,s.setMobileModeAllowed(!1),e.style.fontFamily=t.fontFamily,e.style.fontSize=t.fontSize,this.textSize=e.measureText("m".repeat(t.maxLabelLength+3)),this.nodeWidth=this.textSize.width+3*t.padding,this.plugin.settings.compactView&&(this.nodeWidth=.6*this.nodeWidth),this.nodeHeight=2*(this.textSize.height+2*t.padding),(()=>{s.updateScene({appState:{viewModeEnabled:!0,activeTool:{lastActiveToolBeforeEraser:null,locked:!1,type:"selection"},theme:"light",viewBackgroundColor:this.plugin.settings.backgroundColor},elements:[]})})(),e.style.strokeColor=t.textColor,e.addText(0,0,"ðŸš€ To get started\nselect a document using the search in the top left or\nopen a document in another pane.\n\nâœ¨ For the best experience enable 'Open in adjacent pane'\nin Excalidraw settings under 'Links and Transclusion'.\n\nâš  ExcaliBrain may need to wait for DataView to initialize its index.\nThis can take up to a few minutes after starting Obsidian.",{textAlign:"center"}),e.addElementsToView(),(()=>{this.plugin.settings.allowAutozoom&&s.zoomToFit(null,5,.15),e.targetView.linksAlwaysOpenInANewPane=!0,this.addEventHandler(),this.historyPanel=new Au(this.leaf.view.contentEl,this.plugin),new n.Notice("ExcaliBrain On")})()}addNodes(t){t.neighbours.forEach((i=>{if(i.page.path===this.ea.targetView.file.path)return;const n=new B({ea:this.ea,page:i.page,isInferred:i.relationType===e.INFERRED,isCentral:t.isCentral,isSibling:t.isSibling,friendGateOnLeft:t.friendGateOnLeft});this.nodesMap.set(i.page.path,n),t.layout.nodes.push(n)}))}async render(){var e,i;if(this.historyPanel&&this.historyPanel.rerender(),!this.centralPagePath)return;let n=this.plugin.pages.get(this.centralPagePath);if(!n&&(this.centralPagePath=this.plugin.lowercasePathMap.get(this.centralPagePath.toLowerCase()),n=this.plugin.pages.get(this.centralPagePath),!n))return;const s=this.ea;this.zoomToFitOnNextBrainLeafActivate=!s.targetView.containerEl.isShown(),s.clear(),s.getExcalidrawAPI().updateScene({elements:[]}),s.style.verticalAlign="middle";const u=n.getParents().filter((e=>!(e.page.path===n.path||this.plugin.settings.excludeFilepaths.some((t=>e.page.path.startsWith(t)))||e.page.primaryStyleTag&&this.toolsPanel.linkTagFilter.selectedTags.has(e.page.primaryStyleTag)))).slice(0,this.plugin.settings.maxItemCount),r=u.map((e=>e.page.path)),a=n.getChildren().filter((e=>!(e.page.path===n.path||this.plugin.settings.excludeFilepaths.some((t=>e.page.path.startsWith(t)))||e.page.primaryStyleTag&&this.toolsPanel.linkTagFilter.selectedTags.has(e.page.primaryStyleTag)))).slice(0,this.plugin.settings.maxItemCount),o=n.getFriends().filter((e=>!(e.page.path===n.path||this.plugin.settings.excludeFilepaths.some((t=>e.page.path.startsWith(t)))||e.page.primaryStyleTag&&this.toolsPanel.linkTagFilter.selectedTags.has(e.page.primaryStyleTag)))).slice(0,this.plugin.settings.maxItemCount),D=n.getSiblings().filter((e=>!(u.some((t=>t.page.path===e.page.path))||a.some((t=>t.page.path===e.page.path))||o.some((t=>t.page.path===e.page.path))||this.plugin.settings.excludeFilepaths.some((t=>e.page.path.startsWith(t))))&&e.page.path!==n.path)),l=D.filter((e=>e.page.getParents().map((e=>e.page.path)).some((e=>r.includes(e)))&&(!e.page.primaryStyleTag||!this.toolsPanel.linkTagFilter.selectedTags.has(e.page.primaryStyleTag)))).slice(0,this.plugin.settings.maxItemCount);this.nodesMap=new Map,this.links=new ls(this.plugin),this.layouts=[];const c=o.length>=10,d=this.plugin.settings.baseNodeStyle,h=l.length>=20?3:l.length>=10?2:1,p=this.plugin.settings.compactView?a.length<=12?[1,1,2,3,3,3,3,2,2,3,3,2,2][a.length]:3:a.length<=12?[1,1,2,3,3,3,3,4,4,5,5,4,4][a.length]:5,g=this.plugin.settings.compactView?u.length<2?1:2:u.length<5?[1,1,2,3,2][u.length]:3,F=new Ds({origoX:0,origoY:0,top:null,bottom:null,columns:1,columnWidth:this.nodeWidth,rowHeight:this.nodeHeight});this.layouts.push(F);const f=new Ds({origoX:0,origoY:2.5*this.nodeHeight,top:2*this.nodeHeight,bottom:null,columns:p,columnWidth:this.nodeWidth,rowHeight:this.nodeHeight});this.layouts.push(f);const E=new Ds({origoX:-((c?1:0)+Math.max(p,g)+1.9)/2.4*this.nodeWidth,origoY:0,top:null,bottom:null,columns:1,columnWidth:this.nodeWidth,rowHeight:this.nodeHeight});this.layouts.push(E);const m=new Ds({origoX:0,origoY:-2.5*this.nodeHeight,top:null,bottom:-2*this.nodeHeight,columns:g,columnWidth:this.nodeWidth,rowHeight:this.nodeHeight});this.layouts.push(m);const C=this.plugin.settings.siblingNodeStyle,y=null!==(e=C.padding)&&void 0!==e?e:d.padding,w=null!==(i=C.maxLabelLength)&&void 0!==i?i:d.maxLabelLength;s.style.fontFamily=C.fontFamily,s.style.fontSize=C.fontSize;const v=s.measureText("m".repeat(w+3)),b=v.width+3*y,S=2*(v.height+2*y),x=new Ds({origoX:this.nodeWidth*((g-1)/2+(h+1.5)/3),origoY:-2.5*this.nodeHeight,top:null,bottom:-this.nodeHeight/2,columns:h,columnWidth:b,rowHeight:S});this.layouts.push(x);const A=new B({ea:s,page:n,isInferred:!1,isCentral:!0,isSibling:!1,friendGateOnLeft:!0});this.nodesMap.set(n.path,A),F.nodes.push(A),this.addNodes({neighbours:u,layout:m,isCentral:!1,isSibling:!1,friendGateOnLeft:!0}),this.addNodes({neighbours:a,layout:f,isCentral:!1,isSibling:!1,friendGateOnLeft:!0}),this.addNodes({neighbours:o,layout:E,isCentral:!1,isSibling:!1,friendGateOnLeft:!1}),this.plugin.settings.renderSiblings&&this.addNodes({neighbours:l,layout:x,isCentral:!1,isSibling:!0,friendGateOnLeft:!0});const T=(e,t,i)=>{t.forEach((t=>{const n=this.nodesMap.get(t.page.path);n&&this.links.addLink(e,n,i,t.relationType,t.typeDefinition,t.linkDirection,s,this.plugin.settings)}))};Array.from(this.nodesMap.values()).forEach((e=>{T(e,e.page.getChildren(),t.CHILD),T(e,e.page.getParents(),t.PARENT),T(e,e.page.getFriends(),t.FRIEND)})),s.style.opacity=100,this.layouts.forEach((e=>e.render()));const O=s.getElements();this.links.render(Array.from(this.toolsPanel.linkTagFilter.selectedLinks));const N=s.getElements().filter((e=>!O.includes(e)));s.getExcalidrawAPI().updateScene({elements:N.concat(O)}),s.getExcalidrawAPI().updateScene({appState:{viewBackgroundColor:this.plugin.settings.backgroundColor}}),this.plugin.settings.allowAutozoom&&s.getExcalidrawAPI().zoomToFit(null,5,.15),this.toolsPanel.rerender(),this.focusSearchAfterInitiation&&this.plugin.settings.allowAutofocuOnSearch&&(this.toolsPanel.searchElement.focus(),this.focusSearchAfterInitiation=!1),this.blockUpdateTimer=!1}isCentralLeafStillThere(){return null!==app.workspace.getLeafById(this.centralLeaf.id)}async addEventHandler(){const e=this,t=async t=>{var i;if(this.disregardLeafChange)return;if(e.blockUpdateTimer=!0,await sleep(100),this.pinLeaf&&!this.isCentralLeafStillThere()&&(this.pinLeaf=!1,this.toolsPanel.rerender()),this.pinLeaf&&t!==this.centralLeaf)return;if(!(null===(i=e.ea.targetView)||void 0===i?void 0:i.file)||e.ea.targetView.file.path!==e.plugin.settings.excalibrainFilepath)return void e.unloadScene();if(!((null==t?void 0:t.view)&&t.view instanceof n.FileView&&t.view.file))return void(e.blockUpdateTimer=!1);const s=t.view.file;if(s.path===e.ea.targetView.file.path)return this.vaultFileChanged&&(this.zoomToFitOnNextBrainLeafActivate=!1,await this.reRender(!0)),this.zoomToFitOnNextBrainLeafActivate&&(this.zoomToFitOnNextBrainLeafActivate=!1,e.plugin.settings.allowAutozoom&&e.ea.getExcalidrawAPI().zoomToFit(null,5,.15)),void(e.blockUpdateTimer=!1);const u=e.plugin.pages.get(e.centralPagePath);u&&u.path===s.path&&s.stat.mtime===u.mtime?e.blockUpdateTimer=!1:(e.plugin.pages.get(s.path)||await e.plugin.createIndex(),this.addToHistory(s.path),e.centralPagePath=s.path,e.centralLeaf=t,e.render())},i=()=>{this.vaultFileChanged=!0};app.workspace.on("active-leaf-change",t),this.removeEH=()=>app.workspace.off("active-leaf-change",t),this.setTimer(),app.vault.on("rename",i),this.removeOnRename=()=>app.vault.off("rename",i),app.vault.on("modify",i),this.removeOnModify=()=>app.vault.off("modify",i),app.vault.on("create",i),this.removeOnCreate=()=>app.vault.off("create",i),app.vault.on("delete",i),this.removeOnDelete=()=>app.vault.off("delete",i);const s=[];app.workspace.iterateAllLeaves((e=>{e.view instanceof n.FileView&&e.view.file&&e.view.file.path!==this.ea.targetView.file.path&&s.push(e)})),await this.plugin.createIndex();let u=s[0];if(s.length>0){const e=app.workspace.getLastOpenFiles()[0];if(e&&""!==e){const t=s.filter((t=>{var i;return(null===(i=t.view)||void 0===i?void 0:i.file.path)===e}));t.length>0&&(u=t[0])}t(u)}}setTimer(){this.removeTimer&&(this.removeTimer(),this.removeTimer=void 0);const e=setInterval((async()=>{this.blockUpdateTimer||this.vaultFileChanged&&(this.vaultFileChanged=!1,await this.plugin.createIndex(),this.centralPagePath&&(this.plugin.pages.get(this.centralPagePath)||this.centralLeaf&&this.centralLeaf.view&&this.centralLeaf.view.file&&(this.centralPagePath=this.centralLeaf.view.file.path)),this.render())}),this.plugin.settings.indexUpdateInterval);this.removeTimer=()=>clearInterval(e)}unloadScene(){var e,t;if(this.removeEH&&(this.removeEH(),this.removeEH=void 0),this.removeTimer&&(this.removeTimer(),this.removeTimer=void 0),this.removeOnRename&&(this.removeOnRename(),this.removeOnRename=void 0),this.removeOnModify&&(this.removeOnModify(),this.removeOnModify=void 0),this.removeOnCreate&&(this.removeOnCreate(),this.removeOnCreate=void 0),this.removeOnDelete&&(this.removeOnDelete(),this.removeOnDelete=void 0),this.ea.targetView&&isBoolean(this.ea.targetView.linksAlwaysOpenInANewPane)&&(this.ea.targetView.linksAlwaysOpenInANewPane=!1),this.ea.targetView&&this.ea.targetView.excalidrawAPI)try{this.ea.targetView.semaphores.saving=!1,this.ea.targetView.excalidrawAPI.setMobileModeAllowed(!0),this.ea.targetView.excalidrawAPI.updateScene({appState:{viewModeEnabled:!1}})}catch(e){}if(this.ea.targetView&&this.ea.targetView._loaded)try{this.ea.deregisterThisAsViewEA()}catch(e){}(async()=>{const e=this.plugin.settings.navigationHistory.slice();await this.plugin.loadSettings(),this.plugin.settings.navigationHistory=e,await this.plugin.saveSettings()})(),null===(e=this.toolsPanel)||void 0===e||e.terminate(),this.toolsPanel=void 0,null===(t=this.historyPanel)||void 0===t||t.terminate(),this.historyPanel=void 0,this.ea.targetView=void 0,this.leaf=void 0,this.centralLeaf=void 0,this.centralPagePath=void 0,this.terminated=!0,app.plugins.plugins["obsidian-excalidraw-plugin"]||(this.plugin.EA=null),new n.Notice("Brain Graph Off")}}class Bu extends n.EditorSuggest{constructor(e){super(e.app),this.getKeys=()=>{const e=this.plugin.settings.hierarchy,t=this.suggestType;return"all"===t?e.parents.concat(e.children).concat(e.friends).sort(((e,t)=>e.toLowerCase()>t.toLowerCase()?1:-1)):"parent"===t?e.parents:"child"===t?e.children:e.friends},this.getTrigger=()=>{const e=this.suggestType,t=this.plugin.settings;return"all"===e?t.ontologySuggesterTrigger:"parent"===e?t.ontologySuggesterParentTrigger:"child"===e?t.ontologySuggesterChildTrigger:t.ontologySuggesterFriendTrigger},this.getSuggestions=e=>{const t=e.query.toLowerCase();return this.getKeys().filter((e=>e.toLowerCase().includes(t)))},this.plugin=e}onTrigger(e,t,i){const n=this.plugin.settings;if(n.allowOntologySuggester){const i=t.getLine(e.line).substring(0,e.ch),s=new RegExp(`(^${n.ontologySuggesterTrigger}|\\${n.ontologySuggesterMidSentenceTrigger+n.ontologySuggesterTrigger}|^${n.ontologySuggesterParentTrigger}|\\${n.ontologySuggesterMidSentenceTrigger+n.ontologySuggesterParentTrigger}|^${n.ontologySuggesterChildTrigger}|\\${n.ontologySuggesterMidSentenceTrigger+n.ontologySuggesterChildTrigger}|^${n.ontologySuggesterFriendTrigger}|\\${n.ontologySuggesterMidSentenceTrigger+n.ontologySuggesterFriendTrigger})([^\\s\\${n.ontologySuggesterTrigger}]*)`,"g");let u,r,a;const o=i.matchAll(s);for(;!(a=o.next()).done;)r=a.value[1],u=a.value[2];if(void 0!==u){switch(r){case n.ontologySuggesterTrigger:case n.ontologySuggesterMidSentenceTrigger+n.ontologySuggesterTrigger:this.suggestType="all";break;case n.ontologySuggesterParentTrigger:case n.ontologySuggesterMidSentenceTrigger+n.ontologySuggesterParentTrigger:this.suggestType="parent";break;case n.ontologySuggesterChildTrigger:case n.ontologySuggesterMidSentenceTrigger+n.ontologySuggesterChildTrigger:this.suggestType="child";break;default:this.suggestType="friend"}return this.latestTriggerInfo={end:e,start:{ch:e.ch-u.length-this.getTrigger().length,line:e.line},query:u},this.latestTriggerInfo}}return null}renderSuggestion(e,t){t.createEl("b",{text:e})}selectSuggestion(e){const{context:t}=this;if(t){const i=this.plugin.settings.boldFields,n=(i?"**":"")+e+(i?"**":"")+":: ";if(t.editor.replaceRange(n,this.latestTriggerInfo.start,this.latestTriggerInfo.end),this.latestTriggerInfo.start.ch===this.latestTriggerInfo.end.ch){const e=this.latestTriggerInfo.end;e.ch+=n.length,t.editor.setCursor(e)}}}}class Ou extends n.Plugin{constructor(e,t){super(e,t),this.hierarchyLowerCase={parents:[],children:[],friends:[]},this.scene=null,this.pluginLoaded=!1,this.starred=[],this.focusSearchAfterInitiation=!1,this.starred=[new F(null,"Initializing index, please wait",null,this,!1,!1,"Initializing index, please wait")]}async onload(){await this.loadSettings(),this.addSettingTab(new R(this.app,this)),this.registerEditorSuggest(new Bu(this)),this.app.workspace.onLayoutReady((()=>{this.DVAPI=rs(),this.DVAPI?this.DVAPI.version.compare(">=","0.5.31")?(this.EA=C(),this.EA?this.EA.verifyMinimumPluginVersion("1.6.33")?(this.registerCommands(),this.registerExcalidrawAutomateHooks(),this.pluginLoaded=!0):new T(app,"âš  ExcaliBrain Disabled: Please upgrade Excalidraw and try again",A("EXCALIDRAW_MINAPP_VERSION")).show((async e=>{new n.Notice("Disabling ExcaliBrain Plugin",8e3),D({fn:this.onload,where:"main.ts/onload()",message:"ExcaliBrain requires a new version of Excalidraw"}),this.app.plugins.disablePlugin("excalibrain")})):new T(app,"âš  ExcaliBrain Disabled: Excalidraw Plugin not found",A("EXCALIDRAW_NOT_FOUND")).show((async e=>{new n.Notice("Disabling ExcaliBrain Plugin",8e3),D({fn:this.onload,where:"main.ts/onload()",message:"Excalidraw not found"}),this.app.plugins.disablePlugin("excalibrain")}))):new T(app,"âš  ExcaliBrain Disabled: Dataview upgrade requried",A("DATAVIEW_UPGRADE")).show((async e=>{new n.Notice("Disabling ExcaliBrain Plugin",8e3),D({fn:this.onload,where:"main.ts/onload()",message:"Dataview version error"}),this.app.plugins.disablePlugin("excalibrain")})):new T(app,"âš  ExcaliBrain Disabled: DataView Plugin not found",A("DATAVIEW_NOT_FOUND")).show((async e=>{new n.Notice("Disabling ExcaliBrain Plugin",8e3),D({fn:this.onload,where:"main.ts/onload()",message:"Dataview not found"}),this.app.plugins.disablePlugin("excalibrain")}))}))}async createIndex(){this.pages=new as(this),this.lowercasePathMap=new Map;let t=0;for(;this.app.metadataCache.inProgressTaskCount>0||this.DVAPI.index.importer.reloadQueue.length>0;)t++%100==10&&new n.Notice("ExcaliBrain is waiting for Dataview to update its index",1e3),await sleep(100);const s=(t,u)=>{t.children.forEach((t=>{if(t instanceof n.TFolder){const n=new F(this.pages,"folder:"+t.path,null,this,!0,!1,t.name);return this.pages.add("folder:"+t.path,n),n.addParent(u,e.DEFINED,i.FROM,"file-tree"),u.addChild(n,e.DEFINED,i.TO,"file-tree"),void s(t,n)}{this.lowercasePathMap.set(t.path.toLowerCase(),t.path);const n=new F(this.pages,t.path,t,this);this.pages.add(t.path,n),n.addParent(u,e.DEFINED,i.FROM,"file-tree"),u.addChild(n,e.DEFINED,i.TO,"file-tree")}}))},u=app.vault.getRoot(),r=new F(this.pages,"folder:/",null,this,!0,!1,"/");this.pages.add("folder:/",r),s(u,r);const a=Object.keys(app.metadataCache.getTags()).map((e=>e.substring(1).split("/")));a.forEach((t=>{const n=[];t.forEach(((t,s,u)=>{const r=u.slice(0,s+1).join("/"),a="tag:"+r;let o=this.pages.get(a);if(o)n.push(o);else if(o=new F(this.pages,a,null,this,!1,!0,this.settings.showFullTagName?r:t),this.pages.add(a,o),n.push(o),s>0){const t=n[s-1];o.addParent(t,e.DEFINED,i.FROM,"tag-tree"),t.addChild(o,e.DEFINED,i.TO,"tag-tree")}}))})),this.pages.addUnresolvedLinks(),this.pages.addResolvedLinks();const o=this;setTimeout((async()=>{const e=app.internalPlugins.getPluginById("bookmarks");if(!e){const e=app.internalPlugins.getPluginById("starred");if(!e)return;return void(o.starred=(await e.loadData()).items.filter((e=>"file"===e.type)).map((e=>e.path)).filter((e=>e!==o.settings.excalibrainFilepath&&o.pages.has(e))).map((e=>o.pages.get(e))))}e._loaded||await e.loadData();const t=e=>{if(!e)return;let i=e.filter((e=>"file"===e.type)).map((e=>e.path)).filter((e=>e!==o.settings.excalibrainFilepath&&o.pages.has(e))).map((e=>o.pages.get(e)));return i=i.concat(e.filter((e=>"folder"===e.type)).map((e=>e.path)).filter((e=>e!==o.settings.excalibrainFilepath&&o.pages.has(`folder:${e}`))).map((e=>o.pages.get(`folder:${e}`)))),e.filter((e=>"group"===e.type)).forEach((e=>i=i.concat(t(e.items)))),i};o.starred=t(e.instance.items)}))}excalidrawAvailable(){const e=C();return e?(!this.EA!==e&&(this.EA=e,this.registerExcalidrawAutomateHooks()),!0):(this.EA=null,this.scene&&this.scene.unloadScene(),new n.Notice("ExcaliBrain: Please start Excalidraw and try again.",4e3),!1)}revealBrainLeaf(){var e;if(!this.scene||this.scene.terminated)return;app.workspace.revealLeaf(this.scene.leaf);const t=app.plugins.getPlugin("obsidian-hover-editor");if(t){const e=t.activePopovers.filter((e=>e.leaves()[0]===this.scene.leaf))[0];e&&0===this.scene.leaf.view.containerEl.offsetHeight&&e.titleEl.querySelector("a.popover-action.mod-minimize").click()}const i=null===(e=this.scene.toolsPanel)||void 0===e?void 0:e.searchElement;null==i||i.focus()}registerCommands(){const e=(e,t)=>{var i;const s=null===(i=app.workspace.activeLeaf)||void 0===i?void 0:i.view;if(e)return s instanceof n.MarkdownView&&"source"===s.getMode();if(!(s instanceof n.MarkdownView)||"source"!==s.getMode())return!1;const u=s.editor.getCursor(),r=s.editor.getLine(u.line).match(/^([^\:]*)::/);return!!r&&((async()=>{const e=this.settings.navigationHistory;if(await this.loadSettings(),this.settings.navigationHistory=e,this.settings.hierarchy.parents.includes(r[1]))new n.Notice(`${r[1]} is already registered as a PARENT`);else if(this.settings.hierarchy.children.includes(r[1]))new n.Notice(`${r[1]} is already registered as a CHILD`);else if(this.settings.hierarchy.friends.includes(r[1]))new n.Notice(`${r[1]} is already registered as a FRIEND`);else{switch(t){case"parent":this.settings.hierarchy.parents.push(r[1]),this.settings.hierarchy.parents=this.settings.hierarchy.parents.sort(((e,t)=>e.toLowerCase()<t.toLowerCase()?-1:1)),this.hierarchyLowerCase.parents=[],this.settings.hierarchy.parents.forEach((e=>this.hierarchyLowerCase.parents.push(e.toLowerCase().replaceAll(" ","-"))));break;case"child":this.settings.hierarchy.children.push(r[1]),this.settings.hierarchy.children=this.settings.hierarchy.children.sort(((e,t)=>e.toLowerCase()<t.toLowerCase()?-1:1)),this.hierarchyLowerCase.children=[],this.settings.hierarchy.children.forEach((e=>this.hierarchyLowerCase.children.push(e.toLowerCase().replaceAll(" ","-"))));break;default:this.settings.hierarchy.friends.push(r[1]),this.settings.hierarchy.friends=this.settings.hierarchy.friends.sort(((e,t)=>e.toLowerCase()<t.toLowerCase()?-1:1)),this.hierarchyLowerCase.friends=[],this.settings.hierarchy.friends.forEach((e=>this.hierarchyLowerCase.friends.push(e.toLowerCase().replaceAll(" ","-"))))}await this.saveSettings(),this.scene&&!this.scene.terminated&&(this.scene.vaultFileChanged=!0),new n.Notice(`Added ${r[1]} as ${t}`)}})(),!0)};this.addCommand({id:"excalibrain-addParentField",name:A("COMMAND_ADD_PARENT_FIELD"),checkCallback:t=>e(t,"parent")}),this.addCommand({id:"excalibrain-addChildField",name:A("COMMAND_ADD_CHILD_FIELD"),checkCallback:t=>e(t,"child")}),this.addCommand({id:"excalibrain-addFriendField",name:A("COMMAND_ADD_FRIEND_FIELD"),checkCallback:t=>e(t,"friend")}),this.addCommand({id:"excalibrain-start",name:A("COMMAND_START"),checkCallback:e=>{if(e)return this.excalidrawAvailable();if(!this.excalidrawAvailable())return;if(this.scene&&!this.scene.terminated)return void this.revealBrainLeaf();const t=this.getBrainLeaf();if(t)return this.scene=new Tu(this,!0,t),this.scene.initialize(!0),void this.revealBrainLeaf();this.focusSearchAfterInitiation=!0,Tu.openExcalidrawLeaf(window.ExcalidrawAutomate,this.settings,t)}}),this.addCommand({id:"excalibrain-start-popout",name:A("COMMAND_START_POPOUT"),checkCallback:e=>{if(e)return!app.isMobile&&this.excalidrawAvailable();if(!this.excalidrawAvailable()||app.isMobile)return;if(this.scene&&!this.scene.terminated)return void this.revealBrainLeaf();const t=this.getBrainLeaf();if(t)return this.scene=new Tu(this,!0,t),this.scene.initialize(!0),void this.revealBrainLeaf();this.focusSearchAfterInitiation=!0,Tu.openExcalidrawLeaf(window.ExcalidrawAutomate,this.settings,app.workspace.openPopoutLeaf())}}),this.addCommand({id:"excalibrain-open-hover",name:A("COMMAND_START_HOVER"),checkCallback:e=>{const t=app.plugins.getPlugin("obsidian-hover-editor");if(e)return t&&this.excalidrawAvailable();if(this.excalidrawAvailable()&&t)if(!this.scene||this.scene.terminated)try{const e=this.getBrainLeaf();if(e){const i=t.activePopovers.filter((t=>t.leaves()[0]===e))[0];if(i)return app.workspace.revealLeaf(e),0===e.view.containerEl.offsetHeight&&i.titleEl.querySelector("a.popover-action.mod-maximize").click(),this.scene=new Tu(this,!0,e),void this.scene.initialize(!0)}const i=t.spawnPopover(void 0,(()=>{if(this.app.workspace.setActiveLeaf(i,!1,!0),!t.activePopovers.filter((e=>e.leaves()[0]===i))[0])return new n.Notice(A("HOVER_EDITOR_ERROR"),6e3),!1;setTimeout((()=>app.commands.executeCommandById("obsidian-hover-editor:snap-active-popover-to-viewport"))),this.focusSearchAfterInitiation=!0,Tu.openExcalidrawLeaf(window.ExcalidrawAutomate,this.settings,i)}))}catch(e){new n.Notice(A("HOVER_EDITOR_ERROR"),6e3)}else this.revealBrainLeaf()}})}getBrainLeaf(){let e;return app.workspace.iterateAllLeaves((t=>{t.view&&this.EA.isExcalidrawView(t.view)&&t.view instanceof n.TextFileView&&t.view.file.path===this.settings.excalibrainFilepath&&(e=t)})),e}registerExcalidrawAutomateHooks(){this.EA.onViewModeChangeHook=e=>{var t;this.EA.targetView&&(null===(t=this.EA.targetView.file)||void 0===t?void 0:t.path)===this.settings.excalibrainFilepath&&(e||this.stop())},this.EA.onLinkHoverHook=(e,t)=>{var i;return!(this.scene&&this.EA.targetView&&(null===(i=this.EA.targetView.file)||void 0===i?void 0:i.path)===this.settings.excalibrainFilepath&&this.EA.targetView.excalidrawAPI&&this.EA.targetView.excalidrawAPI.getAppState().viewModeEnabled&&(this.scene.disregardLeafChange=!0,this.disregardLeafChangeTimer&&clearTimeout(this.disregardLeafChangeTimer),this.disregardLeafChangeTimer=setTimeout((()=>{this.disregardLeafChangeTimer=null,this.scene&&(this.scene.disregardLeafChange=!1)}),1e3),0))},this.EA.onLinkClickHook=(e,t,i)=>{var s,u,r,a,o,D,l,c,d,h,p;const g=t.match(/\[\[([^\]]*)/)[1],F=this.pages.get(g);if(!i.shiftKey&&F&&F.isVirtual)return null===(s=this.scene)||void 0===s||s.renderGraphForPath(g),!1;if(!t.startsWith("[[folder:")&&!t.startsWith("[[tag:")){if((null===(o=null===(a=null===(r=null===(u=this.scene)||void 0===u?void 0:u.centralLeaf)||void 0===r?void 0:r.view)||void 0===a?void 0:a.file)||void 0===o?void 0:o.path)===g)return null===(D=this.scene)||void 0===D||D.renderGraphForPath(g),!1;if((null===(l=this.scene)||void 0===l?void 0:l.pinLeaf)&&(null===(c=this.scene)||void 0===c?void 0:c.isCentralLeafStillThere())){const e=app.vault.getAbstractFileByPath(g.split("#")[0]);if(e&&e instanceof n.TFile)return this.scene.centralLeaf.openFile(e),this.scene.renderGraphForPath(g),!1}if(null===(d=this.scene)||void 0===d?void 0:d.isCentralLeafStillThere()){const e=app.vault.getAbstractFileByPath(g.split("#")[0]);if(e&&e instanceof n.TFile)return this.scene.centralLeaf.openFile(e),this.scene.renderGraphForPath(g),!1}return null===(h=this.scene)||void 0===h||h.renderGraphForPath(g,!1),!0}return null===(p=this.scene)||void 0===p||p.renderGraphForPath(g),!1},this.EA.onViewUnloadHook=e=>{this.scene&&this.scene.leaf===e.leaf&&this.stop()}}onunload(){this.scene&&(this.scene.unloadScene(),this.scene=null)}setHierarchyLinkStylesExtended(){this.hierarchyLinkStylesExtended={},Object.entries(this.settings.hierarchyLinkStyles).forEach((e=>{const t=e[0].toLowerCase().replaceAll(" ","-");this.hierarchyLinkStylesExtended[e[0]]=e[1],e[0]!==t&&(this.hierarchyLinkStylesExtended[t]=e[1])}))}loadCustomNodeLabelFunction(){if(this.settings.nodeTitleScript)try{this.customNodeLabel=new Function("dvPage","defaultName","return "+this.settings.nodeTitleScript)}catch(e){D({fn:this.loadCustomNodeLabelFunction,message:"error processing custom node label script",where:"loadCustomNodeLabelFunction()",data:this.settings.nodeTitleScript,error:e}),new n.Notice("Could not load custom node label function. See Developer console for details"),this.customNodeLabel=null}else this.customNodeLabel=null}async loadSettings(){this.settings=Object.assign({},N,await this.loadData()),this.settings.hierarchy.exclusions||(this.settings.hierarchy.exclusions=N.hierarchy.exclusions),this.loadCustomNodeLabelFunction(),this.settings.baseLinkStyle=Object.assign(Object.assign({},v),this.settings.baseLinkStyle),this.settings.baseNodeStyle=Object.assign(Object.assign({},b),this.settings.baseNodeStyle),this.hierarchyLowerCase.parents=[],this.settings.hierarchy.parents=this.settings.hierarchy.parents.sort(((e,t)=>e.toLowerCase()<t.toLowerCase()?-1:1)),this.settings.hierarchy.parents.forEach((e=>this.hierarchyLowerCase.parents.push(e.toLowerCase().replaceAll(" ","-")))),this.hierarchyLowerCase.children=[],this.settings.hierarchy.children=this.settings.hierarchy.children.sort(((e,t)=>e.toLowerCase()<t.toLowerCase()?-1:1)),this.settings.hierarchy.children.forEach((e=>this.hierarchyLowerCase.children.push(e.toLowerCase().replaceAll(" ","-")))),this.hierarchyLowerCase.friends=[],this.settings.hierarchy.friends=this.settings.hierarchy.friends.sort(((e,t)=>e.toLowerCase()<t.toLowerCase()?-1:1)),this.settings.hierarchy.friends.forEach((e=>this.hierarchyLowerCase.friends.push(e.toLowerCase().replaceAll(" ","-")))),this.settings.hierarchy.exclusions=this.settings.hierarchy.exclusions.sort(((e,t)=>e.toLowerCase()<t.toLowerCase()?-1:1)),this.setHierarchyLinkStylesExtended(),this.linkStyles={},this.linkStyles.base={style:this.settings.baseLinkStyle,allowOverride:!1,userStyle:!1,display:A("LINKSTYLE_BASE"),getInheritedStyle:()=>this.settings.baseLinkStyle},this.linkStyles.inferred={style:this.settings.inferredLinkStyle,allowOverride:!0,userStyle:!1,display:A("LINKSTYLE_INFERRED"),getInheritedStyle:()=>this.settings.baseLinkStyle},this.linkStyles["file-tree"]={style:this.settings.folderLinkStyle,allowOverride:!0,userStyle:!1,display:A("LINKSTYLE_FOLDER"),getInheritedStyle:()=>this.settings.baseLinkStyle},this.linkStyles["tag-tree"]={style:this.settings.tagLinkStyle,allowOverride:!0,userStyle:!1,display:A("LINKSTYLE_TAG"),getInheritedStyle:()=>this.settings.baseLinkStyle},Object.entries(this.settings.hierarchyLinkStyles).forEach((e=>{w.contains(e[0])||(this.linkStyles[e[0]]={style:e[1],allowOverride:!0,userStyle:!0,display:e[0],getInheritedStyle:()=>this.settings.baseLinkStyle})})),this.nodeStyles={},this.nodeStyles.base={style:this.settings.baseNodeStyle,allowOverride:!1,userStyle:!1,display:A("NODESTYLE_BASE"),getInheritedStyle:()=>this.settings.baseNodeStyle},this.nodeStyles.inferred={style:this.settings.inferredNodeStyle,allowOverride:!0,userStyle:!1,display:A("NODESTYLE_INFERRED"),getInheritedStyle:()=>this.settings.baseNodeStyle},this.nodeStyles.virtual={style:this.settings.virtualNodeStyle,allowOverride:!0,userStyle:!1,display:A("NODESTYLE_VIRTUAL"),getInheritedStyle:()=>this.settings.baseNodeStyle},this.nodeStyles.central={style:this.settings.centralNodeStyle,allowOverride:!0,userStyle:!1,display:A("NODESTYLE_CENTRAL"),getInheritedStyle:()=>this.settings.baseNodeStyle},this.nodeStyles.sibling={style:this.settings.siblingNodeStyle,allowOverride:!0,userStyle:!1,display:A("NODESTYLE_SIBLING"),getInheritedStyle:()=>this.settings.baseNodeStyle},this.nodeStyles.attachment={style:this.settings.attachmentNodeStyle,allowOverride:!0,userStyle:!1,display:A("NODESTYLE_ATTACHMENT"),getInheritedStyle:()=>this.settings.baseNodeStyle},this.nodeStyles.folder={style:this.settings.folderNodeStyle,allowOverride:!0,userStyle:!1,display:A("NODESTYLE_FOLDER"),getInheritedStyle:()=>this.settings.baseNodeStyle},this.nodeStyles.tag={style:this.settings.tagNodeStyle,allowOverride:!0,userStyle:!1,display:A("NODESTYLE_TAG"),getInheritedStyle:()=>this.settings.baseNodeStyle},Object.entries(this.settings.tagNodeStyles).sort(((e,t)=>e[0].toLowerCase()<t[0].toLowerCase()?-1:1)).forEach((e=>{this.nodeStyles[e[0]]={style:e[1],allowOverride:!0,userStyle:!0,display:e[0],getInheritedStyle:()=>this.settings.baseNodeStyle}}))}async saveSettings(){await this.saveData(this.settings)}stop(){this.scene&&!this.scene.terminated&&(this.scene.unloadScene(),this.scene=null)}async start(e){if(!e.view)return;if(!(e.view instanceof n.TextFileView))return void new n.Notice("Wrong view type. Cannot start ExcaliBrain.");if(e.view.file.path!==this.settings.excalibrainFilepath)return void new n.Notice(`The brain file is not the one configured in settings!\nThe file in settings is ${this.settings.excalibrainFilepath}.\nThis file is ${e.view.file.path}.\nPlease start ExcaliBrain using the Command Palette action.`,5e3);let t=0;for(;!this.pluginLoaded&&t++<100;)await sleep(50);if(!this.pluginLoaded)return new n.Notice("ExcaliBrain plugin did not load - aborting start()"),void D({where:"ExcaliBrain.start()",fn:this.start,message:"ExcaliBrain did not load. Aborting after 5000ms of trying"});this.excalidrawAvailable()&&(this.stop(),e?(this.scene=new Tu(this,!0,e),this.scene.initialize(this.focusSearchAfterInitiation),this.focusSearchAfterInitiation=!1):await Tu.openExcalidrawLeaf(window.ExcalidrawAutomate,this.settings,this.getBrainLeaf()))}}module.exports=Ou;
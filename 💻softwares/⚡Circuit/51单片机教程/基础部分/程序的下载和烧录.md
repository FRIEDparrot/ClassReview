使用stc-isp在烧录时要重启一下单片机 
在下载程序时需要短接P31T与URXD以及P3OR与UTXD 

先选择串口(Scan Type)和芯片类型(MCU Type) : 本芯片的类型为STC89C516RD+ (用STC89C58RD+Series) 

选择波特率(Baud) 

# 工程配置方法
对于keil中文件的保存， 可以搜索AT89C52()
![[attachments/Pasted image 20231130014018.png|400]]
**在新建文件时, 右键相应的组选取添加项目**, 而不要新建文件后保存(否则无法接入工程) 
![[attachments/Pasted image 20231203120827.png]]

Translate 是编译, 而 Build可以建立相应的 

电阻的表示$102 - 10 \cdot 10^{2}, 473-47\cdot 10^{3}$

单片机使用TTL电平(高5V, 低0V)
P2寄存器连接驱动器 

为了能产生.hex文件, 我们可以找Options for Target , 中output -> create hex file 
![[attachments/Pasted image 20231130020009.png]]

```c 
#include <regx52.h>

void main(){
	P2 = 0xFD;  // 1111 1101 , 0 is high voltage level
	// P2 has defined in the regx52.h. this has been 
	while(true){
	}
}
```

STC-isp自带延时计算器, 也可以直接使用如下的函数(ms记): 

```c
#include <regx52.h>
#include <intrins.h>
#define D0 0xFF // 1111 1111
#define D1 0xFE // 1111 1110
#define D2 0xFD // 1111 1101
#define D3 0xFB // 1111 1011
#define D4 0xF7 // 1111 0111
#define D5 0xEF 
#define D6 0xDF 
#define D7 0xBF 
#define D8 0x7F 
void Delay(unsigned int xms)	//@12.000MHz
{
	while (xms > 0){
		unsigned char data i, j;
		for (i = 2;i>0;i--){
			for (j = 239; j> 0; j--){
			}
		}
		xms--;
	}
}
```

![[attachments/Pasted image 20231130023023.png]]

注意: 要求使用STC-Y1类型

16位: 
int 整形 32767
unsigned int 0-65535 
long 

需要参考源代码可以右键 Open document 
![[attachments/Pasted image 20231203115002.png]]

# 统计按键时长函数 

```c
sbit btn1 = P3^0; // 首先定义按钮
unsigned int xms;
for (xms = 0; !btn1; xms++) Delay(1); // 这个是每ms计数一次, 但是没有越界保护
```

对于需要考虑越界保护的情况, 给xms设定一个上界
```c
unsigned int xms;
for (xms = 0; !btn1; xms++) Delay(1);
```

GPIO(general purpose input output)为51单片机的通用输入输出端口。

实现GPIO的输入, 输出检测电平的高低。 
51单片机的引脚包括**电源引脚, 晶振引脚, 复位引脚，下载引脚和GPIO引脚**。

P1, P2, ... P3 都是GPIO引脚(绝大多数)
可以通过原理图可以通过数据手册和与原理图(管脚说明)

**GPIO引脚的原理**如图: 
![[Excalidraw/51单片机的GPIO引脚介绍 2023-12-07 19.43.04|500]]
输入缓冲器(三态门, 高电平, 低电平, 高阻状态)

只有读锁存器有效时, Q才能到达读入的一部分

读引脚要求读引脚的三态控制端有效
原理: 当$D$输入数据时, 如果CLK没有信号, 则D的数据无法传输到Q
只有$CLK$处得到时序, 则D的数据传输到$Q$的输出或者$\overline{Q}$的输出。当CLK的控制信号消失时, D端有锁存功能。

P0口可以作为通用的IO或者外扩存储器的总线口。
对于8031单片机, 内部没有ROM, 此时**P0口可以作为地址数据的总线来使用**。

多路开关**用于选择是地址数据总线还是普通的IO口来使用**。当多路开关<u>在下面时, P0口和读引脚以及读锁存器相连, 用于普通的IO口</u>, 而当多路开关在上方时, P0口和地址数据线连接, 作为地址的总线。

P0口的输出由两个MOS管组成的推拉式结构, 当V1导通时, V2截止, 只能导通一个。
参考[[📘ClassNotes/⚡Circuit/电工电子技术/第八章 数字电路基础|第八章 数字电路基础]], 右侧其实是一个非门结构。 

# GPIO 工作原理

## P0输出原理
P0端口**输出的原理**如下图所示, 当CLK有效时, CLK经过脉冲传到D锁存器, 经过V2漏极传到P0引脚
![[attachments/Pasted image 20231207195956.png|450]]
当控制信号为低电平0 时, V1截止, 此时P0是一个<b><mark style="background: transparent; color: blue">漏极开路</mark></b>**输出**， 类似OC门， **只有依靠外接上拉电阻才能输出高电平**。因此由于V1截止高电平是没办法输出的, 只能输出低电平，利用V2导通与GND得到输出端的低电平

如果需要接入外接上拉电阻, 范围4.7-10k
## P0端口输入原理
![[Excalidraw/51单片机的GPIO引脚介绍 2023-12-07 20.11.36|550]]

外扩地址的方法可以查阅其他资料获得。

# 其他端口的工作原理 
## P1端口的工作原理
P1 仅能作为数据的输入和输出进行使用, 即没有地址的写入, 但是**在P1 端口有一个上拉电阻代替了V1场效应管**。并且输出信息仅来自于内部总线。 反向之后输出到管脚, P1是具有输出锁存的静态口。

默认输出高电平 
具有输入和输出的端口称为**准双向口P1,P2,P3均为准双向口, 而P0 有三态功能, 输入前为高阻状态无需写入操作** 
![[attachments/Pasted image 20231207204709.png|400]]

## 2. P2端口 
在开关打到下方时, 功能上兼容了P0和P1端口的特点，除了可以起到地址数据的传输作用， 其中P0是低8位而P2是高8位(即可以通过P0和P2扩充一个16位RAM或者ROM)

内部也有上拉电阻
![[attachments/Pasted image 20231207205415.png]]

## P3端口 
除了普通的IO口，还有第二功能的输入和输出(与非门控制), 
![[Excalidraw/51单片机的GPIO引脚介绍 2023-12-07 20.59.45]]


